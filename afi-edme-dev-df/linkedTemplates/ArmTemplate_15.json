{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		},
		"Rest_Postalcodes_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "@{linkedService().BaseURL}"
		},
		"Rest_Postalcodes_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "Test"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/masterdata_CDP_CrossWalk_MD_OUT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "CrossWalk_MD_OUT"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/retailCustomer_dbo_CrossWalk_MD_OUT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "CrossWalk_MD_OUT"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/retail_v_legal_entity_scd')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/usp_ASH_REMOVE_LOAD')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Rest_Postalcodes')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"parameters": {
					"BaseURL": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('Rest_Postalcodes_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('Rest_Postalcodes_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AFIEDME_KeyVault_dev",
							"type": "LinkedServiceReference"
						},
						"secretName": "melissa-data-license-key"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CDP_Customer_Dedupe_CsvToTable')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CDP_Customer_Deduped",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "clusterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "globalID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "timestamp",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "customer_since",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "do_not_sell",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "EntryID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "do_not_sell_request_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "unsubscribe",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "unsubscribe_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "birthdate",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CDP_Customer_Deduped_csv",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									},
									"Container_Name": {
										"value": "@pipeline().parameters.Container_Name",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CDP_Customer_Dedeped",
								"type": "DatasetReference",
								"parameters": {
									"CDP_TableName": {
										"value": "@pipeline().parameters.Table_Name",
										"type": "Expression"
									},
									"Table_Schema": {
										"value": "@pipeline().parameters.Table_Schema",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"FileName": {
						"type": "String"
					},
					"Table_Name": {
						"type": "String"
					},
					"Table_Schema": {
						"type": "String"
					},
					"Container_Name": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cdp_Customer_Dedupe_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "cdp_customer_deduped",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \nclusterID,\nconfidence_score,\nglobalID,\nRecID,\nposRawContainerRecID,\nposFirstName,\nposMiddleInitial,\nposLastName,\nposCustomerEmail1,\nposCustomerEmail2,\nposCustomerEmail3,\nposCustomerPhone1,\nposCustomerPhone2,\nposCustomerPhone3,\nn_address,\nn_addr2,\nn_city,\nn_state,\nn_zip9,\nposFaceBookID,\nposTwitterID,\nmarket_id,\ncustomer_type,\ntimestamp,\ncustomer_since,\ndtec,\nposFirstNameSoundex,\nposLastNameSoundex,\nAlpha,\nSourceSystem,\nSourceSubSystem,\nracProfitCenter,\nracSalesNumber,\ndo_not_sell,\nEntryID,\ndo_not_sell_request_date,\nunsubscribe,\nunsubscribe_date,\nbirthdate\nFROM @{pipeline().parameters.CDPSchema}.@{pipeline().parameters.CDPTableName} WITH(NOLOCK) WHERE YEAR(dtec)=@{pipeline().parameters.Year} AND MONTH(dtec)=@{pipeline().parameters.Month}",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "cdp_customer_deduped",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Cdp_Customer_Deduped",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.SemarchySchema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.SemarchyTableName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"CDPSchema": {
						"type": "string"
					},
					"CDPTableName": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"SemarchySchema": {
						"type": "string"
					},
					"SemarchyTableName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Containerrate_Semarchy_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "To load Containerrate to EDW",
				"activities": [
					{
						"name": "Teams_Failed_Notification_CopyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Cp_ContainerRate_GD_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Cp_ContainerRate_GD_EDW').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Cp_ContainerRate_GD_EDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Cp_ContainerRate_GD_EDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Cp_ContainerRate_GD_EDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cp_ContainerRate_GD_EDW",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "Select distinct \nF_WAREHOUSE_ID\n,F_ASHLEY_PORT_ID\n,TYPE\n,RATE\n,FORMAT(EFFECTIVE_FROM, 'yyyy-MM-dd') as EFFECTIVE_FROM\n,FORMAT(EFFECTIVE_TO, 'yyyy-MM-dd') as EFFECTIVE_TO\n,B_CREDATE\n,B_UPDDATE\nfrom [dbo].[GD_CONTAINER_RATES]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_Wholesale_GD",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "GD_CONTAINER_RATES"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ContainerRate_Parquet",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Fail_job",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Cp_ContainerRate_GD_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": "Copy Activity Fails ",
							"errorCode": {
								"value": "@activity('Cp_ContainerRate_GD_EDW').output.executionDetails[0].status",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Wholesale/W_SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:27Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Country_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Country_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Country_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Country_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Country_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Country_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Country_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Country_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Country",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Country_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Country_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_COUNTRY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCOUNTRY_CODE_A2,\nCOUNTRY_CODE_A3,\nCOUNTRY_NAME,\nCOUNTRY_LOCAL_NAME,\nCOUNTRY_UN_CODE \nFROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_COUNTRY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_COUNTRY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Country_Table_Name": {
													"value": "@pipeline().parameters.Sink_Country_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Country_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Country_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Currency_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Currency_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Currency_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Currency_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Currency_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Currency_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Currency_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Currency_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Currency_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Currency",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Currency_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Currency_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_CURENCY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCURRENCY_CODE,\nCURRENCY_NAME\nFROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_CURRENCY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_CURENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_CURRENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_CURRENCY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Currency_Table_Name": {
													"value": "@pipeline().parameters.Sink_Currency_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Currency_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Currency_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_DMA_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Dma_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Dma_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Dma_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Dma_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_DMA WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Dma_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Dma_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Dma_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Dma_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Dma_Data_Not_Found_Logs_Stored_Procedurered",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For dma",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Dma_Data_Not_Found_Logs_Stored_Procedurered",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Dma_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Dma_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Dma_Class_Name}' as B_CLASSNAME,\nENTERPRISE_REF_DMA_ID,\nB_CLASSNAME,\nB_BATCHID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nDMA_REGION\nFROM GD_ENTERPRISE_REF_DMA WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Dma_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_DMAID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_DMA_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													},
													"sink": {
														"name": "EXTERNAL_REF_DMAID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DMA_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "DMA_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_DMA",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Dma_Table_Name": {
													"value": "@pipeline().parameters.Sink_Dma_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Dma_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Dma_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_PostalCode_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "EntRefSemarchyIntegration",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \nSinkDatabaseName,\nSinkTableName,\nSemarchyJobName,\nTableClassName,\nSinkTableSchemaName FROM [EntRef].[SemarchyIntegration] WITH(NOLOCk)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Stage_PostalCode_Query",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "LoadData",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "EntRefSemarchyIntegration",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('EntRefSemarchyIntegration').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{item().SinkDatabaseName}\n,@P_PROGRAM_NAME = @{item().SemarchyJobName}\n,@P_LOAD_DESCRIPTION = @{item().SemarchyJobName}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_PostalCode",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT DISTINCT \nPOSTAL_CODE_MASTER_ID,\n'@{item().TableClassName}' AS B_CLASSNAME,\nB_DELETETYPE,\nB_DELETEDATE,\nCASE\nWHEN B_DELETETYPE='SOFT_DELETE' THEN 'semadmin'\nELSE B_DELETEAUTHOR END AS B_DELETEAUTHOR,\nCASE\nWHEN B_DELETETYPE='SOFT_DELETE' THEN NEWID()\nELSE B_DELETEOPERATION END AS B_DELETEOPERATION,\nB_DELETEPATH,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nPOSTAL_CODE,\nSTATE_OR_PROVINCE_CODE,\nCITY_NAME,\nCITY_ABBREVIATION,\nCOUNTRY_CODE,\nTIME_ZONE,\nOBSERVES_DST,\nLONGITUDE,\nIS_PREFERRED_CITY_NAME,\nPOSTAL_CODE_TYPE,\nMSA_CODE,\n--F_MSA_ID,\nFIPS_CODE,\nLATITUDE\nFROM [EntRef].[PostalCodes] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEOPERATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETEOPERATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEPATH",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETEPATH",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_POSTAL_CODE_MASTER_Sink",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@item().SinkDatabaseName",
													"type": "Expression"
												},
												"PostalCode_Table_Name": {
													"value": "@item().SinkTableName",
													"type": "Expression"
												},
												"Table_Schema": {
													"value": "@item().SinkTableSchemaName",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@item().SemarchyJobName",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "PostalCode_ErrorLogs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_PostalCode').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "@item().SinkTableName",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[EntRef].[PostalCodes]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_Load_PostalCode",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_PostalCode').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_PostalCode",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_PostalCode').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Cancel_PostalCode_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "RemoveEntRefSemarchyIntegration",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LoadData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "Truncate Table [EntRef].[PostalCodes] ;\nselect 1 as succeeded;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Stage_PostalCode_Query",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-10-26T05:56:46Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_PostalCode_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Postalcode_Source_Count",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM dbo.GD_ENT_REF_POSTAL_CODE WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Postalcode_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Postalcode_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Country_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Country",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "Enterprise_ReferenceMaster",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "PostalCode_Copy_Data",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \nENT_REF_POSTAL_CODE_ID,\n'@{pipeline().parameters.Postalcode_Class_Name}' AS B_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nPOSTAL_CODE,\nSTATE_OR_PROVINCE_CODE,\nCITY_NAME,\nCITY_ABBREVIATION,\nCOUNTRY_CODE,\nTIME_ZONE,\nOBSERVES_DST,\nLATITUDE,\nLONGITUDE,\nIS_PREFERRED_CITY_NAME,\nPOSTAL_CODE_TYPE,\nF_MSA_ID,\nFIPS_CODE\nFROM dbo.GD_ENT_REF_POSTAL_CODE WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENT_REF_POSTAL_CODE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "F_MSA_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_POSTAL_CODE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"PostalCode_Table_Name": {
													"value": "@pipeline().parameters.Sink_Postalcode_Table_Name",
													"type": "Expression"
												},
												"Table_Schema": {
													"value": "@pipeline().parameters.Sink_TableSchemaName",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "PostalCode_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadId",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Postalcode_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Postalcode_Class_Name": {
						"type": "string"
					},
					"Sink_TableSchemaName": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-10-26T05:56:47Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Time_Zone_EFF_DT_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Time_Zone_EFF_DT_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Time_Zone_EFF_DT_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENT_REF_TIME_ZONE_EFF_DT WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Time_Zone_EFF_DT_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Time_Zone_EFF_DT_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Time_Zone_EFF_DT_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Time_Zone_EFF_DT_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For TIME_ZONE_EFF_DT",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_EFF_DT_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Time_Zone_EFF_DT_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Time_Zone_EFF_DT_Class_Name}' as B_CLASSNAME,\nENT_REF_TIME_ZN_EFF_DT_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nTIME_ZONE_EFFECTIVE_YEAR,\nDST_START_DT,\nDST_END_DT,\nF_ENTERPRISE_REF_TIME_ZONE\nFROM GD_ENT_REF_TIME_ZONE_EFF_DT WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Time_Zone_EFF_DT_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_TIME_ZONE_EF"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENT_REF_TIME_ZN_EFF_DT_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "EXTERNAL_REF_TIME_ZONE_EF",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_EFFECTIVE_YEAR",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "TIME_ZONE_EFFECTIVE_YEAR",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												},
												{
													"source": {
														"name": "DST_START_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DST_START_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "DST_END_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DST_END_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "F_ENTERPRISE_REF_TIME_ZONE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "F_EXTERNAL_REF_TIME_ZONE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_TIME_ZONE_EF",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Time_Zone_EFF_DT_Table_Name": {
													"value": "@pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_EFF_DT_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_EFF_DT_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Time_Zone_EFF_DT_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_TIME_ZONE_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Time_Zone_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Time_Zone_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Time_Zone_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Time_Zone_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_TIME_ZONE WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Time_Zone_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Time_Zone_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Time_Zone_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Time_Zone_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Time_Zone_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For TIME_ZONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Time_Zone_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Time_Zone_Class_Name}' as B_CLASSNAME,\nENTERP_REF_TIME_ZONE_ID,\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nTIME_ZONE_NAME,\nTIME_ZONE_ABR_STD,\nTIME_ZONE_ABR_DST,\nUTC_OFFSET_STD,\nUTC_OFFSET_DST\nFROM GD_ENTERPRISE_REF_TIME_ZONE WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Time_Zone_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_TIME_ZONE_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERP_REF_TIME_ZONE_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "EXTERNAL_REF_TIME_ZONE_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_ABR_STD",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_ABR_STD",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_ABR_DST",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_ABR_DST",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "UTC_OFFSET_STD",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "UTC_OFFSET_STD",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												},
												{
													"source": {
														"name": "UTC_OFFSET_DST",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "UTC_OFFSET_DST",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_TIME_ZONE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Time_Zone_Table_Name": {
													"value": "@pipeline().parameters.Sink_Time_Zone_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Time_Zone_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_US_STATE_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_State_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_US_State_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "US_State_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "US_State_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_US_STATE WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('US_State_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_US_State_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "US_State_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('US_State_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "US_State_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For US_STATE",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "US_State_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "US_State_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.US_State_Class_Name}' as B_CLASSNAME,\nENTERP_REF_US_STATE_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nSTATE_CODE,\nSTATE_NAME\nFROM GD_ENTERPRISE_REF_US_STATE WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('US_State_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_US_STATE_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERP_REF_US_STATE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_US_STATE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_US_STATE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"US_State_Table_Name": {
													"value": "@pipeline().parameters.Sink_US_State_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "US_State_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_US_State_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"US_State_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ProcessRCMRFD",
						"type": "IfCondition",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(pipeline().parameters.EntityCount),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": "No RAW Data Available For AllSourceCustomers",
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "WaitForSP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = @{concat('Delete',pipeline().parameters.EntityName)}\n,@P_LOAD_DESCRIPTION = @{concat('Delete',pipeline().parameters.EntityName)}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "usp_ASH_REMOVE_LOAD",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[usp_ASH_REMOVE_LOAD]",
										"storedProcedureParameters": {
											"Entity": {
												"value": {
													"value": "@pipeline().parameters.EntityName",
													"type": "Expression"
												},
												"type": "String"
											},
											"LoadID": {
												"value": {
													"value": "@int(activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT)",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"RecordsToDelete": {
												"value": {
													"value": "@int(pipeline().parameters.EntityCount)",
													"type": "Expression"
												},
												"type": "Int32"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "Retail_CustomerMaster",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "usp_ASH_REMOVE_LOAD",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@{concat('Delete',pipeline().parameters.EntityName)}",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@int(activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT)",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "WaitForSP",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 5
									}
								},
								{
									"name": "Teams_Failed_Notification_RFD_SP",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "usp_ASH_REMOVE_LOAD",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": "0",
											"status": {
												"value": "Failed",
												"type": "Expression"
											},
											"message": {
												"value": "usp_DeleteRFDLocalStage Execution Failed",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('usp_ASH_REMOVE_LOAD').output.executionDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"EntityCount": {
						"type": "string"
					},
					"EntityName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow/RCM_RFD_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-11-08T08:53:29Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Historical_National_Assortment_SemarchyToEDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "NationalAssortmentToEDW",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPM.PRODUCT_MAIN_ID as Item, \nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.ITEM_FRIENDLY_DESCRIPTION as Item_Description,\nPM.SERIES_NUMBER as Series,\nPM.SERIES_NAME as Group_Description,\nPM.STATUS as Status,\nPM.ITEM_HS_PRODUCT_LINE as Product_Line,\nPM.ITEM_RETAIL_TYPE as Grouping,\nPM.ITEM_TYPE as Item_Type,\nPM.ITEM_IMPORT_DOMESTIC as Domestic_Import,\nPM.ITEM_FUTURE_STATUS as PD_Status,\nNA.HERO_SKU as HERO_SKU,\nNA.BUSINESS_CHANNEL as Business_Channel,\nNA.STORE_AREA as Store_Area,\nNPL.PRIMARY_LOOK as Primary_Look,\nNSL.SECONDARY_LOOK as Secondary_Look,\nNA.GOOD_BETTER_BEST as Good_Better_Best,\nNA.CMDT_EXCLSV_PRPRTRY_SGNTR as E_P_SD_SDC,\nNA.MONTH as Month,\nNA.MARKET_INTRODUCTION as Market_Introduction,\nNA.SIZE_SHAPE as Size_Shape,\nNA.FEATURE1 as Feature1,\nNA.FEATURE2 as Feature2,\nNA.FOUNDATION as Foundation,\nNPM.PROGRAM as Program,\nNA.ASSORTMENT as Assortment,\nNA.B_CREDATE as Create_Date,\nNA.B_UPDDATE as Update_Date,\nNA.B_CREATOR as Creator,\nNA.B_UPDATOR as Updator\nFROM GH_NATIONAL_ASSORTMENT NA INNER JOIN GD_PRODUCT_MAIN PM\nON NA.F_PRODUCT_MAIN_ITEM = PM.PRODUCT_MAIN_ID\nLEFT JOIN GD_NA_PRIMARY_LOOK_REF NPL\nON NA.F_PRIMARY_LOOK_REF = NPL.NA_PRIMARY_LOOK_REF_ID\nLEFT JOIN GD_NA_SECONDARY_LOOK_REF NSL\nON NA.F_SECONDARY_LOOK_REF = NSL.NA_SECONDARY_LOOK_REF_ID\nLEFT JOIN GD_NA_PROGRAM_REF NPM\nON NA.F_PROGRAM_REF = NPM.NA_PROGRAM_REF_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_NATIONAL_ASSORTMENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NationalAssortmentProduct_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('NationalAssortmentToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('NationalAssortmentToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SemarchyToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalNationalAssortmentProduct",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nSS.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nSS.B_CREDATE as Create_Date,\nSS.B_UPDDATE as Update_Date,\nSS.B_CREATOR as Creator,\nSS.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GH_SISTER_SKU SS\n ON PG.PRODUCT_GROUP_ID = SS.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON SS.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_SISTER_SKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sister_SKU_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ColorwheelToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nCW.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nCW.B_CREDATE as Create_Date,\nCW.B_UPDDATE as Update_Date,\nCW.B_CREATOR as Creator,\nCW.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GH_COLORWHEEL CW\n ON PG.PRODUCT_GROUP_ID = CW.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON CW.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_COLORWHEEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Colorwheel_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SisterSKUToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SisterSKUToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SisterSKUToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_ColorwheelToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('ColorwheelToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('ColorwheelToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SisterSKUToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalSisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalColorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SemarchyToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('NationalAssortmentToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalNationalAssortmentProduct\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SisterSKUToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalSisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('ColorwheelToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalColorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nC.SERIES_NUMBER AS Series_Number, \nC.SERIES_NAME AS Series_Name,\nC.ITEM_HS_PRODUCT_LINE AS Category,\nB.FOUNDATION AS National_Foundation,\nA.[WEST_FOUNDATION] AS West_Foundation,\nA.[WEST_OUTLET] AS West_Outlet,\nA.[B_CREDATE] AS Create_Date,\nA.[B_UPDDATE] AS Update_Date,\nA.[B_CREATOR] AS Creator,\nA.[B_UPDATOR] AS Updator\n  FROM [dbo].[GH_WEST_FOUNDATION] A\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT B\n  ON A.F_NATIONAL_ASSORTMENT = B.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN C\n  ON B.F_PRODUCT_MAIN_ITEM = C.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_WEST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WestFoundation_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_WestFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WestFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WestFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WestFoundationToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalWestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WestFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalWestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nC.SERIES_NUMBER AS Series_Number, \nC.SERIES_NAME AS Series_Name,\nC.ITEM_HS_PRODUCT_LINE AS Category,\nB.FOUNDATION AS National_Foundation,\nA.[EAST_FOUNDATION] AS East_Foundation,\nA.[EAST_OUTLET] AS East_Outlet,\nA.[B_CREDATE] AS Create_Date,\nA.[B_UPDDATE] AS Update_Date,\nA.[B_CREATOR] AS Creator,\nA.[B_UPDATOR] AS Updator\n  FROM [dbo].[GH_EAST_FOUNDATION] A\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT B\n  ON A.F_NATIONAL_ASSORTMENT = B.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN C\n  ON B.F_PRODUCT_MAIN_ITEM = C.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_EAST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EastFoundation_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_EastFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('EastFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('EastFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/EastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('EastFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalEastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_National_Assortment_SemarchyToEDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "NationalAssortmentToEDW",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPM.PRODUCT_MAIN_ID as Item, \nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.ITEM_FRIENDLY_DESCRIPTION as Item_Description,\nPM.SERIES_NUMBER as Series,\nPM.SERIES_NAME as Group_Description,\nPM.STATUS as Status,\nPM.ITEM_HS_PRODUCT_LINE as Product_Line,\nPM.ITEM_RETAIL_TYPE as Grouping,\nPM.ITEM_TYPE as Item_Type,\nPM.ITEM_IMPORT_DOMESTIC as Domestic_Import,\nPM.ITEM_FUTURE_STATUS as PD_Status,\nNA.HERO_SKU as HERO_SKU,\nNA.BUSINESS_CHANNEL as Business_Channel,\nNA.STORE_AREA as Store_Area,\nNPL.PRIMARY_LOOK as Primary_Look,\nNSL.SECONDARY_LOOK as Secondary_Look,\nNA.GOOD_BETTER_BEST as Good_Better_Best,\nNA.CMDT_EXCLSV_PRPRTRY_SGNTR as E_P_SD_SDC,\nNA.MONTH as Month,\nNA.MARKET_INTRODUCTION as Market_Introduction,\nNA.SIZE_SHAPE as Size_Shape,\nNA.FEATURE1 as Feature1,\nNA.FEATURE2 as Feature2,\nNA.FOUNDATION as Foundation,\nNPM.PROGRAM as Program,\nNA.ASSORTMENT as Assortment,\nNA.B_CREDATE as Create_Date,\nNA.B_UPDDATE as Update_Date,\nNA.B_CREATOR as Creator,\nNA.B_UPDATOR as Updator\nFROM GD_NATIONAL_ASSORTMENT NA INNER JOIN GD_PRODUCT_MAIN PM\nON NA.F_PRODUCT_MAIN_ITEM = PM.PRODUCT_MAIN_ID\nLEFT JOIN GD_NA_PRIMARY_LOOK_REF NPL\nON NA.F_PRIMARY_LOOK_REF = NPL.NA_PRIMARY_LOOK_REF_ID\nLEFT JOIN GD_NA_SECONDARY_LOOK_REF NSL\nON NA.F_SECONDARY_LOOK_REF = NSL.NA_SECONDARY_LOOK_REF_ID\nLEFT JOIN GD_NA_PROGRAM_REF NPM\nON NA.F_PROGRAM_REF = NPM.NA_PROGRAM_REF_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_NATIONAL_ASSORTMENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NationalAssortmentProduct",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('NationalAssortmentToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('NationalAssortmentToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SemarchyToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/NationalAssortmentProduct",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nSS.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nSS.B_CREDATE as Create_Date,\nSS.B_UPDDATE as Update_Date,\nSS.B_CREATOR as Creator,\nSS.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GD_SISTER_SKU SS\n ON PG.PRODUCT_GROUP_ID = SS.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON SS.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_SISTER_SKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sister_SKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ColorwheelToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nCW.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nCW.B_CREDATE as Create_Date,\nCW.B_UPDDATE as Update_Date,\nCW.B_CREATOR as Creator,\nCW.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GD_COLORWHEEL CW\n ON PG.PRODUCT_GROUP_ID = CW.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON CW.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_COLORWHEEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Colorwheel",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SisterSKUToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SisterSKUToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SisterSKUToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_ColorwheelToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('ColorwheelToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('ColorwheelToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SisterSKUToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/SisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/Colorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SemarchyToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('NationalAssortmentToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/NationalAssortmentProduct",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SisterSKUToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/SisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('ColorwheelToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/Colorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n\t  c.SERIES_NUMBER \n\t  ,c.SERIES_NAME\n\t  ,c.ITEM_HS_PRODUCT_LINE AS Category\n\t  , b.FOUNDATION AS National_Foundation\n      ,a.[WEST_FOUNDATION] AS West_Foundation\n      ,a.[West_OUTLET] AS West_Outlet\n\t   , a.[B_CREDATE] AS Create_Date\n      ,a.[B_UPDDATE] AS Update_Date\n      ,a.[B_CREATOR] AS Creator\n      ,a.[B_UPDATOR] AS Updator\n  FROM [dbo].[GD_WEST_FOUNDATION] a\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT b\n  ON a.F_NATIONAL_ASSORTMENT = b.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN c\n  ON b.F_PRODUCT_MAIN_ITEM = c.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_WEST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WestFoundation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_WestFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WestFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WestFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WestFoundationToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/WestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WestFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/WestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n\t  c.SERIES_NUMBER \n\t  ,c.SERIES_NAME\n\t  ,c.ITEM_HS_PRODUCT_LINE AS Category\n\t  , b.FOUNDATION AS National_Foundation\n      ,a.[EAST_FOUNDATION] AS East_Foundation\n      ,a.[EAST_OUTLET] AS East_Outlet\n\t   , a.[B_CREDATE] AS Create_Date\n      ,a.[B_UPDDATE] AS Update_Date\n      ,a.[B_CREATOR] AS Creator\n      ,a.[B_UPDATOR] AS Updator\n  FROM [dbo].[GD_EAST_FOUNDATION] a\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT b\n  ON a.F_NATIONAL_ASSORTMENT = b.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN c\n  ON b.F_PRODUCT_MAIN_ITEM = c.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_EAST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EastFoundation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_EastFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('EastFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('EastFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/EastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('EastFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/EastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMasterLoad_Retail_Delete_PIM_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load_Retail_PIM_Delete_EDWProduct",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetDateVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nPRODUCT_MAIN_ID,\nLAST_MOD_DATE_TIME_UTC,\nB_CREDATE,\nB_CLASSNAME,\nB_DELETETYPE,\nB_DELETEOPERATION,\nB_DELETEAUTHOR,\nB_DELETEDATE,\nSOURCE_ID,\nSTATUS,\nSYSTEM_TIMESTAMP,\nALTERNATE_DESCRIPTION2,\nITEM_AFI_IMAGE_SET,\nITEM_ALTERNATE_AFI_FLUFF1,\nITEM_ALTER_DESC3,\nITEM_ARVR_READY,\nITEM_ASM_INSTR_INTERNAL,\nITEM_ASM_INSTR_PUBLIC,\nITEM_BOX_QTY,\nITEM_CARTON_DEPTH_IN,\nITEM_CARTON_DEPTH_MM,\nITEM_CARTON_HEIGHT_IN,\nITEM_CARTON_HEIGHT_MM,\nITEM_CARTON_WIDTH_IN,\nITEM_CARTON_WIDTH_MM,\nITEM_CLASS,\nITEM_CODE,\nITEM_COLOR,\nITEM_COLOR_SWATCH,\nITEM_COMMODITY,\nITEM_COMPONENT_QUANTITY,\nITEM_CONSUMER_ASSEMBLY,\nITEM_CUBES_FT,\nITEM_CUBES_M,\nITEM_DEAD,\nITEM_DIMENSION_SKETCH,\nITEM_DINING_CHAIR_QTY_CTN,\nITEM_ENGINEERING_DIVISION,\nITEM_EXCLUSIVE,\nITEM_EXCLUSIVE_COMMENT,\nITEM_EXPRESS_SHIP,\nITEM_FOB_BASE_PRICE,\nITEM_FORECAST_PLANNER_ID,\nITEM_FRIENDLY_DIMENSIONS,\nITEM_FUTURE_STATUS,\nITEM_GNRL_DESC_ID,\nITEM_GNRL_LONG_DESC,\nITEM_GOOGLE_TITLE,\nITEM_HOMSTORE_ASM_VIDEO1,\nITEM_HTS_CODE,\nITEM_IMPORT_DOMESTIC,\nITEM_KEY_ITEM,\nITEM_KNOCKOUT,\nITEM_MTERIAL_REF_NEEDED,\nITEM_MFG_WARRANTY,\nITEM_NUMBER,\nITEM_PHOTO,\nITEM_PRODUCT_DEPTH_IN,\nITEM_PRODUCT_DEPTH_MM,\nITEM_PRODUCT_HEIGHT_IN,\nITEM_PRODUCT_HEIGHT_MM,\nITEM_PRODUCT_PAGE_URL,\nITEM_PRODUCT_WIDTH_IN,\nITEM_PRODUCT_WIDTH_MM,\nITEM_RETAIL_BRAND_NAME,\nITEM_RETAIL_TYPE,\nITEM_ROLL_OVERIMAGE,\nITEM_SALES_CATEGORY_CODE,\nITEM_SCENE7_IMAGE_SET,\nITEM_SEATS,\nITEM_SERIES_NAME,\nITEM_SERIES_NUMBER,\nITEM_STAND_ALONE_FLAG,\nITEM_STATUS,\nITEM_STATUS_CHANGED,\nITEM_SUPP_DT_SHIP_ONLY,\nITEM_SUPP_WET_NET_WET_KG,\nITEM_SUPP_WET_NET_WET_LBS,\nITEM_THIRD_PARTY_ITEM,\nITEM_TRACKING_PIECE,\nITEM_TRADEMARK_TEXT,\nITEM_TYPE,\nITEM_UNIT_WEIGHT_KG,\nITEM_UNIT_WEIGHT_LBS,\nITEM_UPC,\nITEM_VALIDATION_COMPLETE,\nITEM_WHOLESALE_ASM_VIDEO1,\nITEM_AFI_FEATURE_BULLET1,\nITEM_AFI_FEATURE_BULLET2,\nITEM_AFI_FEATURE_BULLET3,\nITEM_AFI_FEATURE_BULLET4,\nITEM_AFI_FEATURE_BULLET5,\nITEM_AFI_FEATURE_BULLET6,\nITEM_AFI_FEATURE_BULLET7,\nITEM_CONSUMER_DESCRIPTION,\nITEM_FLUFF_AFI,\nITEM_FLUFF_PRINT,\nITEM_FRIENDLY_DESCRIPTION,\nITEM_HOMESTORE_FT_BULLET1,\nITEM_HOMESTORE_FT_BULLET2,\nITEM_HOMESTORE_FT_BULLET3,\nITEM_HOMESTORE_FT_BULLET4,\nITEM_HOMESTORE_FT_BULLET5,\nITEM_HOMESTORE_FT_BULLET6,\nITEM_HOMESTORE_FT_BULLET7,\nITEM_HOMESTORE_FT_BULLET8,\nITEM_HOMESTORE_ITEM_FLUFF,\nSERIES_ASHLEY_HOMESTORE,\nSERIES_CORP_ONLINE_SELLNG,\nSERIES_DIVISION,\nSERIES_EXCLUSIVE_COMMENT,\nSERIES_FEATURES,\nSERIES_ID,\nSERIES_INTERNATIONAL_HS,\nSERIES_INTRO_DATE,\nSERIES_MAIN_IMAGE,\nSERIES_NAME,\nSERIES_NUMBER,\nSERIES_RETAIL_SALES_CATEG,\nSERIES_SHOWROOM,\nSERIES_SOURCE_ID,\nSERIES_STATUS,\nSERIES_STYLE,\nSERIES_THIRD_PARTY,\nSERIES_PRIMARY,\nITEM_UOM_KEY,\nITEM_SHIPPABLE_UOM_KEY,\nITEM_ELIG_PROTECTION_PLAN,\nITEM_IS_PROTECTION_PLAN,\nITEM_ASHCOMM_DLVR_MODE,\nITEM_MATERIAL,\nITEM_HS_PRODUCT_LINE,\nITEM_ECOM_MERCHANT_NOTES,\nITEM_AMAZON_BRAND_OWNER,\nITEM_LIFESTYLE_DESC\nFROM [Retail].[EDWProductDelete] WITH(NOLOCK) WHERE CAST(LAST_MOD_DATE_TIME_UTC AS date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_Delete_EDWProductKit",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nKIT_ID,\nLAST_MOD_DATE_TIME_UTC,\nB_CREDATE,\nB_CLASSNAME,\nB_DELETETYPE,\nB_DELETEOPERATION,\nB_DELETEAUTHOR,\nB_DELETEDATE,\nCREATED_DATE_TIME_UTC,\nKIT_ADDITIONAL_DIMENSIONS,\nKIT_AFI_FT_BULLET1_ENG,\nKIT_AFI_FT_BULLET2_ENG,\nKIT_AFI_FT_BULLET3_ENG,\nKIT_AFI_FT_BULLET4_ENG,\nKIT_AFI_FT_BULLET5_ENG,\nKIT_AFI_FT_BULLET6_ENG,\nKIT_AFI_FT_BULLET7_ENG,\nKIT_AFI_IMAGE_SET,\nKIT_ALTER_DESC2,\nKIT_ALTER_DESC3,\nKIT_ALTERNATE_AFI_FLUFF1,\nKIT_AMAZON_BRAND_OWNER,\nKIT_ARVR_READY,\nKIT_ASHCOMM_DELIVERY_MODE,\nKIT_ASM_INSTR_INTERNAL,\nKIT_ASM_INSTR_PUBLIC,\nKIT_ATP_SERIES,\nKIT_AX_KIT_NUMBER,\nKIT_BOX_QTY,\nKIT_CARTON_DENSITY,\nKIT_CARTON_DEPTH_IN,\nKIT_CARTON_DEPTH_MM,\nKIT_CARTON_FREIGHT_CLASS,\nKIT_CARTON_HEIGHT_IN,\nKIT_CARTON_HEIGHT_MM,\nKIT_CARTON_VOLUME,\nKIT_CARTON_WIDTH_IN,\nKIT_CARTON_WIDTH_MM,\nKIT_CLASS_KEY,\nKIT_CODE_KEY,\nKIT_COLOR_KEY,\nKIT_COLOR_SWATCH,\nKIT_COMMODITY,\nKIT_COMPONENT_QUANTITY,\nKIT_COND_HOME_DELIV_ELIG,\nKIT_CONSUMER_ASSEMBLY,\nKIT_CONSUMER_DESC_ENG,\nKIT_CUBES_FT,\nKIT_CUBES_M,\nKIT_DEAD,\nKIT_DFLT_GROUP_CODE_KEY,\nKIT_DIMENSION_SKETCH,\nKIT_DIMENSIONS_CONFIRMED,\nKIT_DINING_CHAIR_QTY_CTN,\nKIT_ECOM_MERCHANT_NOTES,\nKIT_ELIG_PROTECTION_PLAN,\nKIT_ENGINEER_DIVISION_KEY,\nKIT_EXCLUSIVE,\nKIT_EXCLUSIVE_COMMENT,\nKIT_EXPRESS_SHIP,\nKIT_FAMILYOF_BUSINESS_KEY,\nKIT_FLUFF_AFI_ENGLISH,\nKIT_FLUFF_PRINT_ENGLISH,\nKIT_FOB_BASE_PRICE,\nKIT_FORECAST_PLANNER_ID,\nKIT_FRIENDLY_DESC_ENG,\nKIT_FRIENDLY_DIMENSIONS,\nKIT_FUTURE_STATUS,\nKIT_GEN_DESC_ID,\nKIT_GEN_LONG_DESC,\nKIT_GOOGLE_TITLE,\nKIT_HOMESTORE_ASM_VIDEO1,\nKIT_HOMESTORE_PDT_LINE,\nKIT_HS_FT_BULLET1_ENG,\nKIT_HS_FT_BULLET2_ENG,\nKIT_HS_FT_BULLET3_ENG,\nKIT_HS_FT_BULLET4_ENG,\nKIT_HS_FT_BULLET5_ENG,\nKIT_HS_FT_BULLET6_ENG,\nKIT_HS_FT_BULLET7_ENG,\nKIT_HS_FT_BULLET8_ENG,\nKIT_HS_KIT_FLUFF_ENG,\nKIT_HTS_CODE,\nKIT_IMPORT_DOMESTIC_KEY,\nKIT_IS_PROTECTION_PLAN,\nKIT_KEY_KIT,\nKIT_KNOCKOUT,\nKIT_MATERIAL_ENGLISH,\nKIT_MFG_WARRANTY,\nKIT_NOT_AVBL_INDIV_SALE,\nKIT_NUMBER,\nKIT_PARTS_DRAWINGS,\nKIT_PHOTO,\nKIT_PK_LEG_SELLABLE_PKG,\nKIT_PRIMARY_LIFESTYLE,\nKIT_PRODUCT_DEPTH_IN,\nKIT_PRODUCT_DEPTH_MM,\nKIT_PRODUCT_HEIGHT_IN,\nKIT_PRODUCT_HEIGHT_MM,\nKIT_PRODUCT_PAGE_URL,\nKIT_PRODUCT_WIDTH_IN,\nKIT_PRODUCT_WIDTH_MM,\nKIT_PURCHASE_TYPE,\nKIT_RETAIL_BRAND_NAME_KEY,\nKIT_RETAIL_ROOM_KEY,\nKIT_RETAIL_TYPE_KEY,\nKIT_ROLL_OVER_IMAGE,\nKIT_SALES_CATEG_CODE_KEY,\nKIT_SCENE7_IMAGE_SET,\nKIT_SEATS,\nKIT_SELLLING_COUNTRIES,\nKIT_SERIES_NUMBER,\nKIT_SERIES_RT_SL_CAT_KEY,\nKIT_SHIPPABLE_UOM_KEY,\nKIT_SHIPPING_DEPTH_IN,\nKIT_SHIPPING_DEPTH_MM,\nKIT_SHIPPING_HEIGHT_IN,\nKIT_SHIPPING_HEIGHT_MM,\nKIT_SHIPPING_WIDTH_IN,\nKIT_SHIPPING_WIDTH_MM,\nKIT_SHOWROOM_MKT_STATUS,\nKIT_SOURCE_ID,\nKIT_STAND_ALONE_FLAG,\nKIT_STATUS,\nKIT_STATUS_CHANGED,\nKIT_STATUS_KEY,\nKIT_SUPP_WT_NET_WT_KG,\nKIT_SUPP_WT_NET_WT_LBS,\nKIT_SUPPLIER_DT_SHIP_ONLY,\nKIT_THIRD_PARTY_KIT,\nKIT_TRACKING_PIECE,\nKIT_TRADEMARK_TEXT,\nKIT_TYPE,\nKIT_UNIT_WEIGHT_KG,\nKIT_UNIT_WEIGHT_LBS,\nKIT_UOM_KEY,\nKIT_UPC,\nKIT_UPHOLSTERY_COVER,\nKIT_VALIDATION_COMPLETE,\nKIT_VENDOR_NAME,\nKIT_WHOLESALE_ASM_VIDEO1,\nSERIES_ID,\nSERIES_KEY\nFROM [Retail].[EDWProductKitDelete] WITH(NOLOCK) WHERE CAST(LAST_MOD_DATE_TIME_UTC AS date)>='@{variables('Date')}'\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_BOX_QTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductKit",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_Delete_EDWProductPackage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nPACKAGE_ID,\nLAST_MOD_DATE_TIME_UTC,\nB_CREDATE,\nB_CLASSNAME,\nB_DELETETYPE,\nB_DELETEOPERATION,\nB_DELETEAUTHOR,\nB_DELETEDATE,\nPACKAGE_KEY,\nHOMESTORE_PACKAGE_ID,\nCREATED_DATE_TIME_UTC,\nPACKAGE_NUMBER,\nPACKAGE_ALTER_NAME,\nPACKAGE_HERO,\nPACKAGE_STATUS,\nPACKAGE_STATUS_CHANGED,\nPACKAGE_IS_THIRD_PARTY,\nPACKAGE_HOMESTORE_ID,\nPACKAGE_WHOLESALE_ID,\nPACKAGE_RETAIL_TYPE,\nPACKAGE_ITEM_QUANTITY,\nPACKAGE_UOM,\nPACKAGE_COLOR,\nPACKAGE_KNOCKOUT,\nPACKAGE_SCENE7_IMAGE_SET,\nPACKAGE_VALIDAT_COMPLETE,\nPACKAGE_VALIDATION_NOTES,\nPACKAGE_ROLLOVER_IMAGE,\nPACKAGE_EXPRESS_SHIP,\nPACKAGE_SUPP_DT_SHIP_ONLY,\nPACKAGE_SALES_CATEG_CODE,\nPACKAGE_SERIES_NUMBER,\nPACKAGE_SERIES_NAME,\nPACKAGE_CODE,\nPACKAGE_ASHCOM_TRANSITION,\nPACKAGE_SWATCH_GROUP_ID,\nPACKAGE_DEFAULT_PRODUCT,\nPACKAGE_NEW_FLAG_DATE,\nPACKAGE_ASHCOMM_DLVR_MODE,\nPACKAGE_CHANNEL_CHANGE,\nPACKAGE_EXCLUSIVE,\nPACKAGE_HOT_SPOTS_REVIEW,\nPACKAGE_ALT_DESC1,\nPACKAGE_ASH_TTL_OVERRIDE,\nPACKAGE_HIDDEN_FIELD,\nPACKAGE_CONSUMER_CHOICE,\nPACKAGE_TOTAL_ASM_TIME,\nPACKAGE_ASHCOMM_FLAGS,\nPACKAGE_NAVIGABLE_CATEG,\nPACKAGE_NAME,\nPACKAGE_AFI_FLUFF,\nPACKAGE_HS_PACKAGE_FLUFF,\nPACKAGE_AFI_BULLETS1,\nPACKAGE_AFI_BULLETS2,\nPACKAGE_AFI_BULLETS3,\nPACKAGE_AFI_BULLETS4,\nPACKAGE_AFI_BULLETS5,\nPACKAGE_AFI_BULLETS6,\nPACKAGE_HOMESTORE_BULLET1,\nPACKAGE_HOMESTORE_BULLET2,\nPACKAGE_HOMESTORE_BULLET3,\nPACKAGE_HOMESTORE_BULLET4,\nPACKAGE_HOMESTORE_BULLET5,\nPACKAGE_HOMESTORE_BULLET6\nFROM [Retail].[EDWProductPackageDelete] WITH(NOLOCK) WHERE CAST(LAST_MOD_DATE_TIME_UTC AS date)>='@{variables('Date')}'\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SetDateVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Date",
							"value": {
								"value": "@formatDateTime(adddays(startOfDay(utcnow()),-1), 'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Product_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProduct]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Product",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_Delete_EDWProduct').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProduct]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ProductKit_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_KIT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductKit]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_ProductKit",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_Delete_EDWProductKit').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "ProductKit_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_KIT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductKit]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ProductPackage_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_PACKAGE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductPackage]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ProductPackage_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_PACKAGE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductPackage]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_ProductPackage",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_Delete_EDWProductPackage').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_EDWProduct_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_EDWProductKit_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_EDWProductPackage_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Date": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-11-08T08:53:29Z"
			},
			"dependsOn": []
		}
	]
}