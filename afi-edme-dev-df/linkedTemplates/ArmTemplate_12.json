{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Remove_RetailCustomerLoad_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Remove_Archive_Files",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@adddays(startOfDay(utcnow()),-100)",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@adddays(startOfDay(utcnow()),-20)",
									"type": "Expression"
								},
								"wildcardFileName": "*.csv",
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_Postal_Code",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "US"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ST",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "A/C",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "County",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "County",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Pref?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Pref",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "T/Z",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TZ",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DST?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Lat",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Lat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Long",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Long",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Div",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Div",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USA_Zip_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_USA": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "US_Zip_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CANADA_Postal_Code",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "CA"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Latitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Longitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Province",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Province",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Canada_Postal_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_canada": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CANADA_Postal_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": "*.*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_Code_Archive",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Postal_Code_Succeed_Files_Delete",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": "*.*",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_US_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.US_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_CANADA_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.CANADA_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('US_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('US_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('US_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is US Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('US_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('US_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('US_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "US_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('US_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('CANADA_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('CANADA_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Canada Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CANADA_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CANADA_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('CANADA_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LOAD_EDW_Kit",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Kit]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "SeriesID",
											"type": "String"
										},
										"sink": {
											"name": "SeriesID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesKey",
											"type": "Int64"
										},
										"sink": {
											"name": "SeriesKey",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitColorKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitColorKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitStatusKey",
											"type": "String"
										},
										"sink": {
											"name": "KitStatusKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitClassKey",
											"type": "String"
										},
										"sink": {
											"name": "KitClassKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										},
										"sink": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitType",
											"type": "String"
										},
										"sink": {
											"name": "KitType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "KitExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										},
										"sink": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAXKitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitAXKitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "KitDead",
											"type": "String"
										},
										"sink": {
											"name": "KitDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitBoxQty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitBoxQty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeats",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSeats",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitUPC",
											"type": "String"
										},
										"sink": {
											"name": "KitUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "KitARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "KitStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										},
										"sink": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "KitForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSelllingCountries",
											"type": "String"
										},
										"sink": {
											"name": "KitSelllingCountries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitThirdPartyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitThirdPartyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "KitRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKnockout",
											"type": "String"
										},
										"sink": {
											"name": "KitKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "KitColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPhoto",
											"type": "String"
										},
										"sink": {
											"name": "KitPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "KitGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "KitProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCubesFt",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesFt",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCubesM",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "KitHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKeyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitKeyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "KitTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "KitTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "KitValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusive",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCommodity",
											"type": "String"
										},
										"sink": {
											"name": "KitCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUpholsteryCover",
											"type": "String"
										},
										"sink": {
											"name": "KitUpholsteryCover",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										},
										"sink": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPurchaseType",
											"type": "String"
										},
										"sink": {
											"name": "KitPurchaseType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPartsDrawings",
											"type": "String"
										},
										"sink": {
											"name": "KitPartsDrawings",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										},
										"sink": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										},
										"sink": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitATPSeries",
											"type": "String"
										},
										"sink": {
											"name": "KitATPSeries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitVendorName",
											"type": "String"
										},
										"sink": {
											"name": "KitVendorName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "KitComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMaterialEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitMaterialEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Kit",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KIT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Package",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Kit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Package]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PackageID",
											"type": "String"
										},
										"sink": {
											"name": "PackageID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKey",
											"type": "Int32"
										},
										"sink": {
											"name": "PackageKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "HomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "HomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHero",
											"type": "String"
										},
										"sink": {
											"name": "PackageHero",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatus",
											"type": "String"
										},
										"sink": {
											"name": "PackageStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageIsThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "PackageIsThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageWholesaleID",
											"type": "String"
										},
										"sink": {
											"name": "PackageWholesaleID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRetailType",
											"type": "String"
										},
										"sink": {
											"name": "PackageRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageItemQuantity",
											"type": "String"
										},
										"sink": {
											"name": "PackageItemQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageUOM",
											"type": "String"
										},
										"sink": {
											"name": "PackageUOM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageColor",
											"type": "String"
										},
										"sink": {
											"name": "PackageColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKnockout",
											"type": "String"
										},
										"sink": {
											"name": "PackageKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationNotes",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRolloverImage",
											"type": "String"
										},
										"sink": {
											"name": "PackageRolloverImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "PackageExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTransition",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTransition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										},
										"sink": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageDefaultProduct",
											"type": "String"
										},
										"sink": {
											"name": "PackageDefaultProduct",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageChannelChange",
											"type": "String"
										},
										"sink": {
											"name": "PackageChannelChange",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExclusive",
											"type": "String"
										},
										"sink": {
											"name": "PackageExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										},
										"sink": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHiddenField",
											"type": "String"
										},
										"sink": {
											"name": "PackageHiddenField",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageConsumerChoice",
											"type": "String"
										},
										"sink": {
											"name": "PackageConsumerChoice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										},
										"sink": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommFlags",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommFlags",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNavigableCategories",
											"type": "String"
										},
										"sink": {
											"name": "PackageNavigableCategories",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Product",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Package",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Product]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SystemTimestamp",
											"type": "Int32"
										},
										"sink": {
											"name": "SystemTimestamp",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "AlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "AlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "ItemARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemBoxQty",
											"type": "String"
										},
										"sink": {
											"name": "ItemBoxQty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemClass",
											"type": "String"
										},
										"sink": {
											"name": "ItemClass",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColor",
											"type": "String"
										},
										"sink": {
											"name": "ItemColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "ItemColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCommodity",
											"type": "String"
										},
										"sink": {
											"name": "ItemCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "ItemComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesFt",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesFt",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesM",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDead",
											"type": "String"
										},
										"sink": {
											"name": "ItemDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "ItemDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										},
										"sink": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										},
										"sink": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusive",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "ItemExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										},
										"sink": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "ItemGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemImportDomestic",
											"type": "String"
										},
										"sink": {
											"name": "ItemImportDomestic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKeyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemKeyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKnockout",
											"type": "String"
										},
										"sink": {
											"name": "ItemKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMfgWarranty",
											"type": "String"
										},
										"sink": {
											"name": "ItemMfgWarranty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemPhoto",
											"type": "String"
										},
										"sink": {
											"name": "ItemPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailBrandName",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailBrandName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailType",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "ItemRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeats",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeats",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatusChanged",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatusChanged",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemType",
											"type": "String"
										},
										"sink": {
											"name": "ItemType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUPC",
											"type": "String"
										},
										"sink": {
											"name": "ItemUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "ItemValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffAFI",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffAFI",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffPrint",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffPrint",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										},
										"sink": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesDivision",
											"type": "String"
										},
										"sink": {
											"name": "SeriesDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesFeatures",
											"type": "String"
										},
										"sink": {
											"name": "SeriesFeatures",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesId",
											"type": "String"
										},
										"sink": {
											"name": "SeriesId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesIntroDate",
											"type": "String"
										},
										"sink": {
											"name": "SeriesIntroDate",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesMainImage",
											"type": "String"
										},
										"sink": {
											"name": "SeriesMainImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesName",
											"type": "String"
										},
										"sink": {
											"name": "SeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "SeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										},
										"sink": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesShowroom",
											"type": "String"
										},
										"sink": {
											"name": "SeriesShowroom",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesSourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SeriesSourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "SeriesStatus",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesStyle",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "SeriesThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesPrimary",
											"type": "String"
										},
										"sink": {
											"name": "SeriesPrimary",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterial",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_ProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Product",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE  [EDW].[ProductPackageCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_ProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[KitComponentCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "ComponentType",
											"type": "String"
										},
										"sink": {
											"name": "ComponentType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentID",
											"type": "String"
										},
										"sink": {
											"name": "ComponentID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "ComponentSourceID",
											"type": "Int64"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(DTStamp) AS MaxDate FROM [Masterdata_CDP].[cdp_customer_preferences_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "OptOut_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(EmailChannelOptStatusDate) AS MaxDate FROM [Masterdata_CDP].[OptOut_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_CDP_Customer_Prefrence_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS CDPCustomerPreferencesCount FROM EDME_DataFactory.cdp_customer_preferences_v2 with(nolock) where DTStamp is not null AND DTStamp>'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_OptOut_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "OptOut_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS OptOutCount FROM EDME_DataFactory.OptOut with(nolock) where EmailChannelOptStatusDate>'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_EDW_CDP_Customer_Prefrence_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_CDP_Customer_Prefrence_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_CDP_Customer_Prefrence_Count').output.firstRow.CDPCustomerPreferencesCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_CDP_Customer_Prefrence_Count_Data_Not_Found_Logs_SP",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_CDP_Customer_Prefrence_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Cdp_Customer_Preferences",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType ,\nDTStamp\nfrom EDME_DataFactory.cdp_customer_preferences_v2 WITH(NOLOCK) WHERE DTStamp is not null AND DTStamp >'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Cdp_Customer_Preferences_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP_Cdp_Customer_Preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cdp_Customer_Preferences_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Cdp_Customer_Preferences').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Cdp_Customer_Preferences').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Cdp_Customer_Preferences').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_Cdp_Customer_Preferences",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Check_EDW_OptOut_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_OptOut_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_OptOut_Count').output.firstRow.OptOutCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_OptOutCount_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_OptOut_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "OptOut",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)\nwhere EmailChannelOptStatusDate >'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_OptOut",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_OptOut_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "OptOut_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('OptOut').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('OptOut').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "OptOut_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('OptOut').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('OptOut').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('OptOut').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('OptOut').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_OptOut",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('OptOut').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('OptOut').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('OptOut').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('OptOut').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('OptOut').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_OptOut",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('OptOut').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('OptOut').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType \nfrom EDME_DataFactory.cdp_customer_preferences WITH(NOLOCK) where dtec<>'null.null'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "OptOut",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cdp_Customer_Preferences_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cdp_Customer_Preferences_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Cdp_Customer_Preferences').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Cdp_Customer_Preferences').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Cdp_Customer_Preferences').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OptOut_copy_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OptOut').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OptOut').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OptOut_copy_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OptOut').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OptOut').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OptOut').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OptOut').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_OptOut",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OptOut').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OptOut').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OptOut').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('OptOut').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OptOut').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Last_Trigger_Time",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(LasteTriggerDateTime) AS LasteTriggerDateTime FROM Audit.ADFRetailCustomerWatermark WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "GetLastTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Current_UTCTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get_Last_Trigger_Time",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ToDateTime",
							"value": {
								"value": "@utcNow()",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load_ECM_Customer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "updatedDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "createdDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')\n",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceCustomerId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "firstName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "middleInitial",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "lastName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "city",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "state",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "zipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "marketId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSubSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createdDate",
											"type": "String"
										},
										"sink": {
											"name": "createdDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "updatedDate",
											"type": "String"
										},
										"sink": {
											"name": "updatedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_AllSourceCustomers",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Homes_Customer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "updatedDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "createdDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "Homes*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceCustomerId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "firstName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "middleInitial",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "lastName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "city",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "state",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "zipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "marketId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createdDate",
											"type": "String"
										},
										"sink": {
											"name": "createdDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "updatedDate",
											"type": "String"
										},
										"sink": {
											"name": "updatedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Homes_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_AllSourceCustomers",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "UpdateTriggerTime",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "UPDATE Audit.ADFRetailCustomerWatermark SET LasteTriggerDateTime='@{formatDateTime(variables('ToDateTime'),'yyyy-MM-ddTHH:mm:ss')}';\nselect 1 as success;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "UpdateTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Error_ECM_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_Customer_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_ECM_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Error_ECM_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "D365Ecm*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Error_Homes_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "Homes*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Homes_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_Customer_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Homes_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Error_Homes_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "Homes*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Stage_Retail_Customer_Failure_Notification_ECM",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Load_ECM_Customer').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Load_ECM_Customer').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Load_ECM_Customer').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().RunId}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is D365 ECM Customers Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_ECM_Customer').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_ECM_Customer').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_ECM_Customer').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Stage_Retail_Customer_Failure_Notification_Homes",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Load_Homes_Customer').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Load_Homes_Customer').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Load_Homes_Customer').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Load_Homes_Customer').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().RunId}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Load_Homes_Customer').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Homes RET Customers Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('Load_Homes_Customer').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Homes_Customer').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Homes_Customer').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Homes_Customer').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Homes_Files_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_Failure_Notification_Homes",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Load_Homes_Customer').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Load_Homes_Customer').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ECM_Files_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_Failure_Notification_ECM",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Load_ECM_Customer').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Retail_Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Deleta_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Succeed_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "*.csv",
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"ToDateTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_DAC_Payload')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEachLocationIds",
						"description": "Loop through location ids sequentially",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.item_param",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "WebLocationsAPI",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationsAPI').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFile",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationsAPI').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SetErrorMsg",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "ErrorMsg",
										"value": {
											"value": "@activity('WebLocationsAPI').error.message",
											"type": "Expression"
										}
									}
								},
								{
									"name": "WaitTime",
									"type": "Wait",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 3
									}
								},
								{
									"name": "LoggingStoredProcedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('WebLocationsAPI').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "WebLocationAPIFailed",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "WaitTime",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload_AfterFailed",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationAPIFailed').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFileAfterFailed",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationAPIFailed').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"item_param": {
						"type": "array"
					}
				},
				"variables": {
					"FailedActivity": {
						"type": "String"
					},
					"ErrorMsg": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "OSLocation",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLocationID,\r\noslAccountNo,\r\noslShipTo,\r\noslLocationName,\r\noslAddress1,\r\noslAddress2,\r\noslCity,\r\noslState,\r\noslZip,\r\noslCountry,\r\noslCounty,\r\noslPrimaryPhone,\r\noslPrimaryFax,\r\noslPrimaryEmail,\r\noslLatitude,\r\noslLongitude,\r\noslLocationStatus,\r\noslLocationStatusNotes,\r\noslLegacyLocationID,\r\noslWhseShipTo,\r\noslProspectID,\r\noslOwnerType,\r\noslLta,\r\noslDMA,\r\noslMSA,\r\noslCountyFips,\r\noslMarketZone,\r\noslOpAreaZone,\r\noslCurrency,\r\noslLanguage,\r\noslTimeZone,\r\noslGeographicZone,\r\noslStatus,\r\noslStatusNotes,\r\noslLocationType,\r\noslSoftOpenDate,\r\noslGrandOpenDate,\r\noslClosed,\r\noslClosedDate,\r\noslClosedAuthorization,\r\noslRelocated,\r\noslRelocationCloseDate,\r\noslRelocationOpenDate,\r\noslRelocationNotes,\r\noslAcquisition,\r\noslAcquisitionDate,\r\noslAcquisitionNotes,\r\noslPreOpenComments,\r\noslTUAID,\r\noslTUADate,\r\noslTUAExpireDate,\r\noslTUATerm,\r\noslTUADateComplete,\r\noslTurnoverDate,\r\noslRecordChangesFlag,\r\noslOperationsIntroDate,\r\noslMsPipelineDate,\r\noslLicenseeID,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\noslAddress3,\r\noslStoreRefresh,\r\noslStoreRefreshDate,\r\noslStoreRefreshNotes,\r\noslmPlansSubToDesign,\r\noslmPRMeeting,\r\noslmPlansSentToOwnerLic,\r\noslURLRegistration,\r\noslEnterpriseStoreNumber FROM [EDME_DataFactory].OSLocation WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLocation]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLocation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLocation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLocation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLocation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLocation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLocation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLocation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLocation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLocation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLocation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLocation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLocation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT osOneSourceID,\r\nosOneSourceName,\r\nosLegacyLocationID,\r\nosLegacyStoreID,\r\nosProfitCenter,\r\nosChannel,\r\nosActive,\r\nosStoreType,\r\nosSource,\r\nosLocationID,\r\nosStartDate,\r\nosEndDate,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\nosProfitCenterType,\r\nosProfitCenterStatus FROM [EDME_DataFactory].OSOneSource WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OsOneSource]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSOneSource",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OsOneSource",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OsOneSource').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OsOneSource').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OsOneSource').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OsOneSource').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OsOneSource_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OsOneSource').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OsOneSource').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OsOneSource').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OsOneSource').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLicenseeID,\r\noslStoreType,\r\noslLicenseeNotes,\r\noslPrimaryCountry,\r\noslStatus,\r\noslActive,\r\noslActiveDate,\r\noslActiveNotes,\r\noslGuarantors,\r\noslMailingAddress1,\r\noslMailingAddress2,\r\noslMailingCity,\r\noslMailingState,\r\noslMailingZip,\r\noslMailingCountry,\r\noslLegalEntityName,\r\noslLegalEntityAddress1,\r\noslLegalEntityAddress2,\r\noslLegalEntityCity,\r\noslLegalEntityState,\r\noslLegalEntityZip,\r\noslLegalEntityCountry,\r\nusra,\r\ndtea,\r\nusrc,\r\ndetc,\r\noslLicensedTerritory,\r\noslDisclosureDocument,\r\noslMailingAdd FROM [EDME_DataFactory].OSLicensee WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLicensee]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLicensee",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLicensee",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLicensee').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLicensee').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLicensee').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLicensee').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLicensee_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLicensee').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLicensee').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLicensee').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLicensee').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT [Status] AS Status,\r\n[LocationKey] AS LocationKey,\r\n[Prospect ID] AS ProspectID,\r\n[Google ID] AS GoogleID,\r\n[Bindy ID] AS BindyID,\r\n[StoreID] AS StoreID,\r\n[ProfitCenter] AS ProfitCenter,\r\n[Location] AS Location,\r\n[Country] AS Country,\r\n[Account #] AS Account,\r\n[Store Front Ship-To] AS StoreFrontShipTo,\r\n[Entity] AS Entity,\r\n[Licensee / Contact] AS LicenseeContact,\r\n[Soft Open Date] AS SoftOpenDate,\r\n[Acquisition Date] AS AcquisitionDate,\r\n[Closure Date] AS ClosureDate,\r\n[ShopperTrakLocID] AS ShopperTrakLocID,\r\n[Store Address] AS StoreAddress,\r\n[City] AS City,\r\n[State / Province] AS StateProvince,\r\n[ZIP] AS ZIP,\r\n[DMA ID] AS DMAID,\r\n[DMA Region] AS DMARegion,\r\n[Showroom Sq. Ft.] AS ShowroomSqFt,\r\n[Store Type] AS StoreType,\r\n[Store Model] AS StoreModel,\r\n[Store Version] AS StoreVersion,\r\n[Market] AS Market,\r\n[Region] AS Region,\r\n[Building Ownership] AS BuildingOwnership,\r\n[Country Category] AS CountryCategory,\r\n[Domestic Category] AS DomesticCategory,\r\n[Classification] AS Classification,\r\n[Store Phone] AS StorePhone,\r\n[District Manager] AS DistrictManager,\r\n[BDDirector] AS BDDirector,\r\n[Licensee Email] AS LicenseeEmail,\r\n[Licensee Phone #] AS LicenseePhone,\r\n[Corporation Address] AS CorporationAddress,\r\n[Corp City] AS CorpCity,\r\n[Corp State] AS CorpState,\r\n[Corp Zip] AS CorpZip,\r\n[RDC Address] AS RDCAddress,\r\n[RDC City] AS RDCCity,\r\n[RDC State] AS RDCState,\r\n[RDC Zip] AS RDCZip,\r\n[RDC Ship To] AS RDCShipTo,\r\n[RDC Sq. Ft.] AS RDCSqFt,\r\n[RDC Dock Doors] AS RDCDockDoors,\r\n[TUA Expiration Date] AS TUAExpirationDate,\r\n[Licensed Territory] AS LicensedTerritory,\r\n[Latitude] AS Latitude,\r\n[Longitude] AS Longitude,\r\n[Notes] AS Notes,\r\n[Store Email] AS StoreEmail,\r\n[Unit #] AS Unit,\r\n[OneSource ID] AS OneSourceID,\r\n[HS Database Name] AS HSDatabaseName,\r\n[SVP] AS SVP,\r\n[VP] AS VP,\r\n[Sr. RD] AS SrRD,\r\n[RD] AS RD,\r\n[Store Manager] AS StoreManager,\r\n[Store Mgr. Phone] AS StoreMgrPhone,\r\n[Sales Manager (1)] AS SalesManager1,\r\n[Sales Manager (2)] AS SalesManager2,\r\n[Sales Manager (3)] AS SalesManager3,\r\n[Sales Manager (4)] AS SalesManager4,\r\n[Office Manager] AS OfficeManager,\r\n[Director of Ops] AS DirectorOfOps,\r\n[Regional Ops Mgr] AS RegionalOpsMgr,\r\n[Ops Mgr] AS OpsMgr,\r\n[Comp Status] AS CompStatus,\r\n[Kit #] AS Kit,\r\n[Traffic Divisor] AS TrafficDivisor,\r\n[ERP] AS ERP,\r\n[DTC Technology] AS DTCTechnology,\r\n[DTC Brand] AS DTCBrand,\r\n[Forum ID] AS ForumID,\r\n[Account Type] AS AccountType,\r\n[Facade Current Image] AS FacadeCurrentImage,\r\n[Website Facade Current] AS WebsiteFacadeCurrent,\r\n[Store Manager Image] AS StoreManagerImage,\r\n[Enterprise Facade Image] AS EnterpriseFacadeImage,\r\n[Licensee Sales District] AS LicenseeSalesDistrict,\r\n[Licensee Sales Region] AS LicenseeSalesRegion,\r\nCAST([Modified Date] AS DATE) AS ModifiedDate\r\nFROM EDME_DataFactory.StoreMasterCustom WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom;",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LocationKey",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LocationKey",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProspectID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProspectID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GoogleID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GoogleID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BindyID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BindyID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Country",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Country",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Entity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Entity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeContact",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SoftOpenDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SoftOpenDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AcquisitionDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "AcquisitionDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "ClosureDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "ClosureDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "ShopperTrakLocID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ShopperTrakLocID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreAddress",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreAddress",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StateProvince",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StateProvince",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMAID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMAID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMARegion",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMARegion",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ShowroomSqFt",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ShowroomSqFt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreModel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreModel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreVersion",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreVersion",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Market",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Market",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BuildingOwnership",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BuildingOwnership",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CountryCategory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CountryCategory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DomesticCategory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomesticCategory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Classification",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Classification",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StorePhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StorePhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DistrictManager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DistrictManager",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BDDirector",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BDDirector",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseePhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseePhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorporationAddress",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorporationAddress",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorpCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorpCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorpState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorpState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorpZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorpZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCAddress",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCAddress",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCSqFt",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCSqFt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCDockDoors",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCDockDoors",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TUAExpirationDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUAExpirationDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Notes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Notes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OneSourceID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OneSourceID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "HSDatabaseName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HSDatabaseName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SVP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SVP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "VP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SrRD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SrRD",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RD",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreManager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreManager",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreMgrPhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreMgrPhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager4",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OfficeManager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OfficeManager",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DirectorOfOps",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DirectorOfOps",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RegionalOpsMgr",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RegionalOpsMgr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OpsMgr",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OpsMgr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CompStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CompStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Kit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Kit",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TrafficDivisor",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TrafficDivisor",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ERP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DTCTechnology",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DTCTechnology",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DTCBrand",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DTCBrand",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ForumID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ForumID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "AccountType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FacadeCurrentImage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FacadeCurrentImage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WebsiteFacadeCurrent",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WebsiteFacadeCurrent",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreManagerImage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreManagerImage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EnterpriseFacadeImage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "EnterpriseFacadeImage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeSalesDistrict",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeSalesDistrict",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeSalesRegion",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeSalesRegion",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ModifiedDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "ModifiedDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_StoreMasterCustom",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('StoreMasterCustom').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('StoreMasterCustom').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('StoreMasterCustom').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('StoreMasterCustom').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "StoreMasterCustom_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('StoreMasterCustom').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('StoreMasterCustom').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('StoreMasterCustom').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('StoreMasterCustom').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WholesaleCustomersShippingLocations",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT * \nFROM EDME_DataFactory.CustomersShippingLocations \nWHERE cslBusinessType = '1E'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[WholesaleCustomersShippingLocations]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										},
										"sink": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										}
									},
									{
										"source": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										},
										"sink": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_CustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_WholesaleCustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WholesaleCustomersShippingLocations_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_CustomersShippingLocations",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WholesaleCustomersShippingLocations').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('StoreMasterCustom').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WHolesaleCustomersShippingLocations_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WholesaleCustomersShippingLocations').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Mappings')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "StoreMasterCustom_LegalEntities_Mapping",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom_LegalEntities_Mapping",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesMapping_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_Mapping",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[StoreMasterCustom_Sites_JoinCodes]\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"LegalEntitiesMapping_FileName": {
						"type": "String",
						"defaultValue": "StoreMasterCustom_LegalEntities_Mapping.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					},
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_Load_Retail_LegalEntityLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SiteLegalEntityOWNER",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteLegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "Loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_SOURCEID,\nB_PUBID,\nB_CREDATE,\nOWNER_FIRST_NAME,\nOWNER_LAST_NAME,\nRAW_OWNER_PHONE,\nRAW_CONTACT_EMAIL,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY_OWNER WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteLegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT SITE_LEGAL_ENTITY_ID,\nB_PUBID,\nB_CLASSNAME,\nB_CREDATE,\nSITE_LEGAL_ENTITY_NAME,\nRAW_SITE_ADDRESS_LINE1,\nRAW_SITE_ADDRESS_LINE2,\nRAW_SITE_CITY,\nRAW_SITE_STATE_CODE,\nRAW_SITE_POSTAL_CODE,\nRAW_SITE_COUNTRY_CODE,\nSITE_LEGAL_ENTITY_TYPE,\nF_SITE_LEGAL_ENTITY,\nFD_SITE_LEGAL_ENTITY,\nROW_NUMBER() OVER (PARTITION BY SITE_LEGAL_ENTITY_ID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'LegalEntityLoad'\r\n,@P_LOAD_DESCRIPTION = 'LegalEntityLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteLegalEntityOWNER",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "LegalEntityLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_Load_Retail_SiteMasterLoad_DAC_initialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteMainView",
						"description": "select all data from DACJSONLoadSiteMain view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT \nB_CLASSNAME,\nB_PUBID,\nB_SOURCEID,\nB_CREDATE,\nSITE_NAME,\nSITE_TYPE,\nISACTIVE,\nSITE_DESCRIPTION,\nSITE_OWNERSHIP_TYPE,\nADDRESS_STATUS_CODE,\nADDRESS_ERROR_CODE,\nRAWADDRESS_LINE1,\nRAWADDRESS_LINE2,\nRAWCITY,\nRAWSTATE_CODE,\nRAWPOSTAL_CODE,\nRAWCOUNTRY_CODE,\nSTASTREET_NAME,\nSTASTREET_NUMBER,\nSTACITY,\nSTASTATE_CODE,\nSTAPOSTAL_CODE,\nSTACOUNTRY_CODE,\nSTALATITUDE,\nSTALONGITUDE,\nOPERATIONS_START_DATE,\nOPERATIONS_END_DATE,\nCUSTOMER_OPEN_DATE,\nCUSTOMER_CLOSE_DATE,\nLOCAL_CURRENCY_CODE,\nLOCAL_UNIT_OF_MEASURE_ARE,\nTOTAL_SITE_AREA,\nOPERATIONS_SITE_AREA,\nCUSTOMER_SITE_AREA,\nSITE_SHIP_TO,\nRAW_MAIN_PHONE,\nSTD_MAIN_PHONE,\nMAIN_PHONE_STATUS_CODE,\nRAW_FAX,\nSTD_FAX,\nFAX_STATUS_CODE,\nRAW_CS_PHONE,\nSTD_CS_PHONE,\nCS_PHONE_STATUS_CODE,\nRAW_CS_EMAIL,\nVLD_CS_EMAIL,\nRAW_SALES_PHONE,\nSTD_SALES_PHONE,\nSALES_PHONE_STATUS_CODE,\nRAW_SALES_CHAT,\nRAW_SERVICE_PHONE,\nSTD_SERVICE_PHONE,\nSERVICE_PHONE_STATUS_CODE,\nRAW_SERVICE_CHAT,\nFP_WAREHOUSE_PARENT,\nFS_WAREHOUSE_PARENT,\nLICENSED_TERRITORY,\nDISTRICT_MANAGER,\nSTORE_MODEL,\nTUA_EXPIRATION_DATE,\nF_SITE_LEGAL_ENTITY,\nSTORE_PROSPECT_ID,\nNUMBER_OF_DOCK_DOORS,\nPRIMARY_PROFIT_CENTER,\nRETAIL_SYSTEMS_NUMBER,\nGOOGLE_ID,\nLEGACY_STORE_NUMBER,\nLEGACY_ERP_DATABASE_NAME,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\r\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nCONTENT_CATEGORY,\nCONTENT_TYPE,\nCONTENT_SHORT_TEXT,\nCONTENT_LONG_TEXT,\nCONTENT_LANGUAGE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CONTENT_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CONTENT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CONTENT WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"CONTENT_TYPE"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nDAY_OF_WEEK,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_DEFAULT_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_DEFAULT_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_DEFAULT_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"SITE_HOURS_TYPE",
										"DAY_OF_WEEK"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteProgramView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteCustomeHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nCUSTOM_HOURS_REASON,\nSITE_DATE,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CUSTOM_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CUSTOM_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CUSTOM_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Custome_Hours",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteProgramView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteCustomeHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nPROGRAM_NAME,\nPROGRAM_START_DATE,\nPROGRAM_END_DATE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_PROGRAM_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_PROGRAM_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_PROGRAM WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Site_Program",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/00_Load_SiteMaster_Initial')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_SiteMaster_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_SiteMaster_Initial",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_EDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_SiteMaster_Initial",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "FetchEntityName",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@array(variables('Entity'))",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Get_Entity_Count",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RecordsToDelete INT; \nEXECUTE [dbo].[usp_ASH_REMOVE_LOAD] \n@Entity = @{item()}, \n@RecordsToDelete = @RecordsToDelete OUTPUT; \nSELECT @RecordsToDelete AS RecordsToDeleteADDRESS;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "usp_ASH_REMOVE_LOAD",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"EntityCount": {
												"value": "@string(activity('Get_Entity_Count').output.firstRow.RecordsToDeleteADDRESS)",
												"type": "Expression"
											},
											"EntityName": {
												"value": "@{item()}",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_Get_Entity_Count",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": "0",
											"status": {
												"value": "Failed",
												"type": "Expression"
											},
											"message": {
												"value": "usp_DeleteRFDLocalStage Execution Failed",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Get_Entity_Count').output.executionDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"AddressLocation",
							"EmailAddress",
							"PhoneNumber",
							"RetailCustomer"
						]
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow/RCM_RFD_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInfoIncremental",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_Site",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"B_LOADID": {
									"value": "@variables('LoadID')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Tracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_LegalEntity",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"B_LOADID": {
									"value": "@variables('LoadID')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_Tracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_Tracking",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"B_LOADID": {
									"value": "@variables('LoadID')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SiteAdditionalInfoIncremental",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"MaxHSOPCTrackingID": {
						"type": "Integer"
					},
					"B_LOADID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Load_EnterpriseRef')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_EnterpriseRef_Country",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_Country_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Country_Table_Name": {
									"value": "@pipeline().parameters.Sink_Country_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.Country_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Country_Class_Name": {
									"value": "@pipeline().parameters.Country_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_Currency_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_Currency_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Currency_Table_Name": {
									"value": "@pipeline().parameters.Sink_Currency_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.Currency_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Currency_Class_Name": {
									"value": "@pipeline().parameters.Currency_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_DMA_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_DMA_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Dma_Table_Name": {
									"value": "@pipeline().parameters.Sink_Dma_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.DMA_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Dma_Class_Name": {
									"value": "@pipeline().parameters.Dma_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Time_Zone_Table_Name": {
									"value": "@pipeline().parameters.Sink_Time_Zone_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.TimeZone_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Time_Zone_Class_Name": {
									"value": "@pipeline().parameters.Time_Zone_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Time_Zone_EFF_DT_Table_Name": {
									"value": "@pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.TimeZoneEF_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Time_Zone_EFF_DT_Class_Name": {
									"value": "@pipeline().parameters.Time_Zone_EFF_DT_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_US_STATE_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_US_State_Table_Name": {
									"value": "@pipeline().parameters.Sink_US_State_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.USState_Semarchy_Job_Name",
									"type": "Expression"
								},
								"US_State_Class_Name": {
									"value": "@pipeline().parameters.US_State_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CountryLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_Country').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_Country').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_Country').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_Country').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_Country').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_Country').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_Country').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CurrencyLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_Currency_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_DMALoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_DMA_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_TimeZoneLoad_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_TimeZoneEFFLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_USStateLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Country_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_Country').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Currency_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DMA_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Time_Zone_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "TimeZone_EFF_DT_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "USState_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_US_State_Table_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_EFF_DT_Table_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_Table_Name": {
						"type": "string"
					},
					"Sink_Currency_Table_Name": {
						"type": "string"
					},
					"Sink_Country_Table_Name": {
						"type": "string"
					},
					"Sink_Dma_Table_Name": {
						"type": "string"
					},
					"Country_Class_Name": {
						"type": "string"
					},
					"Currency_Class_Name": {
						"type": "string"
					},
					"Dma_Class_Name": {
						"type": "string"
					},
					"Time_Zone_Class_Name": {
						"type": "string"
					},
					"Time_Zone_EFF_DT_Class_Name": {
						"type": "string"
					},
					"US_State_Class_Name": {
						"type": "string"
					},
					"Country_Semarchy_Job_Name": {
						"type": "string"
					},
					"Currency_Semarchy_Job_Name": {
						"type": "string"
					},
					"DMA_Semarchy_Job_Name": {
						"type": "string"
					},
					"TimeZone_Semarchy_Job_Name": {
						"type": "string"
					},
					"TimeZoneEF_Semarchy_Job_Name": {
						"type": "string"
					},
					"USState_Semarchy_Job_Name": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Load_Retail_ProductMasterLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_EDW_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_Retail_PIM_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_ProductMasterLoad_Retail_PIM_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_EDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_InitialLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_EDW_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_MasterLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_Retail_PIM_EDW').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_Retail_PIM_EDW').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_EDW').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_EDW').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_EDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Retail_PIM_EDW').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_EDW').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_National_Assortment_SemarchyToEDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_National_Assortment_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_National_Assortment_SemarchyToEDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_Historical_National_Assortment_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_National_Assortment_SemarchyToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_Historical_National_Assortment_SemarchyToEDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_PostalCode_ReferenceDataLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"US_PostalCode_FileName": {
									"value": "@pipeline().parameters.US_PostalCode_FileName",
									"type": "Expression"
								},
								"CANADA_PostalCode_FileName": {
									"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_PostalCode_ReferenceDataLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_PostalCode_EnterpriseRefPostalCodeLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification_Stage_PostalCode_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_PostalCode_ReferenceDataLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_Load_PostalCode_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_PostalCode_ReferenceDataLoad_Incremental').error.message,'\"','')\n",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "z5max.txt"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "PCensusNWE.csv"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Stage_PostalCode_ReferenceDataLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_RetailCustomer_CommunicationPreferenceLoad",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_RetailCustomer_CommunicationPreferenceLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_RetailCustomer_CommunicationPreferenceLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_RetailCustomer_CommunicationPreferenceLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Stage_Retail_Customer_RetailCustomerLoad_Incremental')]"
			]
		}
	]
}