{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_SITE_DEFAULT_HOURS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTENT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_SHORT_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LONG_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LANGUAGE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_DEFAULT_HOURS"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SD_SITE_MAIN')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SITE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ISACTIVE",
						"type": "bit"
					},
					{
						"name": "SITE_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "SITE_OWNERSHIP_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_OWNER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "OPERATIONS_START_DATE",
						"type": "date"
					},
					{
						"name": "OPERATIONS_END_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_CLOSE_DATE",
						"type": "date"
					},
					{
						"name": "LOCAL_CURRENCY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LOCAL_UNIT_OF_MEASURE_ARE",
						"type": "nvarchar"
					},
					{
						"name": "TOTAL_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "OPERATIONS_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "CUSTOMER_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "F_SITE_DEFAULT_HOURS",
						"type": "uniqueidentifier"
					},
					{
						"name": "FD_SITE_DEFAULT_HOURS",
						"type": "nvarchar"
					},
					{
						"name": "SITE_SHIP_TO",
						"type": "nvarchar"
					},
					{
						"name": "RAW_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "MAIN_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FAX",
						"type": "nvarchar"
					},
					{
						"name": "STD_FAX",
						"type": "nvarchar"
					},
					{
						"name": "FAX_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CS_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "VLD_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SALES_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SERVICE_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "F_WAREHOUSE_PARENT",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FS_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FD_WAREHOUSE_PARENT",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE_MAIN"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SD_SITE_OWNER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OWNER_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE_OWNER"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CDP_Customer_Dedupe_CsvToTable')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CDP_Customer_Deduped",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "clusterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "globalID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "timestamp",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "customer_since",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "do_not_sell",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "EntryID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "do_not_sell_request_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "unsubscribe",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "unsubscribe_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "birthdate",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CDP_Customer_Deduped_csv",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CDP_Customer_Dedeped",
								"type": "DatasetReference",
								"parameters": {
									"CDP_TableName": {
										"value": "@pipeline().parameters.Table_Name",
										"type": "Expression"
									},
									"Table_Schema": {
										"value": "@pipeline().parameters.Table_Schema",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"FileName": {
						"type": "String"
					},
					"Table_Name": {
						"type": "String"
					},
					"Table_Schema": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Initial_Load_RetailCustomer')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Initial_Load_RetailCustomers",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\nB_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE,\nB_UPDATE AS B_CREDATE\nFROM CDP.RetailCustomerInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWFIRSTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWLASTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWMIDDLENAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_RETAIL_CUSTOMER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_PhoneNumber",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_RetailCustomers",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM CDP.PhoneNumbersInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPHONENUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersPhoneInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_PHONE_NUMBER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_EmailAddresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_PhoneNumber",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM CDP.EmailAddressesInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWEMAILADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersEmailInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_EMAIL_ADDRESS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_Addresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_EmailAddresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM CDP.AddressLocationsInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTREETADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STREET_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESSLINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATEORPROVINCECODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_OR_PROV_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWZIPOSTALCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ZIP_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRYCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersAddress",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_ADDRESS_LOCATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_InitialLoadRetail",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Initial_Load_Addresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailCustomerLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadId')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_InitialLoadRetail",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[CDP].[usp_InitialLoadRetail]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Country_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Country_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Country_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Country_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Country_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Country_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Country_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Country_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Country",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Country_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Country_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_COUNTRY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCOUNTRY_CODE_A2,\nCOUNTRY_CODE_A3,\nCOUNTRY_NAME,\nCOUNTRY_LOCAL_NAME,\nCOUNTRY_UN_CODE \nFROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_COUNTRY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_COUNTRY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Country_Table_Name": {
													"value": "@pipeline().parameters.Sink_Country_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Country_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Country_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Currency_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Currency_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Currency_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Currency_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Currency_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Currency_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Currency_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Currency_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Currency_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Currency",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Currency_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Currency_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_CURENCY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCURRENCY_CODE,\nCURRENCY_NAME\nFROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_CURRENCY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_CURENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_CURRENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_CURRENCY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Currency_Table_Name": {
													"value": "@pipeline().parameters.Sink_Currency_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Currency_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Currency_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_DMA_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Dma_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Dma_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Dma_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Dma_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_DMA WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Dma_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Dma_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Dma_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Dma_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Dma_Data_Not_Found_Logs_Stored_Procedurered",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For dma",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Dma_Data_Not_Found_Logs_Stored_Procedurered",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Dma_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Dma_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Dma_Class_Name}' as B_CLASSNAME,\nENTERPRISE_REF_DMA_ID,\nB_CLASSNAME,\nB_BATCHID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nDMA_REGION\nFROM GD_ENTERPRISE_REF_DMA WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Dma_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_DMAID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_DMA_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													},
													"sink": {
														"name": "EXTERNAL_REF_DMAID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DMA_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "DMA_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_DMA",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Dma_Table_Name": {
													"value": "@pipeline().parameters.Sink_Dma_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Dma_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Dma_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Time_Zone_EFF_DT_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Time_Zone_EFF_DT_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Time_Zone_EFF_DT_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENT_REF_TIME_ZONE_EFF_DT WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Time_Zone_EFF_DT_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Time_Zone_EFF_DT_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Time_Zone_EFF_DT_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Time_Zone_EFF_DT_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For TIME_ZONE_EFF_DT",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_EFF_DT_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Time_Zone_EFF_DT_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Time_Zone_EFF_DT_Class_Name}' as B_CLASSNAME,\nENT_REF_TIME_ZN_EFF_DT_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nTIME_ZONE_EFFECTIVE_YEAR,\nDST_START_DT,\nDST_END_DT,\nF_ENTERPRISE_REF_TIME_ZONE\nFROM GD_ENT_REF_TIME_ZONE_EFF_DT WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Time_Zone_EFF_DT_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_TIME_ZONE_EF"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENT_REF_TIME_ZN_EFF_DT_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "EXTERNAL_REF_TIME_ZONE_EF",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_EFFECTIVE_YEAR",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "TIME_ZONE_EFFECTIVE_YEAR",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												},
												{
													"source": {
														"name": "DST_START_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DST_START_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "DST_END_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DST_END_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "F_ENTERPRISE_REF_TIME_ZONE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "F_EXTERNAL_REF_TIME_ZONE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_TIME_ZONE_EF",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Time_Zone_EFF_DT_Table_Name": {
													"value": "@pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_EFF_DT_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_EFF_DT_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Time_Zone_EFF_DT_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_TIME_ZONE_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Time_Zone_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Time_Zone_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Time_Zone_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Time_Zone_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_TIME_ZONE WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Time_Zone_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Time_Zone_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Time_Zone_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Time_Zone_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Time_Zone_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For TIME_ZONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Time_Zone_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Time_Zone_Class_Name}' as B_CLASSNAME,\nENTERP_REF_TIME_ZONE_ID,\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nTIME_ZONE_NAME,\nTIME_ZONE_ABR_STD,\nTIME_ZONE_ABR_DST,\nUTC_OFFSET_STD,\nUTC_OFFSET_DST\nFROM GD_ENTERPRISE_REF_TIME_ZONE WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Time_Zone_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_TIME_ZONE_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERP_REF_TIME_ZONE_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "EXTERNAL_REF_TIME_ZONE_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_ABR_STD",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_ABR_STD",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_ABR_DST",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_ABR_DST",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "UTC_OFFSET_STD",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "UTC_OFFSET_STD",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												},
												{
													"source": {
														"name": "UTC_OFFSET_DST",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "UTC_OFFSET_DST",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_TIME_ZONE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Time_Zone_Table_Name": {
													"value": "@pipeline().parameters.Sink_Time_Zone_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Time_Zone_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_US_STATE_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_State_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_US_State_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "US_State_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "US_State_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_US_STATE WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('US_State_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_US_State_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "US_State_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('US_State_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "US_State_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For US_STATE",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "US_State_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "US_State_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.US_State_Class_Name}' as B_CLASSNAME,\nENTERP_REF_US_STATE_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nSTATE_CODE,\nSTATE_NAME\nFROM GD_ENTERPRISE_REF_US_STATE WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('US_State_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_US_STATE_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERP_REF_US_STATE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_US_STATE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_US_STATE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"US_State_Table_Name": {
													"value": "@pipeline().parameters.Sink_US_State_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "US_State_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_US_State_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"US_State_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_D365Ecm')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_D365Ecm",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [D365ECM].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_D365Ecm_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_D365Ecm",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_D365Ecm').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "D365Ecm_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For D365Ecm",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "D365Ecm_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_D365Ecm_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM D365Ecm.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_D365Ecm').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_D365Ecm_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_D365Ecm_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM D365Ecm.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_D365Ecm').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_D365Ecm_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_D365Ecm_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM D365Ecm.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_D365Ecm').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_D365Ecm_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_D365Ecm_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM D365Ecm.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_D365Ecm').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_D365Ecm_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesArcadia')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesArcadia",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesArcadia].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesArcadia_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesArcadia",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesArcadia').output.firstRow.MAX_ID,null))\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesArcadia_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesArcadia",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesArcadia_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesArcadia_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesArcadia.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesArcadia').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesArcadia_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesArcadia_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesArcadia.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesArcadia').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesArcadia_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesArcadia_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesArcadia.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesArcadia').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesArcadia_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesArcadia_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesArcadia.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesArcadia').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesArcadia_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesAtlanta')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesAtlanta",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesAtlanta].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesAtlanta_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesAtlanta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesAtlanta').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesAtlanta_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesAtlanta",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesAtlanta_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesAtlanta_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesAtlanta.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesAtlanta').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesAtlanta_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesAtlanta_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesAtlanta.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesAtlanta').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesAtlanta_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesAtlanta_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesAtlanta.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesAtlanta').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesAtlanta_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesAtlanta_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesAtlanta.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesAtlanta').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesAtlanta_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesBoise')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesBoise",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesBoise].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesBoise_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesBoise",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesBoise').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesPhoenix_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesBoise",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesPhoenix_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesBoise_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesBoise.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBoise').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesBoise_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesBoise_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesBoise.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBoise').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesBoise_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesBoise_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesBoise.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBoise').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesBoise_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesBoise_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesBoise.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBoise').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesBoise_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesBrandon')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesBrandon",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesBrandon].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesBrandon_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesBrandon",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesBrandon').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesBrandon_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesBrandon",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesBrandon_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesBrandon_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesBrandon.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBrandon').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesBrandon_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesBrandon_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesBrandon.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBrandon').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesBrandon_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesBrandon_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesBrandon.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBrandon').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesBrandon_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesBrandon_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesBrandon.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesBrandon').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesBrandon_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesColton')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesColton",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesColton].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesColton_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesColton",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesColton').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesColton_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesColton",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesColton_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesColton_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesColton.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesColton').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesColton_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesColton_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesColton.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesColton').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesColton_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesColton_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesColton.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesColton').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesColton_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesColton_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesColton.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesColton').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesColton_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesLasVegas')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesLasVegas",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesLasVegas].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesLasVegas_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesLasVegas",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesLasVegas').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesLasVegas_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesLasVegas",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesLasVegas_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesLasVegas_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesLasVegas.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesLasVegas').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesLasVegas_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesLasVegas_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesLasVegas.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesLasVegas').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesLasVegas_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesLasVegas_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesLasVegas.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesLasVegas').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesLasVegas_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesLasVegas_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesLasVegas.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesLasVegas').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesLasVegas_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesPNW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesPNW",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesPNW].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesPNW_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesPNW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesPNW').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesPNW_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesPNW",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesPNW_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesPNW_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesPNW.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPNW').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesPNW_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesPNW_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesPNW.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPNW').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesPNW_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesPNW_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesPNW.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPNW').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesPNW_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesPNW_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesPNW.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPNW').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesPNW_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_HomesPhoenix')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get_Max_CustomerMasterID_HomesPhoenix",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [HomesPhoenix].CustomerInfo WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_HomesPhoenix_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Max_CustomerMasterID_HomesPhoenix",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Max_CustomerMasterID_HomesPhoenix').output.firstRow.MAX_ID,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "HomesPhoenix_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For HomesPhoenix",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "HomesPhoenix_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HomesPhoenix_RetailCustomers",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE\nFROM HomesPhoenix.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPhoenix').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesPhoenix_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesPhoenix_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesPhoenix.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPhoenix').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesPhoenix_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesPhoenix_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesPhoenix.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPhoenix').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Load_HomesPhoenix_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HomesPhoenix_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM HomesPhoenix.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID_HomesPhoenix').output.firstRow.MAX_ID}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_HomesPhoenix_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Count": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}