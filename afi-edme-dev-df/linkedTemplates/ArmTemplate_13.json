{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_DAC_Payload')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEachLocationIds",
						"description": "Loop through location ids sequentially",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.item_param",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "WebLocationsAPI",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationsAPI').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFile",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationsAPI').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SetErrorMsg",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "ErrorMsg",
										"value": {
											"value": "@activity('WebLocationsAPI').error.message",
											"type": "Expression"
										}
									}
								},
								{
									"name": "WaitTime",
									"type": "Wait",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 3
									}
								},
								{
									"name": "LoggingStoredProcedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('WebLocationsAPI').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "WebLocationAPIFailed",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "WaitTime",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload_AfterFailed",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationAPIFailed').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFileAfterFailed",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationAPIFailed').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"item_param": {
						"type": "array"
					}
				},
				"variables": {
					"FailedActivity": {
						"type": "String"
					},
					"ErrorMsg": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "OSLocation",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLocationID,\r\noslAccountNo,\r\noslShipTo,\r\noslLocationName,\r\noslAddress1,\r\noslAddress2,\r\noslCity,\r\noslState,\r\noslZip,\r\noslCountry,\r\noslCounty,\r\noslPrimaryPhone,\r\noslPrimaryFax,\r\noslPrimaryEmail,\r\noslLatitude,\r\noslLongitude,\r\noslLocationStatus,\r\noslLocationStatusNotes,\r\noslLegacyLocationID,\r\noslWhseShipTo,\r\noslProspectID,\r\noslOwnerType,\r\noslLta,\r\noslDMA,\r\noslMSA,\r\noslCountyFips,\r\noslMarketZone,\r\noslOpAreaZone,\r\noslCurrency,\r\noslLanguage,\r\noslTimeZone,\r\noslGeographicZone,\r\noslStatus,\r\noslStatusNotes,\r\noslLocationType,\r\noslSoftOpenDate,\r\noslGrandOpenDate,\r\noslClosed,\r\noslClosedDate,\r\noslClosedAuthorization,\r\noslRelocated,\r\noslRelocationCloseDate,\r\noslRelocationOpenDate,\r\noslRelocationNotes,\r\noslAcquisition,\r\noslAcquisitionDate,\r\noslAcquisitionNotes,\r\noslPreOpenComments,\r\noslTUAID,\r\noslTUADate,\r\noslTUAExpireDate,\r\noslTUATerm,\r\noslTUADateComplete,\r\noslTurnoverDate,\r\noslRecordChangesFlag,\r\noslOperationsIntroDate,\r\noslMsPipelineDate,\r\noslLicenseeID,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\noslAddress3,\r\noslStoreRefresh,\r\noslStoreRefreshDate,\r\noslStoreRefreshNotes,\r\noslmPlansSubToDesign,\r\noslmPRMeeting,\r\noslmPlansSentToOwnerLic,\r\noslURLRegistration,\r\noslEnterpriseStoreNumber FROM [EDME_DataFactory].OSLocation WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLocation]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLocation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLocation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLocation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLocation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLocation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLocation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLocation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLocation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLocation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLocation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLocation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLocation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT osOneSourceID,\r\nosOneSourceName,\r\nosLegacyLocationID,\r\nosLegacyStoreID,\r\nosProfitCenter,\r\nosChannel,\r\nosActive,\r\nosStoreType,\r\nosSource,\r\nosLocationID,\r\nosStartDate,\r\nosEndDate,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\nosProfitCenterType,\r\nosProfitCenterStatus FROM [EDME_DataFactory].OSOneSource WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OsOneSource]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSOneSource",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OsOneSource",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OsOneSource').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OsOneSource').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OsOneSource').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OsOneSource').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OsOneSource_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OsOneSource').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OsOneSource').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OsOneSource').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OsOneSource').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLicenseeID,\r\noslStoreType,\r\noslLicenseeNotes,\r\noslPrimaryCountry,\r\noslStatus,\r\noslActive,\r\noslActiveDate,\r\noslActiveNotes,\r\noslGuarantors,\r\noslMailingAddress1,\r\noslMailingAddress2,\r\noslMailingCity,\r\noslMailingState,\r\noslMailingZip,\r\noslMailingCountry,\r\noslLegalEntityName,\r\noslLegalEntityAddress1,\r\noslLegalEntityAddress2,\r\noslLegalEntityCity,\r\noslLegalEntityState,\r\noslLegalEntityZip,\r\noslLegalEntityCountry,\r\nusra,\r\ndtea,\r\nusrc,\r\ndetc,\r\noslLicensedTerritory,\r\noslDisclosureDocument,\r\noslMailingAdd FROM [EDME_DataFactory].OSLicensee WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLicensee]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLicensee",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLicensee",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLicensee').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLicensee').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLicensee').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLicensee').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLicensee_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLicensee').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLicensee').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLicensee').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLicensee').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT [Status] AS Status,\r\n[LocationKey] AS LocationKey,\r\n[Prospect ID] AS ProspectID,\r\n[Google ID] AS GoogleID,\r\n[Bindy ID] AS BindyID,\r\n[StoreID] AS StoreID,\r\n[ProfitCenter] AS ProfitCenter,\r\n[Location] AS Location,\r\n[Country] AS Country,\r\n[Account #] AS Account,\r\n[Store Front Ship-To] AS StoreFrontShipTo,\r\n[Entity] AS Entity,\r\n[Licensee / Contact] AS LicenseeContact,\r\n[Soft Open Date] AS SoftOpenDate,\r\n[Acquisition Date] AS AcquisitionDate,\r\n[Closure Date] AS ClosureDate,\r\n[ShopperTrakLocID] AS ShopperTrakLocID,\r\n[Store Address] AS StoreAddress,\r\n[City] AS City,\r\n[State / Province] AS StateProvince,\r\n[ZIP] AS ZIP,\r\n[DMA ID] AS DMAID,\r\n[DMA Region] AS DMARegion,\r\n[Showroom Sq. Ft.] AS ShowroomSqFt,\r\n[Store Type] AS StoreType,\r\n[Store Model] AS StoreModel,\r\n[Store Version] AS StoreVersion,\r\n[Market] AS Market,\r\n[Region] AS Region,\r\n[Building Ownership] AS BuildingOwnership,\r\n[Country Category] AS CountryCategory,\r\n[Domestic Category] AS DomesticCategory,\r\n[Classification] AS Classification,\r\n[Store Phone] AS StorePhone,\r\n[District Manager] AS DistrictManager,\r\n[BDDirector] AS BDDirector,\r\n[Licensee Email] AS LicenseeEmail,\r\n[Licensee Phone #] AS LicenseePhone,\r\n[Corporation Address] AS CorporationAddress,\r\n[Corp City] AS CorpCity,\r\n[Corp State] AS CorpState,\r\n[Corp Zip] AS CorpZip,\r\n[RDC Address] AS RDCAddress,\r\n[RDC City] AS RDCCity,\r\n[RDC State] AS RDCState,\r\n[RDC Zip] AS RDCZip,\r\n[RDC Ship To] AS RDCShipTo,\r\n[RDC Sq. Ft.] AS RDCSqFt,\r\n[RDC Dock Doors] AS RDCDockDoors,\r\n[TUA Expiration Date] AS TUAExpirationDate,\r\n[Licensed Territory] AS LicensedTerritory,\r\n[Latitude] AS Latitude,\r\n[Longitude] AS Longitude,\r\n[Notes] AS Notes,\r\n[Store Email] AS StoreEmail,\r\n[Unit #] AS Unit,\r\n[OneSource ID] AS OneSourceID,\r\n[HS Database Name] AS HSDatabaseName,\r\n[SVP] AS SVP,\r\n[VP] AS VP,\r\n[Sr. RD] AS SrRD,\r\n[RD] AS RD,\r\n[Store Manager] AS StoreManager,\r\n[Store Mgr. Phone] AS StoreMgrPhone,\r\n[Sales Manager (1)] AS SalesManager1,\r\n[Sales Manager (2)] AS SalesManager2,\r\n[Sales Manager (3)] AS SalesManager3,\r\n[Sales Manager (4)] AS SalesManager4,\r\n[Office Manager] AS OfficeManager,\r\n[Director of Ops] AS DirectorOfOps,\r\n[Regional Ops Mgr] AS RegionalOpsMgr,\r\n[Ops Mgr] AS OpsMgr,\r\n[Comp Status] AS CompStatus,\r\n[Kit #] AS Kit,\r\n[Traffic Divisor] AS TrafficDivisor,\r\n[ERP] AS ERP,\r\n[DTC Technology] AS DTCTechnology,\r\n[DTC Brand] AS DTCBrand,\r\n[Forum ID] AS ForumID,\r\n[Account Type] AS AccountType,\r\n[Facade Current Image] AS FacadeCurrentImage,\r\n[Website Facade Current] AS WebsiteFacadeCurrent,\r\n[Store Manager Image] AS StoreManagerImage,\r\n[Enterprise Facade Image] AS EnterpriseFacadeImage,\r\n[Licensee Sales District] AS LicenseeSalesDistrict,\r\n[Licensee Sales Region] AS LicenseeSalesRegion,\r\nCAST([Modified Date] AS DATE) AS ModifiedDate\r\nFROM EDME_DataFactory.StoreMasterCustom WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom;",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LocationKey",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LocationKey",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProspectID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProspectID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GoogleID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GoogleID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BindyID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BindyID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Country",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Country",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Entity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Entity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeContact",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SoftOpenDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SoftOpenDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AcquisitionDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "AcquisitionDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "ClosureDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "ClosureDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "ShopperTrakLocID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ShopperTrakLocID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreAddress",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreAddress",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StateProvince",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StateProvince",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMAID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMAID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMARegion",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMARegion",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ShowroomSqFt",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ShowroomSqFt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreModel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreModel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreVersion",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreVersion",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Market",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Market",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BuildingOwnership",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BuildingOwnership",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CountryCategory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CountryCategory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DomesticCategory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomesticCategory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Classification",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Classification",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StorePhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StorePhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DistrictManager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DistrictManager",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BDDirector",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BDDirector",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseePhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseePhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorporationAddress",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorporationAddress",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorpCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorpCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorpState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorpState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CorpZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CorpZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCAddress",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCAddress",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCSqFt",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCSqFt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCDockDoors",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RDCDockDoors",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TUAExpirationDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUAExpirationDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Notes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Notes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OneSourceID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OneSourceID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "HSDatabaseName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HSDatabaseName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SVP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SVP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "VP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SrRD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SrRD",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RD",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreManager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreManager",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreMgrPhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreMgrPhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesManager4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager4",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OfficeManager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OfficeManager",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DirectorOfOps",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DirectorOfOps",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RegionalOpsMgr",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RegionalOpsMgr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OpsMgr",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OpsMgr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CompStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CompStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Kit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Kit",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TrafficDivisor",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TrafficDivisor",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ERP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DTCTechnology",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DTCTechnology",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DTCBrand",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DTCBrand",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ForumID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ForumID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "AccountType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FacadeCurrentImage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FacadeCurrentImage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WebsiteFacadeCurrent",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WebsiteFacadeCurrent",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreManagerImage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreManagerImage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EnterpriseFacadeImage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "EnterpriseFacadeImage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeSalesDistrict",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeSalesDistrict",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeSalesRegion",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LicenseeSalesRegion",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ModifiedDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "ModifiedDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_StoreMasterCustom",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('StoreMasterCustom').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('StoreMasterCustom').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('StoreMasterCustom').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('StoreMasterCustom').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "StoreMasterCustom_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('StoreMasterCustom').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('StoreMasterCustom').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('StoreMasterCustom').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('StoreMasterCustom').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.StoreMasterCustom",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('StoreMasterCustom').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WholesaleCustomersShippingLocations",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT * \nFROM EDME_DataFactory.CustomersShippingLocations",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[WholesaleCustomersShippingLocations]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										},
										"sink": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										}
									},
									{
										"source": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										},
										"sink": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_CustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_WholesaleCustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WholesaleCustomersShippingLocations_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_CustomersShippingLocations",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WholesaleCustomersShippingLocations').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WHolesaleCustomersShippingLocations_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WholesaleCustomersShippingLocations').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Mappings')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "StoreMasterCustom_LegalEntities_Mapping",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom_LegalEntities_Mapping",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesMapping_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_Mapping",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[StoreMasterCustom_Sites_JoinCodes]\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"LegalEntitiesMapping_FileName": {
						"type": "String",
						"defaultValue": "StoreMasterCustom_LegalEntities_Mapping.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					},
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_old_Load_Retail_LegalEntityLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SiteLegalEntityOWNER",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteLegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "Loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_SOURCEID,\nB_PUBID,\nB_CREDATE,\nOWNER_FIRST_NAME,\nOWNER_LAST_NAME,\nRAW_OWNER_PHONE,\nRAW_CONTACT_EMAIL,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY_OWNER WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteLegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT SITE_LEGAL_ENTITY_ID,\nB_PUBID,\nB_CLASSNAME,\nB_CREDATE,\nSITE_LEGAL_ENTITY_NAME,\nRAW_SITE_ADDRESS_LINE1,\nRAW_SITE_ADDRESS_LINE2,\nRAW_SITE_CITY,\nRAW_SITE_STATE_CODE,\nRAW_SITE_POSTAL_CODE,\nRAW_SITE_COUNTRY_CODE,\nSITE_LEGAL_ENTITY_TYPE,\nF_SITE_LEGAL_ENTITY,\nFD_SITE_LEGAL_ENTITY,\nROW_NUMBER() OVER (PARTITION BY SITE_LEGAL_ENTITY_ID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'LegalEntityLoad'\r\n,@P_LOAD_DESCRIPTION = 'LegalEntityLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteLegalEntityOWNER",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "LegalEntityLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_old_Load_Retail_SiteMasterLoad_DAC_initialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteMainView",
						"description": "select all data from DACJSONLoadSiteMain view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT \nB_CLASSNAME,\nB_PUBID,\nB_SOURCEID,\nB_CREDATE,\nSITE_NAME,\nSITE_TYPE,\nISACTIVE,\nSITE_DESCRIPTION,\nSITE_OWNERSHIP_TYPE,\nADDRESS_STATUS_CODE,\nADDRESS_ERROR_CODE,\nRAWADDRESS_LINE1,\nRAWADDRESS_LINE2,\nRAWCITY,\nRAWSTATE_CODE,\nRAWPOSTAL_CODE,\nRAWCOUNTRY_CODE,\nSTASTREET_NAME,\nSTASTREET_NUMBER,\nSTACITY,\nSTASTATE_CODE,\nSTAPOSTAL_CODE,\nSTACOUNTRY_CODE,\nSTALATITUDE,\nSTALONGITUDE,\nOPERATIONS_START_DATE,\nOPERATIONS_END_DATE,\nCUSTOMER_OPEN_DATE,\nCUSTOMER_CLOSE_DATE,\nLOCAL_CURRENCY_CODE,\nLOCAL_UNIT_OF_MEASURE_ARE,\nTOTAL_SITE_AREA,\nOPERATIONS_SITE_AREA,\nCUSTOMER_SITE_AREA,\nSITE_SHIP_TO,\nRAW_MAIN_PHONE,\nSTD_MAIN_PHONE,\nMAIN_PHONE_STATUS_CODE,\nRAW_FAX,\nSTD_FAX,\nFAX_STATUS_CODE,\nRAW_CS_PHONE,\nSTD_CS_PHONE,\nCS_PHONE_STATUS_CODE,\nRAW_CS_EMAIL,\nVLD_CS_EMAIL,\nRAW_SALES_PHONE,\nSTD_SALES_PHONE,\nSALES_PHONE_STATUS_CODE,\nRAW_SALES_CHAT,\nRAW_SERVICE_PHONE,\nSTD_SERVICE_PHONE,\nSERVICE_PHONE_STATUS_CODE,\nRAW_SERVICE_CHAT,\nFP_WAREHOUSE_PARENT,\nFS_WAREHOUSE_PARENT,\nLICENSED_TERRITORY,\nDISTRICT_MANAGER,\nSTORE_MODEL,\nTUA_EXPIRATION_DATE,\nF_SITE_LEGAL_ENTITY,\nSTORE_PROSPECT_ID,\nNUMBER_OF_DOCK_DOORS,\nPRIMARY_PROFIT_CENTER,\nRETAIL_SYSTEMS_NUMBER,\nGOOGLE_ID,\nLEGACY_STORE_NUMBER,\nLEGACY_ERP_DATABASE_NAME,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\r\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nCONTENT_CATEGORY,\nCONTENT_TYPE,\nCONTENT_SHORT_TEXT,\nCONTENT_LONG_TEXT,\nCONTENT_LANGUAGE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CONTENT_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CONTENT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CONTENT WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"CONTENT_TYPE"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nDAY_OF_WEEK,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_DEFAULT_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_DEFAULT_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_DEFAULT_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"SITE_HOURS_TYPE",
										"DAY_OF_WEEK"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteProgramView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteCustomeHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nCUSTOM_HOURS_REASON,\nSITE_DATE,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CUSTOM_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CUSTOM_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CUSTOM_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Custome_Hours",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteProgramView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteCustomeHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nPROGRAM_NAME,\nPROGRAM_START_DATE,\nPROGRAM_END_DATE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_PROGRAM_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_PROGRAM_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_PROGRAM WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Site_Program",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF_Stage_SiteMaster_RDC_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This Dataflow loads RDC info to Semarchy staging",
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_Smartsheets",
								"type": "LinkedServiceReference"
							},
							"name": "SRCSMARTSHEET",
							"description": "Smartsheet data-RDCMasterlist"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DS_SEM_STG_Smartsheet",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "masterDataHubStg",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Status as string,",
						"          Location as string,",
						"          {Bindy ID} as string,",
						"          {Account #} as integer,",
						"          {RDC Ship To} as string,",
						"          Entity as string,",
						"          {Licensee / Contact} as string,",
						"          {RDC Address} as string,",
						"          {RDC City} as string,",
						"          {RDC State} as string,",
						"          {RDC Zip} as string,",
						"          {RDC Country} as string,",
						"          {RDC Sq. Ft.} as string,",
						"          {RDC Dock Doors} as double,",
						"          {Is Ecom Fulfiller} as string,",
						"          {Acquisition Date} as date,",
						"          {Modified Date} as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'smartsheet',",
						"     format: 'rest',",
						"     entityId: '7848339512971140',",
						"     entityType: 'sheets') ~> SRCSMARTSHEET",
						"SRCSMARTSHEET select(mapColumn(",
						"          Status,",
						"          Location,",
						"          BindyID = {Bindy ID},",
						"          Account = {Account #},",
						"          ShipTo = {RDC Ship To},",
						"          Entity,",
						"          LicenseeContact = {Licensee / Contact},",
						"          Address = {RDC Address},",
						"          City = {RDC City},",
						"          State = {RDC State},",
						"          Zip = {RDC Zip},",
						"          Country = {RDC Country},",
						"          WarehouseSqFt = {RDC Sq. Ft.},",
						"          WarehouseDockDoors = {RDC Dock Doors},",
						"          IsEcomFulfiller = {Is Ecom Fulfiller},",
						"          AcquisitionDate = {Acquisition Date},",
						"          ModifiedDate = {Modified Date}",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Status as string,",
						"          Location as string,",
						"          BindyID as string,",
						"          Account as integer,",
						"          ShipTo as string,",
						"          Entity as string,",
						"          LicenseeContact as string,",
						"          Address as string,",
						"          City as string,",
						"          State as string,",
						"          Zip as string,",
						"          Country as string,",
						"          WarehouseSqFt as integer,",
						"          WarehouseDockDoors as integer,",
						"          IsEcomFulfiller as string,",
						"          AcquisitionDate as date,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['Delete from Smartsheet.RDCMasterlist'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     outputRejectedData: true,",
						"     outputAssertFailedRows: true,",
						"     assertFailure_fileSystem: 'Error',",
						"     assertFailure_folderPath: 'RDC',",
						"     mapColumn(",
						"          Status,",
						"          Location,",
						"          BindyID,",
						"          Account,",
						"          ShipTo,",
						"          Entity,",
						"          LicenseeContact,",
						"          Address,",
						"          City,",
						"          State,",
						"          Zip,",
						"          Country,",
						"          WarehouseSqFt,",
						"          WarehouseDockDoors,",
						"          IsEcomFulfiller,",
						"          AcquisitionDate,",
						"          ModifiedDate",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "FetchEntityName",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@array(variables('Entity'))",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Get_Entity_Count",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RecordsToDelete INT; \nEXECUTE [dbo].[usp_ASH_REMOVE_LOAD] \n@Entity = @{item()}, \n@RecordsToDelete = @RecordsToDelete OUTPUT; \nSELECT @RecordsToDelete AS RecordsToDeleteADDRESS;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "usp_ASH_REMOVE_LOAD",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"EntityCount": {
												"value": "@string(activity('Get_Entity_Count').output.firstRow.RecordsToDeleteADDRESS)",
												"type": "Expression"
											},
											"EntityName": {
												"value": "@{item()}",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_Get_Entity_Count",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": "0",
											"status": {
												"value": "Failed",
												"type": "Expression"
											},
											"message": {
												"value": "usp_DeleteRFDLocalStage Execution Failed",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Get_Entity_Count').output.executionDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"AddressLocation",
							"EmailAddress",
							"PhoneNumber",
							"RetailCustomer"
						]
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow/RCM_RFD_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_HS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LoadTrackingHS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LoadTrackingHS",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LoadLegalEntityHS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_TrackingHS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"B_LOADID": {
									"value": "@variables('LoadID')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LoadSiteHSAdditionalInfo",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadSiteHS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadSiteHSAdditionalInfo",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'Site' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nsite_id AS B_SOURCEID,\r\noperational_status AS OPERATIONAL_STATUS,\r\ntype AS TYPE,\r\naccount_num AS ACCOUNT_NUMBER,\r\nship_to_num AS SHIP_TO_NUM,\r\nmodel AS MODEL,\r\nversion AS VERSION,\r\ntime_zone AS TIME_ZONE,\r\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\r\nraw_phone AS RAW_PHONE,\r\nraw_cs_phone AS RAW_CS_PHONE,\r\nraw_fax AS RAW_FAX,\r\nsms_code AS SMS_CODE,\r\nsoft_open_date AS SOFT_OPEN_DATE,\r\ngrand_open_date AS GRAND_OPEN_DATE,\r\nclose_date AS CLOSE_DATE,\r\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\r\nbuilding_sqft AS BUILDING_SQFT,\r\nwarehouse_sqft AS WAREHOUSE_SQFT,\r\nshowroom_sqft AS SHOWROOM_SQFT,\r\noffice_sqft AS OFFICE_SQFT,\r\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\r\nretail_system_num AS RETAIL_SYSTEM_NUM, \r\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\r\ngoogle_id AS F_GOOGLE_ID,\r\nprospect_id  AS PROSPECT_ID,\r\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \r\ndma AS DMA,\r\nmsa_id AS MSA_ID,\r\nmsa AS MSA,\r\nmarket AS MARKET,\r\nregion AS REGION,\r\ndomestic_category AS DOMESTIC_CATEGORY,\r\ncountry_category AS COUNTRY_CATEGORY,\r\nCASE WHEN warehouse_account_ship_to IS NULL THEN NULL ELSE 'INITIALLOAD' END as FP_SUPPORTING_WAREHOUSE,\r\nwarehouse_account_ship_to AS FS_SUPPORTING_WAREHOUSE\r\nFROM Retail.v_site_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadLegalEntityHS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadSiteHS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_legal_entity_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"MaxHSOPCTrackingID": {
						"type": "Integer"
					},
					"B_LOADID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_WH')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LoadSiteWH",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG\nFROM Retail.v_site_warehouse_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadLegalEntityWH",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadSiteWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\r\n'LegalEntity' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nlegal_entity_id AS LEGAL_ENTITY_ID,\r\nname AS NAME,\r\ntype AS TYPE,\r\nlic_contact AS LIC_CONTACT,\r\nlic_contact_email AS LIC_CONTACT_EMAIL,\r\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\r\nraw_addr_line1 AS RAW_ADDR_LINE1,\r\nraw_addr_line2 AS RAW_ADDR_LINE2,\r\nraw_city AS RAW_CITY,\r\nraw_state AS RAW_STATE,\r\nraw_state_code AS RAW_STATE_CODE,\r\nraw_country AS RAW_COUNTRY,\r\nraw_country_code AS RAW_COUNTRY_CODE,\r\nraw_postal_code AS RAW_POSTAL_CODE,\r\nraw_longitude AS RAW_LONGITUDE,\r\nraw_latitude AS RAW_LATITUDE,\r\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\r\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\r\nmailing_city AS MAILING_CITY,\r\nmailing_state AS MAILING_STATE,\r\nmailing_state_code AS MAILING_STATE_CODE,\r\nmailing_country AS MAILING_COUNTRY,\r\nmailing_country_code AS MAILING_COUNTRY_CODE,\r\nmailing_postal_code AS MAILING_POSTAL_CODE,\r\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\r\ncompany_code AS COMPANY_CODE\r\nFROM Retail.v_wh_legal_entity_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadTrackingWH",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LoadLegalEntityWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_TrackingWH",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"B_LOADID": {
									"value": "@variables('LoadID')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LoadTrackingWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"MaxWHLETrackingID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Load_EnterpriseRef')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_EnterpriseRef_Country",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_Country_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Country_Table_Name": {
									"value": "@pipeline().parameters.Sink_Country_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.Country_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Country_Class_Name": {
									"value": "@pipeline().parameters.Country_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_Currency_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_Currency_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Currency_Table_Name": {
									"value": "@pipeline().parameters.Sink_Currency_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.Currency_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Currency_Class_Name": {
									"value": "@pipeline().parameters.Currency_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_DMA_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_DMA_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Dma_Table_Name": {
									"value": "@pipeline().parameters.Sink_Dma_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.DMA_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Dma_Class_Name": {
									"value": "@pipeline().parameters.Dma_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Time_Zone_Table_Name": {
									"value": "@pipeline().parameters.Sink_Time_Zone_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.TimeZone_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Time_Zone_Class_Name": {
									"value": "@pipeline().parameters.Time_Zone_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Time_Zone_EFF_DT_Table_Name": {
									"value": "@pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.TimeZoneEF_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Time_Zone_EFF_DT_Class_Name": {
									"value": "@pipeline().parameters.Time_Zone_EFF_DT_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_US_STATE_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_US_State_Table_Name": {
									"value": "@pipeline().parameters.Sink_US_State_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.USState_Semarchy_Job_Name",
									"type": "Expression"
								},
								"US_State_Class_Name": {
									"value": "@pipeline().parameters.US_State_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CountryLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_Country').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_Country').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_Country').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_Country').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_Country').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_Country').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_Country').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CurrencyLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_Currency_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_DMALoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_DMA_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_TimeZoneLoad_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_TimeZoneEFFLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_USStateLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Country_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_Country').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Currency_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DMA_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Time_Zone_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "TimeZone_EFF_DT_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "USState_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_US_State_Table_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_EFF_DT_Table_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_Table_Name": {
						"type": "string"
					},
					"Sink_Currency_Table_Name": {
						"type": "string"
					},
					"Sink_Country_Table_Name": {
						"type": "string"
					},
					"Sink_Dma_Table_Name": {
						"type": "string"
					},
					"Country_Class_Name": {
						"type": "string"
					},
					"Currency_Class_Name": {
						"type": "string"
					},
					"Dma_Class_Name": {
						"type": "string"
					},
					"Time_Zone_Class_Name": {
						"type": "string"
					},
					"Time_Zone_EFF_DT_Class_Name": {
						"type": "string"
					},
					"US_State_Class_Name": {
						"type": "string"
					},
					"Country_Semarchy_Job_Name": {
						"type": "string"
					},
					"Currency_Semarchy_Job_Name": {
						"type": "string"
					},
					"DMA_Semarchy_Job_Name": {
						"type": "string"
					},
					"TimeZone_Semarchy_Job_Name": {
						"type": "string"
					},
					"TimeZoneEF_Semarchy_Job_Name": {
						"type": "string"
					},
					"USState_Semarchy_Job_Name": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Load_Retail_ProductMasterLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_EDW_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_Retail_PIM_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_ProductMasterLoad_Retail_PIM_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_EDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_InitialLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_EDW_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_MasterLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_Retail_PIM_EDW').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_Retail_PIM_EDW').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_EDW').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_EDW').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_EDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Retail_PIM_EDW').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_EDW').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_National_Assortment_SemarchyToEDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_National_Assortment_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_National_Assortment_SemarchyToEDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_Historical_National_Assortment_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_National_Assortment_SemarchyToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_Historical_National_Assortment_SemarchyToEDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_PostalCode_ReferenceDataLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"US_PostalCode_FileName": {
									"value": "@pipeline().parameters.US_PostalCode_FileName",
									"type": "Expression"
								},
								"CANADA_PostalCode_FileName": {
									"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_PostalCode_ReferenceDataLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_PostalCode_EnterpriseRefPostalCodeLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification_Stage_PostalCode_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_PostalCode_ReferenceDataLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_Load_PostalCode_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_PostalCode_ReferenceDataLoad_Incremental').error.message,'\"','')\n",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "z5max.txt"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "PCensusNWE.csv"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_RetailCustomer_CommunicationPreferenceLoad",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_RetailCustomer_CommunicationPreferenceLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_RetailCustomer_CommunicationPreferenceLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_RetailCustomer_CommunicationPreferenceLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_DAC_Tables')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetAllJsonFiles",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DAC_Location_List_Read",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "JsonReadSettings"
							}
						}
					},
					{
						"name": "ForEachJsonFile",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "SP_Truncate_DAC_Tables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('GetAllJsonFiles').output.childItems",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "LookupJsonFile",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"dataset": {
											"referenceName": "Dac_Stage_Location_List_Load",
											"type": "DatasetReference",
											"parameters": {
												"fileName": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									}
								},
								{
									"name": "Store_DAC_Store_Details",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "LookupJsonFile",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Stage_SiteMaster_DAC_Payload",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"item_param": {
												"value": "@activity('LookupJsonFile').output.firstRow.Data",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "SP_Load_Stores_Details",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEachJsonFile",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Load_Stores_Data]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP_Truncate_DAC_Tables",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GetAllJsonFiles",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Truncate_DAC_Tables]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreLocationDetailsErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GetAllJsonFiles",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('GetAllJsonFiles').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('GetAllJsonFiles').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('GetAllJsonFiles').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('GetAllJsonFiles').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"location_id_var": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:05Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_DAC_Payload')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Load RDC masterlist data from smartsheet to Semarchy staging",
				"activities": [
					{
						"name": "DF_Smartsheet_SemStg",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_Stage_SiteMaster_RDC_Smartsheet",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"SRCSMARTSHEET": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/DF_Stage_SiteMaster_RDC_Smartsheet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CustomerInitialChunkLoad')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Customer Chunk Load",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_RetailCustomer_RetailCustomerLoad_InitialLoad",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 3,
						"startTime": "2023-02-03T10:00:00",
						"timeZone": "Eastern Standard Time"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDWPIMDailyRemoveLoad')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_ProductMasterLoad_Retail_Delete_PIM_EDW",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-10-03T05:49:00",
						"timeZone": "Eastern Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								6
							]
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ReProcessErrorFilesRetailCustomerLoadIncremental')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "ReProcess RetailCustomer Error Files from the error folder",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "ReProcess_ErrorFiles_Stage_Retail_Customer_RetailCustomerLoad_Incremental",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 2,
						"startTime": "2023-03-15T00:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": []
		}
	]
}