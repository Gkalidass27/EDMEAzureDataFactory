{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_PostalCode')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Mtce_Stage_PostalCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT * FROM [dbo].[GD_ENT_REF_POSTAL_CODE]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE Scratch.GD_ENT_REF_POSTAL_CODE",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OBSERVES_DST",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "OBSERVES_DST",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										},
										"sink": {
											"name": "LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										},
										"sink": {
											"name": "LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Scratch_GD_ENT_REF_POSTAL_CODE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:12Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_RDC_Files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyRDCMasterlist",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE Scratch.RDCMasterlist",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Bindy ID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BindyID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Account #",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Entity",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Entity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Licensee / Contact",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicenseeContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDC Address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCAddress",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDC City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDC State",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDC Zip",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDC Ship To",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDC Sq. Ft.",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCSqft",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDC Dock Doors",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCDockDoor",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Modified Date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ModifedDate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SiteMaster_RDCMasterlist",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Scratch_RDCMasterlist",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CopyZipAllocationRef",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CopyRDCMasterlist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "HSZIPType",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "HSZIPType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeType",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicenseeType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeAssignmentMethod",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicenseeAssignmentMethod",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeFinal",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicenseeFinal",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCAcctShipNew",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCAcctShipNew",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCAcctShipDriveTimeNew",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCAcctShipDriveTimeNew",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesNew",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SalesNew",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Licensee SalesOld",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Licensee SalesOld",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Sale Variance",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Sale Variance",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LicenseeOld",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicenseeOld",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EntityName2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCAcctShipOld",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCAcctShipOld",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RDCAcctShipDriveTimeOld",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RDCAcctShipDriveTimeOld",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SalesOld",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SalesOld",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TradeAreaType",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TradeAreaType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ChangeType",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ChangeType",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SiteMaster_ZipAllocationRef",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Scratch_ZipToRDCRef",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_SiteMaster_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetJsongFilesList",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Store_Details_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "JsonReadSettings"
							}
						}
					},
					{
						"name": "LoadJsonFiles",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "GetJsongFilesList",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('GetJsongFilesList').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "GetJsoncontains",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"dataset": {
											"referenceName": "Fetch_Location_Json",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									}
								},
								{
									"name": "LoadJsonContainsToJsonPayLoad",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "GetJsoncontains",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('GetJsoncontains').output.firstRow}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@{activity('GetJsoncontains').output.firstRow.LocationID}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postal_Code_Hist_Syncup')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Its an adhoc flow .If required we can use this flow to copy from -to Hist files  (Postal code)",
				"activities": [
					{
						"name": "Cp_Blob_To_Table",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OBSERVES_DST",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "OBSERVES_DST",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "LATITUDE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "LONGITUDE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Hist_Postal_Code",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Tbl_Postal_Code_Hist",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cp_Table_To_Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Cp_Blob_To_Table",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Tbl_Postal_Code_Hist",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Hist_Postal_Code",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Province_Code_Validation')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LUP_STATEORPROVINCECODE",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Concate_Postal_code",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select Count(*) as STATE_OR_PROVINCE_CODE from [Ref_PostalCode].[PostalCode]   WHERE COUNTRY_CODE = 'CA' AND STATE_OR_PROVINCE_CODE = '--'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_postalcode_StateOrProvinceCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "CHK_PROVINCE_CODE",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "LUP_STATEORPROVINCECODE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('LUP_STATEORPROVINCECODE').output.firstRow.STATE_OR_PROVINCE_CODE, 0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "NoActionRequired",
									"description": "NoActionRequired",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "NoActionRequired",
										"value": {
											"value": "NoActionRequired",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Notification_State_Or_Provencecode",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "'STATE_OR_PROVINCE_CODE having --'",
												"type": "Expression"
											},
											"status": {
												"value": "'LUP_STATEORPROVINCECODE'",
												"type": "Expression"
											},
											"message": {
												"value": "@{concat('The following PostalCodes not assigned the STATE_OR_PROVINCE_CODE: ', variables('Concate_Postal'))}",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "''",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "@pipeline().globalParameters.GP_WebhookUrl",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "LUP_STATEORPROVINCECODE_Value",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "Select Postal_code from [Ref_PostalCode].[PostalCode]   WHERE COUNTRY_CODE = 'CA' AND \nSTATE_OR_PROVINCE_CODE = '--'\n\nselect 1 as ret",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_postalcode_StateOrProvinceCode",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Postal_Code_Append",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "LUP_STATEORPROVINCECODE_Value",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@array(activity('LUP_STATEORPROVINCECODE_Value').output.value)",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Append_Postalcodes",
									"description": "Append_Postalcodes",
									"type": "AppendVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Append_PC",
										"value": {
											"value": "@item().Postal_code",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Concate_Postal_code",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Postal_Code_Append",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Concate_Postal",
							"value": {
								"value": "@{join(variables('Append_PC'), ', ')}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"NoActionRequired": {
						"type": "String"
					},
					"notificaon": {
						"type": "String"
					},
					"Concate_Postal": {
						"type": "String"
					},
					"Append_PC": {
						"type": "Array"
					},
					"StateOrProvinceCode": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:01:41Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ReProcess_ErrorFiles_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move_Error_Container_Files",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Error",
									"wildcardFileName": {
										"value": "*.csv",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Error_Files_From_ErrorFolder",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Move_Error_Files_RetailCustomer_Container",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Remove_Error_Files_From_ErrorFolder",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "*.csv",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Error_Folder_Reprocess_Error_Logs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Move_Error_Container_Files').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Reprocess_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": null,
									"type": "Int32"
								},
								"RowsRead": {
									"value": null,
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"FileCheck": {
						"type": "String"
					},
					"TableSchema": {
						"type": "String"
					},
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:12Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Remove_RetailCustomerLoad_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Remove_Archive_Files",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@adddays(startOfDay(utcnow()),-100)",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@adddays(startOfDay(utcnow()),-20)",
									"type": "Expression"
								},
								"wildcardFileName": "*.csv",
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:05Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Incremental_SiteMaster_Mappings')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Assign_new_legalEntity_Id",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Assign_new_legalEntity_Id_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Load Legal entity id to new Licensee"
							}
						],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[StoreMasterCustom_Sites_JoinCodes]\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Assign_new_legalEntity_Id_Warehouse",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Load Legal entity id to new Licensee"
							}
						],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_WH_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Assign_new_legalEntity_Id",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PIM_Delete_SKU')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "PIM_SKU_DELETE",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_loadid",
										"value": {
											"value": "@variables('B_Loadid')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "/*select  B_CREATOR,B_CLASSNAME,PRODUCT_MAIN_ID,SOURCE_ID,STATUS,LAST_MOD_DATE_TIME_UTC,SYSTEM_TIMESTAMP,ALTERNATE_DESCRIPTION2,ITEM_AFI_IMAGE_SET,ITEM_ALTERNATE_AFI_FLUFF1,ITEM_ALTER_DESC3,ITEM_ARVR_READY,ITEM_ASM_INSTR_INTERNAL,ITEM_ASM_INSTR_PUBLIC,ITEM_BOX_QTY,ITEM_CARTON_DEPTH_IN,ITEM_CARTON_DEPTH_MM,ITEM_CARTON_HEIGHT_IN,ITEM_CARTON_HEIGHT_MM,ITEM_CARTON_WIDTH_IN,ITEM_CARTON_WIDTH_MM,ITEM_CLASS,ITEM_CODE,ITEM_COLOR,ITEM_COLOR_SWATCH,ITEM_COMMODITY,ITEM_COMPONENT_QUANTITY,ITEM_CONSUMER_ASSEMBLY,ITEM_CUBES_FT,ITEM_CUBES_M,ITEM_DEAD,ITEM_DIMENSION_SKETCH,ITEM_DINING_CHAIR_QTY_CTN,ITEM_ENGINEERING_DIVISION,ITEM_EXCLUSIVE,ITEM_EXCLUSIVE_COMMENT,ITEM_EXPRESS_SHIP,ITEM_FOB_BASE_PRICE,ITEM_FORECAST_PLANNER_ID,ITEM_FRIENDLY_DIMENSIONS,ITEM_FUTURE_STATUS,ITEM_GNRL_DESC_ID,ITEM_GNRL_LONG_DESC,ITEM_GOOGLE_TITLE,ITEM_HOMSTORE_ASM_VIDEO1,ITEM_HTS_CODE,ITEM_IMPORT_DOMESTIC,ITEM_KEY_ITEM,ITEM_KNOCKOUT,ITEM_MTERIAL_REF_NEEDED,ITEM_MFG_WARRANTY,ITEM_NUMBER,ITEM_PHOTO,ITEM_PRODUCT_DEPTH_IN,ITEM_PRODUCT_DEPTH_MM,ITEM_PRODUCT_HEIGHT_IN,ITEM_PRODUCT_HEIGHT_MM,ITEM_PRODUCT_PAGE_URL,ITEM_PRODUCT_WIDTH_IN,ITEM_PRODUCT_WIDTH_MM,ITEM_RETAIL_BRAND_NAME,ITEM_RETAIL_TYPE,ITEM_ROLL_OVERIMAGE,ITEM_SALES_CATEGORY_CODE,ITEM_SCENE7_IMAGE_SET,ITEM_SEATS,ITEM_SERIES_NAME,ITEM_SERIES_NUMBER,ITEM_STAND_ALONE_FLAG,ITEM_STATUS,ITEM_STATUS_CHANGED,ITEM_SUPP_DT_SHIP_ONLY,ITEM_SUPP_WET_NET_WET_KG,ITEM_SUPP_WET_NET_WET_LBS,ITEM_THIRD_PARTY_ITEM,ITEM_TRACKING_PIECE,ITEM_TRADEMARK_TEXT,ITEM_TYPE,ITEM_UNIT_WEIGHT_KG,ITEM_UNIT_WEIGHT_LBS,ITEM_UPC,ITEM_VALIDATION_COMPLETE,ITEM_WHOLESALE_ASM_VIDEO1,ITEM_AFI_FEATURE_BULLET1,ITEM_AFI_FEATURE_BULLET2,ITEM_AFI_FEATURE_BULLET3,ITEM_AFI_FEATURE_BULLET4,ITEM_AFI_FEATURE_BULLET5,ITEM_AFI_FEATURE_BULLET6,ITEM_AFI_FEATURE_BULLET7,ITEM_CONSUMER_DESCRIPTION,ITEM_FLUFF_AFI,ITEM_FLUFF_PRINT,ITEM_FRIENDLY_DESCRIPTION,ITEM_HOMESTORE_FT_BULLET1,ITEM_HOMESTORE_FT_BULLET2,ITEM_HOMESTORE_FT_BULLET3,ITEM_HOMESTORE_FT_BULLET4,ITEM_HOMESTORE_FT_BULLET5,ITEM_HOMESTORE_FT_BULLET6,ITEM_HOMESTORE_FT_BULLET7,ITEM_HOMESTORE_FT_BULLET8,ITEM_HOMESTORE_ITEM_FLUFF,SERIES_ASHLEY_HOMESTORE,SERIES_CORP_ONLINE_SELLNG,SERIES_DIVISION,SERIES_EXCLUSIVE_COMMENT,SERIES_FEATURES,SERIES_ID,SERIES_INTERNATIONAL_HS,SERIES_INTRO_DATE,SERIES_MAIN_IMAGE,SERIES_NAME,SERIES_NUMBER,SERIES_RETAIL_SALES_CATEG,SERIES_SHOWROOM,SERIES_SOURCE_ID,SERIES_STATUS,SERIES_STYLE,SERIES_THIRD_PARTY,SERIES_PRIMARY,ITEM_UOM_KEY,ITEM_SHIPPABLE_UOM_KEY,ITEM_ELIG_PROTECTION_PLAN,ITEM_IS_PROTECTION_PLAN,ITEM_ASHCOMM_DLVR_MODE,ITEM_MATERIAL,ITEM_HS_PRODUCT_LINE,ITEM_ECOM_MERCHANT_NOTES,ITEM_AMAZON_BRAND_OWNER,ITEM_LIFESTYLE_DESC,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION,\ncast(newid() as uniqueidentifier) as B_operationID\nfrom Retail.PIM_Product_Delete\n*/\n\nselect \n 'semadmin' as B_CREATOR,\n 'semadmin' as B_UPDATOR,\n getdate() as B_credate,\n getdate() as B_upddate, B_CLASSNAME,PRODUCT_MAIN_ID,SOURCE_ID,STATUS,LAST_MOD_DATE_TIME_UTC,\n SYSTEM_TIMESTAMP,ALTERNATE_DESCRIPTION2,ITEM_AFI_IMAGE_SET,ITEM_ALTERNATE_AFI_FLUFF1,ITEM_ALTER_DESC3,\n ITEM_ARVR_READY,ITEM_ASM_INSTR_INTERNAL,ITEM_ASM_INSTR_PUBLIC,ITEM_BOX_QTY,ITEM_CARTON_DEPTH_IN,\n ITEM_CARTON_DEPTH_MM,ITEM_CARTON_HEIGHT_IN,ITEM_CARTON_HEIGHT_MM,ITEM_CARTON_WIDTH_IN,ITEM_CARTON_WIDTH_MM,\n ITEM_CLASS,ITEM_CODE,ITEM_COLOR,ITEM_COLOR_SWATCH,ITEM_COMMODITY,ITEM_COMPONENT_QUANTITY,ITEM_CONSUMER_ASSEMBLY,\n ITEM_CUBES_FT,ITEM_CUBES_M,ITEM_DEAD,ITEM_DIMENSION_SKETCH,ITEM_DINING_CHAIR_QTY_CTN,ITEM_ENGINEERING_DIVISION,\n ITEM_EXCLUSIVE,ITEM_EXCLUSIVE_COMMENT,ITEM_EXPRESS_SHIP,ITEM_FOB_BASE_PRICE,ITEM_FORECAST_PLANNER_ID,\n ITEM_FRIENDLY_DIMENSIONS,ITEM_FUTURE_STATUS,ITEM_GNRL_DESC_ID,ITEM_GNRL_LONG_DESC,ITEM_GOOGLE_TITLE,ITEM_HOMSTORE_ASM_VIDEO1,ITEM_HTS_CODE,ITEM_IMPORT_DOMESTIC,ITEM_KEY_ITEM,\n ITEM_KNOCKOUT,ITEM_MTERIAL_REF_NEEDED,ITEM_MFG_WARRANTY,ITEM_NUMBER,ITEM_PHOTO,ITEM_PRODUCT_DEPTH_IN,\n ITEM_PRODUCT_DEPTH_MM,ITEM_PRODUCT_HEIGHT_IN,ITEM_PRODUCT_HEIGHT_MM,ITEM_PRODUCT_PAGE_URL,ITEM_PRODUCT_WIDTH_IN,ITEM_PRODUCT_WIDTH_MM,ITEM_RETAIL_BRAND_NAME,ITEM_RETAIL_TYPE,ITEM_ROLL_OVERIMAGE,ITEM_SALES_CATEGORY_CODE,ITEM_SCENE7_IMAGE_SET,ITEM_SEATS,ITEM_SERIES_NAME,ITEM_SERIES_NUMBER,ITEM_STAND_ALONE_FLAG,ITEM_STATUS,ITEM_STATUS_CHANGED,ITEM_SUPP_DT_SHIP_ONLY,ITEM_SUPP_WET_NET_WET_KG,ITEM_SUPP_WET_NET_WET_LBS,ITEM_THIRD_PARTY_ITEM,ITEM_TRACKING_PIECE,ITEM_TRADEMARK_TEXT,ITEM_TYPE,ITEM_UNIT_WEIGHT_KG,ITEM_UNIT_WEIGHT_LBS,ITEM_UPC,ITEM_VALIDATION_COMPLETE,ITEM_WHOLESALE_ASM_VIDEO1,ITEM_AFI_FEATURE_BULLET1,ITEM_AFI_FEATURE_BULLET2,ITEM_AFI_FEATURE_BULLET3,ITEM_AFI_FEATURE_BULLET4,ITEM_AFI_FEATURE_BULLET5,ITEM_AFI_FEATURE_BULLET6,ITEM_AFI_FEATURE_BULLET7,ITEM_CONSUMER_DESCRIPTION,ITEM_FLUFF_AFI,ITEM_FLUFF_PRINT,ITEM_FRIENDLY_DESCRIPTION,ITEM_HOMESTORE_FT_BULLET1,ITEM_HOMESTORE_FT_BULLET2,ITEM_HOMESTORE_FT_BULLET3,ITEM_HOMESTORE_FT_BULLET4,ITEM_HOMESTORE_FT_BULLET5,ITEM_HOMESTORE_FT_BULLET6,ITEM_HOMESTORE_FT_BULLET7,ITEM_HOMESTORE_FT_BULLET8,ITEM_HOMESTORE_ITEM_FLUFF,SERIES_ASHLEY_HOMESTORE,SERIES_CORP_ONLINE_SELLNG,SERIES_DIVISION,SERIES_EXCLUSIVE_COMMENT,SERIES_FEATURES,SERIES_ID,SERIES_INTERNATIONAL_HS,SERIES_INTRO_DATE,SERIES_MAIN_IMAGE,SERIES_NAME,SERIES_NUMBER,SERIES_RETAIL_SALES_CATEG,SERIES_SHOWROOM,SERIES_SOURCE_ID,SERIES_STATUS,SERIES_STYLE,SERIES_THIRD_PARTY,SERIES_PRIMARY,ITEM_UOM_KEY,ITEM_SHIPPABLE_UOM_KEY,ITEM_ELIG_PROTECTION_PLAN,ITEM_IS_PROTECTION_PLAN,ITEM_ASHCOMM_DLVR_MODE,ITEM_MATERIAL,ITEM_HS_PRODUCT_LINE,ITEM_ECOM_MERCHANT_NOTES,ITEM_AMAZON_BRAND_OWNER,ITEM_LIFESTYLE_DESC,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION,\ncast(newid() as uniqueidentifier) as B_operationID\nfrom Retail.PIM_Product_Delete",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_operationID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_OPERATIONID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_credate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_upddate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "PIM_SKU_DELETE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_PRODUCT_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GX_Colorwheel",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GX_Sistersku",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.GX_COLORWHEEL",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GX_COLORWHEEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GX_COLOR_WHEEL_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GX_Sistersku",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GX_National_Assortment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table  Retail.GX_SISTER_SKU",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GX_SISTER_SKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GX_SISTERSKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GX_National_Assortment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Gx_Product_main",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.GX_NATIONAL_ASSORTMENT",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "NATIONAL_ASSORTMENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "NATIONAL_ASSORTMENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEPATH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETEPATH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_GOLDENTYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_GOLDENTYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_HASOVERRIDE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "B_HASOVERRIDE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_ERROR_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_ERROR_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ISCONFIRMED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "B_ISCONFIRMED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_CONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_CONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_HASSUGGMERGE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "B_HASSUGGMERGE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGEID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_SUGGMERGEID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGECONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_SUGGMERGECONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGECONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SUGGMERGECONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGEMASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_SUGGMERGEMASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "HERO_SKU",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "HERO_SKU",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "BUSINESS_CHANNEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BUSINESS_CHANNEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_AREA",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_AREA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_LOCATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Primary_Location",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SECONDARY_LOCATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Secondary_Location",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GOOD_BETTER_BEST",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GOOD_BETTER_BEST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CMDT_EXCLSV_PRPRTRY_SGNTR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CMDT_EXCLSV_PRPRTRY_SGNTR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MONTH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MONTH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET_INTRODUCTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MARKET_INTRODUCTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SIZE_SHAPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SIZE_SHAPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FEATURE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FEATURE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FEATURE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FEATURE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FOUNDATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FOUNDATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ASSORTMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ASSORTMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_MAIN_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PRODUCT_MAIN_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ENTRY_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "Entry_date",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EXIT_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "Exit_date",
											"type": "DateTime",
											"physicalType": "date"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GX_NATIONAL_ASSORTMENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GX_NATIONAL_ASSORTMENT_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_Colorwheel",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_SisterSKU",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.GD_Colorwheel",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Color_wheel",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GD_Colorwheel_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_SisterSKU",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_NationalAssortment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.GD_SISTER_SKU",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_SisterSKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GD_SISTER_SKU_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_NationalAssortment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GX_Colorwheel",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate  table retail.GD_NationalAssortment",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "NATIONAL_ASSORTMENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "NATIONAL_ASSORTMENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_GOLDENTYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_GOLDENTYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_HASOVERRIDE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "B_HASOVERRIDE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_ERROR_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_ERROR_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ISCONFIRMED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "B_ISCONFIRMED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_CONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_CONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_HASSUGGMERGE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "B_HASSUGGMERGE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGEID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_SUGGMERGEID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGECONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_SUGGMERGECONFSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGECONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SUGGMERGECONFSCORETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SUGGMERGEMASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_SUGGMERGEMASTERSCOUNT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "HERO_SKU",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "HERO_SKU",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "BUSINESS_CHANNEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BUSINESS_CHANNEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_AREA",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_AREA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_LOCATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Primary_Location",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SECONDARY_LOCATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Secondary_Location",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GOOD_BETTER_BEST",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GOOD_BETTER_BEST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CMDT_EXCLSV_PRPRTRY_SGNTR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CMDT_EXCLSV_PRPRTRY_SGNTR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MONTH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MONTH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET_INTRODUCTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MARKET_INTRODUCTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SIZE_SHAPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SIZE_SHAPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FEATURE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FEATURE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FEATURE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FEATURE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FOUNDATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FOUNDATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ASSORTMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ASSORTMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_MAIN_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PRODUCT_MAIN_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ENTRY_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "Entry_date",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EXIT_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "Exit_date",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "HS_ASST_OR_OUTLET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "HS_ASST_OR_OUTLET",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FLOOR_PLAN_HERO_SKU",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FLOOR_PLAN_HERO_SKU",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SLOT_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SLOT_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SLOT_FLOORING_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "SLOT_FLOORING_FLAG",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "STOCK_OR_DO_NOT_STOCK",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STOCK_OR_DO_NOT_STOCK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POP_NEEDS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POP_NEEDS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TRANSITION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TRANSITION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAUNCH_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "LAUNCH_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_NationalAssortment",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GD_NationalAssortment_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_Product_main",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.GD_Product_main",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Product_main",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GD_Product_main_staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Gx_Product_main",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_Product_main",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.GX_Product_main",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Gx_Product_main",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Gx_Product_main_staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "GD_Colorwheel",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "B_Loadid",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "PIM_SKU_DELETE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('B_Loadid')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"B_Loadid": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCodeAutomation_CA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Getlicensekey_Melissa",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "To get license key from KV"
							}
						],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"url": {
								"value": "@pipeline().globalParameters.Melissa_LicenseKey",
								"type": "Expression"
							},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "Set Licensekey",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Getlicensekey_Melissa",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set License key to variable"
							}
						],
						"typeProperties": {
							"variableName": "license_key",
							"value": {
								"value": "@activity('Getlicensekey_Melissa').output.value",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy_PostalCode_CA",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Licensekey",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.10:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 60,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Copy File from download URL to Blob container"
							}
						],
						"typeProperties": {
							"source": {
								"type": "HttpSource",
								"httpRequestTimeout": "00:01:40"
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "HttpDataset2_CA_canadatxt",
								"type": "DatasetReference",
								"parameters": {
									"ID": {
										"value": "@variables('license_key')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_PostalCode_CA",
								"type": "DatasetReference",
								"parameters": {
									"Filename": {
										"value": "@concat('canada','.txt')",
										"type": "Expression"
									},
									"FolderName": {
										"value": "@pipeline().parameters.FolderName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy_PostalCode_CA_OverLay",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Licensekey",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.10:00:00",
							"retry": 2,
							"retryIntervalInSeconds": 60,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Copy File from download URL to Blob container"
							}
						],
						"typeProperties": {
							"source": {
								"type": "HttpSource",
								"httpRequestTimeout": "00:01:40"
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "HttpDataset2_CA_overlaytxt",
								"type": "DatasetReference",
								"parameters": {
									"ID": "ZJERTAWalLbr19V1DoknD4**"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_PostalCode_CA",
								"type": "DatasetReference",
								"parameters": {
									"Filename": {
										"value": "@concat('overlay','.txt')",
										"type": "Expression"
									},
									"FolderName": {
										"value": "@pipeline().parameters.FolderName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_PostalCode_Failed_overlaytxt",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_PostalCode_CA_OverLay",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Notify Team "
							}
						],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Copy_PostalCode_CA_OverLay').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "'Failure'",
									"type": "Expression"
								},
								"message": {
									"value": "'File Copy failed . Please have a look'",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Copy_PostalCode_CA_OverLay').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_PostalCode_Failed_canadatxt",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_PostalCode_CA",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Notify Team "
							}
						],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Copy_PostalCode_CA').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "'Failure'",
									"type": "Expression"
								},
								"message": {
									"value": "'File Copy failed . Please have a look'",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Copy_PostalCode_CA').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Success_Notification_PostalCode_overlaytxt",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_PostalCode_CA_OverLay",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Notify Team about new file processed"
							}
						],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Copy_PostalCode_CA_OverLay').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Copy_PostalCode_CA_OverLay').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "'Postal codes file available in blob container'",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Copy_PostalCode_CA_OverLay').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Success_Notification_PostalCode_canadatxt",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Copy_PostalCode_CA",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Notify Team about new file processed"
							}
						],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Copy_PostalCode_CA').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Copy_PostalCode_CA').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "'Postal codes file available in blob container'",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Copy_PostalCode_CA').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"FolderName": {
						"type": "string",
						"defaultValue": "Postal_Code_Source_Files"
					},
					"GetLicensekey": {
						"type": "string",
						"defaultValue": "https://afide-edmekv.vault.azure.net/secrets/melissa-data-license-key/b0d3207214ea4b0b9fef24ac132a17e1?api-version=7.0"
					}
				},
				"variables": {
					"license_key": {
						"type": "String"
					},
					"folder": {
						"type": "Array"
					},
					"datelist": {
						"type": "String"
					},
					"parsedatelist": {
						"type": "Array"
					},
					"dummy": {
						"type": "String"
					},
					"Processed_for_YrMonth_lkp": {
						"type": "String"
					},
					"Api_Path": {
						"type": "String"
					},
					"insert_stmt": {
						"type": "String"
					},
					"New_processed_YearMonth": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCodeAutomation_US')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Getlicensekey_Melissa",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "To get license key from KV"
							}
						],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"url": {
								"value": "@pipeline().globalParameters.Melissa_LicenseKey",
								"type": "Expression"
							},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "Set Licensekey",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Getlicensekey_Melissa",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set License key to variable"
							}
						],
						"typeProperties": {
							"variableName": "license_key",
							"value": {
								"value": "@activity('Getlicensekey_Melissa').output.value",
								"type": "Expression"
							}
						}
					},
					{
						"name": "GetFilelist",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set Licensekey",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Get folder available list from Release URL"
							}
						],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"httpRequestTimeout": "00:10:00",
							"url": {
								"value": "@concat('https://releases.melissadata.net/releases/data/z5max.txt?FORMAT=JSON&ID=',variables('license_key'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Filter_LatestFileProcessed",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Set ProcessedForYearMonth",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [
							{
								"name": "Task",
								"value": "Filter latest file to be processed in this run"
							}
						],
						"typeProperties": {
							"items": {
								"value": "@variables('parsedatelist')",
								"type": "Expression"
							},
							"condition": {
								"value": "@greater(item(), variables('Processed_for_YrMonth_lkp'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Datelist",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetFilelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set Folderlist to variable"
							}
						],
						"typeProperties": {
							"variableName": "datelist",
							"value": {
								"value": "@activity('GetFilelist').output.Response",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set parsedatelist",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Datelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Parse Json to array"
							}
						],
						"typeProperties": {
							"variableName": "parsedatelist",
							"value": {
								"value": "@json(variables('datelist'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup_LastFileProcessed",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set parsedatelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Get processed file list from previous run"
							}
						],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select max(Processed_for_YrMonth) as Processed_for_YrMonth from Retail.Postalcode_Processed_files",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Postalcode_Processed_files",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set ProcessedForYearMonth",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_LastFileProcessed",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set previously processed file to variable"
							}
						],
						"typeProperties": {
							"variableName": "Processed_for_YrMonth_lkp",
							"value": {
								"value": "@activity('Lookup_LastFileProcessed').output.firstRow.Processed_for_YrMonth\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter_LatestFileProcessed",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [
							{
								"name": "Task",
								"value": "For each Files"
							}
						],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter_LatestFileProcessed').output.Value\n",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "If Condition1",
									"type": "IfCondition",
									"dependsOn": [
										{
											"activity": "Set variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [
										{
											"name": "Task",
											"value": "Will execute if latest file from Release url > previously processed file"
										}
									],
									"typeProperties": {
										"expression": {
											"value": "@greater(length(activity('Filter_LatestFileProcessed').output.value),0)\n",
											"type": "Expression"
										},
										"ifFalseActivities": [
											{
												"name": "Teams_Failed_Notification_PostalCode",
												"type": "ExecutePipeline",
												"dependsOn": [],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team "
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Filter_LatestFileProcessed').output.executionDetails[0].start\n",
															"type": "Expression"
														},
														"status": {
															"value": "'Success'",
															"type": "Expression"
														},
														"message": {
															"value": "'Not yet received Melissa data'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Filter_LatestFileProcessed').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "@pipeline().globalParameters.GP_WebhookUrl",
															"type": "Expression"
														}
													}
												}
											}
										],
										"ifTrueActivities": [
											{
												"name": "Set variable2",
												"type": "SetVariable",
												"dependsOn": [],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Set new file to be processed"
													}
												],
												"typeProperties": {
													"variableName": "New_processed_YearMonth",
													"value": {
														"value": "@item()",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Copy_PostalCode_US",
												"type": "Copy",
												"dependsOn": [
													{
														"activity": "Set variable2",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "0.10:00:00",
													"retry": 2,
													"retryIntervalInSeconds": 60,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Copy File from download URL to Blob container"
													}
												],
												"typeProperties": {
													"source": {
														"type": "HttpSource",
														"httpRequestTimeout": "00:01:40"
													},
													"sink": {
														"type": "BinarySink",
														"storeSettings": {
															"type": "AzureBlobFSWriteSettings"
														}
													},
													"enableStaging": false
												},
												"inputs": [
													{
														"referenceName": "HttpDataset2",
														"type": "DatasetReference",
														"parameters": {
															"ID": {
																"value": "@variables('license_key')",
																"type": "Expression"
															},
															"Currentmonthyear": {
																"value": "@variables('New_processed_YearMonth')",
																"type": "Expression"
															}
														}
													}
												],
												"outputs": [
													{
														"referenceName": "DS_PostalCode_US",
														"type": "DatasetReference",
														"parameters": {
															"Filename": {
																"value": "@concat('z5max','.txt')",
																"type": "Expression"
															},
															"FolderName": {
																"value": "@pipeline().parameters.FolderName",
																"type": "Expression"
															}
														}
													}
												]
											},
											{
												"name": "Teams_Success_Notification_PostalCode_copy1",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Script1",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team about new file processed"
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Copy_PostalCode_US').output.executionDetails[0].start",
															"type": "Expression"
														},
														"status": {
															"value": "@activity('Copy_PostalCode_US').output.executionDetails[0].status",
															"type": "Expression"
														},
														"message": {
															"value": "'Postal codes file available in blob container'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Copy_PostalCode_US').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "@pipeline().globalParameters.GP_WebhookUrl",
															"type": "Expression"
														}
													}
												}
											},
											{
												"name": "Script1",
												"type": "Script",
												"dependsOn": [
													{
														"activity": "Set ApiPath",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "0.12:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Update file processed to Retail.Postalcode_Processed_files table"
													}
												],
												"linkedServiceName": {
													"referenceName": "semarchy_staging",
													"type": "LinkedServiceReference"
												},
												"typeProperties": {
													"scripts": [
														{
															"type": "Query",
															"text": {
																"value": "@concat('INSERT INTO Retail.Postalcode_Processed_files ',\n'(',\n'Country, ',\n'API_path, ',\n'Processed_date, ',\n'Processed_for_YrMonth',\n') ',\n'VALUES ',\n'(',\n'''US'', ',\n'''', variables('Api_Path'), ''', ',\n'GETDATE(), ',\n'''', variables('New_processed_YearMonth'), '''',\n')'\n)",
																"type": "Expression"
															}
														}
													],
													"scriptBlockExecutionTimeout": "02:00:00"
												}
											},
											{
												"name": "Set ApiPath",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "Copy_PostalCode_US",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Set API path"
													}
												],
												"typeProperties": {
													"variableName": "Api_Path",
													"value": {
														"value": "@concat('https://releases.melissadata.net/Download/Data/',variables('New_processed_YearMonth'),'/z5max.txt?ID={{licenseKey}}')",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Teams_Failed_Notification_PostalCode_Failed",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Copy_PostalCode_US",
														"dependencyConditions": [
															"Failed"
														]
													}
												],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team "
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Filter_LatestFileProcessed').output.executionDetails[0].start\n",
															"type": "Expression"
														},
														"status": {
															"value": "'Failure'",
															"type": "Expression"
														},
														"message": {
															"value": "'File Copy failed . Please have a look'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Filter_LatestFileProcessed').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "@pipeline().globalParameters.GP_WebhookUrl",
															"type": "Expression"
														}
													}
												}
											}
										]
									}
								},
								{
									"name": "Set variable",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Task",
											"value": "Latest file from Release URL"
										}
									],
									"typeProperties": {
										"variableName": "New_processed_YearMonth",
										"value": {
											"value": "@item()",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"FolderName": {
						"type": "string",
						"defaultValue": "Postal_Code_Source_Files"
					},
					"GetLicensekey": {
						"type": "string",
						"defaultValue": "https://afide-edmekv.vault.azure.net/secrets/melissa-data-license-key/b0d3207214ea4b0b9fef24ac132a17e1?api-version=7.0"
					}
				},
				"variables": {
					"license_key": {
						"type": "String"
					},
					"folder": {
						"type": "Array"
					},
					"datelist": {
						"type": "String"
					},
					"parsedatelist": {
						"type": "Array"
					},
					"dummy": {
						"type": "String"
					},
					"Processed_for_YrMonth_lkp": {
						"type": "String"
					},
					"Api_Path": {
						"type": "String"
					},
					"insert_stmt": {
						"type": "String"
					},
					"New_processed_YearMonth": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_Postal_Code",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "US"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ST",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "A/C",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "County",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "County",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Pref?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Pref",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "T/Z",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TZ",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DST?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Lat",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Lat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Long",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Long",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Div",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Div",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USA_Zip_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_USA": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "US_Zip_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CANADA_Postal_Code",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "CA"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Latitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Longitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Province",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Province",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Canada_Postal_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_canada": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CANADA_Postal_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": "*.*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_Code_Archive",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Postal_Code_Succeed_Files_Delete",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": "*.*",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_US_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.US_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_CANADA_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.CANADA_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('US_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('US_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('US_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is US Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('US_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('US_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('US_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "US_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('US_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('CANADA_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('CANADA_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Canada Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CANADA_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CANADA_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('CANADA_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "z5max.txt"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "zipcodeset.txt"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LOAD_EDW_Kit",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Kit]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "SeriesID",
											"type": "String"
										},
										"sink": {
											"name": "SeriesID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesKey",
											"type": "Int64"
										},
										"sink": {
											"name": "SeriesKey",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitColorKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitColorKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitStatusKey",
											"type": "String"
										},
										"sink": {
											"name": "KitStatusKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitClassKey",
											"type": "String"
										},
										"sink": {
											"name": "KitClassKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										},
										"sink": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitType",
											"type": "String"
										},
										"sink": {
											"name": "KitType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "KitExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										},
										"sink": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAXKitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitAXKitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "KitDead",
											"type": "String"
										},
										"sink": {
											"name": "KitDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitBoxQty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitBoxQty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeats",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSeats",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitUPC",
											"type": "String"
										},
										"sink": {
											"name": "KitUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "KitARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "KitStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										},
										"sink": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "KitForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSelllingCountries",
											"type": "String"
										},
										"sink": {
											"name": "KitSelllingCountries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitThirdPartyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitThirdPartyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "KitRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKnockout",
											"type": "String"
										},
										"sink": {
											"name": "KitKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "KitColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPhoto",
											"type": "String"
										},
										"sink": {
											"name": "KitPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "KitGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "KitProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCubesFt",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesFt",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCubesM",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "KitHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKeyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitKeyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "KitTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "KitTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "KitValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusive",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCommodity",
											"type": "String"
										},
										"sink": {
											"name": "KitCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUpholsteryCover",
											"type": "String"
										},
										"sink": {
											"name": "KitUpholsteryCover",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										},
										"sink": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPurchaseType",
											"type": "String"
										},
										"sink": {
											"name": "KitPurchaseType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPartsDrawings",
											"type": "String"
										},
										"sink": {
											"name": "KitPartsDrawings",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										},
										"sink": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										},
										"sink": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitATPSeries",
											"type": "String"
										},
										"sink": {
											"name": "KitATPSeries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitVendorName",
											"type": "String"
										},
										"sink": {
											"name": "KitVendorName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "KitComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMaterialEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitMaterialEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Kit",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KIT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Package",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Kit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Package]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PackageID",
											"type": "String"
										},
										"sink": {
											"name": "PackageID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKey",
											"type": "Int32"
										},
										"sink": {
											"name": "PackageKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "HomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "HomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHero",
											"type": "String"
										},
										"sink": {
											"name": "PackageHero",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatus",
											"type": "String"
										},
										"sink": {
											"name": "PackageStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageIsThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "PackageIsThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageWholesaleID",
											"type": "String"
										},
										"sink": {
											"name": "PackageWholesaleID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRetailType",
											"type": "String"
										},
										"sink": {
											"name": "PackageRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageItemQuantity",
											"type": "String"
										},
										"sink": {
											"name": "PackageItemQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageUOM",
											"type": "String"
										},
										"sink": {
											"name": "PackageUOM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageColor",
											"type": "String"
										},
										"sink": {
											"name": "PackageColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKnockout",
											"type": "String"
										},
										"sink": {
											"name": "PackageKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationNotes",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRolloverImage",
											"type": "String"
										},
										"sink": {
											"name": "PackageRolloverImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "PackageExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTransition",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTransition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										},
										"sink": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageDefaultProduct",
											"type": "String"
										},
										"sink": {
											"name": "PackageDefaultProduct",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageChannelChange",
											"type": "String"
										},
										"sink": {
											"name": "PackageChannelChange",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExclusive",
											"type": "String"
										},
										"sink": {
											"name": "PackageExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										},
										"sink": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHiddenField",
											"type": "String"
										},
										"sink": {
											"name": "PackageHiddenField",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageConsumerChoice",
											"type": "String"
										},
										"sink": {
											"name": "PackageConsumerChoice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										},
										"sink": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommFlags",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommFlags",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNavigableCategories",
											"type": "String"
										},
										"sink": {
											"name": "PackageNavigableCategories",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Product",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Package",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Product]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SystemTimestamp",
											"type": "Int32"
										},
										"sink": {
											"name": "SystemTimestamp",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "AlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "AlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "ItemARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemBoxQty",
											"type": "String"
										},
										"sink": {
											"name": "ItemBoxQty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemClass",
											"type": "String"
										},
										"sink": {
											"name": "ItemClass",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColor",
											"type": "String"
										},
										"sink": {
											"name": "ItemColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "ItemColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCommodity",
											"type": "String"
										},
										"sink": {
											"name": "ItemCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "ItemComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesFt",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesFt",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesM",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDead",
											"type": "String"
										},
										"sink": {
											"name": "ItemDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "ItemDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										},
										"sink": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										},
										"sink": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusive",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "ItemExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										},
										"sink": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "ItemGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemImportDomestic",
											"type": "String"
										},
										"sink": {
											"name": "ItemImportDomestic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKeyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemKeyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKnockout",
											"type": "String"
										},
										"sink": {
											"name": "ItemKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMfgWarranty",
											"type": "String"
										},
										"sink": {
											"name": "ItemMfgWarranty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemPhoto",
											"type": "String"
										},
										"sink": {
											"name": "ItemPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailBrandName",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailBrandName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailType",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "ItemRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeats",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeats",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatusChanged",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatusChanged",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemType",
											"type": "String"
										},
										"sink": {
											"name": "ItemType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUPC",
											"type": "String"
										},
										"sink": {
											"name": "ItemUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "ItemValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffAFI",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffAFI",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffPrint",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffPrint",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										},
										"sink": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesDivision",
											"type": "String"
										},
										"sink": {
											"name": "SeriesDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesFeatures",
											"type": "String"
										},
										"sink": {
											"name": "SeriesFeatures",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesId",
											"type": "String"
										},
										"sink": {
											"name": "SeriesId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesIntroDate",
											"type": "String"
										},
										"sink": {
											"name": "SeriesIntroDate",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesMainImage",
											"type": "String"
										},
										"sink": {
											"name": "SeriesMainImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesName",
											"type": "String"
										},
										"sink": {
											"name": "SeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "SeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										},
										"sink": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesShowroom",
											"type": "String"
										},
										"sink": {
											"name": "SeriesShowroom",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesSourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SeriesSourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "SeriesStatus",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesStyle",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "SeriesThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesPrimary",
											"type": "String"
										},
										"sink": {
											"name": "SeriesPrimary",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterial",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_ProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Product",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE  [EDW].[ProductPackageCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_ProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[KitComponentCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "ComponentType",
											"type": "String"
										},
										"sink": {
											"name": "ComponentType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentID",
											"type": "String"
										},
										"sink": {
											"name": "ComponentID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "ComponentSourceID",
											"type": "Int64"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_ProductCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_KitComponentCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "B_update",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select ProductCodeKey,ProductCode,SYSUTCDATETIME() as Last_modified_date from EDME_Datafactory.ProductCode",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ProductCodeKey"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:17Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(DTStamp) AS MaxDate FROM [Masterdata_CDP].[cdp_customer_preferences_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "OptOut_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(EmailChannelOptStatusDate) AS MaxDate FROM [Masterdata_CDP].[OptOut_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_CDP_Customer_Prefrence_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS CDPCustomerPreferencesCount FROM EDME_DataFactory.cdp_customer_preferences_v2 with(nolock) where DTStamp is not null AND DTStamp>'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_OptOut_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "OptOut_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS OptOutCount FROM EDME_DataFactory.OptOut with(nolock) where EmailChannelOptStatusDate>'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_EDW_CDP_Customer_Prefrence_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_CDP_Customer_Prefrence_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_CDP_Customer_Prefrence_Count').output.firstRow.CDPCustomerPreferencesCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_CDP_Customer_Prefrence_Count_Data_Not_Found_Logs_SP",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_CDP_Customer_Prefrence_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Cdp_Customer_Preferences",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType ,\nDTStamp\nfrom EDME_DataFactory.cdp_customer_preferences_v2 WITH(NOLOCK) WHERE DTStamp is not null AND DTStamp >'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Cdp_Customer_Preferences_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP_Cdp_Customer_Preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cdp_Customer_Preferences_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Cdp_Customer_Preferences').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Cdp_Customer_Preferences').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Cdp_Customer_Preferences').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "@pipeline().globalParameters.GP_WebhookUrl",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_Cdp_Customer_Preferences",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Check_EDW_OptOut_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_OptOut_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_OptOut_Count').output.firstRow.OptOutCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_OptOutCount_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_OptOut_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "OptOut",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)\nwhere EmailChannelOptStatusDate >'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_OptOut",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_OptOut_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "OptOut_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('OptOut').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('OptOut').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "OptOut_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('OptOut').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('OptOut').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('OptOut').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('OptOut').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_OptOut",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('OptOut').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('OptOut').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('OptOut').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('OptOut').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('OptOut').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "@pipeline().globalParameters.GP_WebhookUrl",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_OptOut",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('OptOut').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('OptOut').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType \nfrom EDME_DataFactory.cdp_customer_preferences WITH(NOLOCK) where dtec<>'null.null'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "OptOut",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cdp_Customer_Preferences_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cdp_Customer_Preferences_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Cdp_Customer_Preferences').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Cdp_Customer_Preferences').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Cdp_Customer_Preferences').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OptOut_copy_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OptOut').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OptOut').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OptOut_copy_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OptOut').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OptOut').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OptOut').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OptOut').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_OptOut",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OptOut').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OptOut').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OptOut').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('OptOut').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OptOut').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Last_Trigger_Time",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(LasteTriggerDateTime) AS LasteTriggerDateTime FROM Audit.ADFRetailCustomerWatermark WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "GetLastTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Current_UTCTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get_Last_Trigger_Time",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ToDateTime",
							"value": {
								"value": "@utcNow()",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load_ECM_Customer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "updatedDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "createdDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')\n",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceCustomerId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "firstName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "middleInitial",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "lastName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "city",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "state",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "zipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "marketId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSubSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createdDate",
											"type": "String"
										},
										"sink": {
											"name": "createdDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "updatedDate",
											"type": "String"
										},
										"sink": {
											"name": "updatedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_AllSourceCustomers",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Homes_Customer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "updatedDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "createdDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "Homes*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceCustomerId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "firstName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "middleInitial",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "lastName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "city",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "state",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "zipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "marketId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createdDate",
											"type": "String"
										},
										"sink": {
											"name": "createdDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "updatedDate",
											"type": "String"
										},
										"sink": {
											"name": "updatedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Homes_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_AllSourceCustomers",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "UpdateTriggerTime",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "UPDATE Audit.ADFRetailCustomerWatermark SET LasteTriggerDateTime='@{formatDateTime(variables('ToDateTime'),'yyyy-MM-ddTHH:mm:ss')}';\nselect 1 as success;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "UpdateTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Error_ECM_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_Customer_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_ECM_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Error_ECM_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": false,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "D365Ecm*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Error_Homes_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "Homes*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Homes_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_Customer_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Homes_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Error_Homes_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": false,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "Homes*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Stage_Retail_Customer_Failure_Notification_ECM",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Load_ECM_Customer').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Load_ECM_Customer').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Load_ECM_Customer').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().RunId}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is D365 ECM Customers Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_ECM_Customer').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_ECM_Customer').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_ECM_Customer').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Stage_Retail_Customer_Failure_Notification_Homes",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Load_Homes_Customer').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Load_Homes_Customer').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Load_Homes_Customer').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Load_Homes_Customer').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().RunId}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Load_Homes_Customer').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Homes RET Customers Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('Load_Homes_Customer').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Homes_Customer').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Homes_Customer').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Homes_Customer').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Homes_Files_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_Failure_Notification_Homes",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Load_Homes_Customer').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Load_Homes_Customer').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ECM_Files_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_Failure_Notification_ECM",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Load_ECM_Customer').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer_Afc",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Retail_Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Succeed_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Load_Homes_Customer_Afc",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "updatedDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "createdDate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files/afc",
									"wildcardFileName": "Homes*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceCustomerId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "firstName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "middleInitial",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "lastName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "city",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "state",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "zipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "marketId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createdDate",
											"type": "String"
										},
										"sink": {
											"name": "createdDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "updatedDate",
											"type": "String"
										},
										"sink": {
											"name": "updatedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Homes_Files_afc",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_AllSourceCustomers",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Error_Homes_Files_Afc",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer_Afc",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files/afc",
									"wildcardFileName": "Homes*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Homes_Files_afc",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_Customer_Error_Files_afc",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Homes_Error_Files_afc",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Error_Homes_Files_Afc",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Error_Files_afc",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": false,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "Homes*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Stage_Retail_Customer_Failure_Notification_Homes_afc",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Homes_Customer_Afc",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Load_Homes_Customer_Afc').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Load_Homes_Customer_Afc').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Load_Homes_Customer_Afc').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Load_Homes_Customer_Afc').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().RunId}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Load_Homes_Customer_Afc').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Homes RET Customers Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('Load_Homes_Customer_Afc').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Homes_Customer_Afc').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Homes_Customer_Afc').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Homes_Customer_Afc').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Homes_Files_Fail_afc",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_Failure_Notification_Homes_afc",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Load_Homes_Customer_Afc').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Load_Homes_Customer_Afc').error.errorCode}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"ToDateTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_DAC_Payload')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEachLocationIds",
						"description": "Loop through location ids sequentially",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.item_param",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "WebLocationsAPI",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationsAPI').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFile",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationsAPI').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SetErrorMsg",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "ErrorMsg",
										"value": {
											"value": "@activity('WebLocationsAPI').error.message",
											"type": "Expression"
										}
									}
								},
								{
									"name": "WaitTime",
									"type": "Wait",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 3
									}
								},
								{
									"name": "LoggingStoredProcedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('WebLocationsAPI').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "WebLocationAPIFailed",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "WaitTime",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload_AfterFailed",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationAPIFailed').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFileAfterFailed",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationAPIFailed').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"item_param": {
						"type": "array"
					}
				},
				"variables": {
					"FailedActivity": {
						"type": "String"
					},
					"ErrorMsg": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:12Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "OSLocation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLocationID,\r\noslAccountNo,\r\noslShipTo,\r\noslLocationName,\r\noslAddress1,\r\noslAddress2,\r\noslCity,\r\noslState,\r\noslZip,\r\noslCountry,\r\noslCounty,\r\noslPrimaryPhone,\r\noslPrimaryFax,\r\noslPrimaryEmail,\r\noslLatitude,\r\noslLongitude,\r\noslLocationStatus,\r\noslLocationStatusNotes,\r\noslLegacyLocationID,\r\noslWhseShipTo,\r\noslProspectID,\r\noslOwnerType,\r\noslLta,\r\noslDMA,\r\noslMSA,\r\noslCountyFips,\r\noslMarketZone,\r\noslOpAreaZone,\r\noslCurrency,\r\noslLanguage,\r\noslTimeZone,\r\noslGeographicZone,\r\noslStatus,\r\noslStatusNotes,\r\noslLocationType,\r\noslSoftOpenDate,\r\noslGrandOpenDate,\r\noslClosed,\r\noslClosedDate,\r\noslClosedAuthorization,\r\noslRelocated,\r\noslRelocationCloseDate,\r\noslRelocationOpenDate,\r\noslRelocationNotes,\r\noslAcquisition,\r\noslAcquisitionDate,\r\noslAcquisitionNotes,\r\noslPreOpenComments,\r\noslTUAID,\r\noslTUADate,\r\noslTUAExpireDate,\r\noslTUATerm,\r\noslTUADateComplete,\r\noslTurnoverDate,\r\noslRecordChangesFlag,\r\noslOperationsIntroDate,\r\noslMsPipelineDate,\r\noslLicenseeID,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\noslAddress3,\r\noslStoreRefresh,\r\noslStoreRefreshDate,\r\noslStoreRefreshNotes,\r\noslmPlansSubToDesign,\r\noslmPRMeeting,\r\noslmPlansSentToOwnerLic,\r\noslURLRegistration,\r\noslEnterpriseStoreNumber FROM [EDME_DataFactory].OSLocation WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLocation]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLocation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLocation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLocation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLocation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLocation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLocation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLocation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLocation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLocation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLocation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLocation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLocation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT osOneSourceID,\r\nosOneSourceName,\r\nosLegacyLocationID,\r\nosLegacyStoreID,\r\nosProfitCenter,\r\nosChannel,\r\nosActive,\r\nosStoreType,\r\nosSource,\r\nosLocationID,\r\nosStartDate,\r\nosEndDate,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\nosProfitCenterType,\r\nosProfitCenterStatus FROM [EDME_DataFactory].OSOneSource WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OsOneSource]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSOneSource",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OsOneSource",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OsOneSource').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OsOneSource').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OsOneSource').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OsOneSource').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OsOneSource_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OsOneSource').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OsOneSource').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OsOneSource').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OsOneSource').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLicenseeID,\r\noslStoreType,\r\noslLicenseeNotes,\r\noslPrimaryCountry,\r\noslStatus,\r\noslActive,\r\noslActiveDate,\r\noslActiveNotes,\r\noslGuarantors,\r\noslMailingAddress1,\r\noslMailingAddress2,\r\noslMailingCity,\r\noslMailingState,\r\noslMailingZip,\r\noslMailingCountry,\r\noslLegalEntityName,\r\noslLegalEntityAddress1,\r\noslLegalEntityAddress2,\r\noslLegalEntityCity,\r\noslLegalEntityState,\r\noslLegalEntityZip,\r\noslLegalEntityCountry,\r\nusra,\r\ndtea,\r\nusrc,\r\ndetc,\r\noslLicensedTerritory,\r\noslDisclosureDocument,\r\noslMailingAdd FROM [EDME_DataFactory].OSLicensee WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLicensee]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLicensee",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLicensee",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLicensee').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLicensee').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLicensee').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLicensee').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLicensee_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLicensee').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLicensee').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLicensee').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLicensee').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WholesaleCustomersShippingLocations",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT * \nFROM EDME_DataFactory.CustomersShippingLocations",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[WholesaleCustomersShippingLocations]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										},
										"sink": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										}
									},
									{
										"source": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										},
										"sink": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_CustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_WholesaleCustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WholesaleCustomersShippingLocations_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_CustomersShippingLocations",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WholesaleCustomersShippingLocations').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WHolesaleCustomersShippingLocations_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WholesaleCustomersShippingLocations').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CP_EDW_Units_SemStaging",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "load_date",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "DELETE from [EDW].[Units]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AdminDivisionID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "AdminDivisionID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FinancialDivisionID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FinancialDivisionID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CustomerNumber",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 8
										},
										"sink": {
											"name": "CustomerNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "ProfitCenter",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UserAdded",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UserAdded",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DateAdded",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "DateAdded",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProgramAdded",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProgramAdded",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UserChanged",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UserChanged",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DateChanged",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "DateChanged",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProgramChanged",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProgramChanged",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Facility",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "Facility",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RetailChannel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RetailChannel",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "load_date",
											"type": "String"
										},
										"sink": {
											"name": "load_date",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_Datafactory",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "Units",
									"SchemaName": "EDME_DataFactory"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "Units"
								}
							}
						]
					},
					{
						"name": "Units_Success_Logging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Units_Failure",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('CP_EDW_Units_SemStaging').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CP_EDW_Units_SemStaging').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('CP_EDW_Units_SemStaging').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CP_EDW_Units_SemStaging').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Units_Error_logging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('CP_EDW_Units_SemStaging').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CP_LocationCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations_SuccessLogging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "Select OPERATION_ID,Profit_center,Account_Number,SHIP_TO_NUM,TYPE,LocationCode\r\nfrom \r\nRetail.RSA_LocationCode_VW\r\nWITH(NOLOCK)\r\n\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.Location_Code",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_DB_Query",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Location_Code"
								}
							}
						]
					},
					{
						"name": "RSALocations_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Retail.Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDW.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Locationcode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CP_LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('CP_LocationCode').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CP_LocationCode').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('CP_LocationCode').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CP_LocationCode').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Locationcode_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('CP_LocationCode').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('CP_LocationCode').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('CP_LocationCode').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('CP_LocationCode').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "UNITS_IFM_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_IFM_UNITS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Retail.Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDW.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Locationcode_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CP_IFM_UNITS",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('CP_IFM_UNITS').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CP_IFM_UNITS').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('CP_IFM_UNITS').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CP_IFM_UNITS').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "@pipeline().globalParameters.GP_WebhookUrl",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "IFM_UNITS_Copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_IFM_UNITS",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('CP_IFM_UNITS').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_IFM_UNITS').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.IFM_Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CP_IFM_UNITS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSALocations_SuccessLogging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "Select trim(untUnit) as untUnit ,trim(untUnitDesc) as untUnitDesc,trim(untUnitCategory) as untUnitCategory,\r\ntrim(untUnitGroup) as untUnitGroup,trim(untUnitGroupDesc) as untUnitGroupDesc,trim(untDivision) as untDivision,\r\ntrim(untLocation) as untLocation,trim(untUnitType) as untUnitType,trim(untarea) as untarea\r\nfrom [EDME_DataFactory].[IFM_Units] ",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table EDW.IFM_units",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "untUnit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untUnit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untUnitDesc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untUnitDesc",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untUnitCategory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untUnitCategory",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untUnitGroup",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untUnitGroup",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untUnitGroupDesc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untUnitGroupDesc",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untDivision",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untDivision",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untLocation",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untLocation",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untUnitType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untUnitType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "untarea",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "untarea",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "IFM_UNITS_EDW",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "IFM_UNITS"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Mappings')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "StoreMasterCustom_LegalEntities_Mapping",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_companycode_GD_STG",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "createddate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesMapping_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_Mapping",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "Createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LegalEntityID",
										"EntityName",
										"LicContact"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "utcnow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "\n",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location",
										"SiteID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CP_companycode_GD_STG",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select legal_entity_id,Name,LIC_contact,company_code,\r\ngetdate() as created_date from  dbo.gd_legal_entity\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "delete from retail.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"LegalEntityID",
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LIC_contact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "created_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_CompanyCodes"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"LegalEntitiesMapping_FileName": {
						"type": "String",
						"defaultValue": "StoreMasterCustom_LegalEntities_Mapping.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					},
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Mappings_Automate')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_companycode_GD_STG",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "utcnow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "\n",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location",
										"SiteID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Account",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CP_companycode_GD_STG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Sp_LegalEntityID_Assign_Stores",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select SEQUENCE_ID as legal_entity_id,Name,LIC_contact,company_code,\r\ngetdate() as created_date from  dbo.gd_legal_entity\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Delete from Retail.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LIC_contact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "created_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_CompanyCodes"
								}
							}
						]
					},
					{
						"name": "cp_LegalEntityID_GD_Staging",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \nB_PUBID,\nB_SOURCEID,\nName as Entityname,\nSEQUENCE_ID as LegalEntityID,\nLIC_CONTACT as LICCONTACT,\nCOMPANY_CODE as CompanyCode,\nCONVERT(VARCHAR(30), b_credate, 126) as createddate \nfrom  dbo.gd_legal_entity",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Delete from Retail.StoreMasterCustom_LegalEntities_Mapping",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Entityname",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_Mapping"
								}
							}
						]
					},
					{
						"name": "Sp_LegalEntityID_Assign_Stores",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Sp_LegalEntityID_Assign_RDC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Sp_LegalEntityID_Assign_RDC",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "cp_LegalEntityID_GD_Staging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_WH_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		}
	]
}