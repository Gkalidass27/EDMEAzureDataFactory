{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Storis_Integration_ST_Site_DEL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSAStoris_Intgeration_DEL",
						"description": "select all data from SA_Storis_Intgeration view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									},
									{
										"name": "B_CREDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select \nB_sourceid\n,B_PUBID\n,'Site' as B_CLASSNAME\n,UnitNumber as Unit_Number\n,LocationName \n,RETAIL_SYSTEM_NUMBER\n,StoreType as Type\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\nFROM [RsmSiteSubscriber].[site_source_Incremental_activity_V]\nWhere Activity_Type in('Delete')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_sourceid",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "Unit_Number",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UNIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ST_SI_SITE_INC_DEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Storis_Integration_Site",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_storisintegration",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_DEL",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_DEL').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_DEL').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSAStoris_Intgeration_DEL').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_DEL').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_DEL').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_DEL').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_storis_Integration",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_DEL",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSAStoris_Intgeration_DEL').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSAStoris_Intgeration_DEL').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSAStoris_Intgeration_DEL').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSAStoris_Intgeration_DEL').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda/V28E5kP8YZAlzxR47diCA_z54ghZOHwx7-ds0EdE-hZG41",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_storis_Integration_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_DEL",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Storis_Integration_His",
						"description": "select all data from ZipAllocation_INC_V view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_DEL",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n B_sourceid\n,B_PUBID\n,UnitNumber\n,LocationName\n,RETAIL_SYSTEM_NUMBER\n,StoreType\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\n,Activity_Type\n,IsActiveType\nFROM [RsmSiteSubscriber].[site_source_Incremental_activity_V]\nWhere Activity_Type in('Delete')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"UnitNumber"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_sourceid",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_sourceid",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LocationName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ST_SI_SITE_INC_DEL_His",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_site_his_storis_Inte",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Storis_Integration_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Storis_Integration_WH')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "IncrementalSAStoris_Intgeration_WH",
						"description": "select all data from SA_Storis_Intgeration view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SI_WH_SITE_INC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@pipeline().parameters.B_LoadID",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									},
									{
										"name": "B_CREDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select \nB_Sourceid\n,B_PUBID\n,'Site' as B_CLASSNAME\n,StoreType as Type\n,RETAIL_SYSTEM_NUMBER\n,UnitNumber\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\nFROM [RsmSiteSubscriber].[site_source_WH_Incremental_activity_V]\nwhere Activity_Type in('Insert','Update')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UNIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_SI_WH",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Storis_Integration_Site_WH",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_storisintegration",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSAStoris_Intgeration_WH').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_storis_Integration",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSAStoris_Intgeration_WH').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSAStoris_Intgeration_WH').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSAStoris_Intgeration_WH').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSAStoris_Intgeration_WH').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda/V28E5kP8YZAlzxR47diCA_z54ghZOHwx7-ds0EdE-hZG41",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_storis_Integration_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@pipeline().parameters.B_LoadID",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Storis_Integration_His_WH",
						"description": "select all data from ZipAllocation_INC_V view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@pipeline().parameters.B_LoadID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n B_Sourceid\n,B_PUBID\n,StoreType \n,RETAIL_SYSTEM_NUMBER\n,UnitNumber\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\n,Activity_Type\n,IsActiveType\nFROM [RsmSiteSubscriber].[site_source_WH_Incremental_activity_V]\nwhere Activity_Type in('Insert','Update')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_Sourceid"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_SI_WH_sink",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_sit_his_StorisIntegration_WH",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LE_Tracker_storis_integration",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_SI_INC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@pipeline().parameters.B_LoadID",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									},
									{
										"name": "B_CREDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  \nAddress1 as SITE_RAW_ADDR_LINE1\n,State as SITE_RAW_STATE\n,City as SITE_RAW_CITY\n,PostalCodeID as SITE_RAW_POSTAL_CODE\n,StoreID as PRIMARY_PROFIT_CENTER\n,Operation_ID\n,B_PUBID\n,B_SourceID\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\n,Concat(StoreID,'-',upper('Warehouse')) as FS_SITE_ID  \n,B_PubID as FP_SITE_ID\n,'WarehouseLegalEntityTracking' as B_CLASSNAME\nFROM [RsmSiteSubscriber].[WH_LE_Tracker_Incremental_activity_V]\nWhere Activity_Type in('Insert','Update')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SourceID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_StirisIntegration_LE_WH_Tracker",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SD_HS_OPC_TRACKING",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LE_Tracker_storis_integration').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SD_HS_OPC_TRACKING",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LE_Tracker_storis_integration').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LE_Tracker_storis_integration').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LE_Tracker_storis_integration').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LE_Tracker_storis_integration').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SD_HS_OPC_TRACKING_LoadId_Stored_Procedure_",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@pipeline().parameters.B_LoadID",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LE_WH_Tracker_Storis_Integration",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@pipeline().parameters.B_loadid",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\n Address1\n,State\n,City\n,PostalCodeID\n,StoreID\n,Operation_ID\n,B_PUBID\n,B_SourceID\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\n,Activity_Type\n,IsActiveType\nFROM [RsmSiteSubscriber].[WH_LE_Tracker_Incremental_activity_V]\nWhere Activity_Type in('Insert','Update')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"StoreID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Address1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Address1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PostalCodeID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PostalCodeID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SourceID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_hsopc_his_storis_Inte",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_LE_WH_tracker_storiesIntegration",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LE_WH_Tracker_Storis_Integration",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@pipeline().parameters.b_loadId",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SI_WH_SITE_INC",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT [B_Sourceid]\n      ,[B_PUBID]\n      ,[StoreType]\n      ,[RETAIL_SYSTEM_NUMBER]\n      ,[UnitNumber]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n  FROM [RsmSiteSubscriber].[site_source_WH_Incremental]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "Truncate Table RsmSiteSubscriber.site_source_WH_Incremental_activity",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ST_WH_SITE_INC",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_ST_WH_SITE_INC_SINK",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LE_Tracker_SI_INC",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Storis_Integration_His_WH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT [Address1]\n      ,[State]\n      ,[City]\n      ,[PostalCodeID]\n      ,[StoreID]\n      ,[Operation_ID]\n      ,[B_PUBID]\n      ,[B_Sourceid]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n  FROM [RsmSiteSubscriber].[WH_LE_Tracker_Incremental]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "Truncate Table RsmSiteSubscriber.WH_LE_Tracker_Incremental_activity",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Address1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Address1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PostalCodeID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PostalCodeID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_WH_SI_LE_INC",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_WH_SI_LE_INC_SINK",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"B_LoadID": {
						"type": "string",
						"defaultValue": "12345"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Storis_Integration_WH_LE_DEL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "WH_LE_Tracker_storis_integration_Del",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									},
									{
										"name": "B_CREDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  \nAddress1 as SITE_RAW_ADDR_LINE1\n,State as SITE_RAW_STATE\n,City as SITE_RAW_CITY\n,PostalCodeID as SITE_RAW_POSTAL_CODE\n,StoreID as PRIMARY_PROFIT_CENTER\n,Operation_ID\n,B_PUBID\n,B_SourceID\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\n,Concat(StoreID,'-',upper('Warehouse')) as FS_SITE_ID  \n,B_PubID as FP_SITE_ID\n,'WarehouseLegalEntityTracking' as B_CLASSNAME\nFROM [RsmSiteSubscriber].[WH_LE_Tracker_Incremental_activity_V]\nWhere Activity_Type in('Delete')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SourceID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_WH_SI_LE_INC_DEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_StirisIntegration_LE_WH_Tracker",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SD_HS_OPC_TRACKING",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration_Del",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration_Del').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration_Del').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LE_Tracker_storis_integration_Del').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration_Del').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration_Del').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LE_Tracker_storis_integration_Del').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SD_HS_OPC_TRACKING",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration_Del",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LE_Tracker_storis_integration_Del').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LE_Tracker_storis_integration_Del').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LE_Tracker_storis_integration_Del').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LE_Tracker_storis_integration_Del').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LE_WH_Tracker_Storis_Integration",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration_Del",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\n Address1\n,State\n,City\n,PostalCodeID\n,StoreID\n,Operation_ID\n,B_PUBID\n,B_SourceID\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\n,Activity_Type\n,IsActiveType\nFROM [RsmSiteSubscriber].[WH_LE_Tracker_Incremental_activity_V]\nWhere Activity_Type in('Delete')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"StoreID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Address1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Address1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PostalCodeID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PostalCodeID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Operation_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SourceID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_hsopc_his_storis_Inte",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_LE_WH_tracker_storiesIntegration",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LE_WH_Tracker_Storis_Integration",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Cancel_storis_Integration_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LE_Tracker_storis_integration_Del",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:13Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Storis_Intgeration_WH_SITE_DEL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSAStoris_Intgeration_WH_DEL",
						"description": "select all data from SA_Storis_Intgeration view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									},
									{
										"name": "B_CREDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select \nB_Sourceid\n,B_PUBID\n,'Site' as B_CLASSNAME\n,StoreType as Type\n,RETAIL_SYSTEM_NUMBER\n,UnitNumber\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\nFROM [RsmSiteSubscriber].[site_source_WH_Incremental_activity_V]\nwhere Activity_Type in('Delete')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UNIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ST_WH_SITE_INC_DEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Storis_Integration_Site_WH",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_storisintegration",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH_DEL",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH_DEL').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH_DEL').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSAStoris_Intgeration_WH_DEL').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH_DEL').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH_DEL').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSAStoris_Intgeration_WH_DEL').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_storis_Integration",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH_DEL",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSAStoris_Intgeration_WH_DEL').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSAStoris_Intgeration_WH_DEL').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSAStoris_Intgeration_WH_DEL').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSAStoris_Intgeration_WH_DEL').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda/V28E5kP8YZAlzxR47diCA_z54ghZOHwx7-ds0EdE-hZG41",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Storis_Integration_His_WH",
						"description": "select all data from ZipAllocation_INC_V view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH_DEL",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n B_Sourceid\n,B_PUBID\n,StoreType \n,RETAIL_SYSTEM_NUMBER\n,UnitNumber\n,B_DELETETYPE\n,B_DELETEDATE\n,B_DELETEAUTHOR\n,B_DELETEOPERATION\n,Activity_Type\n,IsActiveType\nFROM [RsmSiteSubscriber].[site_source_WH_Incremental_activity_V]\nwhere Activity_Type in('Delete')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_Sourceid"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_Sourceid",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "StoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UnitNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ST_WH_SITE_INC_DEL_His",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_sit_his_StorisIntegration_WH",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cancel_storis_Integration_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAStoris_Intgeration_WH_DEL",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Storis_Integration_His_WH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:12Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_Retail_Corporate_Store_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Source to Target",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n    S.RecStatus AS STORESTATUS,\n    S.StoreID,\n    S.Name AS STORISName,\n    S.SourceID,\n    S.locnType,\n    S.RegionID,\n    S.Address1,\n    S.City,\n    S.State,\n    S.Distribution_StoreID,\n    S.DateCreated,\n    S.DateChanged \nFROM EDW.Store_temp S",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.EDW_RETAIL_CORPORATE_Store",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "Store_temp"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "EDW_RETAIL_CORPORATE_Store"
								}
							}
						]
					},
					{
						"name": "Process Changes",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy Source to Target",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "EDW.sp_Store_CDC_Process_Unified"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Change Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Process Changes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n    ISNULL(SUM(CASE WHEN ChangeType = 'INSERT' THEN 1 ELSE 0 END), 0) as InsertCount,\n    ISNULL(SUM(CASE WHEN ChangeType = 'UPDATE' THEN 1 ELSE 0 END), 0) as UpdateCount,\n    ISNULL(COUNT(*), 0) as TotalChanges\nFROM EDW.EDW_RETAIL_CORPORATE_Store_Log \nWHERE ProcessDate = CAST(GETDATE() AS DATE)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "EDW_RETAIL_CORPORATE_Store_Log"
								}
							}
						}
					},
					{
						"name": "Send Notification If Changes",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get Change Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Get Change Count').output.firstRow.TotalChanges, 0)",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Teams_Notification",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@pipeline().TriggerTime",
												"type": "Expression"
											},
											"status": "Success",
											"message": {
												"value": "@concat('Store CDC: ', activity('Get Change Count').output.firstRow.InsertCount, ' new stores, ', activity('Get Change Count').output.firstRow.UpdateCount, ' updated stores')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@string(div(sub(ticks(utcnow()), ticks(pipeline().TriggerTime)), 10000000))",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "@pipeline().globalParameters.GP_WebhookUrl",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:01:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_Retail_Corporate_Store_Incremental_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Source to Target",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT S.RecStatus AS STORESTATUS, S.StoreID, S.Name AS STORISName, S.SourceID, S.locnType, S.RegionID, S.Address1, S.City, S.State, S.Distribution_StoreID, S.DateCreated, S.DateChanged \r\nFROM EDME_DataFactory.Store S\r\nwhere S.RecStatus in ('U','N')\r\n/*\r\nA: means active once, used in the past to transafer store ID from character to 3 digits.\r\nU: means currently used ( might include some re-active closed stores.)\r\nD: No longer in use-deleted, maybe mistakenly entered,\r\nS: suspended? A lot of junk orders are saved here.\r\nN: A step preparation before turns to U.\r\n*/",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table EDW.EDW_RETAIL_CORPORATE_Store",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ASHLEY_EDW_EDME",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDME_DataFactory",
									"TableName": "Store"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "EDW_RETAIL_CORPORATE_Store"
								}
							}
						]
					},
					{
						"name": "Process Changes",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy Source to Target",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "EDW.sp_Store_CDC_Process_Unified"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Change Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Process Changes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT ISNULL(SUM(CASE WHEN ChangeType='INSERT' THEN 1 ELSE 0 END),0) AS InsertCount,\r\n ISNULL(SUM(CASE WHEN ChangeType='UPDATE' THEN 1 ELSE 0 END),0) AS UpdateCount,\r\n ISNULL(SUM(CASE WHEN ChangeType='DELETE' THEN 1 ELSE 0 END),0) AS DeleteCount,\r\n  ISNULL(COUNT(*),0) AS TotalChanges \r\n  FROM EDW.EDW_RETAIL_CORPORATE_Store_Log \r\n  WHERE Rundate = CAST(GETDATE() AS DATE)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "EDW_RETAIL_CORPORATE_Store_Log"
								}
							}
						}
					},
					{
						"name": "Get Latest Change Details",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Change Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \r\n    StoreID, \r\n    ChangeType, \r\n    FORMAT(ProcessDate, 'yyyy-MM-dd HH:mm:ss') AS ProcessDate,\r\n    ChangeDetails \r\nFROM EDW.EDW_RETAIL_CORPORATE_Store_Log \r\nWHERE RunDate = CAST(GETDATE() AS DATE) \r\nORDER BY RunDate DESC, ChangeType DESC, StoreID DESC\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "EDW_RETAIL_CORPORATE_Store_Log"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Send Notification If Changes",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get Latest Change Details",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Get Change Count').output.firstRow.TotalChanges, 0)",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Teams_Notification",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@pipeline().TriggerTime",
												"type": "Expression"
											},
											"status": "Success",
											"message": {
												"value": "@concat('Store CDC: ', activity('Get Change Count').output.firstRow.InsertCount, ' new stores, ', activity('Get Change Count').output.firstRow.UpdateCount, ' updated stores')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@string(div(sub(ticks(utcnow()), ticks(pipeline().TriggerTime)), 10000000))",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "@pipeline().globalParameters.GP_WebhookUrl",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Email_Notification",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Email_LogicApp_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"dataFactoryName": {
												"value": "@pipeline().DataFactory",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"status": "Success",
											"triggerTime": {
												"value": "@formatDateTime(pipeline().TriggerTime, 'yyyy-MM-dd HH:mm:ss')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@formatDateTime(utcnow(), 'yyyy-MM-dd HH:mm:ss')",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@string(div(sub(ticks(utcnow()), ticks(pipeline().TriggerTime)), 10000000))",
												"type": "Expression"
											},
											"message": {
												"value": "@concat('Store CDC: ', activity('Get Change Count').output.firstRow.InsertCount, ' new stores, ', activity('Get Change Count').output.firstRow.UpdateCount, ' updated stores,', activity('Get Change Count').output.firstRow.DeleteCount, ' Deleted stores')",
												"type": "Expression"
											},
											"notificationTime": {
												"value": "@formatDateTime(utcnow(), 'yyyy-MM-dd HH:mm:ss')",
												"type": "Expression"
											},
											"to": {
												"value": "@pipeline().globalParameters.DL_LIst",
												"type": "Expression"
											},
											"subject": {
												"value": "@concat('Pipeline execution alert  ', 'Stores Updates from EDW')",
												"type": "Expression"
											},
											"rows": {
												"value": "@activity('Get Latest Change Details').output.value",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:01:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_Retail_Corporate_Store_Incremental_EDW_bkp')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Source to Target",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT\r\n    S.RecStatus AS STORESTATUS,\r\n    S.StoreID,\r\n    S.Name AS STORISName,\r\n   -- Unit.UntUnitDesc AS FinanceUnitDesc,\r\n    S.SourceID,\r\n    S.locnType,\r\n    S.RegionID,\r\n    S.Address1,\r\n    S.City,\r\n    S.State,\r\n    S.Distribution_StoreID,\r\n    S.DateCreated,\r\n    S.DateChanged \r\nFROM EDME_DataFactory.Store S",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"StoreID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ASHLEY_EDW_EDME",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDME_DataFactory",
									"TableName": "Store"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "EDW_RETAIL_CORPORATE_Store"
								}
							}
						]
					},
					{
						"name": "Process Changes",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy Source to Target",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "EDW.sp_Store_CDC_Process_Unified"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Change Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Process Changes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n    ISNULL(SUM(CASE WHEN ChangeType = 'INSERT' THEN 1 ELSE 0 END), 0) as InsertCount,\n    ISNULL(SUM(CASE WHEN ChangeType = 'UPDATE' THEN 1 ELSE 0 END), 0) as UpdateCount,\n    ISNULL(COUNT(*), 0) as TotalChanges\nFROM EDW.EDW_RETAIL_CORPORATE_Store_Log \nWHERE ProcessDate = CAST(GETDATE() AS DATE)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "EDW_RETAIL_CORPORATE_Store_Log"
								}
							}
						}
					},
					{
						"name": "Send Notification If Changes",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get Change Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Get Change Count').output.firstRow.TotalChanges, 0)",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Teams_Notification",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@pipeline().TriggerTime",
												"type": "Expression"
											},
											"status": "Success",
											"message": {
												"value": "@concat('Store CDC: ', activity('Get Change Count').output.firstRow.InsertCount, ' new stores, ', activity('Get Change Count').output.firstRow.UpdateCount, ' updated stores')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@string(div(sub(ticks(utcnow()), ticks(pipeline().TriggerTime)), 10000000))",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "@pipeline().globalParameters.GP_WebhookUrl",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:01:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_Load_Retail_LegalEntityLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SiteLegalEntityOWNER",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteLegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "Loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_SOURCEID,\nB_PUBID,\nB_CREDATE,\nOWNER_FIRST_NAME,\nOWNER_LAST_NAME,\nRAW_OWNER_PHONE,\nRAW_CONTACT_EMAIL,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY_OWNER WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteLegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT SITE_LEGAL_ENTITY_ID,\nB_PUBID,\nB_CLASSNAME,\nB_CREDATE,\nSITE_LEGAL_ENTITY_NAME,\nRAW_SITE_ADDRESS_LINE1,\nRAW_SITE_ADDRESS_LINE2,\nRAW_SITE_CITY,\nRAW_SITE_STATE_CODE,\nRAW_SITE_POSTAL_CODE,\nRAW_SITE_COUNTRY_CODE,\nSITE_LEGAL_ENTITY_TYPE,\nF_SITE_LEGAL_ENTITY,\nFD_SITE_LEGAL_ENTITY,\nROW_NUMBER() OVER (PARTITION BY SITE_LEGAL_ENTITY_ID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'LegalEntityLoad'\r\n,@P_LOAD_DESCRIPTION = 'LegalEntityLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteLegalEntityOWNER",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "LegalEntityLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:16Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_Load_Retail_SiteMasterLoad_DAC_initialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteMainView",
						"description": "select all data from DACJSONLoadSiteMain view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT \nB_CLASSNAME,\nB_PUBID,\nB_SOURCEID,\nB_CREDATE,\nSITE_NAME,\nSITE_TYPE,\nISACTIVE,\nSITE_DESCRIPTION,\nSITE_OWNERSHIP_TYPE,\nADDRESS_STATUS_CODE,\nADDRESS_ERROR_CODE,\nRAWADDRESS_LINE1,\nRAWADDRESS_LINE2,\nRAWCITY,\nRAWSTATE_CODE,\nRAWPOSTAL_CODE,\nRAWCOUNTRY_CODE,\nSTASTREET_NAME,\nSTASTREET_NUMBER,\nSTACITY,\nSTASTATE_CODE,\nSTAPOSTAL_CODE,\nSTACOUNTRY_CODE,\nSTALATITUDE,\nSTALONGITUDE,\nOPERATIONS_START_DATE,\nOPERATIONS_END_DATE,\nCUSTOMER_OPEN_DATE,\nCUSTOMER_CLOSE_DATE,\nLOCAL_CURRENCY_CODE,\nLOCAL_UNIT_OF_MEASURE_ARE,\nTOTAL_SITE_AREA,\nOPERATIONS_SITE_AREA,\nCUSTOMER_SITE_AREA,\nSITE_SHIP_TO,\nRAW_MAIN_PHONE,\nSTD_MAIN_PHONE,\nMAIN_PHONE_STATUS_CODE,\nRAW_FAX,\nSTD_FAX,\nFAX_STATUS_CODE,\nRAW_CS_PHONE,\nSTD_CS_PHONE,\nCS_PHONE_STATUS_CODE,\nRAW_CS_EMAIL,\nVLD_CS_EMAIL,\nRAW_SALES_PHONE,\nSTD_SALES_PHONE,\nSALES_PHONE_STATUS_CODE,\nRAW_SALES_CHAT,\nRAW_SERVICE_PHONE,\nSTD_SERVICE_PHONE,\nSERVICE_PHONE_STATUS_CODE,\nRAW_SERVICE_CHAT,\nFP_WAREHOUSE_PARENT,\nFS_WAREHOUSE_PARENT,\nLICENSED_TERRITORY,\nDISTRICT_MANAGER,\nSTORE_MODEL,\nTUA_EXPIRATION_DATE,\nF_SITE_LEGAL_ENTITY,\nSTORE_PROSPECT_ID,\nNUMBER_OF_DOCK_DOORS,\nPRIMARY_PROFIT_CENTER,\nRETAIL_SYSTEMS_NUMBER,\nGOOGLE_ID,\nLEGACY_STORE_NUMBER,\nLEGACY_ERP_DATABASE_NAME,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\r\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nCONTENT_CATEGORY,\nCONTENT_TYPE,\nCONTENT_SHORT_TEXT,\nCONTENT_LONG_TEXT,\nCONTENT_LANGUAGE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CONTENT_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CONTENT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CONTENT WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"CONTENT_TYPE"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nDAY_OF_WEEK,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_DEFAULT_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_DEFAULT_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_DEFAULT_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"SITE_HOURS_TYPE",
										"DAY_OF_WEEK"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteProgramView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteCustomeHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nCUSTOM_HOURS_REASON,\nSITE_DATE,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CUSTOM_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CUSTOM_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CUSTOM_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Custome_Hours",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteProgramView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteCustomeHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nPROGRAM_NAME,\nPROGRAM_START_DATE,\nPROGRAM_END_DATE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_PROGRAM_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_PROGRAM_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_PROGRAM WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Site_Program",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:16Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_old_Load_Retail_LegalEntityLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SiteLegalEntityOWNER",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteLegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "Loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_SOURCEID,\nB_PUBID,\nB_CREDATE,\nOWNER_FIRST_NAME,\nOWNER_LAST_NAME,\nRAW_OWNER_PHONE,\nRAW_CONTACT_EMAIL,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY_OWNER WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteLegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT SITE_LEGAL_ENTITY_ID,\nB_PUBID,\nB_CLASSNAME,\nB_CREDATE,\nSITE_LEGAL_ENTITY_NAME,\nRAW_SITE_ADDRESS_LINE1,\nRAW_SITE_ADDRESS_LINE2,\nRAW_SITE_CITY,\nRAW_SITE_STATE_CODE,\nRAW_SITE_POSTAL_CODE,\nRAW_SITE_COUNTRY_CODE,\nSITE_LEGAL_ENTITY_TYPE,\nF_SITE_LEGAL_ENTITY,\nFD_SITE_LEGAL_ENTITY,\nROW_NUMBER() OVER (PARTITION BY SITE_LEGAL_ENTITY_ID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'LegalEntityLoad'\r\n,@P_LOAD_DESCRIPTION = 'LegalEntityLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteLegalEntityOWNER",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "LegalEntityLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:16Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_old_Load_Retail_SiteMasterLoad_DAC_initialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteMainView",
						"description": "select all data from DACJSONLoadSiteMain view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT \nB_CLASSNAME,\nB_PUBID,\nB_SOURCEID,\nB_CREDATE,\nSITE_NAME,\nSITE_TYPE,\nISACTIVE,\nSITE_DESCRIPTION,\nSITE_OWNERSHIP_TYPE,\nADDRESS_STATUS_CODE,\nADDRESS_ERROR_CODE,\nRAWADDRESS_LINE1,\nRAWADDRESS_LINE2,\nRAWCITY,\nRAWSTATE_CODE,\nRAWPOSTAL_CODE,\nRAWCOUNTRY_CODE,\nSTASTREET_NAME,\nSTASTREET_NUMBER,\nSTACITY,\nSTASTATE_CODE,\nSTAPOSTAL_CODE,\nSTACOUNTRY_CODE,\nSTALATITUDE,\nSTALONGITUDE,\nOPERATIONS_START_DATE,\nOPERATIONS_END_DATE,\nCUSTOMER_OPEN_DATE,\nCUSTOMER_CLOSE_DATE,\nLOCAL_CURRENCY_CODE,\nLOCAL_UNIT_OF_MEASURE_ARE,\nTOTAL_SITE_AREA,\nOPERATIONS_SITE_AREA,\nCUSTOMER_SITE_AREA,\nSITE_SHIP_TO,\nRAW_MAIN_PHONE,\nSTD_MAIN_PHONE,\nMAIN_PHONE_STATUS_CODE,\nRAW_FAX,\nSTD_FAX,\nFAX_STATUS_CODE,\nRAW_CS_PHONE,\nSTD_CS_PHONE,\nCS_PHONE_STATUS_CODE,\nRAW_CS_EMAIL,\nVLD_CS_EMAIL,\nRAW_SALES_PHONE,\nSTD_SALES_PHONE,\nSALES_PHONE_STATUS_CODE,\nRAW_SALES_CHAT,\nRAW_SERVICE_PHONE,\nSTD_SERVICE_PHONE,\nSERVICE_PHONE_STATUS_CODE,\nRAW_SERVICE_CHAT,\nFP_WAREHOUSE_PARENT,\nFS_WAREHOUSE_PARENT,\nLICENSED_TERRITORY,\nDISTRICT_MANAGER,\nSTORE_MODEL,\nTUA_EXPIRATION_DATE,\nF_SITE_LEGAL_ENTITY,\nSTORE_PROSPECT_ID,\nNUMBER_OF_DOCK_DOORS,\nPRIMARY_PROFIT_CENTER,\nRETAIL_SYSTEMS_NUMBER,\nGOOGLE_ID,\nLEGACY_STORE_NUMBER,\nLEGACY_ERP_DATABASE_NAME,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\r\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nCONTENT_CATEGORY,\nCONTENT_TYPE,\nCONTENT_SHORT_TEXT,\nCONTENT_LONG_TEXT,\nCONTENT_LANGUAGE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CONTENT_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CONTENT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CONTENT WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"CONTENT_TYPE"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nDAY_OF_WEEK,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_DEFAULT_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_DEFAULT_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_DEFAULT_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"SITE_HOURS_TYPE",
										"DAY_OF_WEEK"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteProgramView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteCustomeHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nCUSTOM_HOURS_REASON,\nSITE_DATE,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CUSTOM_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CUSTOM_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CUSTOM_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Custome_Hours",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteProgramView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteCustomeHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nPROGRAM_NAME,\nPROGRAM_START_DATE,\nPROGRAM_END_DATE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_PROGRAM_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_PROGRAM_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_PROGRAM WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Site_Program",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:16Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/RealEstate_File')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Real_Estate_SFTP_Prod",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Filename": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "SftpLocation",
						"fileName": {
							"value": "@dataset().Filename",
							"type": "Expression"
						},
						"folderPath": "/LeaseHarbor"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Real_estate_source_folder')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Real_Estate_SFTP_Prod",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FolderName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "SftpLocation",
						"fileName": "*.xlsx",
						"folderPath": {
							"value": "LeaseHarbor",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Realestate_SFTP_Archive_path')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Real_Estate_SFTP_Prod",
					"type": "LinkedServiceReference",
					"parameters": {}
				},
				"parameters": {
					"SFTP_HostName": {
						"type": "string"
					},
					"SFTP_PortNumber": {
						"type": "string"
					},
					"SFTP_Uname": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "SftpLocation",
						"fileName": {
							"value": "@concat('Record Search - Data Export - Record Info _ Contact Details_', formatDateTime(utcnow(), 'yyyyMMdd_HHmmss'), '.xlsx')",
							"type": "Expression"
						},
						"folderPath": "/archive"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SFTP_XLSX_File')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Real_Estate_SFTP_Prod",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FolderName": {
						"type": "string"
					},
					"FileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "SftpLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "/LeaseHarbor"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF_Stage_SiteMaster_RDC_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This Dataflow loads RDC info to Semarchy staging",
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_Smartsheets",
								"type": "LinkedServiceReference"
							},
							"name": "SRCSMARTSHEET",
							"description": "Smartsheet data-RDCMasterlist"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DS_SEM_STG_Smartsheet",
								"type": "DatasetReference"
							},
							"name": "RDCMasterlist",
							"rejectedDataLinkedService": {
								"referenceName": "masterDataHubStg",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Status as string,",
						"          Location as string,",
						"          {Bindy ID} as string,",
						"          {Account #} as string,",
						"          {RDC Ship To} as string,",
						"          Entity as string,",
						"          {Licensee / Contact} as string,",
						"          {RDC Address} as string,",
						"          {RDC City} as string,",
						"          {RDC State} as string,",
						"          {RDC Zip} as string,",
						"          {RDC Country} as string,",
						"          {RDC Sq. Ft.} as string,",
						"          {RDC Dock Doors} as string,",
						"          {Is Ecom Fulfiller} as string,",
						"          {Acquisition Date} as string,",
						"          {Modified Date} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'smartsheet',",
						"     format: 'rest',",
						"     entityId: '7848339512971140',",
						"     entityType: 'sheets') ~> SRCSMARTSHEET",
						"SRCSMARTSHEET select(mapColumn(",
						"          Status,",
						"          Location,",
						"          BindyID = {Bindy ID},",
						"          Account = {Account #},",
						"          ShipTo = {RDC Ship To},",
						"          Entity,",
						"          LicenseeContact = {Licensee / Contact},",
						"          Address = {RDC Address},",
						"          City = {RDC City},",
						"          State = {RDC State},",
						"          Zip = {RDC Zip},",
						"          Country = {RDC Country},",
						"          WarehouseSqFt = {RDC Sq. Ft.},",
						"          WarehouseDockDoors = {RDC Dock Doors},",
						"          IsEcomFulfiller = {Is Ecom Fulfiller},",
						"          AcquisitionDate = {Acquisition Date},",
						"          ModifiedDate = {Modified Date}",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Status as string,",
						"          Location as string,",
						"          BindyID as string,",
						"          Account as integer,",
						"          ShipTo as string,",
						"          Entity as string,",
						"          LicenseeContact as string,",
						"          Address as string,",
						"          City as string,",
						"          State as string,",
						"          Zip as string,",
						"          Country as string,",
						"          WarehouseSqFt as integer,",
						"          WarehouseDockDoors as integer,",
						"          IsEcomFulfiller as string,",
						"          AcquisitionDate as date,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['Delete from Smartsheet.RDCMasterlist'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     outputRejectedData: true,",
						"     outputAssertFailedRows: true,",
						"     assertFailure_fileSystem: 'Error',",
						"     assertFailure_folderPath: 'RDC',",
						"     mapColumn(",
						"          Status,",
						"          Location,",
						"          BindyID,",
						"          Account,",
						"          ShipTo,",
						"          Entity,",
						"          LicenseeContact,",
						"          Address,",
						"          City,",
						"          State,",
						"          Zip,",
						"          Country,",
						"          WarehouseSqFt,",
						"          WarehouseDockDoors,",
						"          IsEcomFulfiller,",
						"          AcquisitionDate,",
						"          ModifiedDate",
						"     )) ~> RDCMasterlist"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF_Stage_SiteMaster_Store_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This Dataflow loads RDC info to Semarchy staging",
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "Smartsheet_Storemasterlist",
								"type": "LinkedServiceReference"
							},
							"name": "SRCStoremasterlist"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DS_StoreMasterlist",
								"type": "DatasetReference"
							},
							"name": "sink",
							"rejectedDataLinkedService": {
								"referenceName": "masterDataHubStg",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "select"
						},
						{
							"name": "derivedColumn"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Status as string,",
						"          LocationKey as string,",
						"          {Prospect ID} as string,",
						"          {Google ID} as string,",
						"          {Bindy ID} as string,",
						"          StoreID as string,",
						"          ProfitCenter as string,",
						"          Location as string,",
						"          Country as string,",
						"          {Account #} as string,",
						"          {Store Front Ship-To} as string,",
						"          Entity as string,",
						"          {Licensee / Contact} as string,",
						"          {Soft Open Date} as string,",
						"          {Acquisition Date} as string,",
						"          {Closure Date} as string,",
						"          ShopperTrakLocID as string,",
						"          {Store Address} as string,",
						"          City as string,",
						"          {State / Province} as string,",
						"          ZIP as string,",
						"          {DMA ID} as string,",
						"          {DMA Region} as string,",
						"          {Showroom Sq. Ft.} as string,",
						"          {Store Type} as string,",
						"          {Store Model} as string,",
						"          {Store Version} as string,",
						"          Market as string,",
						"          Region as string,",
						"          {Building Ownership} as string,",
						"          {Country Category} as string,",
						"          {Domestic Category} as string,",
						"          Classification as string,",
						"          {Store Phone} as string,",
						"          {District Manager} as string,",
						"          {Secondary Support} as string,",
						"          {BD Director} as string,",
						"          {Licensee Marketing Manager} as string,",
						"          {Licensee Sales Field Manager} as string,",
						"          {Licensee Email} as string,",
						"          {Licensee Phone #} as string,",
						"          IMS as string,",
						"          {Corporation Address} as string,",
						"          {Corp City} as string,",
						"          {Corp State} as string,",
						"          {Corp Zip} as string,",
						"          {RDC Address} as string,",
						"          {RDC City} as string,",
						"          {RDC State} as string,",
						"          {RDC Zip} as string,",
						"          {RDC Ship To} as string,",
						"          {RDC Sq. Ft.} as string,",
						"          {RDC Dock Doors} as string,",
						"          {TUA Expiration Date} as string,",
						"          {Licensed Territory} as string,",
						"          Latitude as string,",
						"          Longitude as string,",
						"          Notes as string,",
						"          {Store Email} as string,",
						"          {Unit #} as string,",
						"          {OneSource ID} as string,",
						"          {HS Database Name} as string,",
						"          SVP as string,",
						"          VP as string,",
						"          {Sr. RD} as string,",
						"          RD as string,",
						"          {Store Manager} as string,",
						"          {Store Mgr. Phone} as string,",
						"          {Sales Manager (1)} as string,",
						"          {Sales Manager (2)} as string,",
						"          {Sales Manager (3)} as string,",
						"          {Sales Manager (4)} as string,",
						"          {Office Manager} as string,",
						"          {Director of Ops} as string,",
						"          {Regional Ops Mgr} as string,",
						"          {Ops Mgr} as string,",
						"          {Comp Status} as string,",
						"          {Kit #} as string,",
						"          {Traffic Divisor} as string,",
						"          ERP as string,",
						"          {DTC Technology} as string,",
						"          {DTC Brand} as string,",
						"          {Forum ID} as string,",
						"          {Account Type} as string,",
						"          {Facade Current Image} as string,",
						"          {Website Facade Current} as string,",
						"          {Store Manager Image} as string,",
						"          {Enterprise Facade Image} as string,",
						"          {Lease Terms} as string,",
						"          {Modified Date} as string,",
						"          {DAC ID} as string,",
						"          {Status Reports} as string,",
						"          {Model Counts} as string,",
						"          {Credit Analyst} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'smartsheet',",
						"     format: 'rest',",
						"     entityId: '4179009966761860',",
						"     entityType: 'sheets') ~> SRCStoremasterlist",
						"SRCStoremasterlist select(mapColumn(",
						"          Status,",
						"          LocationKey,",
						"          ProspectID = {Prospect ID},",
						"          GoogleID = {Google ID},",
						"          BindyID = {Bindy ID},",
						"          StoreID,",
						"          ProfitCenter,",
						"          Location,",
						"          Country,",
						"          Account = {Account #},",
						"          StoreFrontShipTo = {Store Front Ship-To},",
						"          Entity,",
						"          LicenseeContact = {Licensee / Contact},",
						"          SoftOpenDate = {Soft Open Date},",
						"          AcquisitionDate = {Acquisition Date},",
						"          ClosureDate = {Closure Date},",
						"          ShopperTrakLocID,",
						"          StoreAddress = {Store Address},",
						"          City,",
						"          StateProvince = {State / Province},",
						"          ZIP,",
						"          DMAID = {DMA ID},",
						"          DMARegion = {DMA Region},",
						"          ShowroomSqFt = {Showroom Sq. Ft.},",
						"          StoreType = {Store Type},",
						"          StoreModel = {Store Model},",
						"          StoreVersion = {Store Version},",
						"          Market,",
						"          Region,",
						"          BuildingOwnership = {Building Ownership},",
						"          CountryCategory = {Country Category},",
						"          DomesticCategory = {Domestic Category},",
						"          Classification,",
						"          StorePhone = {Store Phone},",
						"          DistrictManager = {District Manager},",
						"          BDDirector = {BD Director},",
						"          LicenseeMarketingManager = {Licensee Marketing Manager},",
						"          LicenseeEmail = {Licensee Email},",
						"          LicenseePhone = {Licensee Phone #},",
						"          IMS,",
						"          CorporationAddress = {Corporation Address},",
						"          CorpCity = {Corp City},",
						"          CorpState = {Corp State},",
						"          CorpZip = {Corp Zip},",
						"          RDCAddress = {RDC Address},",
						"          RDCCity = {RDC City},",
						"          RDCState = {RDC State},",
						"          RDCZip = {RDC Zip},",
						"          RDCShipTo = {RDC Ship To},",
						"          RDCSqFt = {RDC Sq. Ft.},",
						"          RDCDockDoors = {RDC Dock Doors},",
						"          TUAExpirationDate = {TUA Expiration Date},",
						"          LicensedTerritory = {Licensed Territory},",
						"          Latitude,",
						"          Longitude,",
						"          Notes,",
						"          StoreEmail = {Store Email},",
						"          Unit = {Unit #},",
						"          OneSourceID = {OneSource ID},",
						"          HSDatabaseName = {HS Database Name},",
						"          SVP,",
						"          VP,",
						"          SrRD = {Sr. RD},",
						"          RD,",
						"          StoreManager = {Store Manager},",
						"          StoreMgrPhone = {Store Mgr. Phone},",
						"          SalesManager1 = {Sales Manager (1)},",
						"          SalesManager2 = {Sales Manager (2)},",
						"          SalesManager3 = {Sales Manager (3)},",
						"          SalesManager4 = {Sales Manager (4)},",
						"          OfficeManager = {Office Manager},",
						"          DirectorOfOps = {Director of Ops},",
						"          RegionalOpsMgr = {Regional Ops Mgr},",
						"          OpsMgr = {Ops Mgr},",
						"          CompStatus = {Comp Status},",
						"          Kit = {Kit #},",
						"          TrafficDivisor = {Traffic Divisor},",
						"          ERP,",
						"          DTCTechnology = {DTC Technology},",
						"          DTCBrand = {DTC Brand},",
						"          ForumID = {Forum ID},",
						"          AccountType = {Account Type},",
						"          FacadeCurrentImage = {Facade Current Image},",
						"          WebsiteFacadeCurrent = {Website Facade Current},",
						"          StoreManagerImage = {Store Manager Image},",
						"          EnterpriseFacadeImage = {Enterprise Facade Image},",
						"          LicenseeSalesFieldManager = {Licensee Sales Field Manager},",
						"          DACID = {DAC ID},",
						"          LeaseTerms = {Lease Terms},",
						"          ModifiedDate = {Modified Date},",
						"          StatusReports = {Status Reports},",
						"          ModelCounts = {Model Counts}",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> select",
						"select derive(Comments = 'STORESMARTSHEET') ~> derivedColumn",
						"derivedColumn sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Status as string,",
						"          LocationKey as string,",
						"          ProspectID as string,",
						"          GoogleID as string,",
						"          BindyID as string,",
						"          StoreID as string,",
						"          ProfitCenter as string,",
						"          Location as string,",
						"          Country as string,",
						"          Account as string,",
						"          StoreFrontShipTo as string,",
						"          Entity as string,",
						"          LicenseeContact as string,",
						"          SoftOpenDate as date,",
						"          AcquisitionDate as date,",
						"          ClosureDate as date,",
						"          ShopperTrakLocID as string,",
						"          StoreAddress as string,",
						"          City as string,",
						"          StateProvince as string,",
						"          ZIP as string,",
						"          DMAID as string,",
						"          DMARegion as string,",
						"          ShowroomSqFt as string,",
						"          StoreType as string,",
						"          StoreModel as string,",
						"          StoreVersion as string,",
						"          Market as string,",
						"          Region as string,",
						"          BuildingOwnership as string,",
						"          CountryCategory as string,",
						"          DomesticCategory as string,",
						"          Classification as string,",
						"          StorePhone as string,",
						"          DistrictManager as string,",
						"          BDDirector as string,",
						"          LicenseeEmail as string,",
						"          LicenseePhone as string,",
						"          CorporationAddress as string,",
						"          CorpCity as string,",
						"          CorpState as string,",
						"          CorpZip as string,",
						"          RDCAddress as string,",
						"          RDCCity as string,",
						"          RDCState as string,",
						"          RDCZip as string,",
						"          RDCShipTo as string,",
						"          RDCSqFt as string,",
						"          RDCDockDoors as string,",
						"          TUAExpirationDate as date,",
						"          LicensedTerritory as string,",
						"          Latitude as string,",
						"          Longitude as string,",
						"          Notes as string,",
						"          StoreEmail as string,",
						"          Unit as string,",
						"          OneSourceID as string,",
						"          HSDatabaseName as string,",
						"          SVP as string,",
						"          VP as string,",
						"          SrRD as string,",
						"          RD as string,",
						"          StoreManager as string,",
						"          StoreMgrPhone as string,",
						"          SalesManager1 as string,",
						"          SalesManager2 as string,",
						"          SalesManager3 as string,",
						"          SalesManager4 as string,",
						"          OfficeManager as string,",
						"          DirectorOfOps as string,",
						"          RegionalOpsMgr as string,",
						"          OpsMgr as string,",
						"          CompStatus as string,",
						"          Kit as string,",
						"          TrafficDivisor as string,",
						"          ERP as string,",
						"          DTCTechnology as string,",
						"          DTCBrand as string,",
						"          ForumID as string,",
						"          AccountType as string,",
						"          FacadeCurrentImage as string,",
						"          WebsiteFacadeCurrent as string,",
						"          StoreManagerImage as string,",
						"          EnterpriseFacadeImage as string,",
						"          LicenseeSalesDistrict as string,",
						"          LicenseeSalesRegion as string,",
						"          ModifiedDate as date,",
						"          LicenseeMarketingManager as string,",
						"          IMS as string,",
						"          LeaseTerms as string,",
						"          StatusReports as string,",
						"          ModelCounts as string,",
						"          Comments as string,",
						"          DAC_ID as string,",
						"          createddate as timestamp,",
						"          LicenseeSalesFieldManager as string,",
						"          DACID as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['Delete from Smartsheet.StoreMasterCustom'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     outputRejectedData: true,",
						"     outputAssertFailedRows: true,",
						"     assertFailure_fileSystem: 'Error',",
						"     assertFailure_folderPath: 'Store',",
						"     mapColumn(",
						"          Status,",
						"          LocationKey,",
						"          ProspectID,",
						"          GoogleID,",
						"          BindyID,",
						"          StoreID,",
						"          ProfitCenter,",
						"          Location,",
						"          Country,",
						"          Account,",
						"          StoreFrontShipTo,",
						"          Entity,",
						"          LicenseeContact,",
						"          SoftOpenDate,",
						"          AcquisitionDate,",
						"          ClosureDate,",
						"          ShopperTrakLocID,",
						"          StoreAddress,",
						"          City,",
						"          StateProvince,",
						"          ZIP,",
						"          DMAID,",
						"          DMARegion,",
						"          ShowroomSqFt,",
						"          StoreType,",
						"          StoreModel,",
						"          StoreVersion,",
						"          Market,",
						"          Region,",
						"          BuildingOwnership,",
						"          CountryCategory,",
						"          DomesticCategory,",
						"          Classification,",
						"          StorePhone,",
						"          DistrictManager,",
						"          BDDirector,",
						"          LicenseeEmail,",
						"          LicenseePhone,",
						"          CorporationAddress,",
						"          CorpCity,",
						"          CorpState,",
						"          CorpZip,",
						"          RDCAddress,",
						"          RDCCity,",
						"          RDCState,",
						"          RDCZip,",
						"          RDCShipTo,",
						"          RDCSqFt,",
						"          RDCDockDoors,",
						"          TUAExpirationDate,",
						"          LicensedTerritory,",
						"          Latitude,",
						"          Longitude,",
						"          Notes,",
						"          StoreEmail,",
						"          Unit,",
						"          OneSourceID,",
						"          HSDatabaseName,",
						"          SVP,",
						"          VP,",
						"          SrRD,",
						"          RD,",
						"          StoreManager,",
						"          StoreMgrPhone,",
						"          SalesManager1,",
						"          SalesManager2,",
						"          SalesManager3,",
						"          SalesManager4,",
						"          OfficeManager,",
						"          DirectorOfOps,",
						"          RegionalOpsMgr,",
						"          OpsMgr,",
						"          CompStatus,",
						"          Kit,",
						"          TrafficDivisor,",
						"          ERP,",
						"          DTCTechnology,",
						"          DTCBrand,",
						"          ForumID,",
						"          AccountType,",
						"          FacadeCurrentImage,",
						"          WebsiteFacadeCurrent,",
						"          StoreManagerImage,",
						"          EnterpriseFacadeImage,",
						"          ModifiedDate,",
						"          LicenseeMarketingManager,",
						"          IMS,",
						"          LeaseTerms,",
						"          StatusReports,",
						"          ModelCounts,",
						"          Comments,",
						"          LicenseeSalesFieldManager,",
						"          DACID",
						"     )) ~> sink"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Melissa_Fixedwidth_Source')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Canada_Postal_Code_File_melissa",
								"type": "DatasetReference"
							},
							"name": "PostalCodeFixedWidthData"
						},
						{
							"dataset": {
								"referenceName": "Canada_Postal_Code_File_melissa_overlay",
								"type": "DatasetReference"
							},
							"name": "OverlayFixedWidthData",
							"description": "Import data from Canada_Postal_Code_File_melissa overley"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "CANADA_Postal_Code_Table_Melissa",
								"type": "DatasetReference"
							},
							"name": "SinkPostalCode"
						},
						{
							"dataset": {
								"referenceName": "CANADA_Postal_Code_Table_Melissa_overlay",
								"type": "DatasetReference"
							},
							"name": "SinkOverlay"
						}
					],
					"transformations": [
						{
							"name": "DCPostalCode"
						},
						{
							"name": "SelectPostalCode"
						},
						{
							"name": "DCOverlay"
						},
						{
							"name": "SelectOverlay"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {_col0_} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> PostalCodeFixedWidthData",
						"source(output(",
						"          {_col0_} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     limit: 100,",
						"     ignoreNoFilesFound: false) ~> OverlayFixedWidthData",
						"PostalCodeFixedWidthData derive(PostalCode = substring({_col0_},1,6),",
						"          City = substring({_col0_}, 7, 30),",
						"          Province = substring({_col0_}, 37,2),",
						"          Latitude = substring({_col0_}, 39, 9),",
						"          Longitude = substring({_col0_}, 48, 11),",
						"          TimeZone = substring({_col0_}, 59, 2),",
						"          DST = substring({_col0_}, 61, 1),",
						"          AreaCode = substring({_col0_}, 62, 3),",
						"          Overlay = substring({_col0_}, 65, 1)) ~> DCPostalCode",
						"DCPostalCode select(skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> SelectPostalCode",
						"OverlayFixedWidthData derive(Parent = substring({_col0_},1,3),",
						"          Overlay = substring({_col0_},4,3),",
						"          Group = substring({_col0_},5,1)) ~> DCOverlay",
						"DCOverlay select(mapColumn(",
						"          Parent,",
						"          Overlay,",
						"          Group",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> SelectOverlay",
						"SelectPostalCode sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     errorHandlingOption: 'stopOnFirstError') ~> SinkPostalCode",
						"SelectOverlay sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     preCommands: [],",
						"     postCommands: []) ~> SinkOverlay"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Archive_RealEstate_File_To_SFTP')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Excel to Archive with Timestamp",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "SftpReadSettings",
									"recursive": false,
									"deleteFilesAfterCompletion": true,
									"disableChunking": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "SftpWriteSettings",
									"operationTimeout": "01:00:00",
									"useTempFileRename": true
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SFTP_XLSX_File",
								"type": "DatasetReference",
								"parameters": {
									"FolderName": "LeaseHarbor",
									"FileName": "Record Search - Data Export - Record Info _ Contact Details.xlsx"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Realestate_SFTP_Archive_path",
								"type": "DatasetReference",
								"parameters": {
									"SFTP_HostName": {
										"value": "@pipeline().globalParameters.SFTP_HostName",
										"type": "Expression"
									},
									"SFTP_PortNumber": {
										"value": "@pipeline().globalParameters.SFTP_PortNumber",
										"type": "Expression"
									},
									"SFTP_Uname": {
										"value": "@pipeline().globalParameters.SFTP_Uname",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:02:19Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SFTP_XLSX_File')]",
				"[concat(variables('factoryId'), '/datasets/Realestate_SFTP_Archive_path')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "FetchEntityName",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@array(variables('Entity'))",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Get_Entity_Count",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RecordsToDelete INT; \nEXECUTE [dbo].[usp_ASH_REMOVE_LOAD] \n@Entity = @{item()}, \n@RecordsToDelete = @RecordsToDelete OUTPUT; \nSELECT @RecordsToDelete AS RecordsToDeleteADDRESS;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "usp_ASH_REMOVE_LOAD",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"EntityCount": {
												"value": "@string(activity('Get_Entity_Count').output.firstRow.RecordsToDeleteADDRESS)",
												"type": "Expression"
											},
											"EntityName": {
												"value": "@{item()}",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_Get_Entity_Count",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": "0",
											"status": {
												"value": "Failed",
												"type": "Expression"
											},
											"message": {
												"value": "usp_DeleteRFDLocalStage Execution Failed",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Get_Entity_Count').output.executionDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"AddressLocation",
							"EmailAddress",
							"PhoneNumber",
							"RetailCustomer"
						]
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow/RCM_RFD_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2025-12-08T10:01:41Z"
			},
			"dependsOn": []
		}
	]
}