{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Repo1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_repo",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Repo2')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_repo",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "",
					"table": ""
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_ISO_CountryCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "EXT_REF_COUNTRY_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "COUNTRY_CODE_A2",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A3",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_LOCAL_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_UN_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "ISO",
					"table": "countrycode"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_ISO_StateCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "EXT_REF_US_STATE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "ISO",
					"table": "statecode"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/StageInitialLoadRetailChunkControl')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "String"
					},
					"TableName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/StageInitialLoadRetailChunkControl_Blob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Update_Email_Chunk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/cdp_customer_deduped')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CDP_CustomerProfiling",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "clusterID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "confidence_score",
						"type": "varchar"
					},
					{
						"name": "globalID",
						"type": "varchar"
					},
					{
						"name": "RecID",
						"type": "varchar"
					},
					{
						"name": "posRawContainerRecID",
						"type": "varchar"
					},
					{
						"name": "posFirstName",
						"type": "varchar"
					},
					{
						"name": "posMiddleInitial",
						"type": "varchar"
					},
					{
						"name": "posLastName",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail1",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail2",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail3",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone1",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone2",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone3",
						"type": "varchar"
					},
					{
						"name": "n_address",
						"type": "varchar"
					},
					{
						"name": "n_addr2",
						"type": "varchar"
					},
					{
						"name": "n_city",
						"type": "varchar"
					},
					{
						"name": "n_state",
						"type": "varchar"
					},
					{
						"name": "n_zip9",
						"type": "varchar"
					},
					{
						"name": "posFaceBookID",
						"type": "varchar"
					},
					{
						"name": "posTwitterID",
						"type": "varchar"
					},
					{
						"name": "market_id",
						"type": "varchar"
					},
					{
						"name": "customer_type",
						"type": "varchar"
					},
					{
						"name": "timestamp",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "customer_since",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "posFirstNameSoundex",
						"type": "varchar"
					},
					{
						"name": "posLastNameSoundex",
						"type": "varchar"
					},
					{
						"name": "Alpha",
						"type": "varchar"
					},
					{
						"name": "SourceSystem",
						"type": "varchar"
					},
					{
						"name": "SourceSubSystem",
						"type": "varchar"
					},
					{
						"name": "racProfitCenter",
						"type": "nvarchar"
					},
					{
						"name": "racSalesNumber",
						"type": "nvarchar"
					},
					{
						"name": "do_not_sell",
						"type": "bit"
					},
					{
						"name": "Flag",
						"type": "varchar"
					},
					{
						"name": "EntryID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "do_not_sell_request_date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "unsubscribe",
						"type": "bit"
					},
					{
						"name": "unsubscribe_date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "birthdate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_EXTERNAL_REF_COUNTRY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "EXTERNAL_REF_COUNTRY_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A2",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A3",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_LOCAL_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_UN_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_EXTERNAL_REF_COUNTRY"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_EXTERNAL_REF_US_STATE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "EXTERNAL_REF_US_STATE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_EXTERNAL_REF_US_STATE"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_SITE_CONTACT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTACT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTACT_FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "CONTACT_LAST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CONTACT_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "VLD_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "SITE_CONTACT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_CONTACT"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_SITE_CONTENT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTENT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_SHORT_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LONG_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LANGUAGE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_CONTENT"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_SITE_DEFAULT_HOURS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTENT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_SHORT_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LONG_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LANGUAGE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_DEFAULT_HOURS"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SD_SITE_MAIN')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SITE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ISACTIVE",
						"type": "bit"
					},
					{
						"name": "SITE_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "SITE_OWNERSHIP_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_OWNER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "OPERATIONS_START_DATE",
						"type": "date"
					},
					{
						"name": "OPERATIONS_END_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_CLOSE_DATE",
						"type": "date"
					},
					{
						"name": "LOCAL_CURRENCY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LOCAL_UNIT_OF_MEASURE_ARE",
						"type": "nvarchar"
					},
					{
						"name": "TOTAL_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "OPERATIONS_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "CUSTOMER_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "F_SITE_DEFAULT_HOURS",
						"type": "uniqueidentifier"
					},
					{
						"name": "FD_SITE_DEFAULT_HOURS",
						"type": "nvarchar"
					},
					{
						"name": "SITE_SHIP_TO",
						"type": "nvarchar"
					},
					{
						"name": "RAW_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "MAIN_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FAX",
						"type": "nvarchar"
					},
					{
						"name": "STD_FAX",
						"type": "nvarchar"
					},
					{
						"name": "FAX_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CS_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "VLD_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SALES_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SERVICE_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "F_WAREHOUSE_PARENT",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FS_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FD_WAREHOUSE_PARENT",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE_MAIN"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SD_SITE_OWNER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OWNER_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE_OWNER"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CDP_Customer_Dedupe_CsvToTable')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CDP_Customer_Deduped",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "clusterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "globalID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "timestamp",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "customer_since",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "do_not_sell",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "EntryID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "do_not_sell_request_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "unsubscribe",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "unsubscribe_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "birthdate",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CDP_Customer_Deduped_csv",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									},
									"Container_Name": {
										"value": "@pipeline().parameters.Container_Name",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CDP_Customer_Dedeped",
								"type": "DatasetReference",
								"parameters": {
									"CDP_TableName": {
										"value": "@pipeline().parameters.Table_Name",
										"type": "Expression"
									},
									"Table_Schema": {
										"value": "@pipeline().parameters.Table_Schema",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"FileName": {
						"type": "String"
					},
					"Table_Name": {
						"type": "String"
					},
					"Table_Schema": {
						"type": "String"
					},
					"Container_Name": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cdp_Customer_Dedupe_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "cdp_customer_deduped",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \nclusterID,\nconfidence_score,\nglobalID,\nRecID,\nposRawContainerRecID,\nposFirstName,\nposMiddleInitial,\nposLastName,\nposCustomerEmail1,\nposCustomerEmail2,\nposCustomerEmail3,\nposCustomerPhone1,\nposCustomerPhone2,\nposCustomerPhone3,\nn_address,\nn_addr2,\nn_city,\nn_state,\nn_zip9,\nposFaceBookID,\nposTwitterID,\nmarket_id,\ncustomer_type,\ntimestamp,\ncustomer_since,\ndtec,\nposFirstNameSoundex,\nposLastNameSoundex,\nAlpha,\nSourceSystem,\nSourceSubSystem,\nracProfitCenter,\nracSalesNumber,\ndo_not_sell,\nEntryID,\ndo_not_sell_request_date,\nunsubscribe,\nunsubscribe_date,\nbirthdate\nFROM @{pipeline().parameters.CDPSchema}.@{pipeline().parameters.CDPTableName} WITH(NOLOCK) WHERE YEAR(dtec)=@{pipeline().parameters.Year} AND MONTH(dtec)=@{pipeline().parameters.Month}",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "cdp_customer_deduped",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Cdp_Customer_Deduped",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.SemarchySchema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.SemarchyTableName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"CDPSchema": {
						"type": "string"
					},
					"CDPTableName": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"SemarchySchema": {
						"type": "string"
					},
					"SemarchyTableName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/cdp_customer_deduped')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Country_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Country_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Country_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Country_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Country_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Country_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Country_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Country_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Country",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Country_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Country_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_COUNTRY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCOUNTRY_CODE_A2,\nCOUNTRY_CODE_A3,\nCOUNTRY_NAME,\nCOUNTRY_LOCAL_NAME,\nCOUNTRY_UN_CODE \nFROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_COUNTRY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_COUNTRY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Country_Table_Name": {
													"value": "@pipeline().parameters.Sink_Country_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Country_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Country_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Currency_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Currency_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Currency_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Currency_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Currency_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Currency_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Currency_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Currency_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Currency_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Currency",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Currency_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Currency_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_CURENCY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCURRENCY_CODE,\nCURRENCY_NAME\nFROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_CURRENCY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_CURENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_CURRENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_CURRENCY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Currency_Table_Name": {
													"value": "@pipeline().parameters.Sink_Currency_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Currency_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Currency_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}