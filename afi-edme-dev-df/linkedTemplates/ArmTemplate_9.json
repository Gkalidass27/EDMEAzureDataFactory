{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Load_PostalCode_EnterpriseRefPostalCodeLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Count",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECt COUNT(1) AS [count] FROM [Ref_PostalCode].[PostalCode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Stage_PostalCode_Query",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_PostalCode_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Count').output.firstRow.count ,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": "No RAW Data Available For PostalCode",
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Enterprise_ReferenceMaster'\n,@P_PROGRAM_NAME = 'EnterpriseRefPostalCodeLoad'\n,@P_LOAD_DESCRIPTION = 'EnterpriseRefPostalCodeLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_PostalCode",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \nPOSTAL_CODE_MASTER_ID,\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nPOSTAL_CODE,\nSTATE_OR_PROVINCE_CODE,\nCITY_NAME,\nIS_PREFERRED_CITY_NAME,\nCITY_ABBREVIATION,\nCOUNTRY_CODE,\nMSA_CODE,\nTIME_ZONE,\nOBSERVES_DST,\nLATITUDE,\nLONGITUDE,\nPOSTAL_CODE_TYPE,\nFIPS_CODE\nFROM\n[Ref_PostalCode].[PostalCode]",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "ENT_REF_POSTAL_CODE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_POSTAL_CODE_MASTER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "EnterpriseRefPostalCodeLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "PostalCode_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_PostalCode').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SA_ENT_REF_POSTAL_CODE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Ref_PostalCode].[PostalCode]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_Load_PostalCode",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_PostalCode').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_PostalCode",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_PostalCode').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Remove_From_USPostalCode_Stage_Table",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DELETE FROM [Ref_PostalCode].[ZipInfo_USz5max];\nSELECT 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Remove_From_CanadainPostalCode_Stage_Table",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DELETE FROM [Ref_PostalCode].[GeocoderCA_PCensusNWE];\nSELECT 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "Cancel_PostalCode_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Check_PostalCode_Count",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMasterLoad_Retail_PIM_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_EDWProductKit",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT 'ProductKit' AS B_CLASSNAME,\n'semadmin' AS B_CREATOR,\nCreatedDateTimeUtc AS CREATED_DATE_TIME_UTC,\nKitAdditionalDimensions AS KIT_ADDITIONAL_DIMENSIONS,\nKitAfiFeatureBullet1English AS KIT_AFI_FT_BULLET1_ENG,\nKitAfiFeatureBullet2English AS KIT_AFI_FT_BULLET2_ENG,\nKitAfiFeatureBullet3English AS KIT_AFI_FT_BULLET3_ENG,\nKitAfiFeatureBullet4English AS KIT_AFI_FT_BULLET4_ENG,\nKitAfiFeatureBullet5English AS KIT_AFI_FT_BULLET5_ENG,\nKitAfiFeatureBullet6English AS KIT_AFI_FT_BULLET6_ENG,\nKitAfiFeatureBullet7English AS KIT_AFI_FT_BULLET7_ENG,\nKitAFIImageSet AS KIT_AFI_IMAGE_SET,\nKitAlternateDescription2 AS KIT_ALTER_DESC2,\nKitAlternateDescription3 AS KIT_ALTER_DESC3,\nKitAlternateAFIFluff1 AS KIT_ALTERNATE_AFI_FLUFF1,\nKitAmazonBrandOwner AS KIT_AMAZON_BRAND_OWNER,\nKitARVRReady AS KIT_ARVR_READY,\nKitAshcommDeliveryMode AS KIT_ASHCOMM_DELIVERY_MODE,\nKitAssemblyInstructionsInternal AS KIT_ASM_INSTR_INTERNAL,\nKitAssemblyInstructionsPublic AS KIT_ASM_INSTR_PUBLIC,\nKitATPSeries AS KIT_ATP_SERIES,\nKitAXKitNumber AS KIT_AX_KIT_NUMBER,\nKitBoxQty AS KIT_BOX_QTY,\nKitCartonDensity AS KIT_CARTON_DENSITY,\nKitCartonDepthIn AS KIT_CARTON_DEPTH_IN,\nKitCartonDepthMm AS KIT_CARTON_DEPTH_MM,\nKitCartonFreightClass AS KIT_CARTON_FREIGHT_CLASS,\nKitCartonHeightIn AS KIT_CARTON_HEIGHT_IN,\nKitCartonHeightMm AS KIT_CARTON_HEIGHT_MM,\nKitCartonVolume AS KIT_CARTON_VOLUME,\nKitCartonWidthIn AS KIT_CARTON_WIDTH_IN,\nKitCartonWidthMm AS KIT_CARTON_WIDTH_MM,\nKitClassKey AS KIT_CLASS_KEY,\nKitCodeKey AS KIT_CODE_KEY,\nKitColorKey AS KIT_COLOR_KEY,\nKitColorSwatch AS KIT_COLOR_SWATCH,\nKitCommodity AS KIT_COMMODITY,\nKitComponentQuantity AS KIT_COMPONENT_QUANTITY,\nKitConditionalHomeDeliveryEligible AS KIT_COND_HOME_DELIV_ELIG,\nKitConsumerAssembly AS KIT_CONSUMER_ASSEMBLY,\nKitConsumerDescriptionEnglish AS KIT_CONSUMER_DESC_ENG,\nKitCubesFt AS KIT_CUBES_FT,\nKitCubesM AS KIT_CUBES_M,\nKitDead AS KIT_DEAD,\nKitDefaultGroupingLookupCodeKey AS KIT_DFLT_GROUP_CODE_KEY,\nKitDimensionSketch AS KIT_DIMENSION_SKETCH,\nKitDimensionsConfirmed AS KIT_DIMENSIONS_CONFIRMED,\nKitDiningChairQtyCtn AS KIT_DINING_CHAIR_QTY_CTN,\nKitEcomMerchantNotes AS KIT_ECOM_MERCHANT_NOTES,\nKitEligibleforProtectionPlan AS KIT_ELIG_PROTECTION_PLAN,\nKitEngineeringDivisionKey AS KIT_ENGINEER_DIVISION_KEY,\nKitExclusive AS KIT_EXCLUSIVE,\nKitExclusiveComment AS KIT_EXCLUSIVE_COMMENT,\nKitExpressShip AS KIT_EXPRESS_SHIP,\nKitFamilyofBusinessKey AS KIT_FAMILYOF_BUSINESS_KEY,\nKitFluffAFIEnglish AS KIT_FLUFF_AFI_ENGLISH,\nKitFluffPrintEnglish AS KIT_FLUFF_PRINT_ENGLISH,\nKitFOBBasePrice AS KIT_FOB_BASE_PRICE,\nKitForecastPlannerID AS KIT_FORECAST_PLANNER_ID,\nKitFriendlyDescriptionEnglish AS KIT_FRIENDLY_DESC_ENG,\nKitFriendlyDimensions AS KIT_FRIENDLY_DIMENSIONS,\nKitFutureStatus AS KIT_FUTURE_STATUS,\nKitGeneralDescriptionID AS KIT_GEN_DESC_ID,\nKitGeneralLongDescription AS KIT_GEN_LONG_DESC,\nKitGoogleTitle AS KIT_GOOGLE_TITLE,\nKitHomeStoreAssemblyVideo1 AS KIT_HOMESTORE_ASM_VIDEO1,\nKitHomestoreProductLine AS KIT_HOMESTORE_PDT_LINE,\nKitHomstoreFeatureBullet1English AS KIT_HS_FT_BULLET1_ENG,\nKitHomstoreFeatureBullet2English AS KIT_HS_FT_BULLET2_ENG,\nKitHomstoreFeatureBullet3English AS KIT_HS_FT_BULLET3_ENG,\nKitHomstoreFeatureBullet4English AS KIT_HS_FT_BULLET4_ENG,\nKitHomstoreFeatureBullet5English AS KIT_HS_FT_BULLET5_ENG,\nKitHomstoreFeatureBullet6English AS KIT_HS_FT_BULLET6_ENG,\nKitHomstoreFeatureBullet7English AS KIT_HS_FT_BULLET7_ENG,\nKitHomstoreFeatureBullet8English AS KIT_HS_FT_BULLET8_ENG,\nKitHomestoreKitFluffEnglish AS KIT_HS_KIT_FLUFF_ENG,\nKitHTSCode AS KIT_HTS_CODE,\nKitID AS KIT_ID,\nKitImportDomesticKey AS KIT_IMPORT_DOMESTIC_KEY,\nKitIsProtectionPlan AS KIT_IS_PROTECTION_PLAN,\nKitKeyKit AS KIT_KEY_KIT,\nKitKnockout AS KIT_KNOCKOUT,\nKitMaterialEnglish AS KIT_MATERIAL_ENGLISH,\nKitMfgWarranty AS KIT_MFG_WARRANTY,\nKitNotAvailableforIndividualSale AS KIT_NOT_AVBL_INDIV_SALE,\nKitNumber AS KIT_NUMBER,\nKitPartsDrawings AS KIT_PARTS_DRAWINGS,\nKitPhoto AS KIT_PHOTO,\nKitPKLegacySellablePackage AS KIT_PK_LEG_SELLABLE_PKG,\nKitPrimaryLifestyle AS KIT_PRIMARY_LIFESTYLE,\nKitProductDepthIn AS KIT_PRODUCT_DEPTH_IN,\nKitProductDepthMm AS KIT_PRODUCT_DEPTH_MM,\nKitProductHeightIn AS KIT_PRODUCT_HEIGHT_IN,\nKitProductHeightMm AS KIT_PRODUCT_HEIGHT_MM,\nKitProductPageURL AS KIT_PRODUCT_PAGE_URL,\nKitProductWidthIn AS KIT_PRODUCT_WIDTH_IN,\nKitProductWidthMm AS KIT_PRODUCT_WIDTH_MM,\nKitPurchaseType AS KIT_PURCHASE_TYPE,\nKitRetailBrandNameKey AS KIT_RETAIL_BRAND_NAME_KEY,\nKitRetailRoomKey AS KIT_RETAIL_ROOM_KEY,\nKitRetailTypeKey AS KIT_RETAIL_TYPE_KEY,\nKitRollOverimage AS KIT_ROLL_OVER_IMAGE,\nKitSalesCategoryCodeKey AS KIT_SALES_CATEG_CODE_KEY,\nKitScene7ImageSet AS KIT_SCENE7_IMAGE_SET,\nKitSeats AS KIT_SEATS,\nKitSelllingCountries AS KIT_SELLLING_COUNTRIES,\nKitSeriesNumber AS KIT_SERIES_NUMBER,\nKitSeriesRetailSalesCategoryKey AS KIT_SERIES_RT_SL_CAT_KEY,\nKitShippableUomKey AS KIT_SHIPPABLE_UOM_KEY,\nKitShippingDepthIn AS KIT_SHIPPING_DEPTH_IN,\nKitShippingDepthMm AS KIT_SHIPPING_DEPTH_MM,\nKitShippingHeightIn AS KIT_SHIPPING_HEIGHT_IN,\nKitShippingHeightMm AS KIT_SHIPPING_HEIGHT_MM,\nKitShippingWidthIn AS KIT_SHIPPING_WIDTH_IN,\nKitShippingWidthMm AS KIT_SHIPPING_WIDTH_MM,\nKitShowroomMarketStatus AS KIT_SHOWROOM_MKT_STATUS,\nCAST(KitSourceID AS int) AS KIT_SOURCE_ID,\nKitStandAloneFlag AS KIT_STAND_ALONE_FLAG,\nKitStatus AS KIT_STATUS,\nKitStatusChanged AS KIT_STATUS_CHANGED,\nKitStatusKey AS KIT_STATUS_KEY,\nKitSuppWeightNetWeightKg AS KIT_SUPP_WT_NET_WT_KG,\nKitSuppWeightNetWeightLbs AS KIT_SUPP_WT_NET_WT_LBS,\nKitSupplierDirectShipOnly AS KIT_SUPPLIER_DT_SHIP_ONLY,\nKitThirdPartyKit AS KIT_THIRD_PARTY_KIT,\nKitTrackingPiece AS KIT_TRACKING_PIECE,\nKitTrademarkText AS KIT_TRADEMARK_TEXT,\nKitType AS KIT_TYPE,\nKitUnitWeightKg AS KIT_UNIT_WEIGHT_KG,\nKitUnitWeightLbs AS KIT_UNIT_WEIGHT_LBS,\nKitUomKey AS KIT_UOM_KEY,\nKitUPC AS KIT_UPC,\nKitUpholsteryCover AS KIT_UPHOLSTERY_COVER,\nKitValidationComplete AS KIT_VALIDATION_COMPLETE,\nKitVendorName AS KIT_VENDOR_NAME,\nKitWholesaleAssemblyVideo1 AS KIT_WHOLESALE_ASM_VIDEO1,\nLastModifiedDateTimeUtc AS LAST_MOD_DATE_TIME_UTC,\nSeriesID AS SERIES_ID,\nCAST(SeriesKey AS int) AS SERIES_KEY\nfrom [Retail].[EDWProductKit] WHERE CAST(LastModifiedDateTimeUtc as date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_BOX_QTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductKit",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_EDWProduct",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT 'semadmin' AS B_CREATOR,\n'ProductMain' AS B_CLASSNAME,\nid AS PRODUCT_MAIN_ID,\nSourceId AS SOURCE_ID,\nStatus AS STATUS,\nLastModifiedDateTimeUtc AS LAST_MOD_DATE_TIME_UTC,\nSystemTimestamp AS SYSTEM_TIMESTAMP,\nAlternateDescription2 AS ALTERNATE_DESCRIPTION2,\nItemAFIImageSet AS ITEM_AFI_IMAGE_SET,\nItemAlternateAFIFluff1 AS ITEM_ALTERNATE_AFI_FLUFF1,\nItemAlternateDescription3 AS ITEM_ALTER_DESC3,\nItemARVRReady AS ITEM_ARVR_READY,\nItemAssemblyInstructionsInternal AS ITEM_ASM_INSTR_INTERNAL,\nItemAssemblyInstructionsPublic AS ITEM_ASM_INSTR_PUBLIC,\nItemBoxQty AS ITEM_BOX_QTY,\nItemCartonDepthIn AS ITEM_CARTON_DEPTH_IN,\nItemCartonDepthMm AS ITEM_CARTON_DEPTH_MM,\nItemCartonHeightIn AS ITEM_CARTON_HEIGHT_IN,\nItemCartonHeightMm AS ITEM_CARTON_HEIGHT_MM,\nItemCartonWidthIn AS ITEM_CARTON_WIDTH_IN,\nItemCartonWidthMm AS ITEM_CARTON_WIDTH_MM,\nItemClass AS ITEM_CLASS,\nItemCode AS ITEM_CODE,\nItemColor AS ITEM_COLOR,\nItemColorSwatch AS ITEM_COLOR_SWATCH,\nItemCommodity AS ITEM_COMMODITY,\nItemComponentQuantity AS ITEM_COMPONENT_QUANTITY,\nItemConsumerAssembly AS ITEM_CONSUMER_ASSEMBLY,\nItemCubesFt AS ITEM_CUBES_FT,\nItemCubesM AS ITEM_CUBES_M,\nItemDead AS ITEM_DEAD,\nItemDimensionSketch AS ITEM_DIMENSION_SKETCH,\nItemDiningChairQtyCtn AS ITEM_DINING_CHAIR_QTY_CTN,\nItemEngineeringDivision AS ITEM_ENGINEERING_DIVISION,\nItemExclusive AS ITEM_EXCLUSIVE,\nItemExclusiveComment AS ITEM_EXCLUSIVE_COMMENT,\nItemExpressShip AS ITEM_EXPRESS_SHIP,\nItemFOBBasePrice AS ITEM_FOB_BASE_PRICE,\nItemForecastPlannerID AS ITEM_FORECAST_PLANNER_ID,\nItemFriendlyDimensions AS ITEM_FRIENDLY_DIMENSIONS,\nItemFutureStatus AS ITEM_FUTURE_STATUS,\nItemGeneralDescriptionID AS ITEM_GNRL_DESC_ID,\nItemGeneralLongDescription AS ITEM_GNRL_LONG_DESC,\nItemGoogleTitle AS ITEM_GOOGLE_TITLE,\nItemHomeStoreAssemblyVideo1 AS ITEM_HOMSTORE_ASM_VIDEO1,\nItemHTSCode AS ITEM_HTS_CODE,\nItemImportDomestic AS ITEM_IMPORT_DOMESTIC,\nItemKeyItem AS ITEM_KEY_ITEM,\nItemKnockout AS ITEM_KNOCKOUT,\nItemMaterialReferenceNeeded AS ITEM_MTERIAL_REF_NEEDED,\nItemMfgWarranty AS ITEM_MFG_WARRANTY,\nItemNumber AS ITEM_NUMBER,\nItemPhoto AS ITEM_PHOTO,\nItemProductDepthIn AS ITEM_PRODUCT_DEPTH_IN,\nItemProductDepthMm AS ITEM_PRODUCT_DEPTH_MM,\nItemProductHeightIn AS ITEM_PRODUCT_HEIGHT_IN,\nItemProductHeightMm AS ITEM_PRODUCT_HEIGHT_MM,\nItemProductPageURL AS ITEM_PRODUCT_PAGE_URL,\nItemProductWidthIn AS ITEM_PRODUCT_WIDTH_IN,\nItemProductWidthMm AS ITEM_PRODUCT_WIDTH_MM,\nItemRetailBrandName AS ITEM_RETAIL_BRAND_NAME,\nItemRetailType AS ITEM_RETAIL_TYPE,\nItemRollOverimage AS ITEM_ROLL_OVERIMAGE,\nItemSalesCategoryCode AS ITEM_SALES_CATEGORY_CODE,\nItemScene7ImageSet AS ITEM_SCENE7_IMAGE_SET,\nItemSeats AS ITEM_SEATS,\nItemSeriesName AS ITEM_SERIES_NAME,\nItemSeriesNumber AS ITEM_SERIES_NUMBER,\nItemStandAloneFlag AS ITEM_STAND_ALONE_FLAG,\nItemStatus AS ITEM_STATUS,\nItemStatusChanged AS ITEM_STATUS_CHANGED,\nItemSupplierDirectShipOnly AS ITEM_SUPP_DT_SHIP_ONLY,\nItemSuppWeightNetWeightKg AS ITEM_SUPP_WET_NET_WET_KG,\nItemSuppWeightNetWeightLbs AS ITEM_SUPP_WET_NET_WET_LBS,\nItemThirdPartyItem AS ITEM_THIRD_PARTY_ITEM,\nItemTrackingPiece AS ITEM_TRACKING_PIECE,\nItemTrademarkText AS ITEM_TRADEMARK_TEXT,\nItemType AS ITEM_TYPE,\nItemUnitWeightKg AS ITEM_UNIT_WEIGHT_KG,\nItemUnitWeightLbs AS ITEM_UNIT_WEIGHT_LBS,\nItemUPC AS ITEM_UPC,\nItemValidationComplete AS ITEM_VALIDATION_COMPLETE,\nItemWholesaleAssemblyVideo1 AS ITEM_WHOLESALE_ASM_VIDEO1,\nItemAFIFeatureBullet1 AS ITEM_AFI_FEATURE_BULLET1,\nItemAFIFeatureBullet2 AS ITEM_AFI_FEATURE_BULLET2,\nItemAFIFeatureBullet3 AS ITEM_AFI_FEATURE_BULLET3,\nItemAFIFeatureBullet4 AS ITEM_AFI_FEATURE_BULLET4,\nItemAFIFeatureBullet5 AS ITEM_AFI_FEATURE_BULLET5,\nItemAFIFeatureBullet6 AS ITEM_AFI_FEATURE_BULLET6,\nItemAFIFeatureBullet7 AS ITEM_AFI_FEATURE_BULLET7,\nItemConsumerDescription AS ITEM_CONSUMER_DESCRIPTION,\nItemFluffAFI AS ITEM_FLUFF_AFI,\nItemFluffPrint AS ITEM_FLUFF_PRINT,\nItemFriendlyDescription AS ITEM_FRIENDLY_DESCRIPTION,\nItemHomeStoreFeatureBullet1 AS ITEM_HOMESTORE_FT_BULLET1,\nItemHomeStoreFeatureBullet2 AS ITEM_HOMESTORE_FT_BULLET2,\nItemHomeStoreFeatureBullet3 AS ITEM_HOMESTORE_FT_BULLET3,\nItemHomeStoreFeatureBullet4 AS ITEM_HOMESTORE_FT_BULLET4,\nItemHomeStoreFeatureBullet5 AS ITEM_HOMESTORE_FT_BULLET5,\nItemHomeStoreFeatureBullet6 AS ITEM_HOMESTORE_FT_BULLET6,\nItemHomeStoreFeatureBullet7 AS ITEM_HOMESTORE_FT_BULLET7,\nItemHomeStoreFeatureBullet8 AS ITEM_HOMESTORE_FT_BULLET8,\nItemHomestoreItemFluff AS ITEM_HOMESTORE_ITEM_FLUFF,\nTRIM(SeriesAshleyHomestore) AS SERIES_ASHLEY_HOMESTORE,\nSeriesCorporateOnlineSelling AS SERIES_CORP_ONLINE_SELLNG,\nSeriesDivision AS SERIES_DIVISION,\nSeriesExclusiveComment AS SERIES_EXCLUSIVE_COMMENT,\nSeriesFeatures AS SERIES_FEATURES,\nSeriesId AS SERIES_ID,\nSeriesInternationalHomeStore AS SERIES_INTERNATIONAL_HS,\nSeriesIntroDate AS SERIES_INTRO_DATE,\nSeriesMainImage AS SERIES_MAIN_IMAGE,\nSeriesName AS SERIES_NAME,\nSeriesNumber AS SERIES_NUMBER,\nSeriesRetailSalesCategory AS SERIES_RETAIL_SALES_CATEG,\nSeriesShowroom AS SERIES_SHOWROOM,\nSeriesSourceId AS SERIES_SOURCE_ID,\nSeriesStatus AS SERIES_STATUS,\nSeriesStyle AS SERIES_STYLE,\nSeriesThirdParty AS SERIES_THIRD_PARTY,\nSeriesPrimary AS SERIES_PRIMARY,\nItemUomKey AS ITEM_UOM_KEY,\nItemShippableUomKey AS ITEM_SHIPPABLE_UOM_KEY,\nItemEligibleforProtectionPlan AS ITEM_ELIG_PROTECTION_PLAN,\nItemIsProtectionPlan AS ITEM_IS_PROTECTION_PLAN,\nItemAshcommDeliveryMode AS ITEM_ASHCOMM_DLVR_MODE,\nItemMaterial AS ITEM_MATERIAL,\nItemHomeStoreProductLine AS ITEM_HS_PRODUCT_LINE,\nItemEcomMerchantNotes AS ITEM_ECOM_MERCHANT_NOTES,\nItemAmazonBrandOwner AS ITEM_AMAZON_BRAND_OWNER,\nItemLifestyleDescription AS ITEM_LIFESTYLE_DESC\nfrom [Retail].[EDWProduct] WHERE CAST(LastModifiedDateTimeUtc as date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_EDWProductPackage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetDateVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n'semadmin' AS B_CREATOR,\n'ProductPackage' AS B_CLASSNAME,\nPackageID AS PACKAGE_ID,\nPackageKey AS PACKAGE_KEY,\nHomestorePackageId AS HOMESTORE_PACKAGE_ID,\nLastModifiedDateTimeUtc AS LAST_MOD_DATE_TIME_UTC,\nCreatedDateTimeUtc AS CREATED_DATE_TIME_UTC,\nPackageNumber AS PACKAGE_NUMBER,\nPackageAlternatePackageName AS PACKAGE_ALTER_NAME,\nPackageHero AS PACKAGE_HERO,\nPackageStatus AS PACKAGE_STATUS,\nPackageStatusChanged AS PACKAGE_STATUS_CHANGED,\nPackageIsThirdParty AS PACKAGE_IS_THIRD_PARTY,\nPackageHomestorePackageId AS PACKAGE_HOMESTORE_ID,\nPackageWholesaleID AS PACKAGE_WHOLESALE_ID,\nPackageRetailType AS PACKAGE_RETAIL_TYPE,\nPackageItemQuantity AS PACKAGE_ITEM_QUANTITY,\nPackageUOM AS PACKAGE_UOM,\nPackageColor AS PACKAGE_COLOR,\nPackageKnockout AS PACKAGE_KNOCKOUT,\nPackageScene7ImageSet AS PACKAGE_SCENE7_IMAGE_SET,\nPackageValidationComplete AS PACKAGE_VALIDAT_COMPLETE,\nPackageValidationNotes AS PACKAGE_VALIDATION_NOTES,\nPackageRolloverImage AS PACKAGE_ROLLOVER_IMAGE,\nPackageExpressShip AS PACKAGE_EXPRESS_SHIP,\nPackageSupplierDirectShipOnly AS PACKAGE_SUPP_DT_SHIP_ONLY,\nPackageSalesCategoryCode AS PACKAGE_SALES_CATEG_CODE,\nPackageSeriesNumber AS PACKAGE_SERIES_NUMBER,\nPackageSeriesName AS PACKAGE_SERIES_NAME,\nPackageCode AS PACKAGE_CODE,\nPackageAshcommTransition AS PACKAGE_ASHCOM_TRANSITION,\nPackageSwatchGroupID AS PACKAGE_SWATCH_GROUP_ID,\nPackageDefaultProduct AS PACKAGE_DEFAULT_PRODUCT,\nPackageNewFlagDate AS PACKAGE_NEW_FLAG_DATE,\nPackageAshcommDeliveryMode AS PACKAGE_ASHCOMM_DLVR_MODE,\nPackageChannelChange AS PACKAGE_CHANNEL_CHANGE,\nPackageExclusive AS PACKAGE_EXCLUSIVE,\nPackageHotSpotsNeedReview AS PACKAGE_HOT_SPOTS_REVIEW,\nPackageAlternateDescription1 AS PACKAGE_ALT_DESC1,\nPackageAshcommTitleOverride AS PACKAGE_ASH_TTL_OVERRIDE,\nPackageHiddenField AS PACKAGE_HIDDEN_FIELD,\nPackageConsumerChoice AS PACKAGE_CONSUMER_CHOICE,\nPackageTotalAssemblyTime AS PACKAGE_TOTAL_ASM_TIME,\nPackageAshcommFlags AS PACKAGE_ASHCOMM_FLAGS,\nPackageNavigableCategories AS PACKAGE_NAVIGABLE_CATEG,\nPackageName AS PACKAGE_NAME,\nPackageAFIFluff AS PACKAGE_AFI_FLUFF,\nPackageHomestorePackageFluff AS PACKAGE_HS_PACKAGE_FLUFF,\nPackageAFIBullets1 AS PACKAGE_AFI_BULLETS1,\nPackageAFIBullets2 AS PACKAGE_AFI_BULLETS2,\nPackageAFIBullets3 AS PACKAGE_AFI_BULLETS3,\nPackageAFIBullets4 AS PACKAGE_AFI_BULLETS4,\nPackageAFIBullets5 AS PACKAGE_AFI_BULLETS5,\nPackageAFIBullets6 AS PACKAGE_AFI_BULLETS6,\nPackageHomeStoreBullets1 AS PACKAGE_HOMESTORE_BULLET1,\nPackageHomeStoreBullets2 AS PACKAGE_HOMESTORE_BULLET2,\nPackageHomeStoreBullets3 AS PACKAGE_HOMESTORE_BULLET3,\nPackageHomeStoreBullets4 AS PACKAGE_HOMESTORE_BULLET4,\nPackageHomeStoreBullets5 AS PACKAGE_HOMESTORE_BULLET5,\nPackageHomeStoreBullets6 AS PACKAGE_HOMESTORE_BULLET6\nFROM [Retail].[EDWProductPackage] WHERE CAST(LastModifiedDateTimeUtc as date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_KitComponentCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load_Retail_PIM_EDWProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'semadmin' AS B_CREATOR,\r\n'ProductPackageCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_PKG_CROSSWALK_ID,\r\nProductID AS F_PRODUCT_ID,\r\nProductSourceID AS PRODUCT_SOURCE_ID,\r\nProductType AS PRODUCT_TYPE,\r\nPackageID AS F_PACKAGE_ID,\r\nPackageSourceID AS PACKAGE_SOURCE_ID \r\nFROM [Retail].[ProductPackageCrosswalk]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"PRODUCT_PKG_CROSSWALK_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'semadmin' AS B_CREATOR,\r\n'ProductKitCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_KIT_CROSSWALK_ID,\r\nKitID AS F_KIT_ID,\r\nKitSourceID AS KIT_SOURCE_ID,\r\nComponentType AS PRODUCT_TYPE,\r\nComponentID AS F_PRODUCT_MAIN_ID,\r\nComponentSourceID AS PRODUCT_SOURCE_ID\r\nFROM [Retail].[KitComponentCrosswalk]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"PRODUCT_KIT_CROSSWALK_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SetDateVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Date",
							"value": {
								"value": "@formatDateTime(adddays(startOfDay(utcnow()),-1), 'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Date": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMasterLoad_Retail_PIM_EDW_SA_To_SA_Table')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_EDWProductKit",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_ProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select * FROM (\nSELECT \nKIT_ID,\nKIT_SOURCE_ID,\nKIT_STATUS,\nLAST_MOD_DATE_TIME_UTC,\nCREATED_DATE_TIME_UTC,\nSERIES_ID,\nSERIES_KEY,\nKIT_RETAIL_TYPE_KEY,\nKIT_STATUS_KEY,\nKIT_IMPORT_DOMESTIC_KEY,\nKIT_ENGINEER_DIVISION_KEY,\nKIT_CLASS_KEY,\nKIT_CODE_KEY,\nKIT_SALES_CATEG_CODE_KEY,\nKIT_DFLT_GROUP_CODE_KEY,\nKIT_FAMILYOF_BUSINESS_KEY,\nKIT_SERIES_RT_SL_CAT_KEY,\nKIT_NUMBER,\nKIT_SERIES_NUMBER,\nKIT_EXPRESS_SHIP,\nKIT_PRIMARY_LIFESTYLE,\nKIT_AX_KIT_NUMBER,\nKIT_STATUS_CHANGED,\nKIT_DEAD,\nKIT_BOX_QTY,\nKIT_SEATS,\nKIT_DINING_CHAIR_QTY_CTN,\nKIT_UPC,\nKIT_ARVR_READY,\nKIT_STAND_ALONE_FLAG,\nKIT_SUPPLIER_DT_SHIP_ONLY,\nKIT_DIMENSIONS_CONFIRMED,\nKIT_MFG_WARRANTY,\nKIT_FRIENDLY_DIMENSIONS,\nKIT_GEN_DESC_ID,\nKIT_GEN_LONG_DESC,\nKIT_FORECAST_PLANNER_ID,\nKIT_UOM_KEY,\nKIT_PRODUCT_DEPTH_IN,\nKIT_PRODUCT_DEPTH_MM,\nKIT_PRODUCT_HEIGHT_IN,\nKIT_PRODUCT_HEIGHT_MM,\nKIT_PRODUCT_WIDTH_IN,\nKIT_PRODUCT_WIDTH_MM,\nKIT_ADDITIONAL_DIMENSIONS,\nKIT_CARTON_DEPTH_IN,\nKIT_CARTON_DEPTH_MM,\nKIT_CARTON_HEIGHT_IN,\nKIT_CARTON_HEIGHT_MM,\nKIT_CARTON_WIDTH_IN,\nKIT_CARTON_WIDTH_MM,\nKIT_UNIT_WEIGHT_KG,\nKIT_UNIT_WEIGHT_LBS,\nKIT_SUPP_WT_NET_WT_LBS,\nKIT_SUPP_WT_NET_WT_KG,\nKIT_SELLLING_COUNTRIES,\nKIT_THIRD_PARTY_KIT,\nKIT_AFI_IMAGE_SET,\nKIT_SCENE7_IMAGE_SET,\nKIT_ROLL_OVER_IMAGE,\nKIT_KNOCKOUT,\nKIT_COLOR_SWATCH,\nKIT_PHOTO,\nKIT_GOOGLE_TITLE,\nKIT_PRODUCT_PAGE_URL,\nKIT_CUBES_FT,\nKIT_CUBES_M,\nKIT_FOB_BASE_PRICE,\nKIT_CONSUMER_ASSEMBLY,\nKIT_FUTURE_STATUS,\nKIT_KEY_KIT,\nKIT_TRACKING_PIECE,\nKIT_ALTER_DESC2,\nKIT_SHOWROOM_MKT_STATUS,\nKIT_TRADEMARK_TEXT,\nKIT_ALTERNATE_AFI_FLUFF1,\nKIT_VALIDATION_COMPLETE,\nKIT_ALTER_DESC3,\nKIT_EXCLUSIVE,\nKIT_EXCLUSIVE_COMMENT,\nKIT_COMMODITY,\nKIT_UPHOLSTERY_COVER,\nKIT_CARTON_VOLUME,\nKIT_CARTON_DENSITY,\nKIT_CARTON_FREIGHT_CLASS,\nKIT_SHIPPABLE_UOM_KEY,\nKIT_NOT_AVBL_INDIV_SALE,\nKIT_PURCHASE_TYPE,\nKIT_PARTS_DRAWINGS,\nKIT_HOMESTORE_PDT_LINE,\nKIT_RETAIL_ROOM_KEY,\nKIT_SHIPPING_DEPTH_IN,\nKIT_SHIPPING_DEPTH_MM,\nKIT_SHIPPING_HEIGHT_IN,\nKIT_SHIPPING_HEIGHT_MM,\nKIT_SHIPPING_WIDTH_IN,\nKIT_SHIPPING_WIDTH_MM,\nKIT_PK_LEG_SELLABLE_PKG,\nKIT_COND_HOME_DELIV_ELIG,\nKIT_ATP_SERIES,\nKIT_VENDOR_NAME,\nKIT_ASM_INSTR_INTERNAL,\nKIT_ASM_INSTR_PUBLIC,\nKIT_COMPONENT_QUANTITY,\nKIT_DIMENSION_SKETCH,\nKIT_HOMESTORE_ASM_VIDEO1,\nKIT_WHOLESALE_ASM_VIDEO1,\nKIT_AFI_FT_BULLET1_ENG,\nKIT_AFI_FT_BULLET2_ENG,\nKIT_AFI_FT_BULLET3_ENG,\nKIT_AFI_FT_BULLET4_ENG,\nKIT_AFI_FT_BULLET5_ENG,\nKIT_AFI_FT_BULLET6_ENG,\nKIT_AFI_FT_BULLET7_ENG,\nKIT_CONSUMER_DESC_ENG,\nKIT_FLUFF_AFI_ENGLISH,\nKIT_FLUFF_PRINT_ENGLISH,\nKIT_FRIENDLY_DESC_ENG,\nKIT_HS_FT_BULLET1_ENG,\nKIT_HS_FT_BULLET2_ENG,\nKIT_HS_FT_BULLET3_ENG,\nKIT_HS_FT_BULLET4_ENG,\nKIT_HS_FT_BULLET5_ENG,\nKIT_HS_FT_BULLET6_ENG,\nKIT_HS_FT_BULLET7_ENG,\nKIT_HS_FT_BULLET8_ENG,\nKIT_HS_KIT_FLUFF_ENG,\nKIT_ELIG_PROTECTION_PLAN,\nKIT_IS_PROTECTION_PLAN,\nKIT_ASHCOMM_DELIVERY_MODE,\nKIT_MATERIAL_ENGLISH,\nKIT_ECOM_MERCHANT_NOTES,\nKIT_AMAZON_BRAND_OWNER,\nKIT_RETAIL_BRAND_NAME_KEY,\nKIT_COLOR_KEY,\nKIT_TYPE,\nKIT_HTS_CODE,\nB_CREDATE,\nB_UPDDATE,\n'Semadmin' AS B_CREATOR,\n'Semadmin' AS B_UPDATOR,\nB_CLASSNAME,\n           ROW_NUMBER() OVER (PARTITION BY KIT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_PRODUCT_KIT WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_KIT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductKit",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_EDWProduct",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select * FROM (\nSELECT \nPRODUCT_MAIN_ID,\nSOURCE_ID,\nSTATUS,\nLAST_MOD_DATE_TIME_UTC,\nSYSTEM_TIMESTAMP,\nALTERNATE_DESCRIPTION2,\nITEM_AFI_IMAGE_SET,\nITEM_ALTERNATE_AFI_FLUFF1,\nITEM_ALTER_DESC3,\nITEM_ARVR_READY,\nITEM_ASM_INSTR_INTERNAL,\nITEM_ASM_INSTR_PUBLIC,\nITEM_BOX_QTY,\nITEM_CARTON_DEPTH_IN,\nITEM_CARTON_DEPTH_MM,\nITEM_CARTON_HEIGHT_IN,\nITEM_CARTON_HEIGHT_MM,\nITEM_CARTON_WIDTH_IN,\nITEM_CARTON_WIDTH_MM,\nITEM_CLASS,\nITEM_CODE,\nITEM_COLOR,\nITEM_COLOR_SWATCH,\nITEM_COMMODITY,\nITEM_COMPONENT_QUANTITY,\nITEM_CONSUMER_ASSEMBLY,\nITEM_CUBES_FT,\nITEM_CUBES_M,\nITEM_DEAD,\t\t\t\t\t\nITEM_DIMENSION_SKETCH,\nITEM_DINING_CHAIR_QTY_CTN,\nITEM_ENGINEERING_DIVISION,\nITEM_EXCLUSIVE,\nITEM_EXCLUSIVE_COMMENT,\nITEM_EXPRESS_SHIP,\nITEM_FOB_BASE_PRICE,\nITEM_FORECAST_PLANNER_ID,\nITEM_FRIENDLY_DIMENSIONS,\nITEM_FUTURE_STATUS,\nITEM_GNRL_DESC_ID,\nITEM_GNRL_LONG_DESC,\nITEM_GOOGLE_TITLE,\nITEM_HOMSTORE_ASM_VIDEO1,\nITEM_IMPORT_DOMESTIC,\nITEM_KEY_ITEM,\nITEM_KNOCKOUT,\nITEM_MTERIAL_REF_NEEDED,\nITEM_MFG_WARRANTY,\nITEM_NUMBER,\nITEM_PHOTO,\nITEM_PRODUCT_DEPTH_IN,\nITEM_PRODUCT_DEPTH_MM,\nITEM_PRODUCT_HEIGHT_IN,\nITEM_PRODUCT_HEIGHT_MM,\nITEM_PRODUCT_PAGE_URL,\nITEM_PRODUCT_WIDTH_IN,\nITEM_PRODUCT_WIDTH_MM,\nITEM_RETAIL_BRAND_NAME,\nITEM_RETAIL_TYPE,\nITEM_ROLL_OVERIMAGE,\nITEM_SALES_CATEGORY_CODE,\nITEM_SCENE7_IMAGE_SET,\nITEM_SEATS,\nITEM_SERIES_NAME,\nITEM_SERIES_NUMBER,\nITEM_STAND_ALONE_FLAG,\nITEM_STATUS,\nITEM_STATUS_CHANGED,\nITEM_SUPP_DT_SHIP_ONLY,\nITEM_SUPP_WET_NET_WET_KG,\nITEM_SUPP_WET_NET_WET_LBS,\nITEM_THIRD_PARTY_ITEM,\nITEM_TRACKING_PIECE,\nITEM_TRADEMARK_TEXT,\nITEM_TYPE,\nITEM_UNIT_WEIGHT_KG,\nITEM_UNIT_WEIGHT_LBS,\nITEM_UPC,\nITEM_VALIDATION_COMPLETE,\nITEM_WHOLESALE_ASM_VIDEO1,\nITEM_AFI_FEATURE_BULLET1,\nITEM_AFI_FEATURE_BULLET2,\nITEM_AFI_FEATURE_BULLET3,\nITEM_AFI_FEATURE_BULLET4,\nITEM_AFI_FEATURE_BULLET5,\nITEM_AFI_FEATURE_BULLET6,\nITEM_AFI_FEATURE_BULLET7,\nITEM_CONSUMER_DESCRIPTION,\nITEM_FLUFF_AFI,\nITEM_FLUFF_PRINT,\nITEM_FRIENDLY_DESCRIPTION,\nITEM_HOMESTORE_FT_BULLET1,\nITEM_HOMESTORE_FT_BULLET2,\nITEM_HOMESTORE_FT_BULLET3,\nITEM_HOMESTORE_FT_BULLET4,\nITEM_HOMESTORE_FT_BULLET5,\nITEM_HOMESTORE_FT_BULLET6,\nITEM_HOMESTORE_FT_BULLET7,\nITEM_HOMESTORE_FT_BULLET8,\nITEM_HOMESTORE_ITEM_FLUFF,\nSERIES_ASHLEY_HOMESTORE,\nSERIES_CORP_ONLINE_SELLNG,\nSERIES_DIVISION,\nSERIES_EXCLUSIVE_COMMENT,\nSERIES_FEATURES,\nSERIES_ID,\nSERIES_INTERNATIONAL_HS,\nSERIES_INTRO_DATE,\nSERIES_MAIN_IMAGE,\nSERIES_NAME,\nSERIES_NUMBER,\nSERIES_RETAIL_SALES_CATEG,\nSERIES_SHOWROOM,\nSERIES_SOURCE_ID,\nSERIES_STATUS,\nSERIES_STYLE,\nSERIES_THIRD_PARTY,\nSERIES_PRIMARY,\nITEM_UOM_KEY,\nITEM_SHIPPABLE_UOM_KEY,\nITEM_ELIG_PROTECTION_PLAN,\nITEM_IS_PROTECTION_PLAN,\nITEM_ASHCOMM_DLVR_MODE,\nITEM_MATERIAL,\nITEM_HS_PRODUCT_LINE,\nITEM_ECOM_MERCHANT_NOTES,\nITEM_AMAZON_BRAND_OWNER,\nITEM_LIFESTYLE_DESC,\nITEM_HTS_CODE,\nB_UPDDATE,\nB_CREDATE,\n'Semadmin' AS B_CREATOR,\n'Semadmin' AS B_UPDATOR,\nB_CLASSNAME,\n           ROW_NUMBER() OVER (PARTITION BY PRODUCT_MAIN_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_PRODUCT_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_ProductPackage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select * FROM (\nSELECT \nPACKAGE_ID,\nPACKAGE_KEY,\nHOMESTORE_PACKAGE_ID,\nLAST_MOD_DATE_TIME_UTC,\nCREATED_DATE_TIME_UTC,\nPACKAGE_NUMBER,\nPACKAGE_ALTER_NAME,\nPACKAGE_HERO,\nPACKAGE_STATUS,\nPACKAGE_STATUS_CHANGED,\nPACKAGE_IS_THIRD_PARTY,\nPACKAGE_HOMESTORE_ID,\nPACKAGE_WHOLESALE_ID,\nPACKAGE_RETAIL_TYPE,\nPACKAGE_ITEM_QUANTITY,\nPACKAGE_UOM,\nPACKAGE_COLOR,\nPACKAGE_KNOCKOUT,\nPACKAGE_SCENE7_IMAGE_SET,\nPACKAGE_VALIDAT_COMPLETE,\nPACKAGE_VALIDATION_NOTES,\nPACKAGE_ROLLOVER_IMAGE,\nPACKAGE_EXPRESS_SHIP,\nPACKAGE_SUPP_DT_SHIP_ONLY,\nPACKAGE_SALES_CATEG_CODE,\nPACKAGE_SERIES_NUMBER,\nPACKAGE_SERIES_NAME,\nPACKAGE_CODE,\nPACKAGE_ASHCOM_TRANSITION,\nPACKAGE_SWATCH_GROUP_ID,\nPACKAGE_DEFAULT_PRODUCT,\nPACKAGE_NEW_FLAG_DATE,\nPACKAGE_ASHCOMM_DLVR_MODE,\nPACKAGE_CHANNEL_CHANGE,\nPACKAGE_EXCLUSIVE,\nPACKAGE_HOT_SPOTS_REVIEW,\nPACKAGE_ALT_DESC1,\nPACKAGE_ASH_TTL_OVERRIDE,\nPACKAGE_HIDDEN_FIELD,\nPACKAGE_CONSUMER_CHOICE,\nPACKAGE_TOTAL_ASM_TIME,\nPACKAGE_ASHCOMM_FLAGS,\nPACKAGE_NAVIGABLE_CATEG,\nPACKAGE_NAME,\nPACKAGE_HS_PACKAGE_FLUFF,\nPACKAGE_AFI_BULLETS1,\nPACKAGE_AFI_BULLETS2,\nPACKAGE_AFI_BULLETS3,\nPACKAGE_AFI_BULLETS4,\nPACKAGE_AFI_BULLETS5,\nPACKAGE_AFI_BULLETS6,\nPACKAGE_HOMESTORE_BULLET1,\nPACKAGE_HOMESTORE_BULLET2,\nPACKAGE_HOMESTORE_BULLET3,\nPACKAGE_HOMESTORE_BULLET4,\nPACKAGE_HOMESTORE_BULLET5,\nPACKAGE_HOMESTORE_BULLET6,\nPACKAGE_AFI_FLUFF,\nB_CREDATE,\nB_UPDDATE,\n'Semadmin' AS B_CREATOR,\n'Semadmin' AS B_UPDATOR,\nB_CLASSNAME,\n           ROW_NUMBER() OVER (PARTITION BY PACKAGE_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_PRODUCT_PACKAGE WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_PACKAGE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_KitComponentCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load_Retail_PIM_EDWProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\r\n'semadmin' AS B_CREATOR,\r\n'ProductPackageCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_PKG_CROSSWALK_ID,\r\nPRODUCT_SOURCE_ID,\r\nPRODUCT_TYPE,\r\nPACKAGE_SOURCE_ID,\r\nF_PRODUCT_ID,\r\nF_PACKAGE_ID,\r\nB_CREDATE,\r\nB_UPDDATE\r\nFROM SA_PRODUCT_PACKAGE_CROSSWALK",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_PACKAGE_CROSSWALK",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'semadmin' AS B_CREATOR,\r\n'ProductKitCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_KIT_CROSSWALK_ID,\r\nPRODUCT_SOURCE_ID,\r\nPRODUCT_TYPE,\r\nKIT_SOURCE_ID,\r\nF_PRODUCT_MAIN_ID,\r\nF_KIT_ID,\r\nB_CREDATE,\r\nB_UPDDATE\r\nFROM SA_PRODUCT_KIT_CROSSWALK\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_KIT_CROSSWALK",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Remove_PostalCode_ReferenceDataLoad_RetailCustomer_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Enterprise_ReferenceMaster'\n,@P_PROGRAM_NAME = 'EnterpriseRefPostalCodeLoad'\n,@P_LOAD_DESCRIPTION = 'EnterpriseRefPostalCodeLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_POSTAL_CODE_REMOVE_RECORDS]",
							"storedProcedureParameters": {
								"COUNTRY": {
									"value": {
										"value": "US",
										"type": "Expression"
									},
									"type": "String"
								},
								"LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Enterprise_ReferenceMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "EnterpriseRefPostalCodeLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_POSTAL_CODE_REMOVE_RECORDS]",
							"storedProcedureParameters": {
								"COUNTRY": {
									"value": {
										"value": "CA",
										"type": "Expression"
									},
									"type": "String"
								},
								"LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Enterprise_ReferenceMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_US_RemovePostalCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CA_RemovePostalCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "US_RemovePostalCode_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_POSTAL_CODE_MASTER",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CA_RemovePostalCode_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_POSTAL_CODE_MASTER",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as Count FROM [RetailCustomer].[IncrementalLoadCommPrefEmail] WITH(NOLOCK)\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as Count FROM [RetailCustomer].[IncrementalLoadCommPrefPhone] WITH(NOLOCK)\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(greater(activity('Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate').output.firstRow.Count,0),greater(activity('Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate').output.firstRow.Count,0))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Masterdata_CDP_Count_Data_Not_Found_Logs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_CDP_Customer_Prefrence_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT EmailAddress AS RAW_EMAIL_ADDRESS,\nCAST(OptedIn as bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nEmailCommunicationId AS EMAIL_COMMUNICATION_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [RetailCustomer].[IncrementalLoadCommPrefEmail] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "Byte[]",
														"physicalType": "varbinary"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Masterdata_CDP_preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT PhoneNumber AS RAW_PHONE_NUMBER,\nCAST(OptedIn AS Bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nPhoneCommunicationId AS PHONE_COMM_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [RetailCustomer].[IncrementalLoadCommPrefPhone] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Masterdata_CDP_preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_PHONE",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'CommunicationPreferenceLoad'\n,@P_LOAD_DESCRIPTION = 'CommunicationPreferenceLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "GetMaxCustPrefMasterID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "CommunicationPreferenceLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Delete_Prefrence_Incremental_data",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[RetailCustomer].[usp_ArchiveDeleteIncrementalPreferenceLoad]",
										"storedProcedureParameters": {
											"MaxId_CustPrefMasterID": {
												"value": {
													"value": "@activity('GetMaxCustPrefMasterID').output.firstRow.MAXCustPrefMasterID",
													"type": "Expression"
												},
												"type": "Int32"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_EMAIL",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Fail_PHONE",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "GetMaxCustPrefMasterID",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": "SELECT ISNULL(MAX(CustPrefMasterID),'0') AS MAXCustPrefMasterID FROM RcmPrefsSubscriber.customer_preferences ",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "RcmPrefsSubscriber",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "SD_Cancel_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Check_Count",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_CommunicationPreferenceLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get_Email_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Get_Phone_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'CommunicationPreferenceLoad'\n,@P_LOAD_DESCRIPTION = 'CommunicationPreferenceLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Check_Phone_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "CommunicationPreferenceLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get_Email_Chunk",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select top 1 Id,ChunkNumber,TableName,Organization\nfrom Masterdata_CDP.PreferenceInitialLoadChunks with(nolock)\nwhere isloaded = 0 and ProcessedDate is NULL and channel ='email'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Email_Chunk",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get_Phone_Chunk",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select top 1 Id,ChunkNumber,TableName,Organization\nfrom Masterdata_CDP.PreferenceInitialLoadChunks with(nolock)\nwhere isloaded = 0 and ProcessedDate is NULL and channel = 'SMS'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Get_Phone_Chunk",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Email_Chunk",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@contains(activity('Get_Email_Chunk').output,'firstRow')",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "No_Data_Available_For_Email",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT EmailAddress AS RAW_EMAIL_ADDRESS,\nCAST(OptedIn as bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nEmailCommunicationId AS EMAIL_COMMUNICATION_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [Masterdata_CDP].[InitialLoadCommPrefEmail] WITH(NOLOCK) WHERE ChunkNumber = @{activity('Get_Email_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Email_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Email_Chunk').output.firstRow.Organization}' and channel = 'email'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "Byte[]",
														"physicalType": "varbinary"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "InitialLoad_CommPref",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Failed_Email",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Update_Email_Chunk",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "Update a set ProcessedDate = getdate() , isloaded = 1\nfrom Masterdata_CDP.PreferenceInitialLoadChunks a with(nolock)\nWHERE ChunkNumber = @{activity('Get_Email_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Email_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Email_Chunk').output.firstRow.Organization}' and channel = 'email';\nselect 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Update_Email_Chunk",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "Check_Phone_Chunk",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Check_Email_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@contains(activity('Get_Phone_Chunk').output,'firstRow')",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "No_Data_Available_For_Phone",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT PhoneNumber AS RAW_PHONE_NUMBER,\nCAST(OptedIn AS Bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nPhoneCommunicationId AS PHONE_COMM_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [Masterdata_CDP].[InitialLoadCommPrefPhone] WITH(NOLOCK) WHERE ChunkNumber = @{activity('Get_Phone_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Phone_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Phone_Chunk').output.firstRow.Organization}' and channel = 'SMS'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "InitialLoad_CommPref",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_PHONE",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Failed_Phone",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Update_Phone_Chunk",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "Update a set ProcessedDate = getdate() , isloaded = 1\nfrom Masterdata_CDP.PreferenceInitialLoadChunks a with(nolock)\nWHERE ChunkNumber = @{activity('Get_Phone_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Phone_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Phone_Chunk').output.firstRow.Organization}' and channel = 'SMS';\nselect 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Phone_Chunk",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_Crosswalk')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "TRUNCATE TABLE [dbo].[CrossWalk_MD_OUT]",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHGRP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MATCHGRP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_CUSTOMER_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "RETAIL_CUSTOMER_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CONFIRMEDSDPK",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_CONFIRMEDSDPK",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "masterdata_CDP_CrossWalk_MD_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "retailCustomer_dbo_CrossWalk_MD_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "TRUNCATE TABLE [dbo].[CrossWalk_DU_OUT]",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHRULE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_MATCHRULE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MATCHSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "masterData_CDP_CrossWalk_DU_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "RetailCustomer_CrossWalk_DU_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Retail_Customer_Crosswalk_MD_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Retail_Customer_CrossWalk_MD_OUT').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": "Source is Crosswalk MD Table Data",
								"Source_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_MD_fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Retail_Customer_Crosswalk_MD_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Retail_Customer_CrossWalk_MD_OUT').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_DU_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Retail_Customer_CrossWalk_DU_OUT').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": "Source is Crosswalk DU Table Data",
								"Source_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_DU_fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Retail_Customer_Crosswalk_DU_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Retail_Customer_CrossWalk_DU_OUT').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT_ErrorLogS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Check_CustomerInfo_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Data_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Data_Count').output.firstRow.COUNT ,'0'))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": "No RAW Data Available For AllSourceCustomers",
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Get_Max_CustomerMasterID",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Get_All_Max_rcm_CustomerMasterID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_RetailCustomers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nDO_NOT_SELL \nFROM RetailCustomer.RetailCustomersIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "DO_NOT_SELL",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "DO_NOT_SELL",
														"type": "Boolean",
														"physicalType": "bit"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "RetailCustomers_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.message}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_RetailCustomers').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_RETAIL_CUSTOMER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.RetailCustomersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_RetailCustomers",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_RetailCustomers').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_RetailCustomers').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_RetailCustomers').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_RetailCustomers').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_RetailCustomers",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_RetailCustomers",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_RetailCustomers').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_RetailCustomers').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Customer_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_RETAIL_CUSTOMER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.RetailCustomersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Load_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM RetailCustomer.EmailAddressesIncremental \nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "EmailAddresses_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_EmailAddresses').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_EMAIL_ADDRESS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.EmailAddressesIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_EmailAddresses",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_EmailAddresses').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_EmailAddresses').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_EmailAddresses').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_EmailAddresses').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "EmailAddresses_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_EMAIL_ADDRESS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.EmailAddressesIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_EmailAddresses",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_EmailAddresses",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_EmailAddresses').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_EmailAddresses').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM RetailCustomer.PhoneNumbersIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "PhoneNumbers_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_PhoneNumbers').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_PHONE_NUMBER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.PhoneNumbersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_PhoneNumbers",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_PhoneNumbers').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_PhoneNumbers').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_PhoneNumbers').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_PhoneNumbers').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "PhoneNumbers_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_PHONE_NUMBER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.PhoneNumbersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_PhoneNumbers",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_PhoneNumbers",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_PhoneNumbers').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_PhoneNumbers').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM RetailCustomer.AddressLocationsIncremental\nWITH(NOLOCK) WHERE customerMasterId<='@{activity('Get_Max_CustomerMasterID').output.firstRow.MAX_ID}'\n",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "AddressLocations_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_AddressLocations').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_ADDRESS_LOCATION",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.AddressLocationsIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_AddressLocations",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_AddressLocations').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_AddressLocations').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_AddressLocations').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_AddressLocations').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "AddressLocations_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_ADDRESS_LOCATION",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.AddressLocationsIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_AddressLocations",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_AddressLocations",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_AddressLocations').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_AddressLocations').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_RetailCustomers_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_EmailAddresses_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_PhoneNumbers_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_AddressLocations_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Get_Max_CustomerMasterID",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": "select MAX(customerMasterId) as MAX_ID FROM [Masterdata_CDP].[AllSourceCustomers] WITH(NOLOCK)",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "All_Max_CustomerMasterId_CustomerInfo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Get_All_Max_rcm_CustomerMasterID",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": "SELECT * FROM [RcmCustSubscriber].[all_max_customer_id]",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "All_Max_CustomerMasterId_CustomerInfo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "archive_and_delete_customer_record",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[RetailCustomer].[archive_and_delete_customer_record]",
										"storedProcedureParameters": {
											"MaxId_AddressLocations": {
												"value": {
													"value": "@activity('Get_All_Max_rcm_CustomerMasterID').output.firstRow.AddressLocations",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"MaxId_AllCustomer": {
												"value": {
													"value": "@activity('Get_Max_CustomerMasterID').output.firstRow.MAX_ID",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"MaxId_EmailAddresses": {
												"value": {
													"value": "@activity('Get_All_Max_rcm_CustomerMasterID').output.firstRow.EmailAddresses",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"MaxId_PhoneNumbers": {
												"value": {
													"value": "@activity('Get_All_Max_rcm_CustomerMasterID').output.firstRow.PhoneNumbers",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"MaxId_RetailCustomer": {
												"value": {
													"value": "@activity('Get_All_Max_rcm_CustomerMasterID').output.firstRow.RetailCustomer",
													"type": "Expression"
												},
												"type": "Int32"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "Get_Data_Count",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT COUNT(1) AS [COUNT] FROM [RetailCustomer].[RetailCustomersIncremental]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_RetailCustomerLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Initial_Load_RetailCustomers",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "usp_PreLoad_DROP_SD_Indexes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\nB_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE\nFROM Masterdata_CDP.RetailCustomerInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWFIRSTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWLASTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWMIDDLENAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_RETAIL_CUSTOMER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_PhoneNumber",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_RetailCustomers",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.PhoneNumbersInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPHONENUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersPhoneInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_PHONE_NUMBER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_EmailAddresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_PhoneNumber",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.EmailAddressesInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWEMAILADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersEmailInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_EMAIL_ADDRESS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_Addresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_EmailAddresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.AddressLocationsInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTREETADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STREET_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESSLINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATEORPROVINCECODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_OR_PROV_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWZIPOSTALCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ZIP_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRYCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersAddress",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_ADDRESS_LOCATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_InitialLoadRetail",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_PreSemarchy_ADD_SD_Indexes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailCustomerLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadId')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_InitialLoadRetail",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Masterdata_CDP].[usp_InitialLoadRetail]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_PreLoad_DROP_SD_Indexes",
						"description": "Drop SD table index",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_PreLoad_DROP_SD_Indexes]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_CustomerMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_PreSemarchy_ADD_SD_Indexes",
						"description": "Add indexing in SD table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Initial_Load_Addresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_PreSemarchy_ADD_SD_Indexes]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_CustomerMaster",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_ExternalRefCountry')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'ExternalRefCountryLoad'\n,@P_LOAD_DESCRIPTION = 'External Ref Country Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "External_Ref_Country",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ExternalRefCountryLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "External_Ref_Country",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[EXT_REF_COUNTRY_ID]\n       ,'ExternalRefCountry' as B_CLASSNAME\n      ,[COUNTRY_CODE_A2]\n      ,[COUNTRY_CODE_A3]\n      ,[COUNTRY_NAME]\n      ,[COUNTRY_LOCAL_NAME]\n      ,[COUNTRY_UN_CODE]\n  FROM [ISO].[countrycode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "EXT_REF_COUNTRY_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "EXTERNAL_REF_COUNTRY_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE_A2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE_A2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE_A3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE_A3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_LOCAL_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_LOCAL_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_UN_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_UN_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ISO_CountryCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_EXTERNAL_REF_COUNTRY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_ExternalRefUSState')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'ExternalRefUSStateLoad'\n,@P_LOAD_DESCRIPTION = 'External Ref US State Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "External_Ref_US_State",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ExternalRefUSStateLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "External_Ref_US_State",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,'ExternalRefUSState' as B_CLASSNAME\n      ,[EXT_REF_US_STATE_ID]\n      ,[STATE_CODE]\n      ,[STATE_NAME]\n  FROM [ISO].[statecode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "EXT_REF_US_STATE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "EXTERNAL_REF_US_STATE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ISO_StateCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_EXTERNAL_REF_US_STATE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_LegalEntityLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SiteLegalEntityOWNER",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteLegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "Loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_SOURCEID,\nB_PUBID,\nB_CREDATE,\nOWNER_FIRST_NAME,\nOWNER_LAST_NAME,\nRAW_OWNER_PHONE,\nRAW_CONTACT_EMAIL,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY_OWNER WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteLegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT SITE_LEGAL_ENTITY_ID,\nB_PUBID,\nB_CLASSNAME,\nB_CREDATE,\nSITE_LEGAL_ENTITY_NAME,\nRAW_SITE_ADDRESS_LINE1,\nRAW_SITE_ADDRESS_LINE2,\nRAW_SITE_CITY,\nRAW_SITE_STATE_CODE,\nRAW_SITE_POSTAL_CODE,\nRAW_SITE_COUNTRY_CODE,\nSITE_LEGAL_ENTITY_TYPE,\nF_SITE_LEGAL_ENTITY,\nFD_SITE_LEGAL_ENTITY,\nROW_NUMBER() OVER (PARTITION BY SITE_LEGAL_ENTITY_ID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'LegalEntityLoad'\r\n,@P_LOAD_DESCRIPTION = 'LegalEntityLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteLegalEntityOWNER",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "LegalEntityLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Site_Master"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_SiteMasterLoad_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteMainView",
						"description": "select all data from DACJSONLoadSiteMain view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select \nB_PUBID,\nB_SOURCEID,\n'SiteMain' as B_CLASSNAME,\nSITE_NAME,\nSITE_TYPE,CAST(IS_Active as bit) IS_Active,\nSITE_DESCRIPTION,\nOWNERSHIP_TYPE,\nADDRESS_LINE1 ,\nADDRESS_LINE2 ,\nCITY ,\nSTATE_CODE ,\nPOSTAL_CODE ,\nCOUNTRY_CODE ,\nRAW_MAIN_PHONE ,\nRAW_FAX \nfrom Retail.DACIncrementalSiteMain \n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IS_Active",
											"physicalType": "int"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE1",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE2",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MAIN_PHONE",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME"
										},
										"sink": {
											"name": "B_CLASSNAME"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select \nNEWID() AS SITE_CONTENT_ID,\n'SiteContent' AS B_CLASSNAME,\nCONTENT_CATEGORY,\nCONTENT_TYPE,\nCONVERT(nvarchar(128),[CONTENT_SHORT_TEXT]) AS [CONTENT_SHORT_TEXT],\nCONTENT_LONG_TEXT,\nCONTENT_LANGUAGE,\nFP_SITE_MAIN,\nFS_SITE_MAIN\nfrom Retail.DACIncrementalSiteContent",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"CONTENT_TYPE"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId"
										},
										"sink": {
											"name": "B_LOADID",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"scale": 6
										}
									},
									{
										"source": {
											"name": "CONTENT_CATEGORY"
										},
										"sink": {
											"name": "CONTENT_CATEGORY"
										}
									},
									{
										"source": {
											"name": "CONTENT_TYPE"
										},
										"sink": {
											"name": "CONTENT_TYPE"
										}
									},
									{
										"source": {
											"name": "CONTENT_SHORT_TEXT"
										},
										"sink": {
											"name": "CONTENT_SHORT_TEXT"
										}
									},
									{
										"source": {
											"name": "CONTENT_LONG_TEXT"
										},
										"sink": {
											"name": "CONTENT_LONG_TEXT"
										}
									},
									{
										"source": {
											"name": "CONTENT_LANGUAGE"
										},
										"sink": {
											"name": "CONTENT_LANGUAGE"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN"
										},
										"sink": {
											"name": "FP_SITE_MAIN"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN"
										},
										"sink": {
											"name": "FS_SITE_MAIN"
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID"
										},
										"sink": {
											"name": "SITE_CONTENT_ID"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME"
										},
										"sink": {
											"name": "B_CLASSNAME"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select \nNEWID() AS SITE_DEFAULT_HOURS_ID,\n'SiteDefaultHours' AS B_CLASSNAME,\nSITE_HOURS_TYPE,\nDAY_OF_WEEK,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN\nfrom Retail.DACIncrementalSiteDefaultHours",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"SITE_HOURS_TYPE",
										"DAY_OF_WEEK"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId"
										},
										"sink": {
											"name": "B_LOADID",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"scale": 6
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK"
										},
										"sink": {
											"name": "DAY_OF_WEEK"
										}
									},
									{
										"source": {
											"name": "START_TIME"
										},
										"sink": {
											"name": "START_TIME"
										}
									},
									{
										"source": {
											"name": "END_TIME"
										},
										"sink": {
											"name": "END_TIME"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN"
										},
										"sink": {
											"name": "FP_SITE_MAIN"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN"
										},
										"sink": {
											"name": "FS_SITE_MAIN"
										}
									},
									{
										"source": {
											"name": "SITE_DEFAULT_HOURS_ID"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOURS_ID"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME"
										},
										"sink": {
											"name": "B_CLASSNAME"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteMain",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteMainView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteMainView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteMainView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteMainView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteMainView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteMainView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteMain",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteMainView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteMainView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteMainView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteMainView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteMain_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteContent",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteContentView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_CONTENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteContent",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteContent",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteContentView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteContentView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteContent_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteDefaultHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteDefaultHoursView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteDefaultHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteDefaultHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteDefaultHoursView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteDefaultHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Site_Master"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_SiteMasterLoad_DAC_initialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteMainView",
						"description": "select all data from DACJSONLoadSiteMain view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT \nB_CLASSNAME,\nB_PUBID,\nB_SOURCEID,\nB_CREDATE,\nSITE_NAME,\nSITE_TYPE,\nISACTIVE,\nSITE_DESCRIPTION,\nSITE_OWNERSHIP_TYPE,\nADDRESS_STATUS_CODE,\nADDRESS_ERROR_CODE,\nRAWADDRESS_LINE1,\nRAWADDRESS_LINE2,\nRAWCITY,\nRAWSTATE_CODE,\nRAWPOSTAL_CODE,\nRAWCOUNTRY_CODE,\nSTASTREET_NAME,\nSTASTREET_NUMBER,\nSTACITY,\nSTASTATE_CODE,\nSTAPOSTAL_CODE,\nSTACOUNTRY_CODE,\nSTALATITUDE,\nSTALONGITUDE,\nOPERATIONS_START_DATE,\nOPERATIONS_END_DATE,\nCUSTOMER_OPEN_DATE,\nCUSTOMER_CLOSE_DATE,\nLOCAL_CURRENCY_CODE,\nLOCAL_UNIT_OF_MEASURE_ARE,\nTOTAL_SITE_AREA,\nOPERATIONS_SITE_AREA,\nCUSTOMER_SITE_AREA,\nSITE_SHIP_TO,\nRAW_MAIN_PHONE,\nSTD_MAIN_PHONE,\nMAIN_PHONE_STATUS_CODE,\nRAW_FAX,\nSTD_FAX,\nFAX_STATUS_CODE,\nRAW_CS_PHONE,\nSTD_CS_PHONE,\nCS_PHONE_STATUS_CODE,\nRAW_CS_EMAIL,\nVLD_CS_EMAIL,\nRAW_SALES_PHONE,\nSTD_SALES_PHONE,\nSALES_PHONE_STATUS_CODE,\nRAW_SALES_CHAT,\nRAW_SERVICE_PHONE,\nSTD_SERVICE_PHONE,\nSERVICE_PHONE_STATUS_CODE,\nRAW_SERVICE_CHAT,\nFP_WAREHOUSE_PARENT,\nFS_WAREHOUSE_PARENT,\nLICENSED_TERRITORY,\nDISTRICT_MANAGER,\nSTORE_MODEL,\nTUA_EXPIRATION_DATE,\nF_SITE_LEGAL_ENTITY,\nSTORE_PROSPECT_ID,\nNUMBER_OF_DOCK_DOORS,\nPRIMARY_PROFIT_CENTER,\nRETAIL_SYSTEMS_NUMBER,\nGOOGLE_ID,\nLEGACY_STORE_NUMBER,\nLEGACY_ERP_DATABASE_NAME,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\r\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nCONTENT_CATEGORY,\nCONTENT_TYPE,\nCONTENT_SHORT_TEXT,\nCONTENT_LONG_TEXT,\nCONTENT_LANGUAGE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CONTENT_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CONTENT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CONTENT WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"CONTENT_TYPE"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nDAY_OF_WEEK,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_DEFAULT_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_DEFAULT_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_DEFAULT_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"SITE_HOURS_TYPE",
										"DAY_OF_WEEK"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteProgramView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteCustomeHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nCUSTOM_HOURS_REASON,\nSITE_DATE,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CUSTOM_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CUSTOM_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CUSTOM_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Custome_Hours",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteProgramView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteCustomeHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nPROGRAM_NAME,\nPROGRAM_START_DATE,\nPROGRAM_END_DATE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_PROGRAM_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_PROGRAM_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_PROGRAM WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Site_Program",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Site_Master"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_SiteMasterLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SD_SiteOwner",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "WITH CTE AS(\n\nSELECT OWNER_NAME,\nOWNER_ADDRESS,\nOWNER_CITY,\nOWNER_STATE,\nOWNER_POSTAL_CODE,\nCOUNTRY_CODE,\nB_SOURCE_ID,\n--ROW_NUMBER() OVER(PARTITION BY B_SOURCE_ID ORDER BY OWNER_NAME,OWNER_ADDRESS DESC) AS RNK\nrank() over(partition by B_Source_ID order by ltrim(rtrim(OWNER_NAME))) as rnk\nFROM  [Retail].[InitialLoadSiteOwner]\n)\nSELECT  DISTINCT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID,\n      [OWNER_NAME] AS OWNER_NAME\n      ,[OWNER_ADDRESS] AS RAWADDRESS_LINE1\n      ,[OWNER_CITY] AS RAWCITY\n      ,[OWNER_STATE] AS RAWSTATE_CODE\n      ,[OWNER_POSTAL_CODE] AS RAWPOSTAL_CODE\n\t,'INITIALLOAD' as [B_PUBID]\n\t,'SiteOwner' AS B_CLASSNAME\n\t, B_Source_ID AS [B_SOURCEID]\n       ,Country_Code as RAWCOUNTRY_CODE FROM CTE WHERE RNK=1 ",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SD_SITE_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'Site Master Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_SiteContact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SD_SiteMain",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteMain_RDC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \n      @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[SITE_NAME] AS SITE_NAME\n      ,[SITE_TYPE] AS SITE_TYPE\n      ,CONVERT(BIT, (CASE WHEN [IS_ACTIVE] ='NULL' THEN 0 ELSE CAST([IS_ACTIVE] AS BIT) END)) as ISACTIVE\n      ,[SITE_DESCRIPTION] AS SITE_DESCRIPTION\n      ,[OWNERSHIP_TYPE] AS SITE_OWNERSHIP_TYPE\n      ,[B_SOURCE_ID] AS B_SOURCEID\n      ,[ADDRESS_LINE1] AS RAWADDRESS_LINE1\n      ,[ADDRESS_LINE2] AS RAWADDRESS_LINE2\n      ,[CITY] AS RAWCITY\n      ,[STATE_CODE] AS RAWSTATE_CODE\n      ,[POSTAL_CODE] AS RAWPOSTAL_CODE\n      ,[COUNTRY_CODE] AS RAWCOUNTRY_CODE\n\t  ,[LOCAL_CURRENCY_CODE]\n      ,[LOCAL_UNIT_OF_MEASURE_AREA]\n      ,CAST(OPERATIONS_START_DATE AS DATE) AS OPERATIONS_START_DATE\n      ,CAST(CUSTOMER_OPEN_DATE AS DATE) AS CUSTOMER_OPEN_DATE\n      ,CONVERT(decimal(12,4),CONVERT(float,CUSTOMER_SITE_AREA)) AS CUSTOMER_SITE_AREA\n\t,'INITIALLOAD' AS B_PUBID\n\t,'SiteMain' as B_CLASSNAME\n\t,FS_SITE_OWNER as [FS_SITE_OWNER]\n\t,'INITIALLOAD' AS [FP_SITE_OWNER]\n\t,FP_WAREHOUSE_PARENT as [FP_WAREHOUSE_PARENT]\n\t,FS_WAREHOUSE_PARENT AS [FS_WAREHOUSE_PARENT]\n  FROM [Retail].[InitialLoadSiteMain]    \nWHERE FS_SITE_OWNER IS NOT NULL AND COUNTRY_CODE in ('USA','United States') AND [B_SOURCE_ID] IS NOT NULL",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SD_SiteMain_RDC",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteOwner",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[B_SOURCE_ID]\n      ,[SITE_NAME]\n      ,[SITE_TYPE]\n      ,CONVERT(BIT, (CASE WHEN [IS_ACTIVE] ='NULL' THEN 0 ELSE CAST([IS_ACTIVE] AS BIT) END)) AS ISACTIVE\n      ,[SITE_DESCRIPTION]\n      ,[OWNERSHIP_TYPE]\n      ,[ADDRESS_LINE1]\n      ,[CITY]\n      ,[STATE_CODE]\n      ,[POSTAL_CODE]\n      ,[COUNTRY_CODE]\n      ,[LOCAL_CURRENCY_CODE]\n      ,[LOCAL_UNIT_OF_MEASURE_AREA]\n      ,CASE WHEN OPERATIONS_SITE_AREA='?' THEN NULL ELSE  CONVERT(decimal(16,4),  convert(float,replace([OPERATIONS_SITE_AREA],',','') )) \n\t  END AS OPERATIONS_SITE_AREA\n      ,[FS_SITE_OWNER]\n\t  ,'INITIALLOAD' AS B_PUBID\n\t,'SiteMain' as B_CLASSNAME\n  ,'INITIALLOAD' AS [FP_SITE_OWNER]\n  FROM [Retail].[InitialLoadSiteMainRDC] WHERE RNK=1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 16
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SA_SiteContact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteMain",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT   @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n       ,FP_SITE_MAIN\n      ,NEWID() AS [Site_Contact_ID]\n      ,[CONTACT_FIRST_NAME]\n      ,[CONTACT_LAST_NAME]\n      ,[RAW_CONTACT_PHONE]\n      ,[RAW_CONTACT_EMAIL]\n      ,[SITE_CONTACT_TYPE]\n      ,[FS_SITE_MAIN]\n\t,'SiteContact' as B_CLASSNAME\nFROM [Retail].[InitialLoadSiteContact]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Site_Contact_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTACT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTACT_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTACT_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTACT_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTACT_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_CONTACT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_CONTACT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_SITE_CONTACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_SitesLegalEntitiesLoad_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SA_LEGAL_ENTITIES",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntities' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\nid AS ID,\nname AS NAME,\ntype AS TYPE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID\nFROM Retail.v_LegalEntities WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_v_LegalEntities",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITIES",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_POC'\n,@P_PROGRAM_NAME = 'SitesLegalEntitiesLoad'\n,@P_LOAD_DESCRIPTION = 'SitesLegalEntitiesLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SA_SITES",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SA_LEGAL_ENTITIES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Sites' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\nid AS ID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUM,\nship_to_num AS SHIP_TO_NUM,\nname AS NAME,\nnotes AS NOTES,\nmodel AS MODEL,\nversion AS VERSION,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\ntime_zone AS TIME_ZONE,\nlocal_currency_code AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM,\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nlegacy_erp_system_name AS LEGACY_ERP_SYSTEM_NAME,\nlegacy_erp_database_name AS LEGACY_ERP_DATABASE_NAME,\nlegacy_operation_id AS LEGACY_OPERATION_ID,\nprimary_profit_center AS PRIMARY_PROFIT_CENTER,\nlegacy_location_id AS LEGACY_LOCATION_ID,\nos_id AS OS_ID,\nos_location_id AS OS_LOCATION_ID,\ngoogle_id AS GOOGLE_ID,\ntraffic_system_id AS TRAFFIC_SYSTEM_ID,\ncast(comp_flag as bit) AS COMP_FLAG,\ncast(enterprise_flag as bit) AS ENTERPRISE_FLAG,\nprospect_id AS PROSPECT_ID,\nlegal_entity_id AS F_LEGAL_ENTITY_ID,\ntua_expiration_date AS TUA_EXPIRATION_DATE,\nlic_territory AS LICENSED_TERRITORY,\ndma_id AS DMA_ID,\ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nship_to_number_ref AS SHIP_TO_NUM_REF\nFROM Retail.v_Sites WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LEGACY_ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_OPERATION_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "LEGACY_OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 9
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM_REF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM_REF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_v_Sites",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_v_Sites_to_SA_SITES",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_SITES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SitesLegalEntitiesLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SA_LEGAL_ENTITIES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_LEGAL_ENTITIES",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SA_LEGAL_ENTITIES').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITIES",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_LegalEntities",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SA_LEGAL_ENTITIES",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SA_LEGAL_ENTITIES",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SA_LEGAL_ENTITIES').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SA_LEGAL_ENTITIES').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SA_LEGAL_ENTITIES').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SA_LEGAL_ENTITIES').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SA_LEGAL_ENTITIES_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_LEGAL_ENTITIES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SA_LEGAL_ENTITIES').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SA_SITES_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_SITES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SA_SITES').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SA_SITES').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SA_SITES').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SA_SITES').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SA_SITES').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SA_SITES').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SA_SITES').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SA_SITES').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SA_SITES",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SA_SITES",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SA_SITES').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SA_SITES').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SA_SITES').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SA_SITES').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SA_SITES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_SITES",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SA_SITES').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SA_SITES').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SA_SITES').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SA_SITES').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITES",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SA_SITES').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_Sites",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SA_SITES').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Site_Master"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/MasterData_Validation_Flow')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Customer_Fake_Address",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "FakeAddressPhrase",
											"type": "String"
										},
										"sink": {
											"name": "FakeAddressPhrase",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Address_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Address",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Address_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Address",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AddressLine1",
											"type": "String"
										},
										"sink": {
											"name": "AddressLine1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Zipcode",
											"type": "String"
										},
										"sink": {
											"name": "Zipcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Address_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Address_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_Schema_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Email",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Address_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "FakeEmailPhrase",
											"type": "String"
										},
										"sink": {
											"name": "FakeEmailPhrase",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Email_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Email",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Email_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Email",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Email",
											"type": "String"
										},
										"sink": {
											"name": "Email",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Email_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Email_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Phone_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Email_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Phone",
											"type": "String"
										},
										"sink": {
											"name": "Phone",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Phone_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Phone_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "StageInitialLoadRetailChunkControl",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Phone_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SeqID",
											"type": "String"
										},
										"sink": {
											"name": "SeqID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "FirstNameInitial",
											"type": "String"
										},
										"sink": {
											"name": "FirstNameInitial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "dtComplete",
											"type": "String"
										},
										"sink": {
											"name": "dtComplete",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "RunCount",
											"type": "String"
										},
										"sink": {
											"name": "RunCount",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ProdCountDec2022",
											"type": "String"
										},
										"sink": {
											"name": "ProdCountDec2022",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "dtPrevious",
											"type": "String"
										},
										"sink": {
											"name": "dtPrevious",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "StageInitialLoadRetailChunkControl_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "StageInitialLoadRetailChunkControl",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_TableName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"Customer_Fake_Address_FileName": {
						"type": "String"
					},
					"Customer_Fake_Address_Schema": {
						"type": "String"
					},
					"Customer_Fake_Address_TableName": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_Schema_TableName": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_Schema": {
						"type": "String"
					},
					"Customer_Fake_Email_TableName": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_TableName": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_TableName": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_FileName": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_Schema": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_TableName": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ReProcess_ErrorFiles_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move_Error_Container_Files",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"wildcardFolderPath": "Error",
									"wildcardFileName": {
										"value": "*.csv",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Error_Files_From_ErrorFolder",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Move_Error_Files_RetailCustomer_Container",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Remove_Error_Files_From_ErrorFolder",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": false,
								"wildcardFileName": {
									"value": "*.csv",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Error_Folder_Reprocess_Error_Logs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Move_Error_Container_Files').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Reprocess_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": null,
									"type": "Int32"
								},
								"RowsRead": {
									"value": null,
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"FileCheck": {
						"type": "String"
					},
					"TableSchema": {
						"type": "String"
					},
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Remove_RetailCustomerLoad_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Remove_Archive_Files",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@adddays(startOfDay(utcnow()),-100)",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@adddays(startOfDay(utcnow()),-20)",
									"type": "Expression"
								},
								"wildcardFileName": "*.csv",
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_Postal_Code",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "US"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ST",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "A/C",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "County",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "County",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Pref?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Pref",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "T/Z",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TZ",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DST?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Lat",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Lat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Long",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Long",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Div",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Div",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USA_Zip_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_USA": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "US_Zip_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CANADA_Postal_Code",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "CA"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Latitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Longitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Province",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Province",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_cmauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_cmauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_ername",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_ername",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_csdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_csdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_cmatype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_cmatype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_cdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_cdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_csduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_csduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_cdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_cdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_sactype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_sactype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_saccode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_saccode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_cmapuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_cmapuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_csdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_csdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_cduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_cduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_ccsname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_ccsname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_eruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_eruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_ccsuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_ccsuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Subdivision_cmaname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Subdivision_cmaname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Aggregate_Dissemination_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Aggregate_Dissemination_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Aggregate_Dissemination_cdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Aggregate_Dissemination_cdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Aggregate_Dissemination_cdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Aggregate_Dissemination_cdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Aggregate_Dissemination_cduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Aggregate_Dissemination_cduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Aggregate_Dissemination_adauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Aggregate_Dissemination_adauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Aggregate_Dissemination_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Aggregate_Dissemination_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Ecumene_ecumene",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Ecumene_ecumene",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Ecumene_ecuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Ecumene_ecuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Consolidated_Subdivision_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Consolidated_Subdivision_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Consolidated_Subdivision_cdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Consolidated_Subdivision_cdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Consolidated_Subdivision_cdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Consolidated_Subdivision_cdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Consolidated_Subdivision_ccsname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Consolidated_Subdivision_ccsname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Consolidated_Subdivision_cduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Consolidated_Subdivision_cduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Consolidated_Subdivision_ccsuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Consolidated_Subdivision_ccsuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Consolidated_Subdivision_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Consolidated_Subdivision_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_cmauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_cmauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_ctuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_ctuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_ername",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_ername",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_csdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_csdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_ctname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_ctname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_cmatype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_cmatype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_csduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_csduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_cdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_cdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_dbuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_dbuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_cdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_cdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_sactype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_sactype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_adauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_adauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_saccode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_saccode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_dauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_dauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_cmapuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_cmapuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_dbrplamx",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_dbrplamx",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_feduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_feduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_dbrplamy",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_dbrplamy",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_csdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_csdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_fedname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_fedname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_cduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_cduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_ccsname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_ccsname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_eruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_eruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_ccsuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_ccsuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Block_cmaname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Block_cmaname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmatype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmatype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmaname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmaname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmapuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmapuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Designated_Place_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Designated_Place_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Designated_Place_dpluid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Designated_Place_dpluid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Designated_Place_dplname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Designated_Place_dplname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Designated_Place_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Designated_Place_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Designated_Place_dpltype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Designated_Place_dpltype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Division_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Division_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Division_cdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Division_cdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Division_cdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Division_cdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Division_cduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Division_cduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Division_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Division_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_frname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_frname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_revdt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_revdt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_creadt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_creadt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_enname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_enname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_nid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_nid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_provcode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_provcode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_quipopcnt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_quipopcnt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_fednum",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_fednum",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_decpopcnt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_decpopcnt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Federal_Election_reporder",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Federal_Election_reporder",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_cmauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_cmauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_ctuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_ctuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_cmatype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_cmatype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_ctname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_ctname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_cmaname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_cmaname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Tract_cmapuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Tract_cmapuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Economic_Region_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Economic_Region_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Economic_Region_ername",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Economic_Region_ername",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Economic_Region_eruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Economic_Region_eruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Economic_Region_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Economic_Region_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_cmauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_cmauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_ctuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_ctuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_ername",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_ername",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_csdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_csdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_ctname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_ctname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_cmatype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_cmatype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_csduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_csduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_cdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_cdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_cdtype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_cdtype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_sactype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_sactype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_adauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_adauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_saccode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_saccode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_dauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_dauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_cmapuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_cmapuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_csdname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_csdname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_cduid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_cduid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_ccsname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_ccsname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_eruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_eruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_ccsuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_ccsuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Dissemination_Area_cmaname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Dissemination_Area_cmaname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_cmauid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_cmauid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_pcclass",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_pcclass",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_pcuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_pcuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_cmatype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_cmatype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_pcname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_pcname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_pctype",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_pctype",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_pcpuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_pcpuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_cmaname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_cmaname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population_Centre_cmapuid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population_Centre_cmapuid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Agricultural_pruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Agricultural_pruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Agricultural_caruid",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Agricultural_caruid",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Agricultural_carename",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Agricultural_carename",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Agricultural_carfname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Agricultural_carfname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Census_Agricultural_prname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Census_Agricultural_prname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISED",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ISED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISEDname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ISEDname",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Provincial_Riding_of",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Provincial_Riding_of",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Canada_Postal_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_canada": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CANADA_Postal_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": "*.*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_Code_Archive",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Postal_Code_Succeed_Files_Delete",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": "*.*",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_US_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.US_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_CANADA_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.CANADA_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('US_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('US_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('US_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is US Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('US_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('US_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('US_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "US_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('US_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('CANADA_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('CANADA_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Canada Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CANADA_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CANADA_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('CANADA_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}