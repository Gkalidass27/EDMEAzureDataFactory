{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_CommunicationPreferencePhoneLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as Count FROM [RetailCustomer].[IncrementalLoadCommPrefEmail] WITH(NOLOCK)\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as Count FROM [RetailCustomer].[IncrementalLoadCommPrefPhone] WITH(NOLOCK)\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(greater(activity('Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate').output.firstRow.Count,0),greater(activity('Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate').output.firstRow.Count,0))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Masterdata_CDP_Count_Data_Not_Found_Logs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_CDP_Customer_Prefrence_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT EmailAddress AS RAW_EMAIL_ADDRESS,\nCAST(OptedIn as bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nEmailCommunicationId AS EMAIL_COMMUNICATION_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [RetailCustomer].[IncrementalLoadCommPrefEmail] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "Byte[]",
														"physicalType": "varbinary"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Masterdata_CDP_preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT PhoneNumber AS RAW_PHONE_NUMBER,\nCAST(OptedIn AS Bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nPhoneCommunicationId AS PHONE_COMM_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [RetailCustomer].[IncrementalLoadCommPrefPhone] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Masterdata_CDP_preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_PHONE",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'CommunicationPreferenceLoad'\n,@P_LOAD_DESCRIPTION = 'CommunicationPreferenceLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "GetMaxCustPrefMasterID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "CommunicationPreferenceLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Delete_Prefrence_Incremental_data",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[RetailCustomer].[usp_ArchiveDeleteIncrementalPreferenceLoad]",
										"storedProcedureParameters": {
											"MaxId_CustPrefMasterID": {
												"value": {
													"value": "@activity('GetMaxCustPrefMasterID').output.firstRow.MAXCustPrefMasterID",
													"type": "Expression"
												},
												"type": "Int32"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_EMAIL",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Fail_PHONE",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "GetMaxCustPrefMasterID",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": "SELECT ISNULL(MAX(CustPrefMasterID),'0') AS MAXCustPrefMasterID FROM RcmPrefsSubscriber.customer_preferences ",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "RcmPrefsSubscriber",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "usp_CommunicationPreferenceEmailLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[RcmCustSemarchy].[usp_CommunicationPreferenceEmailLoad]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_CommunicationPreferencePhoneLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_CommunicationPreferenceEmailLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[RcmCustSemarchy].[usp_CommunicationPreferencePhoneLoad]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:07Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_CommunicationPreferenceLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get_Email_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Get_Phone_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'CommunicationPreferenceLoad'\n,@P_LOAD_DESCRIPTION = 'CommunicationPreferenceLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Check_Phone_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "CommunicationPreferenceLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get_Email_Chunk",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select top 1 Id,ChunkNumber,TableName,Organization\nfrom Masterdata_CDP.PreferenceInitialLoadChunks with(nolock)\nwhere isloaded = 0 and ProcessedDate is NULL and channel ='email'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Email_Chunk",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get_Phone_Chunk",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select top 1 Id,ChunkNumber,TableName,Organization\nfrom Masterdata_CDP.PreferenceInitialLoadChunks with(nolock)\nwhere isloaded = 0 and ProcessedDate is NULL and channel = 'SMS'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Get_Phone_Chunk",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Email_Chunk",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@contains(activity('Get_Email_Chunk').output,'firstRow')",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "No_Data_Available_For_Email",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT EmailAddress AS RAW_EMAIL_ADDRESS,\nCAST(OptedIn as bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nEmailCommunicationId AS EMAIL_COMMUNICATION_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [Masterdata_CDP].[InitialLoadCommPrefEmail] WITH(NOLOCK) WHERE ChunkNumber = @{activity('Get_Email_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Email_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Email_Chunk').output.firstRow.Organization}' and channel = 'email'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "Byte[]",
														"physicalType": "varbinary"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "InitialLoad_CommPref",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Failed_Email",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Update_Email_Chunk",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "Update a set ProcessedDate = getdate() , isloaded = 1\nfrom Masterdata_CDP.PreferenceInitialLoadChunks a with(nolock)\nWHERE ChunkNumber = @{activity('Get_Email_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Email_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Email_Chunk').output.firstRow.Organization}' and channel = 'email';\nselect 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Update_Email_Chunk",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "Check_Phone_Chunk",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Check_Email_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@contains(activity('Get_Phone_Chunk').output,'firstRow')",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "No_Data_Available_For_Phone",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT PhoneNumber AS RAW_PHONE_NUMBER,\nCAST(OptedIn AS Bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nPhoneCommunicationId AS PHONE_COMM_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [Masterdata_CDP].[InitialLoadCommPrefPhone] WITH(NOLOCK) WHERE ChunkNumber = @{activity('Get_Phone_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Phone_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Phone_Chunk').output.firstRow.Organization}' and channel = 'SMS'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "InitialLoad_CommPref",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_PHONE",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Failed_Phone",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Update_Phone_Chunk",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "Update a set ProcessedDate = getdate() , isloaded = 1\nfrom Masterdata_CDP.PreferenceInitialLoadChunks a with(nolock)\nWHERE ChunkNumber = @{activity('Get_Phone_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Phone_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Phone_Chunk').output.firstRow.Organization}' and channel = 'SMS';\nselect 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Phone_Chunk",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_Crosswalk')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "TRUNCATE TABLE [dbo].[CrossWalk_MD_OUT]",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHGRP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MATCHGRP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_CUSTOMER_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "RETAIL_CUSTOMER_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CONFIRMEDSDPK",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_CONFIRMEDSDPK",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "masterdata_CDP_CrossWalk_MD_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "retailCustomer_dbo_CrossWalk_MD_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "TRUNCATE TABLE [dbo].[CrossWalk_DU_OUT]",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHRULE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_MATCHRULE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MATCHSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "masterData_CDP_CrossWalk_DU_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "RetailCustomer_CrossWalk_DU_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Retail_Customer_Crosswalk_MD_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Retail_Customer_CrossWalk_MD_OUT').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": "Source is Crosswalk MD Table Data",
								"Source_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_MD_fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Retail_Customer_Crosswalk_MD_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Retail_Customer_CrossWalk_MD_OUT').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_DU_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Retail_Customer_CrossWalk_DU_OUT').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": "Source is Crosswalk DU Table Data",
								"Source_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_DU_fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Retail_Customer_Crosswalk_DU_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Retail_Customer_CrossWalk_DU_OUT').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT_ErrorLogS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Check_CustomerInfo_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Data_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(activity('Get_Data_Count').output.firstRow.COUNT),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": "No RAW Data Available For AllSourceCustomers",
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_RetailCustomers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nDO_NOT_SELL,\nNamePrefix,\nNameSuffix,\nGenderCode,\nIsAshleyEmployee,\nLoadRetailCustomerID,\nMarketingOwner,\nChannel,\nFirstAcquisitionDate,\nFirstAcquisitionSource,\nFirstMarketingSmsSignupCode,\nFirstMarketingSmsSignupDate,\nFirstPurchaseChannel,\nLastMarketingSmsSignupCode,\nLastMarketingSmsSignupDate,\nLastOrderFulfilledDate,\nLastOrderPlacedDate,\nLastPurchaseChannel,\nLastStoreShopped,\nLastStoreShoppedDate,\nLastStorePurchased,\nPreferredStoreID,\nPreferredStoreChangeDate,\nClosestStoreID,\nCurrentMarketingRegion,\nCurrentMarketingRegionChangeDate,\nFirstOrderPlacedDate,\nLastAcquisitionSource,\nLastEmailSignupDate,\nLastEmailSignupStoreID,\nLastTechnicalSource,\nLifetimeGrossDollars,\nLifetimeOrderCount\nFROM RetailCustomer.RetailCustomersIncremental \nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "GenderCode",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "GENDER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DO_NOT_SELL",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "DO_NOT_SELL",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "NamePrefix",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "NAME_PREFIX",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "NameSuffix",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "NAME_SUFFIX",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "IsAshleyEmployee",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_ASHLEY_EMPLOYEE",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LoadRetailCustomerID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "LOAD_RETAIL_CUSTOMER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "MarketingOwner",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MARKETING_OWNER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Channel",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FirstAcquisitionDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "FIRST_ACQUISITION_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FirstAcquisitionSource",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIRST_ACQUISITION_SOURCE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FirstMarketingSmsSignupCode",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIRST_MKTG_SMS_SU_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FirstMarketingSmsSignupDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "FIRST_MKTG_SMS_SU_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FirstPurchaseChannel",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIRST_PURCHASE_CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastMarketingSmsSignupCode",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_MKTG_SMS_SU_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastMarketingSmsSignupDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_MKTG_SMS_SU_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastOrderFulfilledDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_ORDER_FULFILLED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastOrderPlacedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_ORDER_PLACED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastPurchaseChannel",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_PURCHASE_CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastStoreShopped",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_STORE_SHOPPED",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastStoreShoppedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_STORE_SHOPPED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastStorePurchased",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_STORE_PURCHASED",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PreferredStoreID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PREFERRED_STORE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PreferredStoreChangeDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "PREFERRED_STORE_CHG_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "ClosestStoreID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CLOSEST_STORE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CurrentMarketingRegion",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENT_MARKETING_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CurrentMarketingRegionChangeDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "CURRENT_MKTG_REG_CHG_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FirstOrderPlacedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "FIRST_ORDER_PLACED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastAcquisitionSource",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_ACQUISITION_SOURCE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastEmailSignupDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_EMAIL_SU_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastEmailSignupStoreID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_EMAIL_SU_STORE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastTechnicalSource",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_TECHNICAL_SOURCE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LifetimeGrossDollars",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 4,
														"precision": 19
													},
													"sink": {
														"name": "LIFETIME_GROSS_DOLLARS",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 4,
														"precision": 19
													}
												},
												{
													"source": {
														"name": "LifetimeOrderCount",
														"type": "Int32",
														"physicalType": "int"
													},
													"sink": {
														"name": "LIFETIME_ORDER_COUNT",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "RetailCustomers_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.message}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_RetailCustomers').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_RETAIL_CUSTOMER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.RetailCustomersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_RetailCustomers",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_RetailCustomers').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_RetailCustomers').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_RetailCustomers').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_RetailCustomers').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_RetailCustomers",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_RetailCustomers",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_RetailCustomers').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_RetailCustomers').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Customer_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_RETAIL_CUSTOMER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.RetailCustomersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Load_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER,\nIsPrimary,\nLastClickDate,\nLastOpenDate\nFROM RetailCustomer.EmailAddressesIncremental \nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "IsPrimary",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PRIMARY",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LastClickDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_CLICK_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastOpenDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_OPEN_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "EmailAddresses_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_EmailAddresses').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_EMAIL_ADDRESS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.EmailAddressesIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_EmailAddresses",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_EmailAddresses').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_EmailAddresses').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_EmailAddresses').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_EmailAddresses').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "EmailAddresses_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_EMAIL_ADDRESS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.EmailAddressesIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_EmailAddresses",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_EmailAddresses",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_EmailAddresses').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_EmailAddresses').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER,\nIsPrimary\nFROM RetailCustomer.PhoneNumbersIncremental\nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "IsPrimary",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PRIMARY",
														"type": "Boolean",
														"physicalType": "bit"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "PhoneNumbers_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_PhoneNumbers').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_PHONE_NUMBER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.PhoneNumbersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_PhoneNumbers",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_PhoneNumbers').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_PhoneNumbers').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_PhoneNumbers').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_PhoneNumbers').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "PhoneNumbers_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_PHONE_NUMBER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.PhoneNumbersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_PhoneNumbers",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_PhoneNumbers",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_PhoneNumbers').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_PhoneNumbers').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER,\nTimezone, \nIsPrimary,\nADDRESSTYPE\nFROM RetailCustomer.AddressLocationsIncremental\nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "Timezone",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "IsPrimary",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PRIMARY",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ADDRESSTYPE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ADDRESS_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "AddressLocations_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_AddressLocations').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_ADDRESS_LOCATION",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.AddressLocationsIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_AddressLocations",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_AddressLocations').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_AddressLocations').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_AddressLocations').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_AddressLocations').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "AddressLocations_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_ADDRESS_LOCATION",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.AddressLocationsIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_AddressLocations",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_AddressLocations",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_AddressLocations').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_AddressLocations').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_RetailCustomers_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_EmailAddresses_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_PhoneNumbers_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_AddressLocations_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "usp_ArchiveDeleteCustomer",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "RcmCustSemarchy.usp_ArchiveDeleteCustomer"
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "usp_DeleteRFDLocalStage",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "usp_ArchiveDeleteCustomer",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[RcmCustSemarchy].[usp_DeleteRFDLocalStage]"
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Load_DiscountProgram",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": "SELECT \tB_PUBID,\r\n\t\tB_SOURCEID,\r\n\t\tB_CLASSNAME,\r\n\t\tB_CREDATE,\r\n\t\tB_UPDDATE,\r\n\t\tB_CREATOR,\r\n\t\tB_UPDATOR,\r\n\t\tSTART_DATE,\r\n\t\tEND_DATE,\r\n\t\tFP_RETAIL_CUSTOMER,\r\n\t\tFS_RETAIL_CUSTOMER,\r\n\t\tLOAD_PROGRAM_ID\r\nFROM RetailCustomer.DiscountProgramMembershipIncremental\r\nWITH(NOLOCK)",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "START_DATE",
														"type": "DateTime",
														"physicalType": "date"
													},
													"sink": {
														"name": "START_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "END_DATE",
														"type": "DateTime",
														"physicalType": "date"
													},
													"sink": {
														"name": "END_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LOAD_PROGRAM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LOAD_PROGRAM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_CustomerDiscountPrograms",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_SD_DISCOUNT_PROGRAM_MEMSHIP",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "DiscountProgram_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_DISCOUNT_PROGRAM_MEMSHIP",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.CustomerDiscountPrograms",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "DiscountProgram_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_DiscountProgram').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_DISCOUNT_PROGRAM_MEMSHIP",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.CustomerDiscountPrograms",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_DiscountProgram",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_DiscountProgram').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_DiscountProgram').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_DiscountProgram').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_DiscountProgram').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_DiscountProgram",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_DiscountProgram",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_DiscountProgram').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_DiscountProgram').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SD_Cancel_DiscountProgram_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Load_Orders",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": "SELECT O.ORDER_ID,\n       O.B_CLASSNAME,\n       O.B_CREDATE,\n       O.B_UPDDATE,\n       O.B_CREATOR,\n       O.B_UPDATOR,\n       O.ORDER_DATE,\n       O.ORDER_TYPE,\n       O.SOURCE_ORDER_ID,\n       O.FP_RETAIL_CUSTOMER,\n       O.FS_RETAIL_CUSTOMER,\n       O.ORDER_STATUS\nFROM [RetailCustomer].[OrdersIncremental] AS O\nWITH(NOLOCK)",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "ORDER_DATE",
														"type": "DateTime",
														"physicalType": "date"
													},
													"sink": {
														"name": "ORDER_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "ORDER_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ORDER_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SOURCE_ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "SOURCE_ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "ORDER_STATUS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ORDER_STATUS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_Orders_RCM",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_SA_ORDERS_RCM",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Orders_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].start}\n\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_Orders').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_Orders').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_Orders').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SA_ORDERS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.RetailSalesOrderHeader",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Orders_ErrorLogs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_Orders').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_Orders').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_Orders').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_Orders').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SA_ORDERS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.RetailSalesOrderHeader",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_Orders",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_Orders').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_Orders').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_Orders').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_Orders').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_Orders",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_Orders",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_Orders').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_Orders').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SD_Cancel_DiscountProgram_LoadId_Stored_Procedure_copy1",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "Get_Data_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_RetailCustomerLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT COUNT(1) AS [COUNT] FROM [RetailCustomer].[RetailCustomersIncremental]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "usp_RetailCustomerLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[RcmCustSemarchy].[usp_RetailCustomerLoad]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:08Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_RetailCustomerLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Initial_Load_RetailCustomers",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "usp_PreLoad_DROP_SD_Indexes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\nB_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE\nFROM Masterdata_CDP.RetailCustomerInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWFIRSTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWLASTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWMIDDLENAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_RETAIL_CUSTOMER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_PhoneNumber",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_RetailCustomers",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.PhoneNumbersInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPHONENUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersPhoneInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_PHONE_NUMBER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_EmailAddresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_PhoneNumber",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.EmailAddressesInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWEMAILADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersEmailInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_EMAIL_ADDRESS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_Addresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_EmailAddresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.AddressLocationsInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTREETADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STREET_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESSLINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATEORPROVINCECODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_OR_PROV_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWZIPOSTALCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ZIP_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRYCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersAddress",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_ADDRESS_LOCATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_InitialLoadRetail",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_PreSemarchy_ADD_SD_Indexes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailCustomerLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadId')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_InitialLoadRetail",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Masterdata_CDP].[usp_InitialLoadRetail]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_PreLoad_DROP_SD_Indexes",
						"description": "Drop SD table index",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_PreLoad_DROP_SD_Indexes]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_CustomerMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_PreSemarchy_ADD_SD_Indexes",
						"description": "Add indexing in SD table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Initial_Load_Addresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_PreSemarchy_ADD_SD_Indexes]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_CustomerMaster",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_ExternalRefCountry')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'ExternalRefCountryLoad'\n,@P_LOAD_DESCRIPTION = 'External Ref Country Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "External_Ref_Country",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ExternalRefCountryLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "External_Ref_Country",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[EXT_REF_COUNTRY_ID]\n       ,'ExternalRefCountry' as B_CLASSNAME\n      ,[COUNTRY_CODE_A2]\n      ,[COUNTRY_CODE_A3]\n      ,[COUNTRY_NAME]\n      ,[COUNTRY_LOCAL_NAME]\n      ,[COUNTRY_UN_CODE]\n  FROM [ISO].[countrycode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "EXT_REF_COUNTRY_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "EXTERNAL_REF_COUNTRY_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE_A2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE_A2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE_A3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE_A3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_LOCAL_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_LOCAL_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_UN_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_UN_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ISO_CountryCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_EXTERNAL_REF_COUNTRY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_ExternalRefUSState')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'ExternalRefUSStateLoad'\n,@P_LOAD_DESCRIPTION = 'External Ref US State Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "External_Ref_US_State",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ExternalRefUSStateLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "External_Ref_US_State",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,'ExternalRefUSState' as B_CLASSNAME\n      ,[EXT_REF_US_STATE_ID]\n      ,[STATE_CODE]\n      ,[STATE_NAME]\n  FROM [ISO].[statecode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "EXT_REF_US_STATE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "EXTERNAL_REF_US_STATE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ISO_StateCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_EXTERNAL_REF_US_STATE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_SiteMasterLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SD_SiteOwner",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "WITH CTE AS(\n\nSELECT OWNER_NAME,\nOWNER_ADDRESS,\nOWNER_CITY,\nOWNER_STATE,\nOWNER_POSTAL_CODE,\nCOUNTRY_CODE,\nB_SOURCE_ID,\n--ROW_NUMBER() OVER(PARTITION BY B_SOURCE_ID ORDER BY OWNER_NAME,OWNER_ADDRESS DESC) AS RNK\nrank() over(partition by B_Source_ID order by ltrim(rtrim(OWNER_NAME))) as rnk\nFROM  [Retail].[InitialLoadSiteOwner]\n)\nSELECT  DISTINCT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID,\n      [OWNER_NAME] AS OWNER_NAME\n      ,[OWNER_ADDRESS] AS RAWADDRESS_LINE1\n      ,[OWNER_CITY] AS RAWCITY\n      ,[OWNER_STATE] AS RAWSTATE_CODE\n      ,[OWNER_POSTAL_CODE] AS RAWPOSTAL_CODE\n\t,'INITIALLOAD' as [B_PUBID]\n\t,'SiteOwner' AS B_CLASSNAME\n\t, B_Source_ID AS [B_SOURCEID]\n       ,Country_Code as RAWCOUNTRY_CODE FROM CTE WHERE RNK=1 ",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SD_SITE_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'Site Master Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_SiteContact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SD_SiteMain",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteMain_RDC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \n      @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[SITE_NAME] AS SITE_NAME\n      ,[SITE_TYPE] AS SITE_TYPE\n      ,CONVERT(BIT, (CASE WHEN [IS_ACTIVE] ='NULL' THEN 0 ELSE CAST([IS_ACTIVE] AS BIT) END)) as ISACTIVE\n      ,[SITE_DESCRIPTION] AS SITE_DESCRIPTION\n      ,[OWNERSHIP_TYPE] AS SITE_OWNERSHIP_TYPE\n      ,[B_SOURCE_ID] AS B_SOURCEID\n      ,[ADDRESS_LINE1] AS RAWADDRESS_LINE1\n      ,[ADDRESS_LINE2] AS RAWADDRESS_LINE2\n      ,[CITY] AS RAWCITY\n      ,[STATE_CODE] AS RAWSTATE_CODE\n      ,[POSTAL_CODE] AS RAWPOSTAL_CODE\n      ,[COUNTRY_CODE] AS RAWCOUNTRY_CODE\n\t  ,[LOCAL_CURRENCY_CODE]\n      ,[LOCAL_UNIT_OF_MEASURE_AREA]\n      ,CAST(OPERATIONS_START_DATE AS DATE) AS OPERATIONS_START_DATE\n      ,CAST(CUSTOMER_OPEN_DATE AS DATE) AS CUSTOMER_OPEN_DATE\n      ,CONVERT(decimal(12,4),CONVERT(float,CUSTOMER_SITE_AREA)) AS CUSTOMER_SITE_AREA\n\t,'INITIALLOAD' AS B_PUBID\n\t,'SiteMain' as B_CLASSNAME\n\t,FS_SITE_OWNER as [FS_SITE_OWNER]\n\t,'INITIALLOAD' AS [FP_SITE_OWNER]\n\t,FP_WAREHOUSE_PARENT as [FP_WAREHOUSE_PARENT]\n\t,FS_WAREHOUSE_PARENT AS [FS_WAREHOUSE_PARENT]\n  FROM [Retail].[InitialLoadSiteMain]    \nWHERE FS_SITE_OWNER IS NOT NULL AND COUNTRY_CODE in ('USA','United States') AND [B_SOURCE_ID] IS NOT NULL",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SD_SiteMain_RDC",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteOwner",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[B_SOURCE_ID]\n      ,[SITE_NAME]\n      ,[SITE_TYPE]\n      ,CONVERT(BIT, (CASE WHEN [IS_ACTIVE] ='NULL' THEN 0 ELSE CAST([IS_ACTIVE] AS BIT) END)) AS ISACTIVE\n      ,[SITE_DESCRIPTION]\n      ,[OWNERSHIP_TYPE]\n      ,[ADDRESS_LINE1]\n      ,[CITY]\n      ,[STATE_CODE]\n      ,[POSTAL_CODE]\n      ,[COUNTRY_CODE]\n      ,[LOCAL_CURRENCY_CODE]\n      ,[LOCAL_UNIT_OF_MEASURE_AREA]\n      ,CASE WHEN OPERATIONS_SITE_AREA='?' THEN NULL ELSE  CONVERT(decimal(16,4),  convert(float,replace([OPERATIONS_SITE_AREA],',','') )) \n\t  END AS OPERATIONS_SITE_AREA\n      ,[FS_SITE_OWNER]\n\t  ,'INITIALLOAD' AS B_PUBID\n\t,'SiteMain' as B_CLASSNAME\n  ,'INITIALLOAD' AS [FP_SITE_OWNER]\n  FROM [Retail].[InitialLoadSiteMainRDC] WHERE RNK=1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 16
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SA_SiteContact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteMain",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT   @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n       ,FP_SITE_MAIN\n      ,NEWID() AS [Site_Contact_ID]\n      ,[CONTACT_FIRST_NAME]\n      ,[CONTACT_LAST_NAME]\n      ,[RAW_CONTACT_PHONE]\n      ,[RAW_CONTACT_EMAIL]\n      ,[SITE_CONTACT_TYPE]\n      ,[FS_SITE_MAIN]\n\t,'SiteContact' as B_CLASSNAME\nFROM [Retail].[InitialLoadSiteContact]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Site_Contact_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTACT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTACT_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTACT_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTACT_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTACT_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_CONTACT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_CONTACT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_SITE_CONTACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteView",
						"description": "select all data from DACJSONLoadSite view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,DAC_ACCOUNT_ID\n      ,DAC_LOCATION_ID\n      ,SITE_NAME\n      ,RAW_PHONE\n      ,RAW_FAX\n      ,LAND_LINE\n      ,OPERATIONAL_STATUS\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,STORE_LOCATOR_DISABLED\n      ,Location_Number\n      ,B_ClassName\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM [Retail].[DACIncrementalSite_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Stored procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSite_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select \n[LocationNumber] AS SITE_CONTENT_ID\n,'SiteContent' AS B_CLASSNAME\n,[LocationNumber]\n,[ExteriorPhoto]\n,[FlyerLink]\n,[Promotion1Image]  \n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,convert(nvarchar(128),WebsiteURL) as WebsiteURL\n\t  ,convert(nvarchar(128),[BusinessDescription]) as BusinessDescription\n      ,[BusinessLongDescription]\n      ,convert(nvarchar(128),BusinessShortDescription) as BusinessShortDescription\n\t  ,convert(nvarchar(128),[BusinessName]) as BusinessName\n      ,[ContentLanguage]\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,FS_SITE_ID\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\nFROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SHORT_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LONG_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WEBSITE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContent_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n      B_CLASSNAME\n      ,SITE_HOURS_TYPE\n      ,DAY_OF_WEEK\n      \n\t  ,CASE\n    WHEN Cast (START_TIME as nvarchar(10)) = 'Closed' Then ''\n\tElse Cast (START_TIME as nvarchar(10)) end as Starttm\n\t,CASE\n    WHEN Cast (END_TIME as nvarchar(10))='' Then ''\n\tElse Cast (END_TIME as nvarchar(10)) end as endtm\n\n      ,FP_SITE\n      ,FS_SITE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n\t,Concat(FS_SITE,'_',DAY_OF_WEEK) as Key1\n      ,BUSINESS_STATE\n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Starttm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "endtm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Incrementalsdhsopctracking_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_Site",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteContent",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteContentView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_CONTENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteContent",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteContent",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteContentView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteContentView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteContent_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteDefaultHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteDefaultHoursView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteDefaultHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteDefaultHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteDefaultHoursView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteDefaultHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalsdhsopctrackingView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,AccountID\n      ,FS_SITE_ID\n      ,F_LEGAL_ENTITY_ID\n      ,SITE_NAME\n      ,SITE_TYPE\n      ,OWNERSHIP_TYPE\n      ,SITE_RAW_ADDR_LINE1\n      ,ADDRESS_LINE2\n      ,SITE_RAW_CITY\n      ,SITE_RAW_STATE_CODE\n      ,SITE_RAW_POSTAL_CODE\n      ,SITE_RAW_COUNTRY_CODE\n      ,SITE_RAW_LATITUDE\n      ,SITE_RAW_LONGITUDE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,B_CLASSNAME\n       ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM Retail.DACIncrementalOPCTracking_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OP_PC_Tracker_DAC",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SD_HS_OPC_TRACKING",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalsdhsopctrackingView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SD_HS_OPC_TRACKING",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalsdhsopctrackingView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SD_HS_OPC_TRACKING_LoadId_Stored_Procedure_",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteSpecialHours",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHours_HIs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n    'SiteSpecialHour' AS B_CLASSNAME,\n    SPH_Date,\n    SPH_StartTime,\n    SPH_Endtime,\n    SPH_State,\n    FP_SITE,\n    FS_SITE,\n    B_CREDATE,\n    B_CREATOR,\n    B_UPDATOR,\n    CASE \n        WHEN SPH_Date IS NULL THEN NULL\n        ELSE CONCAT(FS_SITE, '_', SPH_Date)\n    END AS key1\nFROM Retail.DACIncrementalSiteSpecialHours_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SPECIAL_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Date",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SPH_State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_StartTime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Endtime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_Special_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SpecialHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteSpecialHours').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteSpecialtHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteSpecialHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteSpecialHours').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteSpecialHours').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteSpecialHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSite_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "SchemaName",
								"value": "Retail"
							},
							{
								"name": "TableName",
								"value": "DACIncrementalSite_His"
							}
						],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[DAC_ACCOUNT_ID]\n      ,[DAC_LOCATION_ID]\n      ,[Location_Number]\n      ,[STORE_LOCATOR_DISABLED]\n      ,[RAW_PHONE]\n      ,[RAW_FAX]\n      ,[LAND_LINE]\n      ,[OPERATIONAL_STATUS]\n      ,[SITE_NAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_ClassName]\n      ,[IsActiveType]  \n      ,B_DELETETYPE\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSite_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_Number"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sit_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSite_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteContent_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [LocationNumber]\n      ,[ExteriorPhoto]\n      ,[FlyerLink]\n      ,[Promotion1Image]\n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,[WebsiteURL]\n      ,[BusinessDescription]\n      ,[BusinessLongDescription]\n      ,[BusinessShortDescription]\n      ,[BusinessName]\n      ,[ContentLanguage]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n      ,[IsActiveType]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationNumber"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sitecontent_His",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteContent_His"
								}
							}
						]
					},
					{
						"name": "Incrementalsdhsopctracking_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[AccountID]\n      ,[LocationID]\n      ,[F_LEGAL_ENTITY_ID]\n      ,[SITE_NAME]\n      ,[SITE_TYPE]\n      ,[OWNERSHIP_TYPE]\n      ,[SITE_RAW_ADDR_LINE1]\n      ,[ADDRESS_LINE2]\n      ,[SITE_RAW_CITY]\n      ,[SITE_RAW_STATE_CODE]\n      ,[SITE_RAW_POSTAL_CODE]\n      ,[SITE_RAW_COUNTRY_CODE]\n      ,[SITE_RAW_LATITUDE]\n      ,[SITE_RAW_LONGITUDE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_CLASSNAME]\n      ,[FS_SITE_ID]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n  FROM [Retail].[DACIncrementalOPCTracking_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_hsopc_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalOPCTracking_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHours_HIs",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_CLASSNAME]\n      ,[SITE_HOURS_TYPE]\n      ,[DAY_OF_WEEK]\n      ,[START_TIME]\n      ,[END_TIME]\n      ,[FP_SITE]\n      ,[FS_SITE]\n      ,[Location_ID]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[BUSINESS_STATE]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n      \n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_defaulthours_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteDefaultHours_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteSpecialHours_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [FS_SITE]\n      ,[SPH_Date]\n      ,[SPH_StartTime]\n      ,[SPH_Endtime]\n      ,[SPH_State]\n      ,[FP_SITE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[LocationID]\n      ,[B_DELETETYPE]\n      ,[IsActiveType]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteSpecialHours_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_specialh_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteSpecialHours_His"
								}
							}
						]
					},
					{
						"name": "Stored procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Load_Stores_Data]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate_DAC_Tables",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SubmitLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Truncate_DAC_Tables]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteView",
						"description": "select all data from DACJSONLoadSite view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,DAC_ACCOUNT_ID\n      ,DAC_LOCATION_ID\n      ,SITE_NAME\n      ,RAW_PHONE\n      ,RAW_FAX\n      ,LAND_LINE\n      ,OPERATIONAL_STATUS\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,STORE_LOCATOR_DISABLED\n      ,Location_Number\n      ,B_ClassName\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM [Retail].[DACIncrementalSite_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Stored procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSite_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select \n[LocationNumber] AS SITE_CONTENT_ID\n,'SiteContent' AS B_CLASSNAME\n,[LocationNumber]\n,[ExteriorPhoto]\n,[FlyerLink]\n,[Promotion1Image]  \n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,convert(nvarchar(128),WebsiteURL) as WebsiteURL\n\t  ,convert(nvarchar(128),[BusinessDescription]) as BusinessDescription\n      ,[BusinessLongDescription]\n      ,convert(nvarchar(128),BusinessShortDescription) as BusinessShortDescription\n\t  ,convert(nvarchar(128),[BusinessName]) as BusinessName\n      ,[ContentLanguage]\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,FS_SITE_ID\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\nFROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SHORT_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LONG_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WEBSITE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContent_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n      B_CLASSNAME\n      ,SITE_HOURS_TYPE\n      ,DAY_OF_WEEK\n      \n\t  ,CASE\n    WHEN Cast (START_TIME as nvarchar(10)) = 'Closed' Then ''\n\tElse Cast (START_TIME as nvarchar(10)) end as Starttm\n\t,CASE\n    WHEN Cast (END_TIME as nvarchar(10))='' Then ''\n\tElse Cast (END_TIME as nvarchar(10)) end as endtm\n\n      ,FP_SITE\n      ,FS_SITE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n\t,Concat(FS_SITE,'_',DAY_OF_WEEK) as Key1\n      ,BUSINESS_STATE\n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Starttm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "endtm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Incrementalsdhsopctracking_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_Site",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteContent",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteContentView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_CONTENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteContent",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteContent",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteContentView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteContentView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteContent_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteDefaultHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteDefaultHoursView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteDefaultHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteDefaultHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteDefaultHoursView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteDefaultHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalsdhsopctrackingView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,AccountID\n      ,FS_SITE_ID\n      ,F_LEGAL_ENTITY_ID\n      ,SITE_NAME\n      ,SITE_TYPE\n      ,OWNERSHIP_TYPE\n      ,SITE_RAW_ADDR_LINE1\n      ,ADDRESS_LINE2\n      ,SITE_RAW_CITY\n      ,SITE_RAW_STATE_CODE\n      ,SITE_RAW_POSTAL_CODE\n      ,SITE_RAW_COUNTRY_CODE\n      ,SITE_RAW_LATITUDE\n      ,SITE_RAW_LONGITUDE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,B_CLASSNAME\n       ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM Retail.DACIncrementalOPCTracking_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OP_PC_Tracker_DAC",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SD_HS_OPC_TRACKING",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalsdhsopctrackingView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SD_HS_OPC_TRACKING",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalsdhsopctrackingView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SD_HS_OPC_TRACKING_LoadId_Stored_Procedure_",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteSpecialHours",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHours_HIs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n    'SiteSpecialHour' AS B_CLASSNAME,\n    SPH_Date,\n    SPH_StartTime,\n    SPH_Endtime,\n    SPH_State,\n    FP_SITE,\n    FS_SITE,\n    B_CREDATE,\n    B_CREATOR,\n    B_UPDATOR,\n    CASE \n        WHEN SPH_Date IS NULL THEN NULL\n        ELSE CONCAT(FS_SITE, '_', SPH_Date)\n    END AS key1\nFROM Retail.DACIncrementalSiteSpecialHours_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SPECIAL_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Date",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SPH_State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_StartTime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Endtime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_Special_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SpecialHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteSpecialHours').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteSpecialtHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteSpecialHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteSpecialHours').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteSpecialHours').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteSpecialHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSite_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "SchemaName",
								"value": "Retail"
							},
							{
								"name": "TableName",
								"value": "DACIncrementalSite_His"
							}
						],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[DAC_ACCOUNT_ID]\n      ,[DAC_LOCATION_ID]\n      ,[Location_Number]\n      ,[STORE_LOCATOR_DISABLED]\n      ,[RAW_PHONE]\n      ,[RAW_FAX]\n      ,[LAND_LINE]\n      ,[OPERATIONAL_STATUS]\n      ,[SITE_NAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_ClassName]\n      ,[IsActiveType]  \n      ,B_DELETETYPE\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSite_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_Number"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sit_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSite_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteContent_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [LocationNumber]\n      ,[ExteriorPhoto]\n      ,[FlyerLink]\n      ,[Promotion1Image]\n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,[WebsiteURL]\n      ,[BusinessDescription]\n      ,[BusinessLongDescription]\n      ,[BusinessShortDescription]\n      ,[BusinessName]\n      ,[ContentLanguage]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n      ,[IsActiveType]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationNumber"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sitecontent_His",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteContent_His"
								}
							}
						]
					},
					{
						"name": "Incrementalsdhsopctracking_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[AccountID]\n      ,[LocationID]\n      ,[F_LEGAL_ENTITY_ID]\n      ,[SITE_NAME]\n      ,[SITE_TYPE]\n      ,[OWNERSHIP_TYPE]\n      ,[SITE_RAW_ADDR_LINE1]\n      ,[ADDRESS_LINE2]\n      ,[SITE_RAW_CITY]\n      ,[SITE_RAW_STATE_CODE]\n      ,[SITE_RAW_POSTAL_CODE]\n      ,[SITE_RAW_COUNTRY_CODE]\n      ,[SITE_RAW_LATITUDE]\n      ,[SITE_RAW_LONGITUDE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_CLASSNAME]\n      ,[FS_SITE_ID]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n  FROM [Retail].[DACIncrementalOPCTracking_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_hsopc_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalOPCTracking_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHours_HIs",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_CLASSNAME]\n      ,[SITE_HOURS_TYPE]\n      ,[DAY_OF_WEEK]\n      ,[START_TIME]\n      ,[END_TIME]\n      ,[FP_SITE]\n      ,[FS_SITE]\n      ,[Location_ID]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[BUSINESS_STATE]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n      \n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_defaulthours_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteDefaultHours_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteSpecialHours_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [FS_SITE]\n      ,[SPH_Date]\n      ,[SPH_StartTime]\n      ,[SPH_Endtime]\n      ,[SPH_State]\n      ,[FP_SITE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[LocationID]\n      ,[B_DELETETYPE]\n      ,[IsActiveType]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteSpecialHours_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_specialh_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteSpecialHours_His"
								}
							}
						]
					},
					{
						"name": "Stored procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Load_Stores_Data]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate_DAC_Tables",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SubmitLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Truncate_DAC_Tables]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_Delete')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId1').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site_Warehouse_Hist_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"OPERATIONAL_STATUS",
										"B_SOURCEID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_WareHouse_Hist"
								}
							}
						]
					},
					{
						"name": "SubmitLoadGX",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Hist_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('Loadid')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_Hist_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID0",
										"value": {
											"value": "@variables('LoadID')\n",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID as LOCATION_NUMBER, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY,\r\n   COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, \r\nFS_SUPPORTING_WAREHOUSE,'SOFT_DELETE' as B_DELETETYPE,\r\ngetdate() as B_DELETEDATE,\r\n'Semadmin' as B_DELETEAUTHOR,\r\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\r\n--change_type, record_insert_date, record_update_date\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='INACTIVE'\r\nand CLOSE_DATE <= CURRENT_DATE",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID0",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_GX').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_GX').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_GX').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_GX').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_GX').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_GX').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_GX').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_GX').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging_GX",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_GX').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_GX').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_GX').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Hist_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY, \r\n  COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, FS_SUPPORTING_WAREHOUSE, \r\nchange_type, record_insert_date, record_update_date\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='INACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_SOURCEID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CHANGE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_insert_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_INSERT_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_update_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_UPDATE_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_StoreMaster_Hist"
								}
							}
						]
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure_copy1_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLogs_GX",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse_GX').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_copy1_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse_GX').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse_GX').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse_GX').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse_GX').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging_GX_WH",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-20T10:34:43Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_RSA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteRSADataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LocationCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select  LOCATION_CODE_ID,\r\nB_CLASSNAME,\r\nB_CREDATE,\r\nB_UPDDATE,\r\nB_CREATOR,\r\nB_UPDATOR,\r\nB_PUBID,\r\nFP_SITE_ID,\r\nFS_SITE_ID,\r\nOPERATION_ID,\r\nPROFIT_CENTER\r\n from Retail.locationcode_Initial_VW \r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "locationcode_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_LOCATION_CODE"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,'INCREMENTAL' as FP_SITE_ID\r\n,FS_SITE_ID\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\n,active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Assignment_Incremental_Vw\r\nwhere active_flag > 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_ASSOCIATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Incremental_Vw"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_RSA_ASSIGNMENT"
								}
							}
						]
					},
					{
						"name": "RSA_Associate",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Error_Log_LocationConstraint",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere active_flag > 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_ASSOCIATE"
								}
							}
						]
					},
					{
						"name": "LocationCode_ErrorLoags_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LocationCode').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LocationCode').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LocationCode').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LocationCode').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_LocationCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LocationCode').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LocationCode').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LocationCode').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LocationCode').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.locationcode_Initial_VW",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "RSA_Associate_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,Active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere Active_flag > 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ASSOCIATE_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_HIST"
								}
							}
						]
					},
					{
						"name": "GetNewLoadId_Delete",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SubmitLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId_Delete",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID1",
							"value": {
								"value": "@{activity('GetNewLoadId_Delete').output.firstRow.RETURN_VALUE_ARGUMENT}\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "RSA_Associate_Delete",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID1')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere active_flag = 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_ASSOCIATE"
								}
							}
						]
					},
					{
						"name": "SubmitLoad_Delete",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteRSADataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID1')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "RSA_Associate_Hist_Delete",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,Active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere Active_flag =0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"ASSOCIATE_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_HIST"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Assignment_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,'INCREMENTAL' as FP_SITE_ID\r\n,FS_SITE_ID\r\nfrom Retail.RSA_Assignment_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.RSA_Assignment_HIST",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_Site_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Initial_vw"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_HIST"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment_Delete",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate_Hist_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID1')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,'INCREMENTAL' as FP_SITE_ID\r\n,FS_SITE_ID\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\n,active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Assignment_Incremental_Vw\r\nwhere active_flag=0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_ASSOCIATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Incremental_Vw"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_RSA_ASSIGNMENT"
								}
							}
						]
					},
					{
						"name": "Archive_delete",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SubmitLoad_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[usp_RSA_ARCHIIVE_DELETE]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "RSA_Error_Log_LocationConstraint",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select AssociatedID as Associate_ID,LastName AS LAST_NAME,MiddleName AS MIDDLE_NAME,FirstName AS FIRST_NAME,Status,EmailAddress AS EMAIL_ADDRESS,\r\nWorkType AS WORK_TYPE,RsaID,LocationCode,OPERATION_ID,Profit_center,entity,LegalentityID AS F_LEGAL_ENTITY,B_CLASSNAME,B_CREDATE,B_UPDDATE,B_CREATOR,B_UPDATOR,StartDate AS START_DATE,Lasthiredate AS LAST_HIRE_DATE,\r\nTerminationDate AS TERMINATION_DATE\r\nfrom Retail.RSA_ERROR_LOG_vw",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_Loadid",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RsaID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RsaID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LocationCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Profit_center",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Profit_center",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "entity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "entity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_ERROR_LOG_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_ERROR_LOG"
								}
							}
						]
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment_Hist",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID1')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_RSA_Associate",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "RSA_Associate",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('RSA_Associate').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('RSA_Associate').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('RSA_Associate').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('RSA_Associate').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_RSA_Assignment",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('RSA_Assignment').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('RSA_Assignment').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('RSA_Assignment').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('RSA_Assignment').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					},
					"LoadID1": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:09Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_StoreMaster')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Site",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID as location_number, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY,\r\n   COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, \r\nFS_SUPPORTING_WAREHOUSE,'' as B_DELETETYPE,\r\ncast(Null as datetime) as B_DELETEDATE,\r\n'' as B_DELETEAUTHOR,\r\ncast (Null as uniqueidentifier) as B_DELETEOPERATION,\r\nUnit as Unit_NUMBER\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere soft_open_date <= CURRENT_DATE\r\n\r\n/*\r\nwhere upper(operational_status) ='ACTIVE'\r\nUNION \r\n\r\nselect B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID as location_number, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY,\r\n   COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, \r\nFS_SUPPORTING_WAREHOUSE,\r\n'SOFT_DELETE' as B_DELETETYPE,\r\ngetdate() as B_DELETEDATE,\r\n'Semadmin' as B_DELETEAUTHOR,\r\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='INACTIVE'\r\n*/",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "location_number",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCATION_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UNIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM [Retail].[v_StoreMaster_Inc_Legal_Entity]\n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking_hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_PUBID,\nSITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\n--change_type\nFROM Retail.v_SiteAdditionalInfo_Incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_HSOPCTracking_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('HSOPCTracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_HSOPCTracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('HSOPCTracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('HSOPCTracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteAdditionalInformation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select HS_OPC_TRACKING_ID,B_CLASSNAME,B_CREDATE,B_UPDDATE,B_CREATOR,B_PUBID,B_SOURCEID,OPERATION_ID,PRIMARY_PROFIT_CENTER,ERP_DATABASE_NAME,ERP_SYSTEM_NAME,EFFECTIVE_START_DATE,EFFECTIVE_END_DATE,LEGACY_LOCATION_ID,SITE_NAME,COMP_FLAG,ENTERPRISE_FLAG,TRAFFIC_SYSTEM_ID,LIC_TERRITORY,TUA_EXPIRATION_DATE,NOTES,OS_ID,OS_LOCATION_ID,SITE_RAW_ADDR_LINE1,SITE_RAW_ADDR_LINE2,SITE_RAW_CITY,SITE_RAW_STATE,SITE_RAW_STATE_CODE,SITE_RAW_POSTAL_CODE,SITE_RAW_COUNTRY,SITE_RAW_COUNTRY_CODE,\r\nSITE_RAW_LATITUDE,SITE_RAW_LONGITUDE,F_LEGAL_ENTITY_ID,\r\n Salesmanager1 as Sales_Manager1,\r\n\t Salesmanager2 as Sales_Manager2,\r\n\t Salesmanager3 as Sales_Manager3,\r\n\t Store_manager,\r\nFP_SITE_ID,FS_SITE_ID from (\r\nSELECT \r\n    cast(newid() as uniqueidentifier) HS_OPC_TRACKING_ID,\r\n    B_CLASSNAME,\r\n\tB_CREDATE,\r\n\tB_UPDDATE,\r\n\tB_CREATOR,\r\n\tB_PUBID,\r\n\tB_SOURCEID,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t FP_SITE_ID,\r\n\t FS_SITE_ID ,\r\n\t Salesmanager1,\r\n\t Salesmanager2,\r\n\t Salesmanager3,\r\n\t Store_manager,\r\n     ROW_NUMBER() OVER (PARTITION BY B_SOURCEID ORDER BY effective_start_date DESC) AS rn     \r\nFROM Retail.v_hs_opc_tracking_incremental)a\r\nwhere rn=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Sales_Manager1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SALES_MANAGER1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Sales_Manager2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SALES_MANAGER2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Sales_Manager3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SALES_MANAGER3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Store_manager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "STORE_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OP_PC_Tracker",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LegalEntity_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\n'1' as Current_flag\nFROM [Retail].[v_StoreMaster_Inc_Legal_Entity]\n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LEGAL_ENTITY_ID",
										"NAME"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Hist_Legal_Entity"
								}
							}
						]
					},
					{
						"name": "Site_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY, \r\n  COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, FS_SUPPORTING_WAREHOUSE, \r\nchange_type, record_insert_date, record_update_date,unit\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='ACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_SOURCEID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CHANGE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_insert_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_INSERT_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_update_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_UPDATE_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_StoreMaster_Hist"
								}
							}
						]
					},
					{
						"name": "HSOPCTracking_hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    cast(newid() as uniqueidentifier) AS HS_OPC_TRACKING_ID,\r\n    B_CLASSNAME,\r\n\tB_CREDATE,\r\n\tB_UPDDATE,\r\n\tB_CREATOR,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t FP_SITE_ID,\r\n\t FS_SITE_ID ,   \r\n     CHANGE_TYPE  as CHANGE_TYPE ,\r\n\t  Salesmanager1,\r\n\t Salesmanager2,\r\n\t Salesmanager3,\r\n\t store_manager\r\nFROM Retail.v_hs_opc_tracking_incremental",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_ID",
										"OPERATION_ID",
										"PRIMARY_PROFIT_CENTER"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "notes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CHANGE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "b_loadid",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Salesmanager1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Salesmanager2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Salesmanager3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SalesManager3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "store_manager",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Store_manager",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "HS_OPC_TRACKING_Hist"
								}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_PUBID,\nSITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME,\nchange_type\nFROM Retail.v_SiteAdditionalInfo_Incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"SITE_ADDITIONAL_INFO_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Change_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_addn_info_Hist"
								}
							}
						]
					},
					{
						"name": "SubmitLoadGD",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_WareHouse')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'' as B_DELETETYPE,\ncast(Null as datetime) as B_DELETEDATE,\n'' as B_DELETEAUTHOR,\ncast (Null as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\n\n/*\nwhere upper(operational_status)='ACTIVE'\n\n\nUnion\nSELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'\n*/",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n--    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n--cast(newid() as uniqueidentifier) AS WH_LE_TRACKING_ID,\r\nsite_id as WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'SSMASTER_RDC' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"WH_LE_TRACKING_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION\n\nFROM Retail.v_wh_legal_entity_inc WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "masterDataHubStg",
										"type": "LinkedServiceReference"
									},
									"path": "raw-zone/Warehouses"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WH_LegalEntity_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nactive_flag,\nactivity_type\nFROM Retail.v_wh_legal_entity_inc \n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LEGAL_ENTITY_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "wh_legal_entity_Hist"
								}
							}
						]
					},
					{
						"name": "Site_Warehouse_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'' as B_DELETETYPE,\ncast(Null as datetime) as B_DELETEDATE,\n'' as B_DELETEAUTHOR,\ncast (Null as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='ACTIVE'\n/*\n\nUnion\nSELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'\n*/",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_WareHouse_Hist"
								}
							}
						]
					},
					{
						"name": "WHLETracking_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \r\n    --ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n\t--cast(newid() as uniqueidentifier) AS WH_LE_TRACKING_ID,\r\n\tsite_id as WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'SSMASTER_RDC' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"WH_LE_TRACKING_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "WH_LE_Tracking_Hist"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-02-24T05:45:17Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_WareHouse_copy')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type \nFROM Retail.v_Site_WareHouse_inc\n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INCREMENTAL' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION\n\nFROM Retail.v_wh_legal_entity_inc WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "masterDataHubStg",
										"type": "LinkedServiceReference"
									},
									"path": "raw-zone/Warehouses"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WH_LegalEntity_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nactive_flag,\nactivity_type\nFROM Retail.v_wh_legal_entity_inc \n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.wh_legal_entity_Hist",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "wh_legal_entity_Hist"
								}
							}
						]
					},
					{
						"name": "Site_Warehouse_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nactive_flag,\nactivity_type  \nFROM Retail.v_Site_WareHouse_inc WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.Site_WareHouse_Hist",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_WareHouse_Hist"
								}
							}
						]
					},
					{
						"name": "WHLETracking_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INCREMENTAL' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.WH_LE_Tracking_Hist",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "WH_LE_Tracking_Hist"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:08Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental__ZipAllocation')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_SA_ZIP_ALLOCATION",
				"activities": [
					{
						"name": "IncrementalSAZipAllocation",
						"description": "select all data from ZipAllocation_INC_V view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE_C",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [ZIP_ALLOCATION_ID]\n      ,[CustomerNumber]\n      ,[Acct_ShipTo]\n      ,[TRADE_AREA]\n      ,[START_DATE]\n      ,[BUSINESS_TYPE]\n      ,[Status]\n      ,[PRICE_GROUP]\n      ,[ENABLE_WEB_SALE]\n      ,[IsActive]\n      ,[B_CLASSNAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n\t  ,[B_DELETETYPE]\n\t  ,[B_DELETEDATE] \n\t  ,[B_DELETEAUTHOR] \n\t  ,[B_DELETEOPERATION] \n  FROM [EDW].[ZipAllocation_INC_V]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "ZIP_ALLOCATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZIP_ALLOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TRADE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRADE_AREA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "BUSINESS_TYPE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "BUSINESS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRICE_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRICE_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ENABLE_WEB_SALE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENABLE_WEB_SALE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE_C",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_ZipAllocation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteDACLoad'\n,@P_LOAD_DESCRIPTION = 'SiteDACLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ZipAllocation_INC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_zipallocation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSAZipAllocation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_zipAllocation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSAZipAllocation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSAZipAllocation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSAZipAllocation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSAZipAllocation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_ZipAllocation_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ZipAllocation_INC",
						"description": "select all data from ZipAllocation_INC_V view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [ZIP_ALLOCATION_ID]\n      ,[CustomerNumber]\n      ,[Acct_ShipTo]\n      ,[TRADE_AREA]\n      ,[START_DATE]\n      ,[BUSINESS_TYPE]\n      ,[Status]\n      ,[PRICE_GROUP]\n      ,cast([ENABLE_WEB_SALE] as int) as ENABLE_WEB_SALE\n      ,cast([IsActive] as varchar(50)) as IsActive\n      ,[B_CLASSNAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n\t  ,[B_DELETETYPE]\n\t  ,[B_DELETEDATE] \n\t  ,[B_DELETEAUTHOR] \n\t  ,[B_DELETEOPERATION] \n        ,IsActive\n  FROM [EDW].[ZipAllocation_INC_V]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ZipCode"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ZIP_ALLOCATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZipCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CustomerNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CustomerNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Acct_ShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Acct_ShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TRADE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TradeArea",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StartDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_TYPE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "BusinessType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "PRICE_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PriceDiscGroup_GroupId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ENABLE_WEB_SALE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "EnableWebSale",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "IsActive",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActive",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_zip_inc",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Initial_00')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'Site' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nsite_id AS B_SOURCEID,\r\noperational_status AS OPERATIONAL_STATUS,\r\ntype AS TYPE,\r\naccount_num AS ACCOUNT_NUMBER,\r\nship_to_num AS SHIP_TO_NUM,\r\nmodel AS MODEL,\r\nversion AS VERSION,\r\ntime_zone AS TIME_ZONE,\r\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\r\nraw_phone AS RAW_PHONE,\r\nraw_cs_phone AS RAW_CS_PHONE,\r\nraw_fax AS RAW_FAX,\r\nsms_code AS SMS_CODE,\r\nsoft_open_date AS SOFT_OPEN_DATE,\r\ngrand_open_date AS GRAND_OPEN_DATE,\r\nclose_date AS CLOSE_DATE,\r\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\r\nbuilding_sqft AS BUILDING_SQFT,\r\nwarehouse_sqft AS WAREHOUSE_SQFT,\r\nshowroom_sqft AS SHOWROOM_SQFT,\r\noffice_sqft AS OFFICE_SQFT,\r\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\r\nretail_system_num AS RETAIL_SYSTEM_NUM, \r\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\r\ngoogle_id AS F_GOOGLE_ID,\r\nprospect_id  AS PROSPECT_ID,\r\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \r\ndma AS DMA,\r\nmsa_id AS MSA_ID,\r\nmsa AS MSA,\r\nmarket AS MARKET,\r\nregion AS REGION,\r\ndomestic_category AS DOMESTIC_CATEGORY,\r\ncountry_category AS COUNTRY_CATEGORY,\r\nCASE WHEN warehouse_account_ship_to IS NULL THEN NULL ELSE 'INITIALLOAD' END as FP_SUPPORTING_WAREHOUSE,\r\nwarehouse_account_ship_to AS FS_SUPPORTING_WAREHOUSE\r\nFROM Retail.v_site WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_HSOPCTracking_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('HSOPCTracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_HSOPCTracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('HSOPCTracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('HSOPCTracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteAdditionalInformation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG\nFROM Retail.v_site_warehouse WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "HSOPCTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by operation_id, primary_profit_center ) AS HS_OPC_TRACKING_ID,\r\n    'HomeStoreOperationProfitCenterTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_hs_opc_tracking\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SubmitLoad0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_wh_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select  LOCATION_CODE_ID,\r\nB_CLASSNAME,\r\nB_CREDATE,\r\nB_UPDDATE,\r\nB_CREATOR,\r\nB_UPDATOR,\r\nB_PUBID,\r\nFP_SITE_ID,\r\nFS_SITE_ID,\r\nOPERATION_ID,\r\nPROFIT_CENTER\r\n from Retail.locationcode_Initial_VW \r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "locationcode_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_LOCATION_CODE"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,FP_SITE_ID\r\n,FS_SITE_ID\r\nfrom Retail.RSA_Assignment_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_ASSOCIATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_RSA_ASSIGNMENT"
								}
							}
						]
					},
					{
						"name": "RSA_Associate",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nRsaID,\r\nLocationCode,\r\nLegalentityID as F_LEGAL_ENTITY,\r\nB_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\nfrom Retail.RSA_Associate_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_ASSOCIATE"
								}
							}
						]
					},
					{
						"name": "LocationCode_ErrorLoags_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_LocationCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.locationcode_Initial_VW",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-02-24T05:45:17Z"
			},
			"dependsOn": []
		}
	]
}