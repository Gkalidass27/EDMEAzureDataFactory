{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Initial_00')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'Site' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nsite_id AS B_SOURCEID,\r\noperational_status AS OPERATIONAL_STATUS,\r\ntype AS TYPE,\r\naccount_num AS ACCOUNT_NUMBER,\r\nship_to_num AS SHIP_TO_NUM,\r\nmodel AS MODEL,\r\nversion AS VERSION,\r\ntime_zone AS TIME_ZONE,\r\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\r\nraw_phone AS RAW_PHONE,\r\nraw_cs_phone AS RAW_CS_PHONE,\r\nraw_fax AS RAW_FAX,\r\nsms_code AS SMS_CODE,\r\nsoft_open_date AS SOFT_OPEN_DATE,\r\ngrand_open_date AS GRAND_OPEN_DATE,\r\nclose_date AS CLOSE_DATE,\r\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\r\nbuilding_sqft AS BUILDING_SQFT,\r\nwarehouse_sqft AS WAREHOUSE_SQFT,\r\nshowroom_sqft AS SHOWROOM_SQFT,\r\noffice_sqft AS OFFICE_SQFT,\r\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\r\nretail_system_num AS RETAIL_SYSTEM_NUM, \r\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\r\ngoogle_id AS F_GOOGLE_ID,\r\nprospect_id  AS PROSPECT_ID,\r\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \r\ndma AS DMA,\r\nmsa_id AS MSA_ID,\r\nmsa AS MSA,\r\nmarket AS MARKET,\r\nregion AS REGION,\r\ndomestic_category AS DOMESTIC_CATEGORY,\r\ncountry_category AS COUNTRY_CATEGORY,\r\nCASE WHEN warehouse_account_ship_to IS NULL THEN NULL ELSE 'INITIALLOAD' END as FP_SUPPORTING_WAREHOUSE,\r\nwarehouse_account_ship_to AS FS_SUPPORTING_WAREHOUSE\r\nFROM Retail.v_site WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_HSOPCTracking_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('HSOPCTracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_HSOPCTracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('HSOPCTracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('HSOPCTracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteAdditionalInformation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG\nFROM Retail.v_site_warehouse WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "HSOPCTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by operation_id, primary_profit_center ) AS HS_OPC_TRACKING_ID,\r\n    'HomeStoreOperationProfitCenterTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_hs_opc_tracking\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SubmitLoad0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_wh_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select  LOCATION_CODE_ID,\r\nB_CLASSNAME,\r\nB_CREDATE,\r\nB_UPDDATE,\r\nB_CREATOR,\r\nB_UPDATOR,\r\nB_PUBID,\r\nFP_SITE_ID,\r\nFS_SITE_ID,\r\nOPERATION_ID,\r\nPROFIT_CENTER\r\n from Retail.locationcode_Initial_VW \r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "locationcode_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_LOCATION_CODE"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,FP_SITE_ID\r\n,FS_SITE_ID\r\nfrom Retail.RSA_Assignment_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_ASSOCIATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_RSA_ASSIGNMENT"
								}
							}
						]
					},
					{
						"name": "RSA_Associate",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nRsaID,\r\nLocationCode,\r\nLegalentityID as F_LEGAL_ENTITY,\r\nB_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\nfrom Retail.RSA_Associate_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_ASSOCIATE"
								}
							}
						]
					},
					{
						"name": "LocationCode_ErrorLoags_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_LocationCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.locationcode_Initial_VW",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Initial_StoreMaster')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'Site' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nsite_id AS B_SOURCEID,\r\noperational_status AS OPERATIONAL_STATUS,\r\ntype AS TYPE,\r\naccount_num AS ACCOUNT_NUMBER,\r\nship_to_num AS SHIP_TO_NUM,\r\nmodel AS MODEL,\r\nversion AS VERSION,\r\ntime_zone AS TIME_ZONE,\r\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\r\nraw_phone AS RAW_PHONE,\r\nraw_cs_phone AS RAW_CS_PHONE,\r\nraw_fax AS RAW_FAX,\r\nsms_code AS SMS_CODE,\r\nsoft_open_date AS SOFT_OPEN_DATE,\r\ngrand_open_date AS GRAND_OPEN_DATE,\r\nclose_date AS CLOSE_DATE,\r\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\r\nbuilding_sqft AS BUILDING_SQFT,\r\nwarehouse_sqft AS WAREHOUSE_SQFT,\r\nshowroom_sqft AS SHOWROOM_SQFT,\r\noffice_sqft AS OFFICE_SQFT,\r\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\r\nretail_system_num AS RETAIL_SYSTEM_NUM, \r\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\r\ngoogle_id AS F_GOOGLE_ID,\r\nprospect_id  AS PROSPECT_ID,\r\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \r\ndma AS DMA,\r\nmsa_id AS MSA_ID,\r\nmsa AS MSA,\r\nmarket AS MARKET,\r\nregion AS REGION,\r\ndomestic_category AS DOMESTIC_CATEGORY,\r\ncountry_category AS COUNTRY_CATEGORY,\r\nCASE WHEN warehouse_account_ship_to IS NULL THEN NULL ELSE 'INITIALLOAD' END as FP_SUPPORTING_WAREHOUSE,\r\nwarehouse_account_ship_to AS FS_SUPPORTING_WAREHOUSE\r\nFROM Retail.v_site WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_HSOPCTracking_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('HSOPCTracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_HSOPCTracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('HSOPCTracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('HSOPCTracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteAdditionalInformation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "HSOPCTracking",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by operation_id, primary_profit_center ) AS HS_OPC_TRACKING_ID,\r\n    'HomeStoreOperationProfitCenterTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_hs_opc_tracking\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Initial_WareHouse')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG\nFROM Retail.v_site_warehouse WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_wh_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_TrackingHS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LoadRecordsForSiteTrackingDeletion",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT SITE_ID\nFROM Retail.v_site_changed",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "DELETE FROM dbo.ASH_REMOVE_SITE_TRACKING\nWHERE SITE_ID NOT LIKE '%-WAREHOUSE'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_ASH_REMOVE_SITE_TRACKING",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetMaxHSTrackingID",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeleteHSTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT INT\n\nEXECUTE dbo.GET_MAX_TRACKING_ID @TrackingIdType = 'HS_OPC', @RETURN_VALUE_ARGUMENT=null\n\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "DeleteHSTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadRecordsForSiteTrackingDeletion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n     OPCTRACKING.HS_OPC_TRACKING_ID,\n     'HomeStoreOperationProfitCenterTracking' AS B_CLASSNAME,\n\t'HARD_DELETE' AS B_DELETETYPE,\n     CAST(NEWID() AS NVARCHAR(128)) AS B_DELETEOPERATION,\n     GETDATE() AS B_DELETEDATE,\n     'semadmin' AS B_DELETEAUTHOR\nFROM DBO.GD_HS_OPC_TRACKING AS OPCTRACKING\nINNER JOIN (SELECT * FROM DBO.ASH_REMOVE_SITE_TRACKING WHERE SITE_ID NOT LIKE '%-WAREHOUSE') AS REMOVEREC\n     ON OPCTRACKING.FS_SITE_ID = REMOVEREC.SITE_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadHSTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetMaxHSTrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\n\t@{variables('MaxHSOPCTrackingID')} + ROW_NUMBER() OVER (PARTITION BY 1 order by site_id, operation_id, primary_profit_center ) AS HS_OPC_TRACKING_ID,\n    'HomeStoreOperationProfitCenterTracking' as B_CLASSNAME,\n\tGETDATE() AS B_CREDATE,\n\tGETDATE() AS B_UPDDATE,\n\t'semadmin' AS B_CREATOR,\n\t operation_id AS OPERATION_ID,\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\n\t erp_database_name AS ERP_DATABASE_NAME,\n\t erp_system_name AS ERP_SYSTEM_NAME,\n\t effective_start_date AS EFFECTIVE_START_DATE,\n\t effective_end_date AS EFFECTIVE_END_DATE,\n\t legacy_location_id AS LEGACY_LOCATION_ID,\n\t site_name AS SITE_NAME,\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\n\t lic_territory AS LIC_TERRITORY,\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\n\t notes AS NOTES,\n\t os_id AS OS_ID,\n\t os_location_id AS OS_LOCATION_ID,\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\n\t raw_city AS SITE_RAW_CITY,\n\t raw_state AS SITE_RAW_STATE,\n\t raw_state_code AS SITE_RAW_STATE_CODE,\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\n\t raw_country AS SITE_RAW_COUNTRY,\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\n\t raw_latitude AS SITE_RAW_LATITUDE,\n\t raw_longitude AS SITE_RAW_LONGITUDE,\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\n\t 'INITIALLOAD' AS FP_SITE_ID,\n\t site_id AS FS_SITE_ID      \nFROM Retail.v_hs_opc_tracking_incremental",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SetMaxHSTrackingID",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetMaxHSTrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "MaxHSOPCTrackingID",
							"value": {
								"value": "@activity('GetMaxHSTrackingID').output.firstRow.RETURN_VALUE_ARGUMENT",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"B_LOADID": {
						"type": "string"
					}
				},
				"variables": {
					"MaxHSOPCTrackingID": {
						"type": "Integer"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_TrackingWH')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LoadRecordsForSiteTrackingWHDeletion",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT SITE_ID\nFROM Retail.v_site_warehouse_changed",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "DELETE FROM dbo.ASH_REMOVE_SITE_TRACKING\nWHERE SITE_ID LIKE '%-WAREHOUSE'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_ASH_REMOVE_SITE_TRACKING",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_WH_LE_Tracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadRecordsForSiteTrackingWHDeletion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n     TRACKING.WH_LE_TRACKING_ID,\n     'WarehouseLegalEntityTracking' AS B_CLASSNAME,\n\t'HARD_DELETE' AS B_DELETETYPE,\n     CAST(NEWID() AS NVARCHAR(128)) AS B_DELETEOPERATION,\n     GETDATE() AS B_DELETEDATE,\n     'semadmin' AS B_DELETEAUTHOR\nFROM DBO.GD_WH_LE_TRACKING AS TRACKING\nINNER JOIN (SELECT * FROM DBO.ASH_REMOVE_SITE_TRACKING WHERE SITE_ID LIKE '%WAREHOUSE') AS REMOVEREC\n     ON TRACKING.FS_SITE_ID = REMOVEREC.SITE_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetMax_WH_LE_TrackingID",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete_WH_LE_Tracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT INT\n\nEXECUTE dbo.GET_MAX_TRACKING_ID @TrackingIdType = 'WH_LE', @RETURN_VALUE_ARGUMENT=null\n\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetMax_WH_LE_TrackingID",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetMax_WH_LE_TrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "MaxWHLETrackingID",
							"value": {
								"value": "@activity('GetMax_WH_LE_TrackingID').output.firstRow.RETURN_VALUE_ARGUMENT",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LoadWHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetMax_WH_LE_TrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\n\t@{variables('MaxWHLETrackingID')} + ROW_NUMBER() OVER (PARTITION BY 1 order by site_id, legal_entity_id ) AS WH_LE_TRACKING_ID,\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\n\tGETDATE() AS B_CREDATE,\n\tGETDATE() AS B_UPDDATE,\n\t'semadmin' AS B_CREATOR,\n\tCAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\n\t--CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\n\t site_name AS SITE_NAME,\n\t notes AS NOTES,\n\t legacy_location_id AS LEGACY_LOCATION_ID,\n\t os_id AS OS_ID,\n\t os_location_id AS OS_LOCATION_ID,\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\n\t raw_city AS SITE_RAW_CITY,\n\t raw_state AS SITE_RAW_STATE,\n\t raw_state_code AS SITE_RAW_STATE_CODE,\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\n\t raw_country AS SITE_RAW_COUNTRY,\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\n\t raw_latitude AS SITE_RAW_LATITUDE,\n\t raw_longitude AS SITE_RAW_LONGITUDE,\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\n\t 'INITIALLOAD' AS FP_SITE_ID,\n\t site_id AS FS_SITE_ID       \nFROM Retail.v_wh_le_tracking_incremental",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"B_LOADID": {
						"type": "string"
					}
				},
				"variables": {
					"MaxWHLETrackingID": {
						"type": "Integer"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_W_SiteMaster_SemarchyStaging_Semarchy')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_WHSMST_STG_Semarchy",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('B_LOADID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select DISTINCT\nWarehouse_ID,\n[Description],\nSite_ID,\nwmaIntransitWarehouse as INTRANSIT_WAREHOUSE,\nwmaWarehouseType as WAREHOUSE_TYPE,\nwmaWarehouseOrderGroup as WAREHOUSE_ORDER_GROUP,\nwmaDefaultPortId as DEFAULT_PORT_ID,\nwmaPrinterName as PRINTER_NAME,\nwmaZebraPrinter as Zebra_printer,\nwmaSendBolsToManu as SEND_BOLS_TO_MANU,\nwmaOrderReleaseMin as ORDER_RELEASE_MIN,\nwmaAsOverhead as AS_OVERHEAD,\nwmaAsFreight as AS_FREIGHT,\nwmaContainerDirectWhse as CONTAINER_DIRECT_WHSE,\nacrec as Status,\npltLocationID as LOCATION_ID,\npltPartyID as PARTY_ID,\npaaAddress1 as ADDRESS1,\npaaAddress2 as ADDRESS2,\npaaCity as CITY,\npaaState as STATE,\npaaCountry as COUNTRY,\npaaGeocodeLatitude as GEOCODE_LATITUDE,\npaaGeocodeLongitude as GEOCODE_LONGITUDE,\npaaZipCode as ZIP_CODE,\npaaCountyCode as COUNTY_CODE,\ndtea as DATE_AND_TIME,\nB_CLASSNAME,\nB_CREDATE,B_CREATOR,B_UPDDATE,B_UPDATOR\n from [Wholesale].[WHSMST_VW]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Warehouse_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WAREHOUSE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Site_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "INTRANSIT_WAREHOUSE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "INTRANSIT_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_TYPE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "WAREHOUSE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_ORDER_GROUP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WAREHOUSE_ORDER_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DEFAULT_PORT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DEFAULT_PORT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRINTER_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRINTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SEND_BOLS_TO_MANU",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SEND_BOLS_TO_MANU",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ORDER_RELEASE_MIN",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ORDER_RELEASE_MIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AS_OVERHEAD",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AS_OVERHEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AS_FREIGHT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AS_FREIGHT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTAINER_DIRECT_WHSE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "CONTAINER_DIRECT_WHSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PARTY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PARTY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ADDRESS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ADDRESS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GEOCODE_LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "GEOCODE_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GEOCODE_LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "GEOCODE_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ZIP_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZIP_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTY_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "COUNTY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DATE_AND_TIME",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "DATE_AND_TIME",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Zebra_printer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZEBRA_PRINTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_WHSMST",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Wholesale_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"Tablename": "SA_WAREHOUSE_MASTER",
									"Schemaname": "dbo"
								}
							}
						]
					},
					{
						"name": "Load_PortMaster_STG_Semarchy",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_WHSMST_STG_Semarchy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_loadId",
										"value": {
											"value": "@variables('B_LOADID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select \r\nASHLEY_PORT_ID,\r\nACE_PORT_CODE,\r\n[Description],\r\nCITY,\r\nCountry_code,\r\nB_CLASSNAME,\r\nB_CREDATE,\r\nB_CREATOR,\r\nB_UPDDATE,\r\nB_UPDATOR\r\nfrom [Wholesale].[PortMaster_vw]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "masterDataHubStg",
										"type": "LinkedServiceReference"
									},
									"path": "test"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_loadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "ASHLEY_PORT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASHLEY_PORT_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACE_PORT_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACE_PORT_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Country_code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_SemStaging_Portmaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Wholesale_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"Tablename": "SA_PORT_MASTER",
									"Schemaname": "dbo"
								}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Wholesale_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "B_LOADID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_PortMaster_STG_Semarchy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "PortWarehouseLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('B_LOADID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WHSMST",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_WHSMST_STG_Semarchy",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_WHSMST_STG_Semarchy').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_WHSMST_STG_Semarchy').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_WHSMST_STG_Semarchy').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_WHSMST_STG_Semarchy').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_WHSMST_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_PortMaster_STG_Semarchy",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_PortMaster_STG_Semarchy').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_PortMaster_STG_Semarchy').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_PortMaster_STG_Semarchy').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_PortMaster_STG_Semarchy').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"B_LOADID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Wholesale/W_SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/MasterData_Validation_Flow')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Customer_Fake_Address",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "FakeAddressPhrase",
											"type": "String"
										},
										"sink": {
											"name": "FakeAddressPhrase",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Address_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Address",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Address_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Address",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AddressLine1",
											"type": "String"
										},
										"sink": {
											"name": "AddressLine1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Zipcode",
											"type": "String"
										},
										"sink": {
											"name": "Zipcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Address_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Address_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_Schema_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Email",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Address_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "FakeEmailPhrase",
											"type": "String"
										},
										"sink": {
											"name": "FakeEmailPhrase",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Email_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Email",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Email_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Email",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Email",
											"type": "String"
										},
										"sink": {
											"name": "Email",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Email_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Email_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Phone_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Email_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Phone",
											"type": "String"
										},
										"sink": {
											"name": "Phone",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Phone_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Phone_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "StageInitialLoadRetailChunkControl",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Phone_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SeqID",
											"type": "String"
										},
										"sink": {
											"name": "SeqID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "FirstNameInitial",
											"type": "String"
										},
										"sink": {
											"name": "FirstNameInitial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "dtComplete",
											"type": "String"
										},
										"sink": {
											"name": "dtComplete",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "RunCount",
											"type": "String"
										},
										"sink": {
											"name": "RunCount",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ProdCountDec2022",
											"type": "String"
										},
										"sink": {
											"name": "ProdCountDec2022",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "dtPrevious",
											"type": "String"
										},
										"sink": {
											"name": "dtPrevious",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "StageInitialLoadRetailChunkControl_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "StageInitialLoadRetailChunkControl",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_TableName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"Customer_Fake_Address_FileName": {
						"type": "String"
					},
					"Customer_Fake_Address_Schema": {
						"type": "String"
					},
					"Customer_Fake_Address_TableName": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_Schema_TableName": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_Schema": {
						"type": "String"
					},
					"Customer_Fake_Email_TableName": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_TableName": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_TableName": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_FileName": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_Schema": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_TableName": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_For_Dynamics_PostalCodes')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GD_GBL_DYNAMICS_US",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as zipZctyab\n,left(CITY_NAME,25) as zipZctynm\n,case when COUNTRY_CODE='US' then 'USA' else COUNTRY_CODE end as zipZcountry\n,right(FIPS_Code,3) as zipZconyn\n,case when IS_PREFERRED_CITY_NAME='True' then 1\nelse 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as zipLat\n,cast(Longitude as decimal(8,4))as zipLong\n,case when MSA_CODE is not null then MSA_CODE\nelse '' end\nas zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as zipDayLightSavings\n,right(replicate('0',5)+ convert(varchar(5),POSTAL_CODE),5) as \n zipZzipcd\n,POSTAL_CODE_TYPE as zipType\n,STATE_OR_PROVINCE_CODE as zipZstate\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as zipTimeZoneCode,\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='US'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipDayLightSavings",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "zipDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipPreferred",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "zipPreferred",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMGBLUS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_SQL_DYNAMICS_US",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_GBL_DYNAMICS_US",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as zipZctyab\n,left(CITY_NAME,25) as zipZctynm\n,case when COUNTRY_CODE='US' then 'USA' else COUNTRY_CODE end as zipZcountry\n,right(FIPS_Code,3) as zipZconyn\n,case when IS_PREFERRED_CITY_NAME='True' then 1\nelse 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as zipLat\n,cast(Longitude as decimal(8,4))as zipLong\n,case when MSA_CODE is not null then MSA_CODE\nelse '' end\nas zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as zipDayLightSavings\n,right(replicate('0',5)+ convert(varchar(5),POSTAL_CODE),5) as \n zipZzipcd\n,case when POSTAL_CODE_TYPE is null then '' \nelse POSTAL_CODE_TYPE end as zipType\n,STATE_OR_PROVINCE_CODE as zipZstate\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as zipTimeZoneCode,\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='US'\n\n\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipDayLightSavings",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipPreferred",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "zipPreferred",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "zipType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipType",
											"type": "String",
											"physicalType": "char"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMSTGUSSQLDYNAMICS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_GBL_DYNAMICS_CAN",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_SQL_DYNAMICS_US",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as [znuCityAbbrev]\n,left(CITY_NAME,30) as [znuCity]\n,case when COUNTRY_CODE='CA' then 'CAN' else COUNTRY_CODE end as [znuCountryCode]\n--,right(FIPS_Code,3) as zipZconyn\n--,case when IS_PREFERRED_CITY_NAME='True' then 1\n--else 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as [znuLat]\n,cast(Longitude as decimal(8,4))as [znuLong]\n--,case when MSA_CODE is not null then MSA_CODE\n--else '' end as zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as [znuDayLightSavings]\n,concat(left(postal_code,3),' ',right(postal_code,3)) as\n[znuPostalCode]\n--,POSTAL_CODE_TYPE as zipType\n,case when \nSTATE_OR_PROVINCE_CODE ='NL' then 'NF' else STATE_OR_PROVINCE_CODE end as [znuProvince]\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as [znuTimeZone],\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='CA'\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMSTGGBLDYNAMICSCAN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_SQL_DYNAMICS_CAN",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_GBL_DYNAMICS_CAN",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as [znuCityAbbrev]\n,left(CITY_NAME,30) as [znuCity]\n,case when COUNTRY_CODE='CA' then 'CAN' else COUNTRY_CODE end as [znuCountryCode]\n--,right(FIPS_Code,3) as zipZconyn\n--,case when IS_PREFERRED_CITY_NAME='True' then 1\n--else 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as [znuLat]\n,cast(Longitude as decimal(8,4))as [znuLong]\n--,case when MSA_CODE is not null then MSA_CODE\n--else '' end as zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as [znuDayLightSavings]\n,concat(left(postal_code,3),' ',right(postal_code,3)) as\n[znuPostalCode]\n--,POSTAL_CODE_TYPE as zipType\n,case when \nSTATE_OR_PROVINCE_CODE ='NL' then 'NF' else STATE_OR_PROVINCE_CODE end as [znuProvince]\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as [znuTimeZone],\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='CA'\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMSTGSQLDYNAMICSCAN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_PostalCode')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Mtce_Stage_PostalCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT * FROM [dbo].[GD_ENT_REF_POSTAL_CODE]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE Scratch.GD_ENT_REF_POSTAL_CODE",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OBSERVES_DST",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "OBSERVES_DST",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										},
										"sink": {
											"name": "LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										},
										"sink": {
											"name": "LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Scratch_GD_ENT_REF_POSTAL_CODE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_SiteMaster_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetJsongFilesList",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Store_Details_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "JsonReadSettings"
							}
						}
					},
					{
						"name": "LoadJsonFiles",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "GetJsongFilesList",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('GetJsongFilesList').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "GetJsoncontains",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"dataset": {
											"referenceName": "Fetch_Location_Json",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									}
								},
								{
									"name": "LoadJsonContainsToJsonPayLoad",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "GetJsoncontains",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('GetJsoncontains').output.firstRow}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@{activity('GetJsoncontains').output.firstRow.LocationID}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Province_Code_Validation')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LUP_STATEORPROVINCECODE",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Concate_Postal_code",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select Count(*) as STATE_OR_PROVINCE_CODE from [Ref_PostalCode].[PostalCode]   WHERE COUNTRY_CODE = 'CA' AND STATE_OR_PROVINCE_CODE = '--'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_postalcode_StateOrProvinceCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "CHK_PROVINCE_CODE",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "LUP_STATEORPROVINCECODE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('LUP_STATEORPROVINCECODE').output.firstRow.STATE_OR_PROVINCE_CODE, 0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "NoActionRequired",
									"description": "NoActionRequired",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "NoActionRequired",
										"value": {
											"value": "NoActionRequired",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Notification_State_Or_Provencecode",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "'STATE_OR_PROVINCE_CODE having --'",
												"type": "Expression"
											},
											"status": {
												"value": "'LUP_STATEORPROVINCECODE'",
												"type": "Expression"
											},
											"message": {
												"value": "@{concat('The following PostalCodes not assigned the STATE_OR_PROVINCE_CODE: ', variables('Concate_Postal'))}",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "''",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "LUP_STATEORPROVINCECODE_Value",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "Select Postal_code from [Ref_PostalCode].[PostalCode]   WHERE COUNTRY_CODE = 'CA' AND \nSTATE_OR_PROVINCE_CODE = '--'\n\nselect 1 as ret",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_postalcode_StateOrProvinceCode",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Postal_Code_Append",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "LUP_STATEORPROVINCECODE_Value",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@array(activity('LUP_STATEORPROVINCECODE_Value').output.value)",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Append_Postalcodes",
									"description": "Append_Postalcodes",
									"type": "AppendVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Append_PC",
										"value": {
											"value": "@item().Postal_code",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Concate_Postal_code",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Postal_Code_Append",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Concate_Postal",
							"value": {
								"value": "@{join(variables('Append_PC'), ', ')}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"NoActionRequired": {
						"type": "String"
					},
					"notificaon": {
						"type": "String"
					},
					"Concate_Postal": {
						"type": "String"
					},
					"Append_PC": {
						"type": "Array"
					},
					"StateOrProvinceCode": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ReProcess_ErrorFiles_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move_Error_Container_Files",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"wildcardFolderPath": "Error",
									"wildcardFileName": {
										"value": "*.csv",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Error_Files_From_ErrorFolder",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Move_Error_Files_RetailCustomer_Container",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Remove_Error_Files_From_ErrorFolder",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": false,
								"wildcardFileName": {
									"value": "*.csv",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Error_Folder_Reprocess_Error_Logs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Move_Error_Container_Files').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Reprocess_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": null,
									"type": "Int32"
								},
								"RowsRead": {
									"value": null,
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"FileCheck": {
						"type": "String"
					},
					"TableSchema": {
						"type": "String"
					},
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Remove_RetailCustomerLoad_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Remove_Archive_Files",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@adddays(startOfDay(utcnow()),-100)",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@adddays(startOfDay(utcnow()),-20)",
									"type": "Expression"
								},
								"wildcardFileName": "*.csv",
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Incremental_SiteMaster_Mappings')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Assign_new_legalEntity_Id",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Assign_new_legalEntity_Id_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Load Legal entity id to new Licensee"
							}
						],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[StoreMasterCustom_Sites_JoinCodes]\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Assign_new_legalEntity_Id_Warehouse",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Load Legal entity id to new Licensee"
							}
						],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_WH_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Assign_new_legalEntity_Id",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCodeAutomation_US')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Getlicensekey_Melissa",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "To get license key from KV"
							}
						],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"url": {
								"value": "@pipeline().globalParameters.Melissa_LicenseKey",
								"type": "Expression"
							},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "Set Licensekey",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Getlicensekey_Melissa",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set License key to variable"
							}
						],
						"typeProperties": {
							"variableName": "license_key",
							"value": {
								"value": "@activity('Getlicensekey_Melissa').output.value",
								"type": "Expression"
							}
						}
					},
					{
						"name": "GetFilelist",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set Licensekey",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Get folder available list from Release URL"
							}
						],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"httpRequestTimeout": "00:10:00",
							"url": {
								"value": "@concat('https://releases.melissadata.net/releases/data/z5max.txt?FORMAT=JSON&ID=',variables('license_key'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Filter_LatestFileProcessed",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Set ProcessedForYearMonth",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [
							{
								"name": "Task",
								"value": "Filter latest file to be processed in this run"
							}
						],
						"typeProperties": {
							"items": {
								"value": "@variables('parsedatelist')",
								"type": "Expression"
							},
							"condition": {
								"value": "@greater(item(), variables('Processed_for_YrMonth_lkp'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Datelist",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetFilelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set Folderlist to variable"
							}
						],
						"typeProperties": {
							"variableName": "datelist",
							"value": {
								"value": "@activity('GetFilelist').output.Response",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set parsedatelist",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Datelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Parse Json to array"
							}
						],
						"typeProperties": {
							"variableName": "parsedatelist",
							"value": {
								"value": "@json(variables('datelist'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup_LastFileProcessed",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set parsedatelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Get processed file list from previous run"
							}
						],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select max(Processed_for_YrMonth) as Processed_for_YrMonth from Retail.Postalcode_Processed_files",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Postalcode_Processed_files",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set ProcessedForYearMonth",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_LastFileProcessed",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set previously processed file to variable"
							}
						],
						"typeProperties": {
							"variableName": "Processed_for_YrMonth_lkp",
							"value": {
								"value": "@activity('Lookup_LastFileProcessed').output.firstRow.Processed_for_YrMonth\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter_LatestFileProcessed",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [
							{
								"name": "Task",
								"value": "For each Files"
							}
						],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter_LatestFileProcessed').output.Value\n",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "If Condition1",
									"type": "IfCondition",
									"dependsOn": [
										{
											"activity": "Set variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [
										{
											"name": "Task",
											"value": "Will execute if latest file from Release url > previously processed file"
										}
									],
									"typeProperties": {
										"expression": {
											"value": "@greater(length(activity('Filter_LatestFileProcessed').output.value),0)\n",
											"type": "Expression"
										},
										"ifFalseActivities": [
											{
												"name": "Teams_Failed_Notification_PostalCode",
												"type": "ExecutePipeline",
												"dependsOn": [],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team "
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Filter_LatestFileProcessed').output.executionDetails[0].start\n",
															"type": "Expression"
														},
														"status": {
															"value": "'Success'",
															"type": "Expression"
														},
														"message": {
															"value": "'Not yet received Melissa data'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Filter_LatestFileProcessed').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
															"type": "Expression"
														}
													}
												}
											}
										],
										"ifTrueActivities": [
											{
												"name": "Set variable2",
												"type": "SetVariable",
												"dependsOn": [],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Set new file to be processed"
													}
												],
												"typeProperties": {
													"variableName": "New_processed_YearMonth",
													"value": {
														"value": "@item()",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Copy_PostalCode_US",
												"type": "Copy",
												"dependsOn": [
													{
														"activity": "Set variable2",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "0.10:00:00",
													"retry": 2,
													"retryIntervalInSeconds": 60,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Copy File from download URL to Blob container"
													}
												],
												"typeProperties": {
													"source": {
														"type": "HttpSource",
														"httpRequestTimeout": "00:01:40"
													},
													"sink": {
														"type": "BinarySink",
														"storeSettings": {
															"type": "AzureBlobFSWriteSettings"
														}
													},
													"enableStaging": false
												},
												"inputs": [
													{
														"referenceName": "HttpDataset2",
														"type": "DatasetReference",
														"parameters": {
															"ID": {
																"value": "@variables('license_key')",
																"type": "Expression"
															},
															"Currentmonthyear": {
																"value": "@variables('New_processed_YearMonth')",
																"type": "Expression"
															}
														}
													}
												],
												"outputs": [
													{
														"referenceName": "DS_PostalCode_US",
														"type": "DatasetReference",
														"parameters": {
															"Filename": {
																"value": "@concat('z5max','.txt')",
																"type": "Expression"
															},
															"FolderName": {
																"value": "@pipeline().parameters.FolderName",
																"type": "Expression"
															}
														}
													}
												]
											},
											{
												"name": "Teams_Success_Notification_PostalCode_copy1",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Script1",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team about new file processed"
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Copy_PostalCode_US').output.executionDetails[0].start",
															"type": "Expression"
														},
														"status": {
															"value": "@activity('Copy_PostalCode_US').output.executionDetails[0].status",
															"type": "Expression"
														},
														"message": {
															"value": "'Postal codes file available in blob container'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Copy_PostalCode_US').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
															"type": "Expression"
														}
													}
												}
											},
											{
												"name": "Script1",
												"type": "Script",
												"dependsOn": [
													{
														"activity": "Set ApiPath",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "0.12:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Update file processed to Retail.Postalcode_Processed_files table"
													}
												],
												"linkedServiceName": {
													"referenceName": "semarchy_staging",
													"type": "LinkedServiceReference"
												},
												"typeProperties": {
													"scripts": [
														{
															"type": "Query",
															"text": {
																"value": "@concat('INSERT INTO Retail.Postalcode_Processed_files ',\n'(',\n'Country, ',\n'API_path, ',\n'Processed_date, ',\n'Processed_for_YrMonth',\n') ',\n'VALUES ',\n'(',\n'''US'', ',\n'''', variables('Api_Path'), ''', ',\n'GETDATE(), ',\n'''', variables('New_processed_YearMonth'), '''',\n')'\n)",
																"type": "Expression"
															}
														}
													],
													"scriptBlockExecutionTimeout": "02:00:00"
												}
											},
											{
												"name": "Set ApiPath",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "Copy_PostalCode_US",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Set API path"
													}
												],
												"typeProperties": {
													"variableName": "Api_Path",
													"value": {
														"value": "@concat('https://releases.melissadata.net/Download/Data/',variables('New_processed_YearMonth'),'/z5max.txt?ID={{licenseKey}}')",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Teams_Failed_Notification_PostalCode_Failed",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Copy_PostalCode_US",
														"dependencyConditions": [
															"Failed"
														]
													}
												],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team "
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Filter_LatestFileProcessed').output.executionDetails[0].start\n",
															"type": "Expression"
														},
														"status": {
															"value": "'Failure'",
															"type": "Expression"
														},
														"message": {
															"value": "'File Copy failed . Please have a look'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Filter_LatestFileProcessed').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
															"type": "Expression"
														}
													}
												}
											}
										]
									}
								},
								{
									"name": "Set variable",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Task",
											"value": "Latest file from Release URL"
										}
									],
									"typeProperties": {
										"variableName": "New_processed_YearMonth",
										"value": {
											"value": "@item()",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"FolderName": {
						"type": "string",
						"defaultValue": "Postal_Code_Source_Files"
					},
					"GetLicensekey": {
						"type": "string",
						"defaultValue": "https://afide-edmekv.vault.azure.net/secrets/melissa-data-license-key/b0d3207214ea4b0b9fef24ac132a17e1?api-version=7.0"
					}
				},
				"variables": {
					"license_key": {
						"type": "String"
					},
					"folder": {
						"type": "Array"
					},
					"datelist": {
						"type": "String"
					},
					"parsedatelist": {
						"type": "Array"
					},
					"dummy": {
						"type": "String"
					},
					"Processed_for_YrMonth_lkp": {
						"type": "String"
					},
					"Api_Path": {
						"type": "String"
					},
					"insert_stmt": {
						"type": "String"
					},
					"New_processed_YearMonth": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_Postal_Code",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "US"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ST",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "A/C",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "County",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "County",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Pref?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Pref",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "T/Z",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TZ",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DST?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Lat",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Lat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Long",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Long",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Div",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Div",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USA_Zip_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_USA": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "US_Zip_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CANADA_Postal_Code",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "CA"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Latitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Longitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Province",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Province",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Canada_Postal_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_canada": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CANADA_Postal_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": "*.*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_Code_Archive",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Postal_Code_Succeed_Files_Delete",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": "*.*",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_US_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.US_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_CANADA_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.CANADA_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('US_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('US_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('US_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is US Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('US_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('US_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('US_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "US_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('US_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('CANADA_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('CANADA_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Canada Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CANADA_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CANADA_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('CANADA_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "z5max.txt"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "zipcodeset.txt"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LOAD_EDW_Kit",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Kit]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "SeriesID",
											"type": "String"
										},
										"sink": {
											"name": "SeriesID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesKey",
											"type": "Int64"
										},
										"sink": {
											"name": "SeriesKey",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitColorKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitColorKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitStatusKey",
											"type": "String"
										},
										"sink": {
											"name": "KitStatusKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitClassKey",
											"type": "String"
										},
										"sink": {
											"name": "KitClassKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										},
										"sink": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitType",
											"type": "String"
										},
										"sink": {
											"name": "KitType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "KitExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										},
										"sink": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAXKitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitAXKitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "KitDead",
											"type": "String"
										},
										"sink": {
											"name": "KitDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitBoxQty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitBoxQty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeats",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSeats",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitUPC",
											"type": "String"
										},
										"sink": {
											"name": "KitUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "KitARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "KitStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										},
										"sink": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "KitForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSelllingCountries",
											"type": "String"
										},
										"sink": {
											"name": "KitSelllingCountries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitThirdPartyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitThirdPartyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "KitRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKnockout",
											"type": "String"
										},
										"sink": {
											"name": "KitKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "KitColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPhoto",
											"type": "String"
										},
										"sink": {
											"name": "KitPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "KitGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "KitProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCubesFt",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesFt",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCubesM",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "KitHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKeyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitKeyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "KitTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "KitTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "KitValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusive",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCommodity",
											"type": "String"
										},
										"sink": {
											"name": "KitCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUpholsteryCover",
											"type": "String"
										},
										"sink": {
											"name": "KitUpholsteryCover",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										},
										"sink": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPurchaseType",
											"type": "String"
										},
										"sink": {
											"name": "KitPurchaseType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPartsDrawings",
											"type": "String"
										},
										"sink": {
											"name": "KitPartsDrawings",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										},
										"sink": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										},
										"sink": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitATPSeries",
											"type": "String"
										},
										"sink": {
											"name": "KitATPSeries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitVendorName",
											"type": "String"
										},
										"sink": {
											"name": "KitVendorName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "KitComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMaterialEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitMaterialEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Kit",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KIT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Package",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Kit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Package]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PackageID",
											"type": "String"
										},
										"sink": {
											"name": "PackageID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKey",
											"type": "Int32"
										},
										"sink": {
											"name": "PackageKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "HomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "HomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHero",
											"type": "String"
										},
										"sink": {
											"name": "PackageHero",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatus",
											"type": "String"
										},
										"sink": {
											"name": "PackageStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageIsThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "PackageIsThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageWholesaleID",
											"type": "String"
										},
										"sink": {
											"name": "PackageWholesaleID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRetailType",
											"type": "String"
										},
										"sink": {
											"name": "PackageRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageItemQuantity",
											"type": "String"
										},
										"sink": {
											"name": "PackageItemQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageUOM",
											"type": "String"
										},
										"sink": {
											"name": "PackageUOM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageColor",
											"type": "String"
										},
										"sink": {
											"name": "PackageColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKnockout",
											"type": "String"
										},
										"sink": {
											"name": "PackageKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationNotes",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRolloverImage",
											"type": "String"
										},
										"sink": {
											"name": "PackageRolloverImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "PackageExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTransition",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTransition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										},
										"sink": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageDefaultProduct",
											"type": "String"
										},
										"sink": {
											"name": "PackageDefaultProduct",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageChannelChange",
											"type": "String"
										},
										"sink": {
											"name": "PackageChannelChange",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExclusive",
											"type": "String"
										},
										"sink": {
											"name": "PackageExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										},
										"sink": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHiddenField",
											"type": "String"
										},
										"sink": {
											"name": "PackageHiddenField",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageConsumerChoice",
											"type": "String"
										},
										"sink": {
											"name": "PackageConsumerChoice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										},
										"sink": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommFlags",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommFlags",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNavigableCategories",
											"type": "String"
										},
										"sink": {
											"name": "PackageNavigableCategories",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Product",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Package",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Product]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SystemTimestamp",
											"type": "Int32"
										},
										"sink": {
											"name": "SystemTimestamp",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "AlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "AlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "ItemARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemBoxQty",
											"type": "String"
										},
										"sink": {
											"name": "ItemBoxQty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemClass",
											"type": "String"
										},
										"sink": {
											"name": "ItemClass",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColor",
											"type": "String"
										},
										"sink": {
											"name": "ItemColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "ItemColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCommodity",
											"type": "String"
										},
										"sink": {
											"name": "ItemCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "ItemComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesFt",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesFt",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesM",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDead",
											"type": "String"
										},
										"sink": {
											"name": "ItemDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "ItemDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										},
										"sink": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										},
										"sink": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusive",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "ItemExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										},
										"sink": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "ItemGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemImportDomestic",
											"type": "String"
										},
										"sink": {
											"name": "ItemImportDomestic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKeyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemKeyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKnockout",
											"type": "String"
										},
										"sink": {
											"name": "ItemKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMfgWarranty",
											"type": "String"
										},
										"sink": {
											"name": "ItemMfgWarranty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemPhoto",
											"type": "String"
										},
										"sink": {
											"name": "ItemPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailBrandName",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailBrandName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailType",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "ItemRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeats",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeats",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatusChanged",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatusChanged",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemType",
											"type": "String"
										},
										"sink": {
											"name": "ItemType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUPC",
											"type": "String"
										},
										"sink": {
											"name": "ItemUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "ItemValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffAFI",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffAFI",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffPrint",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffPrint",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										},
										"sink": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesDivision",
											"type": "String"
										},
										"sink": {
											"name": "SeriesDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesFeatures",
											"type": "String"
										},
										"sink": {
											"name": "SeriesFeatures",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesId",
											"type": "String"
										},
										"sink": {
											"name": "SeriesId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesIntroDate",
											"type": "String"
										},
										"sink": {
											"name": "SeriesIntroDate",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesMainImage",
											"type": "String"
										},
										"sink": {
											"name": "SeriesMainImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesName",
											"type": "String"
										},
										"sink": {
											"name": "SeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "SeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										},
										"sink": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesShowroom",
											"type": "String"
										},
										"sink": {
											"name": "SeriesShowroom",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesSourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SeriesSourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "SeriesStatus",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesStyle",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "SeriesThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesPrimary",
											"type": "String"
										},
										"sink": {
											"name": "SeriesPrimary",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterial",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_ProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Product",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE  [EDW].[ProductPackageCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_ProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[KitComponentCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "ComponentType",
											"type": "String"
										},
										"sink": {
											"name": "ComponentType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentID",
											"type": "String"
										},
										"sink": {
											"name": "ComponentID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "ComponentSourceID",
											"type": "Int64"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_ProductCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_KitComponentCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "B_update",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select ProductCodeKey,ProductCode,SYSUTCDATETIME() as Last_modified_date from EDME_Datafactory.ProductCode",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ProductCodeKey"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(DTStamp) AS MaxDate FROM [Masterdata_CDP].[cdp_customer_preferences_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "OptOut_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(EmailChannelOptStatusDate) AS MaxDate FROM [Masterdata_CDP].[OptOut_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_CDP_Customer_Prefrence_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS CDPCustomerPreferencesCount FROM EDME_DataFactory.cdp_customer_preferences_v2 with(nolock) where DTStamp is not null AND DTStamp>'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_OptOut_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "OptOut_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS OptOutCount FROM EDME_DataFactory.OptOut with(nolock) where EmailChannelOptStatusDate>'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_EDW_CDP_Customer_Prefrence_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_CDP_Customer_Prefrence_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_CDP_Customer_Prefrence_Count').output.firstRow.CDPCustomerPreferencesCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_CDP_Customer_Prefrence_Count_Data_Not_Found_Logs_SP",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_CDP_Customer_Prefrence_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Cdp_Customer_Preferences",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType ,\nDTStamp\nfrom EDME_DataFactory.cdp_customer_preferences_v2 WITH(NOLOCK) WHERE DTStamp is not null AND DTStamp >'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Cdp_Customer_Preferences_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP_Cdp_Customer_Preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cdp_Customer_Preferences_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Cdp_Customer_Preferences').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Cdp_Customer_Preferences').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Cdp_Customer_Preferences').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_Cdp_Customer_Preferences",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Check_EDW_OptOut_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_OptOut_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_OptOut_Count').output.firstRow.OptOutCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_OptOutCount_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_OptOut_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "OptOut",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)\nwhere EmailChannelOptStatusDate >'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_OptOut",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_OptOut_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "OptOut_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('OptOut').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('OptOut').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "OptOut_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('OptOut').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('OptOut').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('OptOut').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('OptOut').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_OptOut",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('OptOut').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('OptOut').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('OptOut').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('OptOut').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('OptOut').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_OptOut",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('OptOut').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('OptOut').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType \nfrom EDME_DataFactory.cdp_customer_preferences WITH(NOLOCK) where dtec<>'null.null'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "OptOut",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cdp_Customer_Preferences_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cdp_Customer_Preferences_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Cdp_Customer_Preferences').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Cdp_Customer_Preferences').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Cdp_Customer_Preferences').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OptOut_copy_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OptOut').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OptOut').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OptOut_copy_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OptOut').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OptOut').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OptOut').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OptOut').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_OptOut",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OptOut').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OptOut').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OptOut').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('OptOut').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OptOut').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Last_Trigger_Time",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(LasteTriggerDateTime) AS LasteTriggerDateTime FROM Audit.ADFRetailCustomerWatermark WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "GetLastTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Current_UTCTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get_Last_Trigger_Time",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ToDateTime",
							"value": {
								"value": "@utcNow()",
								"type": "Expression"
							}
						}
					},
					{
						"name": "UpdateTriggerTime",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "UPDATE Audit.ADFRetailCustomerWatermark SET LasteTriggerDateTime='@{formatDateTime(variables('ToDateTime'),'yyyy-MM-ddTHH:mm:ss')}';\nselect 1 as success;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "UpdateTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Error_ECM_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_Customer_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_ECM_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Error_ECM_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "D365Ecm*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Stage_Retail_Customer_Failure_Notification_ECM",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Load_ECM_Customer').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Load_ECM_Customer').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Load_ECM_Customer').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().RunId}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is D365 ECM Customers Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_ECM_Customer').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_ECM_Customer').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_ECM_Customer').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "ECM_Files_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_Failure_Notification_ECM",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Load_ECM_Customer').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Validate_value",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Retail_Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Deleta_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Succeed_Files",
								"type": "DatasetReference",
								"parameters": {
									"filename_d": {
										"value": "@variables('File_Name')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Get_File_ Metadata",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Homes_Files_GetMetaData",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "File_Name",
						"description": "Find the File Name from Get_File_Metadata",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "FilterActivity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "File_Name",
							"value": {
								"value": "@activity('FilterActivity').output.value[0].name",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Valiadate_File_Name",
						"description": "validate the file name received from get file metadata",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "File_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT SUBSTRING('@{variables('File_Name')}', CHARINDEX('_', '@{variables('File_Name')}') + 1, CHARINDEX('.','@{variables('File_Name')}') - CHARINDEX('_', '@{variables('File_Name')}')-1) as FinalVar;\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_AllSourceCustomers_FileName",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "C_Varibale",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Valiadate_File_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "C_Value",
							"value": {
								"value": "@activity('Valiadate_File_Name').output.firstRow.FinalVar",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load_ECM_Customer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "updateddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "csourceid",
										"value": {
											"value": "@variables('C_Value')",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "posRawContainerRecID"
										},
										"sink": {
											"name": "sourceCustomerId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "firstName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "middleInitial",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "lastName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "city",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "state",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "zipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "marketId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSubSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "createdDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "updateddate",
											"type": "String"
										},
										"sink": {
											"name": "updatedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_AllSourceCustomers",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "FilterActivity",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get_File_ Metadata",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get_File_ Metadata').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@startswith(item().name, 'Homes')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Validate_value",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "C_Varibale",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(equals(sub(length(variables('C_Value')), length(replace(variables('C_Value'), '_', ''))), 2), equals(sub(length(variables('C_Value')), length(replace(variables('C_Value'), '_', ''))), 0))\n\n\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Set variable1",
									"description": "No action",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "NoACtion",
										"value": {
											"value": "'NoRecordinserted'",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HOME_Customer",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "createddate",
													"value": {
														"value": "@utcNow()",
														"type": "Expression"
													}
												},
												{
													"name": "updateddate",
													"value": {
														"value": "@utcNow()",
														"type": "Expression"
													}
												},
												{
													"name": "csourceid",
													"value": {
														"value": "@variables('C_Value')",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": {
													"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
													"type": "Expression"
												},
												"modifiedDatetimeEnd": {
													"value": "@variables('ToDateTime')",
													"type": "Expression"
												},
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"sourceCustomerId"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "csourceid",
														"type": "String"
													},
													"sink": {
														"name": "sourceCustomerId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posFirstName",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "firstName",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posMiddleInitial",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "middleInitial",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posLastName",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "lastName",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerEmail1",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerEmail1",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerEmail2",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerEmail2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerEmail3",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerEmail3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerPhone1",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerPhone1",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerPhone2",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerPhone2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerPhone3",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerPhone3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_address",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "addressLine1",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_addr2",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "addressLine2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_city",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "city",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_state",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "state",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_zip9",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "zipCode",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "market_id",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "marketId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "customer_type",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerType",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SourceSystem",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SourceSubSystem",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "sourceSubSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "createddate",
														"type": "String"
													},
													"sink": {
														"name": "createdDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "updateddate",
														"type": "String"
													},
													"sink": {
														"name": "updatedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Homes_Files",
											"type": "DatasetReference",
											"parameters": {
												"FileName_Prm": {
													"value": "@variables('File_Name')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_AllSourceCustomers",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Error_Homes_Files",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HOME_Customer",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": {
													"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
													"type": "Expression"
												},
												"modifiedDatetimeEnd": {
													"value": "@variables('ToDateTime')",
													"type": "Expression"
												},
												"wildcardFolderPath": "Retail-Customer-Source-Files",
												"wildcardFileName": "Homes*.csv",
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Homes_Files",
											"type": "DatasetReference",
											"parameters": {
												"FileName_Prm": {
													"value": "@activity('Get_File_ Metadata').output.itemName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "Retail_Customer_Error_Files",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Delete_Homes_Error_Files",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Error_Homes_Files",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "Delete_Error_Files",
											"type": "DatasetReference",
											"parameters": {}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"modifiedDatetimeStart": {
												"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
												"type": "Expression"
											},
											"modifiedDatetimeEnd": {
												"value": "@variables('ToDateTime')",
												"type": "Expression"
											},
											"wildcardFileName": "Homes*.csv",
											"enablePartitionDiscovery": false
										}
									}
								},
								{
									"name": "Stage_Retail_Customer_Failure_Notification_Homes",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_HOME_Customer",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Stage_Retail_Customer_Failure_Notification",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"ErrorCode": {
												"value": "@{activity('Load_HOME_Customer').error.errorCode}",
												"type": "Expression"
											},
											"ErrorMsg": {
												"value": "@replace(activity('Load_HOME_Customer').error.message,'\"','')",
												"type": "Expression"
											},
											"ErrorStatusCode": {
												"value": "@activity('Load_HOME_Customer').StatusCode",
												"type": "Expression"
											},
											"FailureType": {
												"value": "@{activity('Load_HOME_Customer').error.failureType}",
												"type": "Expression"
											},
											"PipelineName": {
												"value": "@{pipeline().Pipeline}",
												"type": "Expression"
											},
											"RunID": {
												"value": "@{pipeline().RunId}",
												"type": "Expression"
											},
											"Sink": {
												"value": "Scratch.CustomerInfo",
												"type": "Expression"
											},
											"Sink_Type": {
												"value": "@{activity('Load_HOME_Customer').output.executionDetails[0].sink.type}",
												"type": "Expression"
											},
											"Source": {
												"value": "Source is Homes RET Customers Files",
												"type": "Expression"
											},
											"Source_Type": {
												"value": "@{activity('Load_HOME_Customer').output.executionDetails[0].source.type}",
												"type": "Expression"
											},
											"TriggerId": {
												"value": "@{pipeline().TriggerId}",
												"type": "Expression"
											},
											"TriggerName": {
												"value": "@{pipeline().TriggerName}",
												"type": "Expression"
											},
											"TriggerTime": {
												"value": "@{pipeline().TriggerTime}",
												"type": "Expression"
											},
											"TriggerType": {
												"value": "@{pipeline().TriggerType}",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_HOME_Customer').Status",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_HOME_Customer').Duration",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('Load_HOME_Customer').ExecutionEndTime",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Homes_Files_Fail",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Stage_Retail_Customer_Failure_Notification_Homes",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_HOME_Customer').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_HOME_Customer').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"ToDateTime": {
						"type": "String"
					},
					"filename": {
						"type": "String"
					},
					"LastModified": {
						"type": "String"
					},
					"File_Name": {
						"type": "String"
					},
					"lastmodified1": {
						"type": "String"
					},
					"LSTM": {
						"type": "String"
					},
					"setvalue": {
						"type": "String"
					},
					"Finalvalue": {
						"type": "String"
					},
					"C_Value": {
						"type": "String"
					},
					"NoACtion": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}