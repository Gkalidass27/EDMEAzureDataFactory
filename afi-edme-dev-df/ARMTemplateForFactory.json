{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "afi-edme-dev-df"
		},
		"AGR_Demo_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AGR_Demo'"
		},
		"Ashley_EDW_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Ashley_EDW'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=ashley-edw-dev.database.windows.net;Initial Catalog=ASHLEY_EDW_DEV"
		},
		"Ashley_EDW_Prod_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Ashley_EDW_Prod'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=ashley-edw.database.windows.net;Initial Catalog=Ashley_EDW"
		},
		"AzureFileStorage1_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'AzureFileStorage1'"
		},
		"CDP_CustomerProfiling_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CDP_CustomerProfiling'"
		},
		"DSTrackingTest_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'DSTrackingTest'"
		},
		"EnterpriseMarketingFabricWarehouse_servicePrincipalCredential": {
			"type": "secureString",
			"metadata": "Secure string for 'servicePrincipalCredential' of 'EnterpriseMarketingFabricWarehouse'"
		},
		"EnterpriseMarketingLakehouse_servicePrincipalCredential": {
			"type": "secureString",
			"metadata": "Secure string for 'servicePrincipalCredential' of 'EnterpriseMarketingLakehouse'"
		},
		"Enterprise_ReferenceMaster_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Enterprise_ReferenceMaster'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=Enterprise_ReferenceMaster"
		},
		"LS_AzureFunction_functionKey": {
			"type": "secureString",
			"metadata": "Secure string for 'functionKey' of 'LS_AzureFunction'"
		},
		"LS_SMARTSHEET_apiToken": {
			"type": "secureString",
			"metadata": "Secure string for 'apiToken' of 'LS_SMARTSHEET'"
		},
		"LS_Smartsheets_apiToken": {
			"type": "secureString",
			"metadata": "Secure string for 'apiToken' of 'LS_Smartsheets'"
		},
		"Ls_CSV_FlatFile_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Ls_CSV_FlatFile'"
		},
		"Prod_afimasterdatahubstg_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'Prod_afimasterdatahubstg'"
		},
		"Retail_CustomerMaster_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Retail_CustomerMaster'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=Retail_CustomerMaster"
		},
		"Retail_ProductMaster_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Retail_ProductMaster'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=Retail_ProductMaster"
		},
		"Retail_SiteMaster_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Retail_SiteMaster'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=Retail_SiteMaster"
		},
		"Sink_ReferenceMaster_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Sink_ReferenceMaster'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=@{linkedService().Database_Name}"
		},
		"Smartsheet1_apiToken": {
			"type": "secureString",
			"metadata": "Secure string for 'apiToken' of 'Smartsheet1'"
		},
		"SmartsheetLinkedinService_apiToken": {
			"type": "secureString",
			"metadata": "Secure string for 'apiToken' of 'SmartsheetLinkedinService'"
		},
		"Smartsheet_Storemasterlist_apiToken": {
			"type": "secureString",
			"metadata": "Secure string for 'apiToken' of 'Smartsheet_Storemasterlist'"
		},
		"TestFileShare123_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'TestFileShare123'"
		},
		"Wholesale_sitemaster_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Wholesale_sitemaster'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=Wholesale_SiteMaster"
		},
		"agr_cdp_func_functionKey": {
			"type": "secureString",
			"metadata": "Secure string for 'functionKey' of 'agr_cdp_func'"
		},
		"agr_multi_channel_mktg_hub_customer_dev_func_functionKey": {
			"type": "secureString",
			"metadata": "Secure string for 'functionKey' of 'agr_multi_channel_mktg_hub_customer_dev_func'"
		},
		"edmeCosmos_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'edmeCosmos'"
		},
		"masterDataHubStg_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'masterDataHubStg'"
		},
		"masterDataHub_Retail_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'masterDataHub_Retail'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=masterDataHub_Retail"
		},
		"sandbox_zone_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'sandbox_zone'"
		},
		"semarchy_repo_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'semarchy_repo'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=semarchy_repo"
		},
		"semarchy_staging_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'semarchy_staging'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=afi-edme-semarchy-dev-sql.database.windows.net;Initial Catalog=semarchy_staging"
		},
		"test_functionKey": {
			"type": "secureString",
			"metadata": "Secure string for 'functionKey' of 'test'"
		},
		"AFIEDME_KeyVault_dev_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://afide-edmekv.vault.azure.net/"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://ashleydevlake.dfs.core.windows.net"
		},
		"AzureFileStorage1_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "sftp.ashleyfurniture.com"
		},
		"AzureFileStorage1_properties_typeProperties_userId": {
			"type": "string",
			"defaultValue": "s_Zeta_Analytics"
		},
		"AzureKeyVault_Secrets_Postalcode_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://afide-edmekv.vault.azure.net/"
		},
		"DataAnyWhereProdRestAPI_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://dataanywhereprod.azure-api.net"
		},
		"EDW_Ashleylake_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://ashleydevlake.dfs.core.windows.net"
		},
		"EnterpriseMarketingFabricWarehouse_properties_typeProperties_endpoint": {
			"type": "string",
			"defaultValue": "7woj2wroypauvkpn72b56t46ju-efttw5hffxkuvggerajw5qwnzu.datawarehouse.fabric.microsoft.com"
		},
		"EnterpriseMarketingFabricWarehouse_properties_typeProperties_tenant": {
			"type": "string",
			"defaultValue": "5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d"
		},
		"EnterpriseMarketingFabricWarehouse_properties_typeProperties_servicePrincipalId": {
			"type": "string",
			"defaultValue": "cfa383f8-e53b-46d6-813b-f778b83910c3"
		},
		"EnterpriseMarketingLakehouse_properties_typeProperties_tenant": {
			"type": "string",
			"defaultValue": "5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d"
		},
		"EnterpriseMarketingLakehouse_properties_typeProperties_servicePrincipalId": {
			"type": "string",
			"defaultValue": "cfa383f8-e53b-46d6-813b-f778b83910c3"
		},
		"LS_AzureFunction_properties_typeProperties_functionAppUrl": {
			"type": "string",
			"defaultValue": "https://afi-rsm-subscriber-dev-func.azurewebsites.net"
		},
		"Postal_datadownload_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://releases.melissadata.net/Download/Data/2024.07/z5max.txt"
		},
		"Postalcode_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://releases.melissadata.net"
		},
		"Prod_afimasterdatahubstg_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://afimasterdatahubdevstg.dfs.core.windows.net/"
		},
		"RawZone_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://ashleydevlake.dfs.core.windows.net/"
		},
		"RestService1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://releases.melissadata.net/releases/data/z5max.txt"
		},
		"Rest_Postalcodes_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "@{linkedService().BaseURL}"
		},
		"Rest_Postalcodes_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "Test"
		},
		"agr_cdp_func_properties_typeProperties_functionAppUrl": {
			"type": "string",
			"defaultValue": "https://agr-cdp-func.azurewebsites.net"
		},
		"agr_multi_channel_mktg_hub_customer_dev_func_properties_typeProperties_functionAppUrl": {
			"type": "string",
			"defaultValue": "https://agr-multi-channel-mktg-hub-customer-dev-func.azurewebsites.net"
		},
		"masterDataHubStg_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://afimasterdatahubdevstg.dfs.core.windows.net"
		},
		"test_properties_typeProperties_functionAppUrl": {
			"type": "string",
			"defaultValue": "https://agr-cdp-func.azurewebsites.net"
		},
		"dataFactory_properties_globalParameters_DAC_Accountid_value": {
			"type": "string",
			"defaultValue": "836c0e43-b4f9-41b8-80e6-fd2bee658dee"
		},
		"dataFactory_properties_globalParameters_DAC_SubscriptionKey_value": {
			"type": "string",
			"defaultValue": "331fdee513354dd380cb5977e7cab941"
		},
		"dataFactory_properties_globalParameters_ADF_SubscriptionID_value": {
			"type": "string",
			"defaultValue": "f2330f9f-3a8b-498c-a2d6-476e4f263349"
		},
		"dataFactory_properties_globalParameters_Melissa_LicenseKey_value": {
			"type": "string",
			"defaultValue": "https://afide-edmekv.vault.azure.net/secrets/melissa-data-license-key/b0d3207214ea4b0b9fef24ac132a17e1?api-version=7.0"
		},
		"dataFactory_location": {
			"type": "string",
			"defaultValue": "eastus"
		},
		"dataFactory_identity_type": {
			"type": "string",
			"defaultValue": "SystemAssigned"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/00_Load_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_SiteMaster_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "If HS Changed",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set_HS_ChangedRecordsCount",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(variables('ChangedHSRecordsCount'),0)",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Load_SiteMaster_HS",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Load_SiteMaster_HS",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								}
							]
						}
					},
					{
						"name": "CountChanged_HS_Records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "If WH Changed",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT INT\r\n\r\nEXECUTE dbo.Count_SiteMaster_Changed_Records @SiteType = 'HS', @RETURN_VALUE_ARGUMENT = null\r\n\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_HS_ChangedRecordsCount",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "CountChanged_HS_Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ChangedHSRecordsCount",
							"value": {
								"value": "@activity('CountChanged_HS_Records').output.firstRow.RETURN_VALUE_ARGUMENT",
								"type": "Expression"
							}
						}
					},
					{
						"name": "CountChanged_WH_Records",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LoadGDLegalEntityforCompare",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT INT\r\n\r\nEXECUTE dbo.Count_SiteMaster_Changed_Records @SiteType = 'WH', @RETURN_VALUE_ARGUMENT = null\r\n\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_WH_ChangedRecordsCount",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "CountChanged_WH_Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ChangedWHRecordsCount",
							"value": {
								"value": "@activity('CountChanged_WH_Records').output.firstRow.RETURN_VALUE_ARGUMENT",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If WH Changed",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set_WH_ChangedRecordsCount",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(variables('ChangedWHRecordsCount'),0)",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Load_SiteMaster_WH",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Load_SiteMaster_WH",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								}
							]
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_Mappings",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadGDLegalEntityforCompare",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE Scratch.SiteMaster_GD_LEGAL_ENTITY",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Scratch_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Stage_SiteMaster_Smartsheet",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_EDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_RDC_Smartsheet",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_SiteMaster_Mappings",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_Smartsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_Mappings",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"ChangedHSRecordsCount": {
						"type": "Integer"
					},
					"ChangedWHRecordsCount": {
						"type": "Integer"
					},
					"LoadID": {
						"type": "String"
					},
					"LoadID1": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:28Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_EDW')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_GD_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/EDW_RSM_LicContact_CompanyCode')]",
				"[concat(variables('factoryId'), '/datasets/Scratch_SiteMaster_GD_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_RDC_Smartsheet')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_Mappings')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_HS')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_WH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/00_Load_SiteMaster_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_SiteMaster_DAC",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_DAC",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_DAC",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Stage_SiteMaster_DAC').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Stage_SiteMaster_DAC').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Stage_SiteMaster_DAC').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Stage_SiteMaster_DAC').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_DAC",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Stage_SiteMaster_DAC').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Stage_SiteMaster_DAC').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_SiteMaster_DAC').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_SiteMaster_DAC').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_SiteMaster_DAC').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Stage_SiteMaster_DAC').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_SiteMaster_DAC').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"StoreDetailsErrorMsg": {
						"type": "String"
					},
					"StoreLocationDetailsErrorMsg": {
						"type": "String"
					},
					"DacSiteMasterLoadErrorMsg": {
						"type": "String"
					},
					"JsonCount": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-26T17:07:19Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_DAC')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/00_Load_SiteMaster_Incremental_v2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Assign_ID_Codes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_SiteMaster_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_EDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_SiteMaster_Incremental_RSA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_Smartsheet",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_RDC_Smartsheet",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_Storemaster_Smartsheet",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Smartsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Storemaster_Smartsheet",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Assign_ID_Codes",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Storemaster_Smartsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Incremental_SiteMaster_Mappings",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:28Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_EDW')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Incremental_RSA')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_RDC_Smartsheet')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Storemaster_Smartsheet')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Incremental_SiteMaster_Mappings')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/00_Load_SiteMaster_Initial')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_Mappings",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_SiteMaster_Initial_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_EDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_SiteMaster_Initial_WareHouse",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_Smartsheet",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_RDC_Smartsheet",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_SiteMaster_Mappings",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Storemaster_Smartsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_Mappings",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_Storemaster_Smartsheet",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Smartsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Storemaster_Smartsheet",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_SiteMaster_Initial_Storemaster",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_SiteMaster_Initial_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_SiteMaster_Initial_StoreMaster",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:28Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_EDW')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Initial_WareHouse')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_RDC_Smartsheet')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_Mappings')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Storemaster_Smartsheet')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Initial_StoreMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CDP_Customer_Dedupe_CsvToTable')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CDP_Customer_Deduped",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "clusterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "globalID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "timestamp",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "customer_since",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "do_not_sell",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "EntryID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "do_not_sell_request_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "unsubscribe",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "unsubscribe_date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "birthdate",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CDP_Customer_Deduped_csv",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									},
									"Container_Name": {
										"value": "@pipeline().parameters.Container_Name",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CDP_Customer_Dedeped",
								"type": "DatasetReference",
								"parameters": {
									"CDP_TableName": {
										"value": "@pipeline().parameters.Table_Name",
										"type": "Expression"
									},
									"Table_Schema": {
										"value": "@pipeline().parameters.Table_Schema",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"FileName": {
						"type": "String"
					},
					"Table_Name": {
						"type": "String"
					},
					"Table_Schema": {
						"type": "String"
					},
					"Container_Name": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/CDP_Customer_Deduped_csv')]",
				"[concat(variables('factoryId'), '/datasets/CDP_Customer_Dedeped')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cdp_Customer_Dedupe_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "cdp_customer_deduped",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \nclusterID,\nconfidence_score,\nglobalID,\nRecID,\nposRawContainerRecID,\nposFirstName,\nposMiddleInitial,\nposLastName,\nposCustomerEmail1,\nposCustomerEmail2,\nposCustomerEmail3,\nposCustomerPhone1,\nposCustomerPhone2,\nposCustomerPhone3,\nn_address,\nn_addr2,\nn_city,\nn_state,\nn_zip9,\nposFaceBookID,\nposTwitterID,\nmarket_id,\ncustomer_type,\ntimestamp,\ncustomer_since,\ndtec,\nposFirstNameSoundex,\nposLastNameSoundex,\nAlpha,\nSourceSystem,\nSourceSubSystem,\nracProfitCenter,\nracSalesNumber,\ndo_not_sell,\nEntryID,\ndo_not_sell_request_date,\nunsubscribe,\nunsubscribe_date,\nbirthdate\nFROM @{pipeline().parameters.CDPSchema}.@{pipeline().parameters.CDPTableName} WITH(NOLOCK) WHERE YEAR(dtec)=@{pipeline().parameters.Year} AND MONTH(dtec)=@{pipeline().parameters.Month}",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "clusterID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "confidence_score",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "globalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posRawContainerRecID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_city",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_state",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFaceBookID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posTwitterID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "market_id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "timestamp",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "customer_since",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posFirstNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "posLastNameSoundex",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Alpha",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "racProfitCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "racSalesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "do_not_sell",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "EntryID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "do_not_sell_request_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "unsubscribe",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "unsubscribe_date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "birthdate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "cdp_customer_deduped",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Cdp_Customer_Deduped",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.SemarchySchema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.SemarchyTableName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"CDPSchema": {
						"type": "string"
					},
					"CDPTableName": {
						"type": "string"
					},
					"Year": {
						"type": "string"
					},
					"Month": {
						"type": "string"
					},
					"SemarchySchema": {
						"type": "string"
					},
					"SemarchyTableName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/cdp_customer_deduped')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Cdp_Customer_Deduped')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Containerrate_Semarchy_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "To load Containerrate to EDW",
				"activities": [
					{
						"name": "Teams_Failed_Notification_CopyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Cp_ContainerRate_GD_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Cp_ContainerRate_GD_EDW').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Cp_ContainerRate_GD_EDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Cp_ContainerRate_GD_EDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Cp_ContainerRate_GD_EDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cp_ContainerRate_GD_EDW",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "Select distinct \nF_WAREHOUSE_ID\n,F_ASHLEY_PORT_ID\n,TYPE\n,RATE\n,FORMAT(EFFECTIVE_FROM, 'yyyy-MM-dd') as EFFECTIVE_FROM\n,FORMAT(EFFECTIVE_TO, 'yyyy-MM-dd') as EFFECTIVE_TO\n,B_CREDATE\n,B_UPDDATE\nfrom [dbo].[GD_CONTAINER_RATES]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_Wholesale_GD",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "GD_CONTAINER_RATES"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ContainerRate_Parquet",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Fail_job",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Cp_ContainerRate_GD_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": "Copy Activity Fails ",
							"errorCode": {
								"value": "@activity('Cp_ContainerRate_GD_EDW').output.executionDetails[0].status",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Wholesale/W_SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:27Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_Wholesale_GD')]",
				"[concat(variables('factoryId'), '/datasets/EDW_ContainerRate_Parquet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Country_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Country_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Country_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Country_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Country_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Country_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Country_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Country_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Country",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Country_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Country_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_COUNTRY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCOUNTRY_CODE_A2,\nCOUNTRY_CODE_A3,\nCOUNTRY_NAME,\nCOUNTRY_LOCAL_NAME,\nCOUNTRY_UN_CODE \nFROM GD_ENTERPRISE_REF_COUNTRY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Country_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_COUNTRY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_COUNTRY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE_A3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_LOCAL_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_UN_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_COUNTRY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Country_Table_Name": {
													"value": "@pipeline().parameters.Sink_Country_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Country_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Country_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Master_Table_Max_Date_Sink')]",
				"[concat(variables('factoryId'), '/datasets/Lookup_GD_Master_Table')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/SA_EXTERNAL_REF_COUNTRY')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_Currency_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Currency_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Currency_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Currency_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Currency_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Currency_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Currency_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Currency_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Currency_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Currency",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Currency_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Currency_Class_Name}' AS B_CLASSNAME,\nENTERPRISE_REF_CURENCY_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nCURRENCY_CODE,\nCURRENCY_NAME\nFROM GD_ENTERPRISE_REF_CURRENCY WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Currency_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_CURRENCY_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_CURENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_CURRENCY_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENCY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_CURRENCY",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Currency_Table_Name": {
													"value": "@pipeline().parameters.Sink_Currency_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Currency_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Currency_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Currency_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Master_Table_Max_Date_Sink')]",
				"[concat(variables('factoryId'), '/datasets/Lookup_GD_Master_Table')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/SA_EXTERNAL_REF_CURRENCY')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_DMA_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Dma_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Dma_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Dma_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Dma_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_DMA WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Dma_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Dma_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Dma_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Dma_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Dma_Data_Not_Found_Logs_Stored_Procedurered",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For dma",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Dma_Data_Not_Found_Logs_Stored_Procedurered",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Dma_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Dma_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Dma_Class_Name}' as B_CLASSNAME,\nENTERPRISE_REF_DMA_ID,\nB_CLASSNAME,\nB_BATCHID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nDMA_REGION\nFROM GD_ENTERPRISE_REF_DMA WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Dma_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_DMAID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERPRISE_REF_DMA_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													},
													"sink": {
														"name": "EXTERNAL_REF_DMAID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DMA_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "DMA_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_DMA",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Dma_Table_Name": {
													"value": "@pipeline().parameters.Sink_Dma_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Dma_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Dma_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Master_Table_Max_Date_Sink')]",
				"[concat(variables('factoryId'), '/datasets/Lookup_GD_Master_Table')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/SA_EXTERNAL_REF_DMA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_PostalCode_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "EntRefSemarchyIntegration",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \nSinkDatabaseName,\nSinkTableName,\nSemarchyJobName,\nTableClassName,\nSinkTableSchemaName FROM [EntRef].[SemarchyIntegration] WITH(NOLOCk)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Stage_PostalCode_Query",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "LoadData",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "EntRefSemarchyIntegration",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('EntRefSemarchyIntegration').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{item().SinkDatabaseName}\n,@P_PROGRAM_NAME = @{item().SemarchyJobName}\n,@P_LOAD_DESCRIPTION = @{item().SemarchyJobName}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_PostalCode",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT DISTINCT \nPOSTAL_CODE_MASTER_ID,\n'@{item().TableClassName}' AS B_CLASSNAME,\nB_DELETETYPE,\nB_DELETEDATE,\nCASE\nWHEN B_DELETETYPE='SOFT_DELETE' THEN 'semadmin'\nELSE B_DELETEAUTHOR END AS B_DELETEAUTHOR,\nCASE\nWHEN B_DELETETYPE='SOFT_DELETE' THEN NEWID()\nELSE B_DELETEOPERATION END AS B_DELETEOPERATION,\nB_DELETEPATH,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nPOSTAL_CODE,\nSTATE_OR_PROVINCE_CODE,\nCITY_NAME,\nCITY_ABBREVIATION,\nCOUNTRY_CODE,\nTIME_ZONE,\nOBSERVES_DST,\nLONGITUDE,\nIS_PREFERRED_CITY_NAME,\nPOSTAL_CODE_TYPE,\nMSA_CODE,\nFIPS_CODE,\nLATITUDE\nFROM [EntRef].[PostalCodes] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEOPERATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETEOPERATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEPATH",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_DELETEPATH",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_POSTAL_CODE_MASTER_Sink",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@item().SinkDatabaseName",
													"type": "Expression"
												},
												"PostalCode_Table_Name": {
													"value": "@item().SinkTableName",
													"type": "Expression"
												},
												"Table_Schema": {
													"value": "@item().SinkTableSchemaName",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@item().SemarchyJobName",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "PostalCode_ErrorLogs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_PostalCode').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "@item().SinkTableName",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[EntRef].[PostalCodes]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_Load_PostalCode",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_PostalCode').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_PostalCode",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_PostalCode').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Cancel_PostalCode_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "RemoveEntRefSemarchyIntegration",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "LoadData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "Truncate Table [EntRef].[PostalCodes] ;\nselect 1 as succeeded;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Stage_PostalCode_Query",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-10-26T05:56:46Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Stage_PostalCode_Query')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/SA_POSTAL_CODE_MASTER_Sink')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_PostalCode_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Postalcode_Source_Count",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM dbo.GD_ENT_REF_POSTAL_CODE WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Postalcode_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Postalcode_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Country_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For Country",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "Enterprise_ReferenceMaster",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Country_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "PostalCode_Copy_Data",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \nENT_REF_POSTAL_CODE_ID,\n'@{pipeline().parameters.Postalcode_Class_Name}' AS B_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nPOSTAL_CODE,\nSTATE_OR_PROVINCE_CODE,\nCITY_NAME,\nCITY_ABBREVIATION,\nCOUNTRY_CODE,\nTIME_ZONE,\nOBSERVES_DST,\nLATITUDE,\nLONGITUDE,\nIS_PREFERRED_CITY_NAME,\nPOSTAL_CODE_TYPE,\nMSA_CODE,\nFIPS_CODE\nFROM dbo.GD_ENT_REF_POSTAL_CODE WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENT_REF_POSTAL_CODE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_POSTAL_CODE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"PostalCode_Table_Name": {
													"value": "@pipeline().parameters.Sink_Postalcode_Table_Name",
													"type": "Expression"
												},
												"Table_Schema": {
													"value": "@pipeline().parameters.Sink_TableSchemaName",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "PostalCode_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadId",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Postalcode_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Postalcode_Class_Name": {
						"type": "string"
					},
					"Sink_TableSchemaName": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-10-26T05:56:47Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Lookup_GD_Master_Table')]",
				"[concat(variables('factoryId'), '/linkedServices/Enterprise_ReferenceMaster')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/SA_EXTERNAL_REF_POSTAL_CODE')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Time_Zone_EFF_DT_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Time_Zone_EFF_DT_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Time_Zone_EFF_DT_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENT_REF_TIME_ZONE_EFF_DT WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Time_Zone_EFF_DT_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Country_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Time_Zone_EFF_DT_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Time_Zone_EFF_DT_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Time_Zone_EFF_DT_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For TIME_ZONE_EFF_DT",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_EFF_DT_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Time_Zone_EFF_DT_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Time_Zone_EFF_DT_Class_Name}' as B_CLASSNAME,\nENT_REF_TIME_ZN_EFF_DT_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nTIME_ZONE_EFFECTIVE_YEAR,\nDST_START_DT,\nDST_END_DT,\nF_ENTERPRISE_REF_TIME_ZONE\nFROM GD_ENT_REF_TIME_ZONE_EFF_DT WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Time_Zone_EFF_DT_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_TIME_ZONE_EF"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENT_REF_TIME_ZN_EFF_DT_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "EXTERNAL_REF_TIME_ZONE_EF",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_EFFECTIVE_YEAR",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "TIME_ZONE_EFFECTIVE_YEAR",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												},
												{
													"source": {
														"name": "DST_START_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DST_START_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "DST_END_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DST_END_DT",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "F_ENTERPRISE_REF_TIME_ZONE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "F_EXTERNAL_REF_TIME_ZONE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_TIME_ZONE_EF",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Time_Zone_EFF_DT_Table_Name": {
													"value": "@pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_EFF_DT_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_EFF_DT_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Time_Zone_EFF_DT_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Master_Table_Max_Date_Sink')]",
				"[concat(variables('factoryId'), '/datasets/Lookup_GD_Master_Table')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/SA_EXTERNAL_REF_TIME_ZONE_EF')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_TIME_ZONE_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Time_Zone_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_Time_Zone_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Time_Zone_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Time_Zone_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_TIME_ZONE WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('Time_Zone_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Time_Zone_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Time_Zone_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('Time_Zone_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Time_Zone_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For TIME_ZONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Time_Zone_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Time_Zone_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.Time_Zone_Class_Name}' as B_CLASSNAME,\nENTERP_REF_TIME_ZONE_ID,\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nTIME_ZONE_NAME,\nTIME_ZONE_ABR_STD,\nTIME_ZONE_ABR_DST,\nUTC_OFFSET_STD,\nUTC_OFFSET_DST\nFROM GD_ENTERPRISE_REF_TIME_ZONE WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('Time_Zone_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_TIME_ZONE_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERP_REF_TIME_ZONE_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													},
													"sink": {
														"name": "EXTERNAL_REF_TIME_ZONE_ID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_ABR_STD",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_ABR_STD",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE_ABR_DST",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "TIME_ZONE_ABR_DST",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "UTC_OFFSET_STD",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "UTC_OFFSET_STD",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												},
												{
													"source": {
														"name": "UTC_OFFSET_DST",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													},
													"sink": {
														"name": "UTC_OFFSET_DST",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 5
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_TIME_ZONE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"Time_Zone_Table_Name": {
													"value": "@pipeline().parameters.Sink_Time_Zone_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"Time_Zone_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Master_Table_Max_Date_Sink')]",
				"[concat(variables('factoryId'), '/datasets/Lookup_GD_Master_Table')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/SA_EXTERNAL_REF_TIME_ZONE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_EnterpriseRef_US_STATE_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_State_Sink_Max_Date",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(B_UPDDATE) as MAX_B_UPDDATE FROM @{pipeline().parameters.Sink_US_State_Table_Name} WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Master_Table_Max_Date_Sink",
								"type": "DatasetReference",
								"parameters": {
									"Database_Name": {
										"value": "@pipeline().parameters.Database_Name",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "US_State_Source_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "US_State_Sink_Max_Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as data FROM GD_ENTERPRISE_REF_US_STATE WITH(NOLOCK) WHERE B_UPDDATE>'@{activity('US_State_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Lookup_GD_Master_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_US_State_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "US_State_Source_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('US_State_Source_Count').output.firstRow.data,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "US_State_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No Data Available For US_STATE",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "404",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "No Data Available",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().Pipeline",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cancel_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "US_State_Data_Not_Found_Logs_Stored_Procedure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "US_State_Copy_Data",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadId')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \n'semadmin' AS B_CREATOR,\n'@{pipeline().parameters.US_State_Class_Name}' as B_CLASSNAME,\nENTERP_REF_US_STATE_ID,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nSTATE_CODE,\nSTATE_NAME\nFROM GD_ENTERPRISE_REF_US_STATE WITH(NOLOCK) \nWHERE B_UPDDATE>'@{activity('US_State_Sink_Max_Date').output.firstRow.MAX_B_UPDDATE}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"EXTERNAL_REF_US_STATE_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ENTERP_REF_US_STATE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "EXTERNAL_REF_US_STATE_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "GD_Enterprise_REF_TABLE",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_EXTERNAL_REF_US_STATE",
											"type": "DatasetReference",
											"parameters": {
												"Database_Name": {
													"value": "@pipeline().parameters.Database_Name",
													"type": "Expression"
												},
												"US_State_Table_Name": {
													"value": "@pipeline().parameters.Sink_US_State_Table_Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "US_State_Copy_Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@pipeline().parameters.Semarchy_Job_Name",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadId')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = @{pipeline().parameters.Database_Name}\n,@P_PROGRAM_NAME = @{pipeline().parameters.Semarchy_Job_Name}\n,@P_LOAD_DESCRIPTION =  @{pipeline().parameters.Semarchy_Job_Name}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_US_State_Table_Name": {
						"type": "string"
					},
					"Semarchy_Job_Name": {
						"type": "string"
					},
					"US_State_Class_Name": {
						"type": "string"
					}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Master_Table_Max_Date_Sink')]",
				"[concat(variables('factoryId'), '/datasets/Lookup_GD_Master_Table')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/SA_EXTERNAL_REF_US_STATE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ProcessRCMRFD",
						"type": "IfCondition",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(pipeline().parameters.EntityCount),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": "No RAW Data Available For AllSourceCustomers",
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "WaitForSP",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = @{concat('Delete',pipeline().parameters.EntityName)}\n,@P_LOAD_DESCRIPTION = @{concat('Delete',pipeline().parameters.EntityName)}\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "usp_ASH_REMOVE_LOAD",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[usp_ASH_REMOVE_LOAD]",
										"storedProcedureParameters": {
											"Entity": {
												"value": {
													"value": "@pipeline().parameters.EntityName",
													"type": "Expression"
												},
												"type": "String"
											},
											"LoadID": {
												"value": {
													"value": "@int(activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT)",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"RecordsToDelete": {
												"value": {
													"value": "@int(pipeline().parameters.EntityCount)",
													"type": "Expression"
												},
												"type": "Int32"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "Retail_CustomerMaster",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "usp_ASH_REMOVE_LOAD",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "@{concat('Delete',pipeline().parameters.EntityName)}",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@int(activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT)",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "WaitForSP",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 5
									}
								},
								{
									"name": "Teams_Failed_Notification_RFD_SP",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "usp_ASH_REMOVE_LOAD",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": "0",
											"status": {
												"value": "Failed",
												"type": "Expression"
											},
											"message": {
												"value": "usp_DeleteRFDLocalStage Execution Failed",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('usp_ASH_REMOVE_LOAD').output.executionDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"EntityCount": {
						"type": "string"
					},
					"EntityName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow/RCM_RFD_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-11-08T08:53:29Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "FetchEntityName",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@array(variables('Entity'))",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Get_Entity_Count",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RecordsToDelete INT; \nEXECUTE [dbo].[usp_ASH_REMOVE_LOAD] \n@Entity = @{item()}, \n@RecordsToDelete = @RecordsToDelete OUTPUT; \nSELECT @RecordsToDelete AS RecordsToDeleteADDRESS;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "usp_ASH_REMOVE_LOAD",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"EntityCount": {
												"value": "@string(activity('Get_Entity_Count').output.firstRow.RecordsToDeleteADDRESS)",
												"type": "Expression"
											},
											"EntityName": {
												"value": "@{item()}",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_Get_Entity_Count",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Get_Entity_Count",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": "0",
											"status": {
												"value": "Failed",
												"type": "Expression"
											},
											"message": {
												"value": "usp_DeleteRFDLocalStage Execution Failed",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Get_Entity_Count').output.executionDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"AddressLocation",
							"EmailAddress",
							"PhoneNumber",
							"RetailCustomer"
						]
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow/RCM_RFD_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-11-08T08:53:30Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/usp_ASH_REMOVE_LOAD')]",
				"[concat(variables('factoryId'), '/pipelines/Load_Entity_RCM_RFD_RetailCustomerLoad_Incremental')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Historical_National_Assortment_SemarchyToEDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "NationalAssortmentToEDW",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPM.PRODUCT_MAIN_ID as Item, \nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.ITEM_FRIENDLY_DESCRIPTION as Item_Description,\nPM.SERIES_NUMBER as Series,\nPM.SERIES_NAME as Group_Description,\nPM.STATUS as Status,\nPM.ITEM_HS_PRODUCT_LINE as Product_Line,\nPM.ITEM_RETAIL_TYPE as Grouping,\nPM.ITEM_TYPE as Item_Type,\nPM.ITEM_IMPORT_DOMESTIC as Domestic_Import,\nPM.ITEM_FUTURE_STATUS as PD_Status,\nNA.HERO_SKU as HERO_SKU,\nNA.BUSINESS_CHANNEL as Business_Channel,\nNA.STORE_AREA as Store_Area,\nNPL.PRIMARY_LOOK as Primary_Look,\nNSL.SECONDARY_LOOK as Secondary_Look,\nNA.GOOD_BETTER_BEST as Good_Better_Best,\nNA.CMDT_EXCLSV_PRPRTRY_SGNTR as E_P_SD_SDC,\nNA.MONTH as Month,\nNA.MARKET_INTRODUCTION as Market_Introduction,\nNA.SIZE_SHAPE as Size_Shape,\nNA.FEATURE1 as Feature1,\nNA.FEATURE2 as Feature2,\nNA.FOUNDATION as Foundation,\nNPM.PROGRAM as Program,\nNA.ASSORTMENT as Assortment,\nNA.B_CREDATE as Create_Date,\nNA.B_UPDDATE as Update_Date,\nNA.B_CREATOR as Creator,\nNA.B_UPDATOR as Updator\nFROM GH_NATIONAL_ASSORTMENT NA INNER JOIN GD_PRODUCT_MAIN PM\nON NA.F_PRODUCT_MAIN_ITEM = PM.PRODUCT_MAIN_ID\nLEFT JOIN GD_NA_PRIMARY_LOOK_REF NPL\nON NA.F_PRIMARY_LOOK_REF = NPL.NA_PRIMARY_LOOK_REF_ID\nLEFT JOIN GD_NA_SECONDARY_LOOK_REF NSL\nON NA.F_SECONDARY_LOOK_REF = NSL.NA_SECONDARY_LOOK_REF_ID\nLEFT JOIN GD_NA_PROGRAM_REF NPM\nON NA.F_PROGRAM_REF = NPM.NA_PROGRAM_REF_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_NATIONAL_ASSORTMENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NationalAssortmentProduct_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('NationalAssortmentToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('NationalAssortmentToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SemarchyToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalNationalAssortmentProduct",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nSS.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nSS.B_CREDATE as Create_Date,\nSS.B_UPDDATE as Update_Date,\nSS.B_CREATOR as Creator,\nSS.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GH_SISTER_SKU SS\n ON PG.PRODUCT_GROUP_ID = SS.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON SS.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_SISTER_SKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sister_SKU_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ColorwheelToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nCW.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nCW.B_CREDATE as Create_Date,\nCW.B_UPDDATE as Update_Date,\nCW.B_CREATOR as Creator,\nCW.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GH_COLORWHEEL CW\n ON PG.PRODUCT_GROUP_ID = CW.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON CW.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_COLORWHEEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Colorwheel_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SisterSKUToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SisterSKUToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SisterSKUToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_ColorwheelToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('ColorwheelToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('ColorwheelToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SisterSKUToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalSisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalColorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SemarchyToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('NationalAssortmentToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalNationalAssortmentProduct\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SisterSKUToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalSisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('ColorwheelToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalColorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nC.SERIES_NUMBER AS Series_Number, \nC.SERIES_NAME AS Series_Name,\nC.ITEM_HS_PRODUCT_LINE AS Category,\nB.FOUNDATION AS National_Foundation,\nA.[WEST_FOUNDATION] AS West_Foundation,\nA.[WEST_OUTLET] AS West_Outlet,\nA.[B_CREDATE] AS Create_Date,\nA.[B_UPDDATE] AS Update_Date,\nA.[B_CREATOR] AS Creator,\nA.[B_UPDATOR] AS Updator\n  FROM [dbo].[GH_WEST_FOUNDATION] A\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT B\n  ON A.F_NATIONAL_ASSORTMENT = B.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN C\n  ON B.F_PRODUCT_MAIN_ITEM = C.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_WEST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WestFoundation_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_WestFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WestFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WestFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WestFoundationToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalWestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WestFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalWestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nC.SERIES_NUMBER AS Series_Number, \nC.SERIES_NAME AS Series_Name,\nC.ITEM_HS_PRODUCT_LINE AS Category,\nB.FOUNDATION AS National_Foundation,\nA.[EAST_FOUNDATION] AS East_Foundation,\nA.[EAST_OUTLET] AS East_Outlet,\nA.[B_CREDATE] AS Create_Date,\nA.[B_UPDDATE] AS Update_Date,\nA.[B_CREATOR] AS Creator,\nA.[B_UPDATOR] AS Updator\n  FROM [dbo].[GH_EAST_FOUNDATION] A\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT B\n  ON A.F_NATIONAL_ASSORTMENT = B.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN C\n  ON B.F_PRODUCT_MAIN_ITEM = C.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_EAST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EastFoundation_Historical",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_EastFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('EastFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('EastFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/EastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('EastFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/HistoricalEastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GH_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:55Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/GD_NATIONAL_ASSORTMENT')]",
				"[concat(variables('factoryId'), '/datasets/NationalAssortmentProduct_Historical')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/GD_SISTER_SKU')]",
				"[concat(variables('factoryId'), '/datasets/Sister_SKU_Historical')]",
				"[concat(variables('factoryId'), '/datasets/GD_COLORWHEEL')]",
				"[concat(variables('factoryId'), '/datasets/Colorwheel_Historical')]",
				"[concat(variables('factoryId'), '/datasets/GD_WEST_FOUNDATION')]",
				"[concat(variables('factoryId'), '/datasets/WestFoundation_Historical')]",
				"[concat(variables('factoryId'), '/datasets/GD_EAST_FOUNDATION')]",
				"[concat(variables('factoryId'), '/datasets/EastFoundation_Historical')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_National_Assortment_SemarchyToEDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "NationalAssortmentToEDW",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPM.PRODUCT_MAIN_ID as Item, \nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.ITEM_FRIENDLY_DESCRIPTION as Item_Description,\nPM.SERIES_NUMBER as Series,\nPM.SERIES_NAME as Group_Description,\nPM.STATUS as Status,\nPM.ITEM_HS_PRODUCT_LINE as Product_Line,\nPM.ITEM_RETAIL_TYPE as Grouping,\nPM.ITEM_TYPE as Item_Type,\nPM.ITEM_IMPORT_DOMESTIC as Domestic_Import,\nPM.ITEM_FUTURE_STATUS as PD_Status,\nNA.HERO_SKU as HERO_SKU,\nNA.BUSINESS_CHANNEL as Business_Channel,\nNA.STORE_AREA as Store_Area,\nNPL.PRIMARY_LOOK as Primary_Look,\nNSL.SECONDARY_LOOK as Secondary_Look,\nNA.GOOD_BETTER_BEST as Good_Better_Best,\nNA.CMDT_EXCLSV_PRPRTRY_SGNTR as E_P_SD_SDC,\nNA.MONTH as Month,\nNA.MARKET_INTRODUCTION as Market_Introduction,\nNA.SIZE_SHAPE as Size_Shape,\nNA.FEATURE1 as Feature1,\nNA.FEATURE2 as Feature2,\nNA.FOUNDATION as Foundation,\nNPM.PROGRAM as Program,\nNA.ASSORTMENT as Assortment,\nNA.B_CREDATE as Create_Date,\nNA.B_UPDDATE as Update_Date,\nNA.B_CREATOR as Creator,\nNA.B_UPDATOR as Updator\nFROM GD_NATIONAL_ASSORTMENT NA INNER JOIN GD_PRODUCT_MAIN PM\nON NA.F_PRODUCT_MAIN_ITEM = PM.PRODUCT_MAIN_ID\nLEFT JOIN GD_NA_PRIMARY_LOOK_REF NPL\nON NA.F_PRIMARY_LOOK_REF = NPL.NA_PRIMARY_LOOK_REF_ID\nLEFT JOIN GD_NA_SECONDARY_LOOK_REF NSL\nON NA.F_SECONDARY_LOOK_REF = NSL.NA_SECONDARY_LOOK_REF_ID\nLEFT JOIN GD_NA_PROGRAM_REF NPM\nON NA.F_PROGRAM_REF = NPM.NA_PROGRAM_REF_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_NATIONAL_ASSORTMENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NationalAssortmentProduct",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('NationalAssortmentToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('NationalAssortmentToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('NationalAssortmentToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SemarchyToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/NationalAssortmentProduct",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nSS.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nSS.B_CREDATE as Create_Date,\nSS.B_UPDDATE as Update_Date,\nSS.B_CREATOR as Creator,\nSS.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GD_SISTER_SKU SS\n ON PG.PRODUCT_GROUP_ID = SS.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON SS.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_SISTER_SKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sister_SKU",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ColorwheelToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \nPG.PRODUCT_GROUP_ID as Product_Group_ID,\nPG.CATEGORY as Category,\nPG.GROUP_NAME as Group_Name,\nPG.ITEM_DESCRIPTION as Item_Description,\nCW.F_ITEM as ITEM,\nPM.ITEM_COMPONENT_QUANTITY as Item_Components,\nPM.SERIES_NAME as Group_Description,\nPM.SERIES_NUMBER as Serires_Number,\nCW.B_CREDATE as Create_Date,\nCW.B_UPDDATE as Update_Date,\nCW.B_CREATOR as Creator,\nCW.B_UPDATOR as Updator\nFROM GD_PRODUCT_GROUP PG INNER JOIN GD_COLORWHEEL CW\n ON PG.PRODUCT_GROUP_ID = CW.F_PRODUCT_GROUP\n INNER JOIN GD_PRODUCT_MAIN PM\n ON CW.F_ITEM = PM.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_COLORWHEEL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Colorwheel",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_SisterSKUToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SisterSKUToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SisterSKUToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SisterSKUToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_ColorwheelToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('ColorwheelToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('ColorwheelToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('ColorwheelToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SisterSKUToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/SisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/Colorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SemarchyToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NationalAssortmentToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('NationalAssortmentToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/NationalAssortmentProduct",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_NATIONAL_ASSORTMENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('NationalAssortmentToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SisterSKUToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SisterSKUToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SisterSKUToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/SisterSKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_SISTER_SKU",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SisterSKUToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ColorwheelToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('ColorwheelToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/Colorwheel",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_COLORWHEEL",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('ColorwheelToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ColorwheelToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n\t  c.SERIES_NUMBER \n\t  ,c.SERIES_NAME\n\t  ,c.ITEM_HS_PRODUCT_LINE AS Category\n\t  , b.FOUNDATION AS National_Foundation\n      ,a.[WEST_FOUNDATION] AS West_Foundation\n      ,a.[West_OUTLET] AS West_Outlet\n\t   , a.[B_CREDATE] AS Create_Date\n      ,a.[B_UPDDATE] AS Update_Date\n      ,a.[B_CREATOR] AS Creator\n      ,a.[B_UPDATOR] AS Updator\n  FROM [dbo].[GD_WEST_FOUNDATION] a\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT b\n  ON a.F_NATIONAL_ASSORTMENT = b.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN c\n  ON b.F_PRODUCT_MAIN_ITEM = c.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_WEST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WestFoundation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_WestFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WestFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WestFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WestFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WestFoundationToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/WestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WestFoundationToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WestFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/WestFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_WEST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WestFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDW",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WestFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n\t  c.SERIES_NUMBER \n\t  ,c.SERIES_NAME\n\t  ,c.ITEM_HS_PRODUCT_LINE AS Category\n\t  , b.FOUNDATION AS National_Foundation\n      ,a.[EAST_FOUNDATION] AS East_Foundation\n      ,a.[EAST_OUTLET] AS East_Outlet\n\t   , a.[B_CREDATE] AS Create_Date\n      ,a.[B_UPDDATE] AS Update_Date\n      ,a.[B_CREATOR] AS Creator\n      ,a.[B_UPDATOR] AS Updator\n  FROM [dbo].[GD_EAST_FOUNDATION] a\n  LEFT JOIN dbo.GD_NATIONAL_ASSORTMENT b\n  ON a.F_NATIONAL_ASSORTMENT = b.NATIONAL_ASSORTMENT_ID\n  LEFT JOIN dbo.GD_PRODUCT_MAIN c\n  ON b.F_PRODUCT_MAIN_ITEM = c.PRODUCT_MAIN_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_EAST_FOUNDATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EastFoundation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_EastFoundationToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('EastFoundationToEDW').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('EastFoundationToEDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('EastFoundationToEDW').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/EastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EastFoundationToEDWToEDW_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EastFoundationToEDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('EastFoundationToEDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "trusted-zone/Retail/SupplyChain/EastFoundation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "GD_EAST_FOUNDATION",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('EastFoundationToEDW').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/GD_NATIONAL_ASSORTMENT')]",
				"[concat(variables('factoryId'), '/datasets/NationalAssortmentProduct')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/GD_SISTER_SKU')]",
				"[concat(variables('factoryId'), '/datasets/Sister_SKU')]",
				"[concat(variables('factoryId'), '/datasets/GD_COLORWHEEL')]",
				"[concat(variables('factoryId'), '/datasets/Colorwheel')]",
				"[concat(variables('factoryId'), '/datasets/GD_WEST_FOUNDATION')]",
				"[concat(variables('factoryId'), '/datasets/WestFoundation')]",
				"[concat(variables('factoryId'), '/datasets/GD_EAST_FOUNDATION')]",
				"[concat(variables('factoryId'), '/datasets/EastFoundation')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_PostalCode_EnterpriseRefPostalCodeLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Count",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECt COUNT(1) AS [count] FROM [Ref_PostalCode].[PostalCode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Stage_PostalCode_Query",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_PostalCode_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(equals(activity('Get_Count').output.firstRow.count ,null))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": "No RAW Data Available For PostalCode",
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Enterprise_ReferenceMaster'\n,@P_PROGRAM_NAME = 'EnterpriseRefPostalCodeLoad'\n,@P_LOAD_DESCRIPTION = 'EnterpriseRefPostalCodeLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_PostalCode",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \nPOSTAL_CODE_MASTER_ID,\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nPOSTAL_CODE,\nSTATE_OR_PROVINCE_CODE,\nCITY_NAME,\nIS_PREFERRED_CITY_NAME,\nCITY_ABBREVIATION,\nCOUNTRY_CODE,\nMSA_CODE as F_MSA_ID,\nTIME_ZONE,\nOBSERVES_DST,\nLATITUDE,\nLONGITUDE,\nPOSTAL_CODE_TYPE,\nFIPS_CODE,\nZONE_NAME,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag\nFROM\n[Ref_PostalCode].[vw_PostalCode_IUD]",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ENT_REF_POSTAL_CODE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEOPERATION",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "B_DELETEOPERATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "F_MSA_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "F_MSA_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SA_POSTAL_CODE_MASTER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "EnterpriseRefPostalCodeLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "PostalCode_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_PostalCode').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_PostalCode').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SA_ENT_REF_POSTAL_CODE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Ref_PostalCode].[PostalCode]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PostalCode').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_Load_PostalCode",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_PostalCode').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_PostalCode",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_PostalCode').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_PostalCode').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_PostalCode').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Remove_From_USPostalCode_Stage_Table",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DELETE FROM [Ref_PostalCode].[ZipInfo_USz5max];\nSELECT 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Remove_From_CanadainPostalCode_Stage_Table",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DELETE FROM [Ref_PostalCode].[GeocoderCA_PCensusNWE];\nSELECT 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Load_PostalCode_HIST",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT \nPOSTAL_CODE_MASTER_ID,\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_UPDATOR,\nPOSTAL_CODE,\nSTATE_OR_PROVINCE_CODE,\nCITY_NAME,\nIS_PREFERRED_CITY_NAME,\nCITY_ABBREVIATION,\nCOUNTRY_CODE,\nMSA_CODE,\nTIME_ZONE,\nOBSERVES_DST,\nLATITUDE,\nLONGITUDE,\nPOSTAL_CODE_TYPE,\nFIPS_CODE,\nZONE_NAME,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag\nFROM\n[Ref_PostalCode].[vw_PostalCode_IUD]",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"ENT_REF_POSTAL_CODE_ID"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "POSTAL_CODE_MASTER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ENT_REF_POSTAL_CODE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_DELETETYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_DELETEDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_DELETEAUTHOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_DELETEOPERATION",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "B_DELETEOPERATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "STATE_OR_PROVINCE_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CITY_ABBREVIATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "COUNTRY_CODE",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "varchar"
													}
												},
												{
													"source": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OBSERVES_DST",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LATITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													},
													"sink": {
														"name": "LONGITUDE",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 9
													}
												},
												{
													"source": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PREFERRED_CITY_NAME",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "POSTAL_CODE_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MSA_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIPS_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "ZONE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "active_flag",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "active_flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Stage_PostalCode_Query",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DSPOSTALCODEHIST",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Validate_State_Province",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PostalCode",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Province_Code_Validation",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								}
							]
						}
					},
					{
						"name": "Cancel_PostalCode_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Check_PostalCode_Count",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-20T05:23:13Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Stage_PostalCode_Query')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/SA_POSTAL_CODE_MASTER')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/DSPOSTALCODEHIST')]",
				"[concat(variables('factoryId'), '/pipelines/Province_Code_Validation')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMasterLoad_Retail_Delete_PIM_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load_Retail_PIM_Delete_EDWProduct",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetDateVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nPRODUCT_MAIN_ID,\nLAST_MOD_DATE_TIME_UTC,\nB_CREDATE,\nB_CLASSNAME,\nB_DELETETYPE,\nB_DELETEOPERATION,\nB_DELETEAUTHOR,\nB_DELETEDATE,\nSOURCE_ID,\nSTATUS,\nSYSTEM_TIMESTAMP,\nALTERNATE_DESCRIPTION2,\nITEM_AFI_IMAGE_SET,\nITEM_ALTERNATE_AFI_FLUFF1,\nITEM_ALTER_DESC3,\nITEM_ARVR_READY,\nITEM_ASM_INSTR_INTERNAL,\nITEM_ASM_INSTR_PUBLIC,\nITEM_BOX_QTY,\nITEM_CARTON_DEPTH_IN,\nITEM_CARTON_DEPTH_MM,\nITEM_CARTON_HEIGHT_IN,\nITEM_CARTON_HEIGHT_MM,\nITEM_CARTON_WIDTH_IN,\nITEM_CARTON_WIDTH_MM,\nITEM_CLASS,\nITEM_CODE,\nITEM_COLOR,\nITEM_COLOR_SWATCH,\nITEM_COMMODITY,\nITEM_COMPONENT_QUANTITY,\nITEM_CONSUMER_ASSEMBLY,\nITEM_CUBES_FT,\nITEM_CUBES_M,\nITEM_DEAD,\nITEM_DIMENSION_SKETCH,\nITEM_DINING_CHAIR_QTY_CTN,\nITEM_ENGINEERING_DIVISION,\nITEM_EXCLUSIVE,\nITEM_EXCLUSIVE_COMMENT,\nITEM_EXPRESS_SHIP,\nITEM_FOB_BASE_PRICE,\nITEM_FORECAST_PLANNER_ID,\nITEM_FRIENDLY_DIMENSIONS,\nITEM_FUTURE_STATUS,\nITEM_GNRL_DESC_ID,\nITEM_GNRL_LONG_DESC,\nITEM_GOOGLE_TITLE,\nITEM_HOMSTORE_ASM_VIDEO1,\nITEM_HTS_CODE,\nITEM_IMPORT_DOMESTIC,\nITEM_KEY_ITEM,\nITEM_KNOCKOUT,\nITEM_MTERIAL_REF_NEEDED,\nITEM_MFG_WARRANTY,\nITEM_NUMBER,\nITEM_PHOTO,\nITEM_PRODUCT_DEPTH_IN,\nITEM_PRODUCT_DEPTH_MM,\nITEM_PRODUCT_HEIGHT_IN,\nITEM_PRODUCT_HEIGHT_MM,\nITEM_PRODUCT_PAGE_URL,\nITEM_PRODUCT_WIDTH_IN,\nITEM_PRODUCT_WIDTH_MM,\nITEM_RETAIL_BRAND_NAME,\nITEM_RETAIL_TYPE,\nITEM_ROLL_OVERIMAGE,\nITEM_SALES_CATEGORY_CODE,\nITEM_SCENE7_IMAGE_SET,\nITEM_SEATS,\nITEM_SERIES_NAME,\nITEM_SERIES_NUMBER,\nITEM_STAND_ALONE_FLAG,\nITEM_STATUS,\nITEM_STATUS_CHANGED,\nITEM_SUPP_DT_SHIP_ONLY,\nITEM_SUPP_WET_NET_WET_KG,\nITEM_SUPP_WET_NET_WET_LBS,\nITEM_THIRD_PARTY_ITEM,\nITEM_TRACKING_PIECE,\nITEM_TRADEMARK_TEXT,\nITEM_TYPE,\nITEM_UNIT_WEIGHT_KG,\nITEM_UNIT_WEIGHT_LBS,\nITEM_UPC,\nITEM_VALIDATION_COMPLETE,\nITEM_WHOLESALE_ASM_VIDEO1,\nITEM_AFI_FEATURE_BULLET1,\nITEM_AFI_FEATURE_BULLET2,\nITEM_AFI_FEATURE_BULLET3,\nITEM_AFI_FEATURE_BULLET4,\nITEM_AFI_FEATURE_BULLET5,\nITEM_AFI_FEATURE_BULLET6,\nITEM_AFI_FEATURE_BULLET7,\nITEM_CONSUMER_DESCRIPTION,\nITEM_FLUFF_AFI,\nITEM_FLUFF_PRINT,\nITEM_FRIENDLY_DESCRIPTION,\nITEM_HOMESTORE_FT_BULLET1,\nITEM_HOMESTORE_FT_BULLET2,\nITEM_HOMESTORE_FT_BULLET3,\nITEM_HOMESTORE_FT_BULLET4,\nITEM_HOMESTORE_FT_BULLET5,\nITEM_HOMESTORE_FT_BULLET6,\nITEM_HOMESTORE_FT_BULLET7,\nITEM_HOMESTORE_FT_BULLET8,\nITEM_HOMESTORE_ITEM_FLUFF,\nSERIES_ASHLEY_HOMESTORE,\nSERIES_CORP_ONLINE_SELLNG,\nSERIES_DIVISION,\nSERIES_EXCLUSIVE_COMMENT,\nSERIES_FEATURES,\nSERIES_ID,\nSERIES_INTERNATIONAL_HS,\nSERIES_INTRO_DATE,\nSERIES_MAIN_IMAGE,\nSERIES_NAME,\nSERIES_NUMBER,\nSERIES_RETAIL_SALES_CATEG,\nSERIES_SHOWROOM,\nSERIES_SOURCE_ID,\nSERIES_STATUS,\nSERIES_STYLE,\nSERIES_THIRD_PARTY,\nSERIES_PRIMARY,\nITEM_UOM_KEY,\nITEM_SHIPPABLE_UOM_KEY,\nITEM_ELIG_PROTECTION_PLAN,\nITEM_IS_PROTECTION_PLAN,\nITEM_ASHCOMM_DLVR_MODE,\nITEM_MATERIAL,\nITEM_HS_PRODUCT_LINE,\nITEM_ECOM_MERCHANT_NOTES,\nITEM_AMAZON_BRAND_OWNER,\nITEM_LIFESTYLE_DESC\nFROM [Retail].[EDWProductDelete] WITH(NOLOCK) WHERE CAST(LAST_MOD_DATE_TIME_UTC AS date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_Delete_EDWProductKit",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nKIT_ID,\nLAST_MOD_DATE_TIME_UTC,\nB_CREDATE,\nB_CLASSNAME,\nB_DELETETYPE,\nB_DELETEOPERATION,\nB_DELETEAUTHOR,\nB_DELETEDATE,\nCREATED_DATE_TIME_UTC,\nKIT_ADDITIONAL_DIMENSIONS,\nKIT_AFI_FT_BULLET1_ENG,\nKIT_AFI_FT_BULLET2_ENG,\nKIT_AFI_FT_BULLET3_ENG,\nKIT_AFI_FT_BULLET4_ENG,\nKIT_AFI_FT_BULLET5_ENG,\nKIT_AFI_FT_BULLET6_ENG,\nKIT_AFI_FT_BULLET7_ENG,\nKIT_AFI_IMAGE_SET,\nKIT_ALTER_DESC2,\nKIT_ALTER_DESC3,\nKIT_ALTERNATE_AFI_FLUFF1,\nKIT_AMAZON_BRAND_OWNER,\nKIT_ARVR_READY,\nKIT_ASHCOMM_DELIVERY_MODE,\nKIT_ASM_INSTR_INTERNAL,\nKIT_ASM_INSTR_PUBLIC,\nKIT_ATP_SERIES,\nKIT_AX_KIT_NUMBER,\nKIT_BOX_QTY,\nKIT_CARTON_DENSITY,\nKIT_CARTON_DEPTH_IN,\nKIT_CARTON_DEPTH_MM,\nKIT_CARTON_FREIGHT_CLASS,\nKIT_CARTON_HEIGHT_IN,\nKIT_CARTON_HEIGHT_MM,\nKIT_CARTON_VOLUME,\nKIT_CARTON_WIDTH_IN,\nKIT_CARTON_WIDTH_MM,\nKIT_CLASS_KEY,\nKIT_CODE_KEY,\nKIT_COLOR_KEY,\nKIT_COLOR_SWATCH,\nKIT_COMMODITY,\nKIT_COMPONENT_QUANTITY,\nKIT_COND_HOME_DELIV_ELIG,\nKIT_CONSUMER_ASSEMBLY,\nKIT_CONSUMER_DESC_ENG,\nKIT_CUBES_FT,\nKIT_CUBES_M,\nKIT_DEAD,\nKIT_DFLT_GROUP_CODE_KEY,\nKIT_DIMENSION_SKETCH,\nKIT_DIMENSIONS_CONFIRMED,\nKIT_DINING_CHAIR_QTY_CTN,\nKIT_ECOM_MERCHANT_NOTES,\nKIT_ELIG_PROTECTION_PLAN,\nKIT_ENGINEER_DIVISION_KEY,\nKIT_EXCLUSIVE,\nKIT_EXCLUSIVE_COMMENT,\nKIT_EXPRESS_SHIP,\nKIT_FAMILYOF_BUSINESS_KEY,\nKIT_FLUFF_AFI_ENGLISH,\nKIT_FLUFF_PRINT_ENGLISH,\nKIT_FOB_BASE_PRICE,\nKIT_FORECAST_PLANNER_ID,\nKIT_FRIENDLY_DESC_ENG,\nKIT_FRIENDLY_DIMENSIONS,\nKIT_FUTURE_STATUS,\nKIT_GEN_DESC_ID,\nKIT_GEN_LONG_DESC,\nKIT_GOOGLE_TITLE,\nKIT_HOMESTORE_ASM_VIDEO1,\nKIT_HOMESTORE_PDT_LINE,\nKIT_HS_FT_BULLET1_ENG,\nKIT_HS_FT_BULLET2_ENG,\nKIT_HS_FT_BULLET3_ENG,\nKIT_HS_FT_BULLET4_ENG,\nKIT_HS_FT_BULLET5_ENG,\nKIT_HS_FT_BULLET6_ENG,\nKIT_HS_FT_BULLET7_ENG,\nKIT_HS_FT_BULLET8_ENG,\nKIT_HS_KIT_FLUFF_ENG,\nKIT_HTS_CODE,\nKIT_IMPORT_DOMESTIC_KEY,\nKIT_IS_PROTECTION_PLAN,\nKIT_KEY_KIT,\nKIT_KNOCKOUT,\nKIT_MATERIAL_ENGLISH,\nKIT_MFG_WARRANTY,\nKIT_NOT_AVBL_INDIV_SALE,\nKIT_NUMBER,\nKIT_PARTS_DRAWINGS,\nKIT_PHOTO,\nKIT_PK_LEG_SELLABLE_PKG,\nKIT_PRIMARY_LIFESTYLE,\nKIT_PRODUCT_DEPTH_IN,\nKIT_PRODUCT_DEPTH_MM,\nKIT_PRODUCT_HEIGHT_IN,\nKIT_PRODUCT_HEIGHT_MM,\nKIT_PRODUCT_PAGE_URL,\nKIT_PRODUCT_WIDTH_IN,\nKIT_PRODUCT_WIDTH_MM,\nKIT_PURCHASE_TYPE,\nKIT_RETAIL_BRAND_NAME_KEY,\nKIT_RETAIL_ROOM_KEY,\nKIT_RETAIL_TYPE_KEY,\nKIT_ROLL_OVER_IMAGE,\nKIT_SALES_CATEG_CODE_KEY,\nKIT_SCENE7_IMAGE_SET,\nKIT_SEATS,\nKIT_SELLLING_COUNTRIES,\nKIT_SERIES_NUMBER,\nKIT_SERIES_RT_SL_CAT_KEY,\nKIT_SHIPPABLE_UOM_KEY,\nKIT_SHIPPING_DEPTH_IN,\nKIT_SHIPPING_DEPTH_MM,\nKIT_SHIPPING_HEIGHT_IN,\nKIT_SHIPPING_HEIGHT_MM,\nKIT_SHIPPING_WIDTH_IN,\nKIT_SHIPPING_WIDTH_MM,\nKIT_SHOWROOM_MKT_STATUS,\nKIT_SOURCE_ID,\nKIT_STAND_ALONE_FLAG,\nKIT_STATUS,\nKIT_STATUS_CHANGED,\nKIT_STATUS_KEY,\nKIT_SUPP_WT_NET_WT_KG,\nKIT_SUPP_WT_NET_WT_LBS,\nKIT_SUPPLIER_DT_SHIP_ONLY,\nKIT_THIRD_PARTY_KIT,\nKIT_TRACKING_PIECE,\nKIT_TRADEMARK_TEXT,\nKIT_TYPE,\nKIT_UNIT_WEIGHT_KG,\nKIT_UNIT_WEIGHT_LBS,\nKIT_UOM_KEY,\nKIT_UPC,\nKIT_UPHOLSTERY_COVER,\nKIT_VALIDATION_COMPLETE,\nKIT_VENDOR_NAME,\nKIT_WHOLESALE_ASM_VIDEO1,\nSERIES_ID,\nSERIES_KEY\nFROM [Retail].[EDWProductKitDelete] WITH(NOLOCK) WHERE CAST(LAST_MOD_DATE_TIME_UTC AS date)>='@{variables('Date')}'\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_BOX_QTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductKit",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_Delete_EDWProductPackage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nPACKAGE_ID,\nLAST_MOD_DATE_TIME_UTC,\nB_CREDATE,\nB_CLASSNAME,\nB_DELETETYPE,\nB_DELETEOPERATION,\nB_DELETEAUTHOR,\nB_DELETEDATE,\nPACKAGE_KEY,\nHOMESTORE_PACKAGE_ID,\nCREATED_DATE_TIME_UTC,\nPACKAGE_NUMBER,\nPACKAGE_ALTER_NAME,\nPACKAGE_HERO,\nPACKAGE_STATUS,\nPACKAGE_STATUS_CHANGED,\nPACKAGE_IS_THIRD_PARTY,\nPACKAGE_HOMESTORE_ID,\nPACKAGE_WHOLESALE_ID,\nPACKAGE_RETAIL_TYPE,\nPACKAGE_ITEM_QUANTITY,\nPACKAGE_UOM,\nPACKAGE_COLOR,\nPACKAGE_KNOCKOUT,\nPACKAGE_SCENE7_IMAGE_SET,\nPACKAGE_VALIDAT_COMPLETE,\nPACKAGE_VALIDATION_NOTES,\nPACKAGE_ROLLOVER_IMAGE,\nPACKAGE_EXPRESS_SHIP,\nPACKAGE_SUPP_DT_SHIP_ONLY,\nPACKAGE_SALES_CATEG_CODE,\nPACKAGE_SERIES_NUMBER,\nPACKAGE_SERIES_NAME,\nPACKAGE_CODE,\nPACKAGE_ASHCOM_TRANSITION,\nPACKAGE_SWATCH_GROUP_ID,\nPACKAGE_DEFAULT_PRODUCT,\nPACKAGE_NEW_FLAG_DATE,\nPACKAGE_ASHCOMM_DLVR_MODE,\nPACKAGE_CHANNEL_CHANGE,\nPACKAGE_EXCLUSIVE,\nPACKAGE_HOT_SPOTS_REVIEW,\nPACKAGE_ALT_DESC1,\nPACKAGE_ASH_TTL_OVERRIDE,\nPACKAGE_HIDDEN_FIELD,\nPACKAGE_CONSUMER_CHOICE,\nPACKAGE_TOTAL_ASM_TIME,\nPACKAGE_ASHCOMM_FLAGS,\nPACKAGE_NAVIGABLE_CATEG,\nPACKAGE_NAME,\nPACKAGE_AFI_FLUFF,\nPACKAGE_HS_PACKAGE_FLUFF,\nPACKAGE_AFI_BULLETS1,\nPACKAGE_AFI_BULLETS2,\nPACKAGE_AFI_BULLETS3,\nPACKAGE_AFI_BULLETS4,\nPACKAGE_AFI_BULLETS5,\nPACKAGE_AFI_BULLETS6,\nPACKAGE_HOMESTORE_BULLET1,\nPACKAGE_HOMESTORE_BULLET2,\nPACKAGE_HOMESTORE_BULLET3,\nPACKAGE_HOMESTORE_BULLET4,\nPACKAGE_HOMESTORE_BULLET5,\nPACKAGE_HOMESTORE_BULLET6\nFROM [Retail].[EDWProductPackageDelete] WITH(NOLOCK) WHERE CAST(LAST_MOD_DATE_TIME_UTC AS date)>='@{variables('Date')}'\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SetDateVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Date",
							"value": {
								"value": "@formatDateTime(adddays(startOfDay(utcnow()),-1), 'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Product_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProduct]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Product",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_Delete_EDWProduct').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProduct').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProduct]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProduct').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ProductKit_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_KIT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductKit]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_ProductKit",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_Delete_EDWProductKit').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductKit').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "ProductKit_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_KIT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductKit]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductKit').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ProductPackage_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_PACKAGE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductPackage]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ProductPackage_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.SA_PRODUCT_PACKAGE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "[[Retail].[EDWProductPackage]",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_ProductPackage",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_Delete_EDWProductPackage').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_Delete_EDWProductPackage').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_EDWProduct_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProduct",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_EDWProductKit_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductKit",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_EDWProductPackage_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Delete_EDWProductPackage",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Date": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-11-08T08:53:29Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_Product')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductKit')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductPackage')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMasterLoad_Retail_PIM_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_EDWProductKit",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT 'ProductKit' AS B_CLASSNAME,\n'semadmin' AS B_CREATOR,\nCreatedDateTimeUtc AS CREATED_DATE_TIME_UTC,\nKitAdditionalDimensions AS KIT_ADDITIONAL_DIMENSIONS,\nKitAfiFeatureBullet1English AS KIT_AFI_FT_BULLET1_ENG,\nKitAfiFeatureBullet2English AS KIT_AFI_FT_BULLET2_ENG,\nKitAfiFeatureBullet3English AS KIT_AFI_FT_BULLET3_ENG,\nKitAfiFeatureBullet4English AS KIT_AFI_FT_BULLET4_ENG,\nKitAfiFeatureBullet5English AS KIT_AFI_FT_BULLET5_ENG,\nKitAfiFeatureBullet6English AS KIT_AFI_FT_BULLET6_ENG,\nKitAfiFeatureBullet7English AS KIT_AFI_FT_BULLET7_ENG,\nKitAFIImageSet AS KIT_AFI_IMAGE_SET,\nKitAlternateDescription2 AS KIT_ALTER_DESC2,\nKitAlternateDescription3 AS KIT_ALTER_DESC3,\nKitAlternateAFIFluff1 AS KIT_ALTERNATE_AFI_FLUFF1,\nKitAmazonBrandOwner AS KIT_AMAZON_BRAND_OWNER,\nKitARVRReady AS KIT_ARVR_READY,\nKitAshcommDeliveryMode AS KIT_ASHCOMM_DELIVERY_MODE,\nKitAssemblyInstructionsInternal AS KIT_ASM_INSTR_INTERNAL,\nKitAssemblyInstructionsPublic AS KIT_ASM_INSTR_PUBLIC,\nKitATPSeries AS KIT_ATP_SERIES,\nKitAXKitNumber AS KIT_AX_KIT_NUMBER,\nKitBoxQty AS KIT_BOX_QTY,\nKitCartonDensity AS KIT_CARTON_DENSITY,\nKitCartonDepthIn AS KIT_CARTON_DEPTH_IN,\nKitCartonDepthMm AS KIT_CARTON_DEPTH_MM,\nKitCartonFreightClass AS KIT_CARTON_FREIGHT_CLASS,\nKitCartonHeightIn AS KIT_CARTON_HEIGHT_IN,\nKitCartonHeightMm AS KIT_CARTON_HEIGHT_MM,\nKitCartonVolume AS KIT_CARTON_VOLUME,\nKitCartonWidthIn AS KIT_CARTON_WIDTH_IN,\nKitCartonWidthMm AS KIT_CARTON_WIDTH_MM,\nKitClassKey AS KIT_CLASS_KEY,\nKitCodeKey AS KIT_CODE_KEY,\nKitColorKey AS KIT_COLOR_KEY,\nKitColorSwatch AS KIT_COLOR_SWATCH,\nKitCommodity AS KIT_COMMODITY,\nKitComponentQuantity AS KIT_COMPONENT_QUANTITY,\nKitConditionalHomeDeliveryEligible AS KIT_COND_HOME_DELIV_ELIG,\nKitConsumerAssembly AS KIT_CONSUMER_ASSEMBLY,\nKitConsumerDescriptionEnglish AS KIT_CONSUMER_DESC_ENG,\nKitCubesFt AS KIT_CUBES_FT,\nKitCubesM AS KIT_CUBES_M,\nKitDead AS KIT_DEAD,\nKitDefaultGroupingLookupCodeKey AS KIT_DFLT_GROUP_CODE_KEY,\nKitDimensionSketch AS KIT_DIMENSION_SKETCH,\nKitDimensionsConfirmed AS KIT_DIMENSIONS_CONFIRMED,\nKitDiningChairQtyCtn AS KIT_DINING_CHAIR_QTY_CTN,\nKitEcomMerchantNotes AS KIT_ECOM_MERCHANT_NOTES,\nKitEligibleforProtectionPlan AS KIT_ELIG_PROTECTION_PLAN,\nKitEngineeringDivisionKey AS KIT_ENGINEER_DIVISION_KEY,\nKitExclusive AS KIT_EXCLUSIVE,\nKitExclusiveComment AS KIT_EXCLUSIVE_COMMENT,\nKitExpressShip AS KIT_EXPRESS_SHIP,\nKitFamilyofBusinessKey AS KIT_FAMILYOF_BUSINESS_KEY,\nKitFluffAFIEnglish AS KIT_FLUFF_AFI_ENGLISH,\nKitFluffPrintEnglish AS KIT_FLUFF_PRINT_ENGLISH,\nKitFOBBasePrice AS KIT_FOB_BASE_PRICE,\nKitForecastPlannerID AS KIT_FORECAST_PLANNER_ID,\nKitFriendlyDescriptionEnglish AS KIT_FRIENDLY_DESC_ENG,\nKitFriendlyDimensions AS KIT_FRIENDLY_DIMENSIONS,\nKitFutureStatus AS KIT_FUTURE_STATUS,\nKitGeneralDescriptionID AS KIT_GEN_DESC_ID,\nKitGeneralLongDescription AS KIT_GEN_LONG_DESC,\nKitGoogleTitle AS KIT_GOOGLE_TITLE,\nKitHomeStoreAssemblyVideo1 AS KIT_HOMESTORE_ASM_VIDEO1,\nKitHomestoreProductLine AS KIT_HOMESTORE_PDT_LINE,\nKitHomstoreFeatureBullet1English AS KIT_HS_FT_BULLET1_ENG,\nKitHomstoreFeatureBullet2English AS KIT_HS_FT_BULLET2_ENG,\nKitHomstoreFeatureBullet3English AS KIT_HS_FT_BULLET3_ENG,\nKitHomstoreFeatureBullet4English AS KIT_HS_FT_BULLET4_ENG,\nKitHomstoreFeatureBullet5English AS KIT_HS_FT_BULLET5_ENG,\nKitHomstoreFeatureBullet6English AS KIT_HS_FT_BULLET6_ENG,\nKitHomstoreFeatureBullet7English AS KIT_HS_FT_BULLET7_ENG,\nKitHomstoreFeatureBullet8English AS KIT_HS_FT_BULLET8_ENG,\nKitHomestoreKitFluffEnglish AS KIT_HS_KIT_FLUFF_ENG,\nKitHTSCode AS KIT_HTS_CODE,\nKitID AS KIT_ID,\nKitImportDomesticKey AS KIT_IMPORT_DOMESTIC_KEY,\nKitIsProtectionPlan AS KIT_IS_PROTECTION_PLAN,\nKitKeyKit AS KIT_KEY_KIT,\nKitKnockout AS KIT_KNOCKOUT,\nKitMaterialEnglish AS KIT_MATERIAL_ENGLISH,\nKitMfgWarranty AS KIT_MFG_WARRANTY,\nKitNotAvailableforIndividualSale AS KIT_NOT_AVBL_INDIV_SALE,\nKitNumber AS KIT_NUMBER,\nKitPartsDrawings AS KIT_PARTS_DRAWINGS,\nKitPhoto AS KIT_PHOTO,\nKitPKLegacySellablePackage AS KIT_PK_LEG_SELLABLE_PKG,\nKitPrimaryLifestyle AS KIT_PRIMARY_LIFESTYLE,\nKitProductDepthIn AS KIT_PRODUCT_DEPTH_IN,\nKitProductDepthMm AS KIT_PRODUCT_DEPTH_MM,\nKitProductHeightIn AS KIT_PRODUCT_HEIGHT_IN,\nKitProductHeightMm AS KIT_PRODUCT_HEIGHT_MM,\nKitProductPageURL AS KIT_PRODUCT_PAGE_URL,\nKitProductWidthIn AS KIT_PRODUCT_WIDTH_IN,\nKitProductWidthMm AS KIT_PRODUCT_WIDTH_MM,\nKitPurchaseType AS KIT_PURCHASE_TYPE,\nKitRetailBrandNameKey AS KIT_RETAIL_BRAND_NAME_KEY,\nKitRetailRoomKey AS KIT_RETAIL_ROOM_KEY,\nKitRetailTypeKey AS KIT_RETAIL_TYPE_KEY,\nKitRollOverimage AS KIT_ROLL_OVER_IMAGE,\nKitSalesCategoryCodeKey AS KIT_SALES_CATEG_CODE_KEY,\nKitScene7ImageSet AS KIT_SCENE7_IMAGE_SET,\nKitSeats AS KIT_SEATS,\nKitSelllingCountries AS KIT_SELLLING_COUNTRIES,\nKitSeriesNumber AS KIT_SERIES_NUMBER,\nKitSeriesRetailSalesCategoryKey AS KIT_SERIES_RT_SL_CAT_KEY,\nKitShippableUomKey AS KIT_SHIPPABLE_UOM_KEY,\nKitShippingDepthIn AS KIT_SHIPPING_DEPTH_IN,\nKitShippingDepthMm AS KIT_SHIPPING_DEPTH_MM,\nKitShippingHeightIn AS KIT_SHIPPING_HEIGHT_IN,\nKitShippingHeightMm AS KIT_SHIPPING_HEIGHT_MM,\nKitShippingWidthIn AS KIT_SHIPPING_WIDTH_IN,\nKitShippingWidthMm AS KIT_SHIPPING_WIDTH_MM,\nKitShowroomMarketStatus AS KIT_SHOWROOM_MKT_STATUS,\nCAST(KitSourceID AS int) AS KIT_SOURCE_ID,\nKitStandAloneFlag AS KIT_STAND_ALONE_FLAG,\nKitStatus AS KIT_STATUS,\nKitStatusChanged AS KIT_STATUS_CHANGED,\nKitStatusKey AS KIT_STATUS_KEY,\nKitSuppWeightNetWeightKg AS KIT_SUPP_WT_NET_WT_KG,\nKitSuppWeightNetWeightLbs AS KIT_SUPP_WT_NET_WT_LBS,\nKitSupplierDirectShipOnly AS KIT_SUPPLIER_DT_SHIP_ONLY,\nKitThirdPartyKit AS KIT_THIRD_PARTY_KIT,\nKitTrackingPiece AS KIT_TRACKING_PIECE,\nKitTrademarkText AS KIT_TRADEMARK_TEXT,\nKitType AS KIT_TYPE,\nKitUnitWeightKg AS KIT_UNIT_WEIGHT_KG,\nKitUnitWeightLbs AS KIT_UNIT_WEIGHT_LBS,\nKitUomKey AS KIT_UOM_KEY,\nKitUPC AS KIT_UPC,\nKitUpholsteryCover AS KIT_UPHOLSTERY_COVER,\nKitValidationComplete AS KIT_VALIDATION_COMPLETE,\nKitVendorName AS KIT_VENDOR_NAME,\nKitWholesaleAssemblyVideo1 AS KIT_WHOLESALE_ASM_VIDEO1,\nLastModifiedDateTimeUtc AS LAST_MOD_DATE_TIME_UTC,\nSeriesID AS SERIES_ID,\nCAST(SeriesKey AS int) AS SERIES_KEY\nfrom [Retail].[EDWProductKit] WHERE KitStatus<>'Deleted' AND CAST(LastModifiedDateTimeUtc as date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_BOX_QTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductKit",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_EDWProduct",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT 'semadmin' AS B_CREATOR,\n'ProductMain' AS B_CLASSNAME,\nid AS PRODUCT_MAIN_ID,\nSourceId AS SOURCE_ID,\nStatus AS STATUS,\nLastModifiedDateTimeUtc AS LAST_MOD_DATE_TIME_UTC,\nSystemTimestamp AS SYSTEM_TIMESTAMP,\nAlternateDescription2 AS ALTERNATE_DESCRIPTION2,\nItemAFIImageSet AS ITEM_AFI_IMAGE_SET,\nItemAlternateAFIFluff1 AS ITEM_ALTERNATE_AFI_FLUFF1,\nItemAlternateDescription3 AS ITEM_ALTER_DESC3,\nItemARVRReady AS ITEM_ARVR_READY,\nItemAssemblyInstructionsInternal AS ITEM_ASM_INSTR_INTERNAL,\nItemAssemblyInstructionsPublic AS ITEM_ASM_INSTR_PUBLIC,\nItemBoxQty AS ITEM_BOX_QTY,\nItemCartonDepthIn AS ITEM_CARTON_DEPTH_IN,\nItemCartonDepthMm AS ITEM_CARTON_DEPTH_MM,\nItemCartonHeightIn AS ITEM_CARTON_HEIGHT_IN,\nItemCartonHeightMm AS ITEM_CARTON_HEIGHT_MM,\nItemCartonWidthIn AS ITEM_CARTON_WIDTH_IN,\nItemCartonWidthMm AS ITEM_CARTON_WIDTH_MM,\nItemClass AS ITEM_CLASS,\nItemCode AS ITEM_CODE,\nItemColor AS ITEM_COLOR,\nItemColorSwatch AS ITEM_COLOR_SWATCH,\nItemCommodity AS ITEM_COMMODITY,\nItemComponentQuantity AS ITEM_COMPONENT_QUANTITY,\nItemConsumerAssembly AS ITEM_CONSUMER_ASSEMBLY,\nItemCubesFt AS ITEM_CUBES_FT,\nItemCubesM AS ITEM_CUBES_M,\nItemDead AS ITEM_DEAD,\nItemDimensionSketch AS ITEM_DIMENSION_SKETCH,\nItemDiningChairQtyCtn AS ITEM_DINING_CHAIR_QTY_CTN,\nItemEngineeringDivision AS ITEM_ENGINEERING_DIVISION,\nItemExclusive AS ITEM_EXCLUSIVE,\nItemExclusiveComment AS ITEM_EXCLUSIVE_COMMENT,\nItemExpressShip AS ITEM_EXPRESS_SHIP,\nItemFOBBasePrice AS ITEM_FOB_BASE_PRICE,\nItemForecastPlannerID AS ITEM_FORECAST_PLANNER_ID,\nItemFriendlyDimensions AS ITEM_FRIENDLY_DIMENSIONS,\nItemFutureStatus AS ITEM_FUTURE_STATUS,\nItemGeneralDescriptionID AS ITEM_GNRL_DESC_ID,\nItemGeneralLongDescription AS ITEM_GNRL_LONG_DESC,\nItemGoogleTitle AS ITEM_GOOGLE_TITLE,\nItemHomeStoreAssemblyVideo1 AS ITEM_HOMSTORE_ASM_VIDEO1,\nItemHTSCode AS ITEM_HTS_CODE,\nItemImportDomestic AS ITEM_IMPORT_DOMESTIC,\nItemKeyItem AS ITEM_KEY_ITEM,\nItemKnockout AS ITEM_KNOCKOUT,\nItemMaterialReferenceNeeded AS ITEM_MTERIAL_REF_NEEDED,\nItemMfgWarranty AS ITEM_MFG_WARRANTY,\nItemNumber AS ITEM_NUMBER,\nItemPhoto AS ITEM_PHOTO,\nItemProductDepthIn AS ITEM_PRODUCT_DEPTH_IN,\nItemProductDepthMm AS ITEM_PRODUCT_DEPTH_MM,\nItemProductHeightIn AS ITEM_PRODUCT_HEIGHT_IN,\nItemProductHeightMm AS ITEM_PRODUCT_HEIGHT_MM,\nItemProductPageURL AS ITEM_PRODUCT_PAGE_URL,\nItemProductWidthIn AS ITEM_PRODUCT_WIDTH_IN,\nItemProductWidthMm AS ITEM_PRODUCT_WIDTH_MM,\nItemRetailBrandName AS ITEM_RETAIL_BRAND_NAME,\nItemRetailType AS ITEM_RETAIL_TYPE,\nItemRollOverimage AS ITEM_ROLL_OVERIMAGE,\nItemSalesCategoryCode AS ITEM_SALES_CATEGORY_CODE,\nItemScene7ImageSet AS ITEM_SCENE7_IMAGE_SET,\nItemSeats AS ITEM_SEATS,\nItemSeriesName AS ITEM_SERIES_NAME,\nItemSeriesNumber AS ITEM_SERIES_NUMBER,\nItemStandAloneFlag AS ITEM_STAND_ALONE_FLAG,\nItemStatus AS ITEM_STATUS,\nItemStatusChanged AS ITEM_STATUS_CHANGED,\nItemSupplierDirectShipOnly AS ITEM_SUPP_DT_SHIP_ONLY,\nItemSuppWeightNetWeightKg AS ITEM_SUPP_WET_NET_WET_KG,\nItemSuppWeightNetWeightLbs AS ITEM_SUPP_WET_NET_WET_LBS,\nItemThirdPartyItem AS ITEM_THIRD_PARTY_ITEM,\nItemTrackingPiece AS ITEM_TRACKING_PIECE,\nItemTrademarkText AS ITEM_TRADEMARK_TEXT,\nItemType AS ITEM_TYPE,\nItemUnitWeightKg AS ITEM_UNIT_WEIGHT_KG,\nItemUnitWeightLbs AS ITEM_UNIT_WEIGHT_LBS,\nItemUPC AS ITEM_UPC,\nItemValidationComplete AS ITEM_VALIDATION_COMPLETE,\nItemWholesaleAssemblyVideo1 AS ITEM_WHOLESALE_ASM_VIDEO1,\nItemAFIFeatureBullet1 AS ITEM_AFI_FEATURE_BULLET1,\nItemAFIFeatureBullet2 AS ITEM_AFI_FEATURE_BULLET2,\nItemAFIFeatureBullet3 AS ITEM_AFI_FEATURE_BULLET3,\nItemAFIFeatureBullet4 AS ITEM_AFI_FEATURE_BULLET4,\nItemAFIFeatureBullet5 AS ITEM_AFI_FEATURE_BULLET5,\nItemAFIFeatureBullet6 AS ITEM_AFI_FEATURE_BULLET6,\nItemAFIFeatureBullet7 AS ITEM_AFI_FEATURE_BULLET7,\nItemConsumerDescription AS ITEM_CONSUMER_DESCRIPTION,\nItemFluffAFI AS ITEM_FLUFF_AFI,\nItemFluffPrint AS ITEM_FLUFF_PRINT,\nItemFriendlyDescription AS ITEM_FRIENDLY_DESCRIPTION,\nItemHomeStoreFeatureBullet1 AS ITEM_HOMESTORE_FT_BULLET1,\nItemHomeStoreFeatureBullet2 AS ITEM_HOMESTORE_FT_BULLET2,\nItemHomeStoreFeatureBullet3 AS ITEM_HOMESTORE_FT_BULLET3,\nItemHomeStoreFeatureBullet4 AS ITEM_HOMESTORE_FT_BULLET4,\nItemHomeStoreFeatureBullet5 AS ITEM_HOMESTORE_FT_BULLET5,\nItemHomeStoreFeatureBullet6 AS ITEM_HOMESTORE_FT_BULLET6,\nItemHomeStoreFeatureBullet7 AS ITEM_HOMESTORE_FT_BULLET7,\nItemHomeStoreFeatureBullet8 AS ITEM_HOMESTORE_FT_BULLET8,\nItemHomestoreItemFluff AS ITEM_HOMESTORE_ITEM_FLUFF,\nTRIM(SeriesAshleyHomestore) AS SERIES_ASHLEY_HOMESTORE,\nSeriesCorporateOnlineSelling AS SERIES_CORP_ONLINE_SELLNG,\nSeriesDivision AS SERIES_DIVISION,\nSeriesExclusiveComment AS SERIES_EXCLUSIVE_COMMENT,\nSeriesFeatures AS SERIES_FEATURES,\nSeriesId AS SERIES_ID,\nSeriesInternationalHomeStore AS SERIES_INTERNATIONAL_HS,\nSeriesIntroDate AS SERIES_INTRO_DATE,\nSeriesMainImage AS SERIES_MAIN_IMAGE,\nSeriesName AS SERIES_NAME,\nSeriesNumber AS SERIES_NUMBER,\nSeriesRetailSalesCategory AS SERIES_RETAIL_SALES_CATEG,\nSeriesShowroom AS SERIES_SHOWROOM,\nSeriesSourceId AS SERIES_SOURCE_ID,\nSeriesStatus AS SERIES_STATUS,\nSeriesStyle AS SERIES_STYLE,\nSeriesThirdParty AS SERIES_THIRD_PARTY,\nSeriesPrimary AS SERIES_PRIMARY,\nItemUomKey AS ITEM_UOM_KEY,\nItemShippableUomKey AS ITEM_SHIPPABLE_UOM_KEY,\nItemEligibleforProtectionPlan AS ITEM_ELIG_PROTECTION_PLAN,\nItemIsProtectionPlan AS ITEM_IS_PROTECTION_PLAN,\nItemAshcommDeliveryMode AS ITEM_ASHCOMM_DLVR_MODE,\nItemMaterial AS ITEM_MATERIAL,\nItemHomeStoreProductLine AS ITEM_HS_PRODUCT_LINE,\nItemEcomMerchantNotes AS ITEM_ECOM_MERCHANT_NOTES,\nItemAmazonBrandOwner AS ITEM_AMAZON_BRAND_OWNER,\nItemLifestyleDescription AS ITEM_LIFESTYLE_DESC,\nB_DELETETYPE as B_DELETETYPE,\nB_DELETEDATE as B_DELETEDATE,\nB_DELETEAUTHOR as B_DELETEAUTHOR,\nB_DELETEOPERATION as B_DELETEOPERATION\nfrom retail.PIM_PRODUCT_VW \nwhere activity_type is not null;\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"PRODUCT_MAIN_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_EDWProductPackage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetDateVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n'semadmin' AS B_CREATOR,\n'ProductPackage' AS B_CLASSNAME,\nPackageID AS PACKAGE_ID,\nPackageKey AS PACKAGE_KEY,\nHomestorePackageId AS HOMESTORE_PACKAGE_ID,\nLastModifiedDateTimeUtc AS LAST_MOD_DATE_TIME_UTC,\nCreatedDateTimeUtc AS CREATED_DATE_TIME_UTC,\nPackageNumber AS PACKAGE_NUMBER,\nPackageAlternatePackageName AS PACKAGE_ALTER_NAME,\nPackageHero AS PACKAGE_HERO,\nPackageStatus AS PACKAGE_STATUS,\nPackageStatusChanged AS PACKAGE_STATUS_CHANGED,\nPackageIsThirdParty AS PACKAGE_IS_THIRD_PARTY,\nPackageHomestorePackageId AS PACKAGE_HOMESTORE_ID,\nPackageWholesaleID AS PACKAGE_WHOLESALE_ID,\nPackageRetailType AS PACKAGE_RETAIL_TYPE,\nPackageItemQuantity AS PACKAGE_ITEM_QUANTITY,\nPackageUOM AS PACKAGE_UOM,\nPackageColor AS PACKAGE_COLOR,\nPackageKnockout AS PACKAGE_KNOCKOUT,\nPackageScene7ImageSet AS PACKAGE_SCENE7_IMAGE_SET,\nPackageValidationComplete AS PACKAGE_VALIDAT_COMPLETE,\nPackageValidationNotes AS PACKAGE_VALIDATION_NOTES,\nPackageRolloverImage AS PACKAGE_ROLLOVER_IMAGE,\nPackageExpressShip AS PACKAGE_EXPRESS_SHIP,\nPackageSupplierDirectShipOnly AS PACKAGE_SUPP_DT_SHIP_ONLY,\nPackageSalesCategoryCode AS PACKAGE_SALES_CATEG_CODE,\nPackageSeriesNumber AS PACKAGE_SERIES_NUMBER,\nPackageSeriesName AS PACKAGE_SERIES_NAME,\nPackageCode AS PACKAGE_CODE,\nPackageAshcommTransition AS PACKAGE_ASHCOM_TRANSITION,\nPackageSwatchGroupID AS PACKAGE_SWATCH_GROUP_ID,\nPackageDefaultProduct AS PACKAGE_DEFAULT_PRODUCT,\nPackageNewFlagDate AS PACKAGE_NEW_FLAG_DATE,\nPackageAshcommDeliveryMode AS PACKAGE_ASHCOMM_DLVR_MODE,\nPackageChannelChange AS PACKAGE_CHANNEL_CHANGE,\nPackageExclusive AS PACKAGE_EXCLUSIVE,\nPackageHotSpotsNeedReview AS PACKAGE_HOT_SPOTS_REVIEW,\nPackageAlternateDescription1 AS PACKAGE_ALT_DESC1,\nPackageAshcommTitleOverride AS PACKAGE_ASH_TTL_OVERRIDE,\nPackageHiddenField AS PACKAGE_HIDDEN_FIELD,\nPackageConsumerChoice AS PACKAGE_CONSUMER_CHOICE,\nPackageTotalAssemblyTime AS PACKAGE_TOTAL_ASM_TIME,\nPackageAshcommFlags AS PACKAGE_ASHCOMM_FLAGS,\nPackageNavigableCategories AS PACKAGE_NAVIGABLE_CATEG,\nPackageName AS PACKAGE_NAME,\nPackageAFIFluff AS PACKAGE_AFI_FLUFF,\nPackageHomestorePackageFluff AS PACKAGE_HS_PACKAGE_FLUFF,\nPackageAFIBullets1 AS PACKAGE_AFI_BULLETS1,\nPackageAFIBullets2 AS PACKAGE_AFI_BULLETS2,\nPackageAFIBullets3 AS PACKAGE_AFI_BULLETS3,\nPackageAFIBullets4 AS PACKAGE_AFI_BULLETS4,\nPackageAFIBullets5 AS PACKAGE_AFI_BULLETS5,\nPackageAFIBullets6 AS PACKAGE_AFI_BULLETS6,\nPackageHomeStoreBullets1 AS PACKAGE_HOMESTORE_BULLET1,\nPackageHomeStoreBullets2 AS PACKAGE_HOMESTORE_BULLET2,\nPackageHomeStoreBullets3 AS PACKAGE_HOMESTORE_BULLET3,\nPackageHomeStoreBullets4 AS PACKAGE_HOMESTORE_BULLET4,\nPackageHomeStoreBullets5 AS PACKAGE_HOMESTORE_BULLET5,\nPackageHomeStoreBullets6 AS PACKAGE_HOMESTORE_BULLET6\nFROM [Retail].[EDWProductPackage] WHERE PackageStatus<>'Deleted' AND CAST(LastModifiedDateTimeUtc as date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_ProductCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load_Retail_PIM_EDWProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProduct_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'semadmin' AS B_CREATOR,\r\n'ProductPackageCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_PKG_CROSSWALK_ID,\r\nProductID AS F_PRODUCT_ID,\r\nProductSourceID AS PRODUCT_SOURCE_ID,\r\nProductType AS PRODUCT_TYPE,\r\nPackageID AS F_PACKAGE_ID,\r\nPackageSourceID AS PACKAGE_SOURCE_ID \r\nFROM [Retail].[ProductPackageCrosswalk]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"PRODUCT_PKG_CROSSWALK_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'semadmin' AS B_CREATOR,\r\n'ProductKitCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_KIT_CROSSWALK_ID,\r\nKitID AS F_KIT_ID,\r\nKitSourceID AS KIT_SOURCE_ID,\r\nComponentType AS PRODUCT_TYPE,\r\nComponentID AS F_PRODUCT_MAIN_ID,\r\nComponentSourceID AS PRODUCT_SOURCE_ID\r\nFROM [Retail].[KitComponentCrosswalk]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"PRODUCT_KIT_CROSSWALK_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SetDateVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Date",
							"value": {
								"value": "@formatDateTime(adddays(startOfDay(utcnow()),-1), 'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load_Retail_PIM_ProductCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_KitComponentCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'semadmin' AS B_CREATOR,\n'ProductCode' AS B_CLASSNAME,\nSYSUTCDATETIME() as LAST_MODIFIED_DATE,\nProductCodeKey AS PRODUCT_CODE_KEY,\nProductCode AS PRODUCT_CODE,\ncast(IsActive as bit) AS IS_ACTIVE\nFROM [Retail].[EDWProductCode]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"PRODUCT_CODE_KEY"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PRODUCT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MODIFIED_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IS_ACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "IS_ACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_EDWProduct_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT 'semadmin' AS B_CREATOR,\n'ProductMain' AS B_CLASSNAME,\nid,\nSourceId,\nStatus,\nLastModifiedDateTimeUtc,\nSystemTimestamp,\nAlternateDescription2,\nItemAFIImageSet,\nItemAlternateAFIFluff1,\nItemAlternateDescription3,\nItemARVRReady,\nItemAssemblyInstructionsInternal,\nItemAssemblyInstructionsPublic,\nItemBoxQty,\nItemCartonDepthIn,\nItemCartonDepthMm,\nItemCartonHeightIn,\nItemCartonHeightMm,\nItemCartonWidthIn,\nItemCartonWidthMm,\nItemClass,\nItemCode,\nItemColor,\nItemColorSwatch,\nItemCommodity,\nItemComponentQuantity,\nItemConsumerAssembly,\nItemCubesFt,\nItemCubesM,\nItemDead,\nItemDimensionSketch,\nItemDiningChairQtyCtn,\nItemEngineeringDivision,\nItemExclusive,\nItemExclusiveComment,\nItemExpressShip,\nItemFOBBasePrice,\nItemForecastPlannerID,\nItemFriendlyDimensions,\nItemFutureStatus,\nItemGeneralDescriptionID,\nItemGeneralLongDescription,\nItemGoogleTitle,\nItemHomeStoreAssemblyVideo1,\nItemHTSCode,\nItemImportDomestic,\nItemKeyItem,\nItemKnockout,\nItemMaterialReferenceNeeded,\nItemMfgWarranty,\nItemNumber,\nItemPhoto,\nItemProductDepthIn,\nItemProductDepthMm,\nItemProductHeightIn,\nItemProductHeightMm,\nItemProductPageURL,\nItemProductWidthIn,\nItemProductWidthMm,\nItemRetailBrandName,\nItemRetailType,\nItemRollOverimage,\nItemSalesCategoryCode,\nItemScene7ImageSet,\nItemSeats,\nItemSeriesName,\nItemSeriesNumber,\nItemStandAloneFlag,\nItemStatus,\nItemStatusChanged,\nItemSupplierDirectShipOnly,\nItemSuppWeightNetWeightKg,\nItemSuppWeightNetWeightLbs,\nItemThirdPartyItem,\nItemTrackingPiece,\nItemTrademarkText,\nItemType,\nItemUnitWeightKg,\nItemUnitWeightLbs,\nItemUPC,\nItemValidationComplete,\nItemWholesaleAssemblyVideo1,\nItemAFIFeatureBullet1,\nItemAFIFeatureBullet2,\nItemAFIFeatureBullet3,\nItemAFIFeatureBullet4,\nItemAFIFeatureBullet5,\nItemAFIFeatureBullet6,\nItemAFIFeatureBullet7,\nItemConsumerDescription,\nItemFluffAFI,\nItemFluffPrint,\nItemFriendlyDescription,\nItemHomeStoreFeatureBullet1,\nItemHomeStoreFeatureBullet2,\nItemHomeStoreFeatureBullet3,\nItemHomeStoreFeatureBullet4,\nItemHomeStoreFeatureBullet5,\nItemHomeStoreFeatureBullet6,\nItemHomeStoreFeatureBullet7,\nItemHomeStoreFeatureBullet8,\nItemHomestoreItemFluff,\nTRIM(SeriesAshleyHomestore) as SeriesAshleyHomestore,\nSeriesCorporateOnlineSelling,\nSeriesDivision,\nSeriesExclusiveComment,\nSeriesFeatures,\nSeriesId,\nSeriesInternationalHomeStore,\nSeriesIntroDate,\nSeriesMainImage,\nSeriesName,\nSeriesNumber,\nSeriesRetailSalesCategory,\nSeriesShowroom,\nSeriesSourceId,\nSeriesStatus,\nSeriesStyle,\nSeriesThirdParty,\nSeriesPrimary,\nItemUomKey,\nItemShippableUomKey,\nItemEligibleforProtectionPlan,\nItemIsProtectionPlan,\nItemAshcommDeliveryMode,\nItemMaterial,\nItemHomeStoreProductLine,\nItemEcomMerchantNotes,\nItemAmazonBrandOwner,\nItemLifestyleDescription,\nactivity_type,\nactive_flag,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION\nfrom [Retail].[PIM_PRODUCT_VW]\n-- WHERE Status<>'Deleted' AND CAST(LastModifiedDateTimeUtc as --date)>='@{variables('Date')}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.PIM_PRODUCT_HIST",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"id"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SourceId",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SourceId",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SystemTimestamp",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SystemTimestamp",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "AlternateDescription2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "AlternateDescription2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIImageSet",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIImageSet",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAlternateDescription3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAlternateDescription3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemARVRReady",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemARVRReady",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemBoxQty",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemBoxQty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthIn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCartonDepthIn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthMm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCartonDepthMm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightIn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCartonHeightIn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightMm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCartonHeightMm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthIn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCartonWidthIn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthMm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCartonWidthMm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemClass",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemClass",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemColor",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemColor",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemColorSwatch",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemColorSwatch",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCommodity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCommodity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemComponentQuantity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemComponentQuantity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemConsumerAssembly",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConsumerAssembly",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCubesFt",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCubesFt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemCubesM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemCubesM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemDead",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemDead",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemDimensionSketch",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemDimensionSketch",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemEngineeringDivision",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemEngineeringDivision",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemExclusive",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemExclusive",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemExclusiveComment",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemExclusiveComment",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemExpressShip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemExpressShip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemFOBBasePrice",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemFOBBasePrice",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemForecastPlannerID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemForecastPlannerID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDimensions",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemFriendlyDimensions",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemFutureStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemFutureStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemGeneralDescriptionID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemGeneralDescriptionID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemGeneralLongDescription",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemGeneralLongDescription",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemGoogleTitle",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemGoogleTitle",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHTSCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHTSCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemImportDomestic",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemImportDomestic",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemKeyItem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemKeyItem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemKnockout",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemKnockout",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemMfgWarranty",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemMfgWarranty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemPhoto",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemPhoto",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthIn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemProductDepthIn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthMm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemProductDepthMm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightIn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemProductHeightIn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightMm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemProductHeightMm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemProductPageURL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemProductPageURL",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthIn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemProductWidthIn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthMm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemProductWidthMm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemRetailBrandName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemRetailBrandName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemRetailType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemRetailType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemRollOverimage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemRollOverimage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemSalesCategoryCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemSalesCategoryCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemScene7ImageSet",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemScene7ImageSet",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemSeats",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemSeats",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemSeriesName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemSeriesName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemSeriesNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemSeriesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemStandAloneFlag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemStandAloneFlag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemStatusChanged",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemStatusChanged",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemThirdPartyItem",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemThirdPartyItem",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemTrackingPiece",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemTrackingPiece",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemTrademarkText",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemTrademarkText",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightKg",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemUnitWeightKg",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightLbs",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemUnitWeightLbs",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemUPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemUPC",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemValidationComplete",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemValidationComplete",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemConsumerDescription",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConsumerDescription",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemFluffAFI",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemFluffAFI",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemFluffPrint",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemFluffPrint",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDescription",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemFriendlyDescription",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomestoreItemFluff",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomestoreItemFluff",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesAshleyHomestore",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesAshleyHomestore",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesDivision",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesDivision",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesExclusiveComment",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesExclusiveComment",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesFeatures",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesFeatures",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesId",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesId",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesInternationalHomeStore",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesInternationalHomeStore",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesIntroDate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesIntroDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesMainImage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesMainImage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesRetailSalesCategory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesRetailSalesCategory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesShowroom",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesShowroom",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesSourceId",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SeriesSourceId",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SeriesStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesStyle",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesStyle",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesThirdParty",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesThirdParty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SeriesPrimary",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SeriesPrimary",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemUomKey",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ItemUomKey",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "ItemShippableUomKey",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ItemShippableUomKey",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemIsProtectionPlan",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemIsProtectionPlan",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemMaterial",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemMaterial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreProductLine",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemHomeStoreProductLine",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemEcomMerchantNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemEcomMerchantNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemAmazonBrandOwner",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemAmazonBrandOwner",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemLifestyleDescription",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemLifestyleDescription",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_PIM_PRODUCT_HIST",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"Date": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:08Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductKit')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_Product')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductPackage')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductPackageCrosswalk')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_KitComponentCrosswalk')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductCode')]",
				"[concat(variables('factoryId'), '/datasets/DS_PIM_PRODUCT_HIST')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMasterLoad_Retail_PIM_EDW_SA_To_SA_Table')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_EDWProductKit",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_ProductPackage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select * FROM (\nSELECT \nKIT_ID,\nKIT_SOURCE_ID,\nKIT_STATUS,\nLAST_MOD_DATE_TIME_UTC,\nCREATED_DATE_TIME_UTC,\nSERIES_ID,\nSERIES_KEY,\nKIT_RETAIL_TYPE_KEY,\nKIT_STATUS_KEY,\nKIT_IMPORT_DOMESTIC_KEY,\nKIT_ENGINEER_DIVISION_KEY,\nKIT_CLASS_KEY,\nKIT_CODE_KEY,\nKIT_SALES_CATEG_CODE_KEY,\nKIT_DFLT_GROUP_CODE_KEY,\nKIT_FAMILYOF_BUSINESS_KEY,\nKIT_SERIES_RT_SL_CAT_KEY,\nKIT_NUMBER,\nKIT_SERIES_NUMBER,\nKIT_EXPRESS_SHIP,\nKIT_PRIMARY_LIFESTYLE,\nKIT_AX_KIT_NUMBER,\nKIT_STATUS_CHANGED,\nKIT_DEAD,\nKIT_BOX_QTY,\nKIT_SEATS,\nKIT_DINING_CHAIR_QTY_CTN,\nKIT_UPC,\nKIT_ARVR_READY,\nKIT_STAND_ALONE_FLAG,\nKIT_SUPPLIER_DT_SHIP_ONLY,\nKIT_DIMENSIONS_CONFIRMED,\nKIT_MFG_WARRANTY,\nKIT_FRIENDLY_DIMENSIONS,\nKIT_GEN_DESC_ID,\nKIT_GEN_LONG_DESC,\nKIT_FORECAST_PLANNER_ID,\nKIT_UOM_KEY,\nKIT_PRODUCT_DEPTH_IN,\nKIT_PRODUCT_DEPTH_MM,\nKIT_PRODUCT_HEIGHT_IN,\nKIT_PRODUCT_HEIGHT_MM,\nKIT_PRODUCT_WIDTH_IN,\nKIT_PRODUCT_WIDTH_MM,\nKIT_ADDITIONAL_DIMENSIONS,\nKIT_CARTON_DEPTH_IN,\nKIT_CARTON_DEPTH_MM,\nKIT_CARTON_HEIGHT_IN,\nKIT_CARTON_HEIGHT_MM,\nKIT_CARTON_WIDTH_IN,\nKIT_CARTON_WIDTH_MM,\nKIT_UNIT_WEIGHT_KG,\nKIT_UNIT_WEIGHT_LBS,\nKIT_SUPP_WT_NET_WT_LBS,\nKIT_SUPP_WT_NET_WT_KG,\nKIT_SELLLING_COUNTRIES,\nKIT_THIRD_PARTY_KIT,\nKIT_AFI_IMAGE_SET,\nKIT_SCENE7_IMAGE_SET,\nKIT_ROLL_OVER_IMAGE,\nKIT_KNOCKOUT,\nKIT_COLOR_SWATCH,\nKIT_PHOTO,\nKIT_GOOGLE_TITLE,\nKIT_PRODUCT_PAGE_URL,\nKIT_CUBES_FT,\nKIT_CUBES_M,\nKIT_FOB_BASE_PRICE,\nKIT_CONSUMER_ASSEMBLY,\nKIT_FUTURE_STATUS,\nKIT_KEY_KIT,\nKIT_TRACKING_PIECE,\nKIT_ALTER_DESC2,\nKIT_SHOWROOM_MKT_STATUS,\nKIT_TRADEMARK_TEXT,\nKIT_ALTERNATE_AFI_FLUFF1,\nKIT_VALIDATION_COMPLETE,\nKIT_ALTER_DESC3,\nKIT_EXCLUSIVE,\nKIT_EXCLUSIVE_COMMENT,\nKIT_COMMODITY,\nKIT_UPHOLSTERY_COVER,\nKIT_CARTON_VOLUME,\nKIT_CARTON_DENSITY,\nKIT_CARTON_FREIGHT_CLASS,\nKIT_SHIPPABLE_UOM_KEY,\nKIT_NOT_AVBL_INDIV_SALE,\nKIT_PURCHASE_TYPE,\nKIT_PARTS_DRAWINGS,\nKIT_HOMESTORE_PDT_LINE,\nKIT_RETAIL_ROOM_KEY,\nKIT_SHIPPING_DEPTH_IN,\nKIT_SHIPPING_DEPTH_MM,\nKIT_SHIPPING_HEIGHT_IN,\nKIT_SHIPPING_HEIGHT_MM,\nKIT_SHIPPING_WIDTH_IN,\nKIT_SHIPPING_WIDTH_MM,\nKIT_PK_LEG_SELLABLE_PKG,\nKIT_COND_HOME_DELIV_ELIG,\nKIT_ATP_SERIES,\nKIT_VENDOR_NAME,\nKIT_ASM_INSTR_INTERNAL,\nKIT_ASM_INSTR_PUBLIC,\nKIT_COMPONENT_QUANTITY,\nKIT_DIMENSION_SKETCH,\nKIT_HOMESTORE_ASM_VIDEO1,\nKIT_WHOLESALE_ASM_VIDEO1,\nKIT_AFI_FT_BULLET1_ENG,\nKIT_AFI_FT_BULLET2_ENG,\nKIT_AFI_FT_BULLET3_ENG,\nKIT_AFI_FT_BULLET4_ENG,\nKIT_AFI_FT_BULLET5_ENG,\nKIT_AFI_FT_BULLET6_ENG,\nKIT_AFI_FT_BULLET7_ENG,\nKIT_CONSUMER_DESC_ENG,\nKIT_FLUFF_AFI_ENGLISH,\nKIT_FLUFF_PRINT_ENGLISH,\nKIT_FRIENDLY_DESC_ENG,\nKIT_HS_FT_BULLET1_ENG,\nKIT_HS_FT_BULLET2_ENG,\nKIT_HS_FT_BULLET3_ENG,\nKIT_HS_FT_BULLET4_ENG,\nKIT_HS_FT_BULLET5_ENG,\nKIT_HS_FT_BULLET6_ENG,\nKIT_HS_FT_BULLET7_ENG,\nKIT_HS_FT_BULLET8_ENG,\nKIT_HS_KIT_FLUFF_ENG,\nKIT_ELIG_PROTECTION_PLAN,\nKIT_IS_PROTECTION_PLAN,\nKIT_ASHCOMM_DELIVERY_MODE,\nKIT_MATERIAL_ENGLISH,\nKIT_ECOM_MERCHANT_NOTES,\nKIT_AMAZON_BRAND_OWNER,\nKIT_RETAIL_BRAND_NAME_KEY,\nKIT_COLOR_KEY,\nKIT_TYPE,\nKIT_HTS_CODE,\nB_CREDATE,\nB_UPDDATE,\n'Semadmin' AS B_CREATOR,\n'Semadmin' AS B_UPDATOR,\nB_CLASSNAME,\n           ROW_NUMBER() OVER (PARTITION BY KIT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_PRODUCT_KIT WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SERIES_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_RETAIL_TYPE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STATUS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_IMPORT_DOMESTIC_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_ENGINEER_DIVISION_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_CLASS_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SALES_CATEG_CODE_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_DFLT_GROUP_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_FAMILYOF_BUSINESS_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_SERIES_RT_SL_CAT_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PRIMARY_LIFESTYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AX_KIT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SEATS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_DIMENSIONS_CONFIRMED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_GEN_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_GEN_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ADDITIONAL_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_UNIT_WEIGHT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_LBS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SUPP_WT_NET_WT_KG",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SELLLING_COUNTRIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_THIRD_PARTY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ROLL_OVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_KEY_KIT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SHOWROOM_MKT_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_UPHOLSTERY_COVER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_VOLUME",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_DENSITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_CARTON_FREIGHT_CLASS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_NOT_AVBL_INDIV_SALE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PURCHASE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PARTS_DRAWINGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_PDT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_RETAIL_ROOM_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										},
										"sink": {
											"name": "KIT_SHIPPING_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 20
										}
									},
									{
										"source": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_PK_LEG_SELLABLE_PKG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COND_HOME_DELIV_ELIG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ATP_SERIES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_VENDOR_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HOMESTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AFI_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_CONSUMER_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FLUFF_AFI_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FLUFF_PRINT_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_FRIENDLY_DESC_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET1_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET2_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET3_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET4_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET5_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET6_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET7_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_FT_BULLET8_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HS_KIT_FLUFF_ENG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ASHCOMM_DELIVERY_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_MATERIAL_ENGLISH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_RETAIL_BRAND_NAME_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "KIT_COLOR_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KIT_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_KIT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductKit",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_EDWProduct",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductKit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select * FROM (\nSELECT \nPRODUCT_MAIN_ID,\nSOURCE_ID,\nSTATUS,\nLAST_MOD_DATE_TIME_UTC,\nSYSTEM_TIMESTAMP,\nALTERNATE_DESCRIPTION2,\nITEM_AFI_IMAGE_SET,\nITEM_ALTERNATE_AFI_FLUFF1,\nITEM_ALTER_DESC3,\nITEM_ARVR_READY,\nITEM_ASM_INSTR_INTERNAL,\nITEM_ASM_INSTR_PUBLIC,\nITEM_BOX_QTY,\nITEM_CARTON_DEPTH_IN,\nITEM_CARTON_DEPTH_MM,\nITEM_CARTON_HEIGHT_IN,\nITEM_CARTON_HEIGHT_MM,\nITEM_CARTON_WIDTH_IN,\nITEM_CARTON_WIDTH_MM,\nITEM_CLASS,\nITEM_CODE,\nITEM_COLOR,\nITEM_COLOR_SWATCH,\nITEM_COMMODITY,\nITEM_COMPONENT_QUANTITY,\nITEM_CONSUMER_ASSEMBLY,\nITEM_CUBES_FT,\nITEM_CUBES_M,\nITEM_DEAD,\t\t\t\t\t\nITEM_DIMENSION_SKETCH,\nITEM_DINING_CHAIR_QTY_CTN,\nITEM_ENGINEERING_DIVISION,\nITEM_EXCLUSIVE,\nITEM_EXCLUSIVE_COMMENT,\nITEM_EXPRESS_SHIP,\nITEM_FOB_BASE_PRICE,\nITEM_FORECAST_PLANNER_ID,\nITEM_FRIENDLY_DIMENSIONS,\nITEM_FUTURE_STATUS,\nITEM_GNRL_DESC_ID,\nITEM_GNRL_LONG_DESC,\nITEM_GOOGLE_TITLE,\nITEM_HOMSTORE_ASM_VIDEO1,\nITEM_IMPORT_DOMESTIC,\nITEM_KEY_ITEM,\nITEM_KNOCKOUT,\nITEM_MTERIAL_REF_NEEDED,\nITEM_MFG_WARRANTY,\nITEM_NUMBER,\nITEM_PHOTO,\nITEM_PRODUCT_DEPTH_IN,\nITEM_PRODUCT_DEPTH_MM,\nITEM_PRODUCT_HEIGHT_IN,\nITEM_PRODUCT_HEIGHT_MM,\nITEM_PRODUCT_PAGE_URL,\nITEM_PRODUCT_WIDTH_IN,\nITEM_PRODUCT_WIDTH_MM,\nITEM_RETAIL_BRAND_NAME,\nITEM_RETAIL_TYPE,\nITEM_ROLL_OVERIMAGE,\nITEM_SALES_CATEGORY_CODE,\nITEM_SCENE7_IMAGE_SET,\nITEM_SEATS,\nITEM_SERIES_NAME,\nITEM_SERIES_NUMBER,\nITEM_STAND_ALONE_FLAG,\nITEM_STATUS,\nITEM_STATUS_CHANGED,\nITEM_SUPP_DT_SHIP_ONLY,\nITEM_SUPP_WET_NET_WET_KG,\nITEM_SUPP_WET_NET_WET_LBS,\nITEM_THIRD_PARTY_ITEM,\nITEM_TRACKING_PIECE,\nITEM_TRADEMARK_TEXT,\nITEM_TYPE,\nITEM_UNIT_WEIGHT_KG,\nITEM_UNIT_WEIGHT_LBS,\nITEM_UPC,\nITEM_VALIDATION_COMPLETE,\nITEM_WHOLESALE_ASM_VIDEO1,\nITEM_AFI_FEATURE_BULLET1,\nITEM_AFI_FEATURE_BULLET2,\nITEM_AFI_FEATURE_BULLET3,\nITEM_AFI_FEATURE_BULLET4,\nITEM_AFI_FEATURE_BULLET5,\nITEM_AFI_FEATURE_BULLET6,\nITEM_AFI_FEATURE_BULLET7,\nITEM_CONSUMER_DESCRIPTION,\nITEM_FLUFF_AFI,\nITEM_FLUFF_PRINT,\nITEM_FRIENDLY_DESCRIPTION,\nITEM_HOMESTORE_FT_BULLET1,\nITEM_HOMESTORE_FT_BULLET2,\nITEM_HOMESTORE_FT_BULLET3,\nITEM_HOMESTORE_FT_BULLET4,\nITEM_HOMESTORE_FT_BULLET5,\nITEM_HOMESTORE_FT_BULLET6,\nITEM_HOMESTORE_FT_BULLET7,\nITEM_HOMESTORE_FT_BULLET8,\nITEM_HOMESTORE_ITEM_FLUFF,\nSERIES_ASHLEY_HOMESTORE,\nSERIES_CORP_ONLINE_SELLNG,\nSERIES_DIVISION,\nSERIES_EXCLUSIVE_COMMENT,\nSERIES_FEATURES,\nSERIES_ID,\nSERIES_INTERNATIONAL_HS,\nSERIES_INTRO_DATE,\nSERIES_MAIN_IMAGE,\nSERIES_NAME,\nSERIES_NUMBER,\nSERIES_RETAIL_SALES_CATEG,\nSERIES_SHOWROOM,\nSERIES_SOURCE_ID,\nSERIES_STATUS,\nSERIES_STYLE,\nSERIES_THIRD_PARTY,\nSERIES_PRIMARY,\nITEM_UOM_KEY,\nITEM_SHIPPABLE_UOM_KEY,\nITEM_ELIG_PROTECTION_PLAN,\nITEM_IS_PROTECTION_PLAN,\nITEM_ASHCOMM_DLVR_MODE,\nITEM_MATERIAL,\nITEM_HS_PRODUCT_LINE,\nITEM_ECOM_MERCHANT_NOTES,\nITEM_AMAZON_BRAND_OWNER,\nITEM_LIFESTYLE_DESC,\nITEM_HTS_CODE,\nB_UPDDATE,\nB_CREDATE,\n'Semadmin' AS B_CREATOR,\n'Semadmin' AS B_UPDATOR,\nB_CLASSNAME,\n           ROW_NUMBER() OVER (PARTITION BY PRODUCT_MAIN_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_PRODUCT_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_ProductPackage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select * FROM (\nSELECT \nPACKAGE_ID,\nPACKAGE_KEY,\nHOMESTORE_PACKAGE_ID,\nLAST_MOD_DATE_TIME_UTC,\nCREATED_DATE_TIME_UTC,\nPACKAGE_NUMBER,\nPACKAGE_ALTER_NAME,\nPACKAGE_HERO,\nPACKAGE_STATUS,\nPACKAGE_STATUS_CHANGED,\nPACKAGE_IS_THIRD_PARTY,\nPACKAGE_HOMESTORE_ID,\nPACKAGE_WHOLESALE_ID,\nPACKAGE_RETAIL_TYPE,\nPACKAGE_ITEM_QUANTITY,\nPACKAGE_UOM,\nPACKAGE_COLOR,\nPACKAGE_KNOCKOUT,\nPACKAGE_SCENE7_IMAGE_SET,\nPACKAGE_VALIDAT_COMPLETE,\nPACKAGE_VALIDATION_NOTES,\nPACKAGE_ROLLOVER_IMAGE,\nPACKAGE_EXPRESS_SHIP,\nPACKAGE_SUPP_DT_SHIP_ONLY,\nPACKAGE_SALES_CATEG_CODE,\nPACKAGE_SERIES_NUMBER,\nPACKAGE_SERIES_NAME,\nPACKAGE_CODE,\nPACKAGE_ASHCOM_TRANSITION,\nPACKAGE_SWATCH_GROUP_ID,\nPACKAGE_DEFAULT_PRODUCT,\nPACKAGE_NEW_FLAG_DATE,\nPACKAGE_ASHCOMM_DLVR_MODE,\nPACKAGE_CHANNEL_CHANGE,\nPACKAGE_EXCLUSIVE,\nPACKAGE_HOT_SPOTS_REVIEW,\nPACKAGE_ALT_DESC1,\nPACKAGE_ASH_TTL_OVERRIDE,\nPACKAGE_HIDDEN_FIELD,\nPACKAGE_CONSUMER_CHOICE,\nPACKAGE_TOTAL_ASM_TIME,\nPACKAGE_ASHCOMM_FLAGS,\nPACKAGE_NAVIGABLE_CATEG,\nPACKAGE_NAME,\nPACKAGE_HS_PACKAGE_FLUFF,\nPACKAGE_AFI_BULLETS1,\nPACKAGE_AFI_BULLETS2,\nPACKAGE_AFI_BULLETS3,\nPACKAGE_AFI_BULLETS4,\nPACKAGE_AFI_BULLETS5,\nPACKAGE_AFI_BULLETS6,\nPACKAGE_HOMESTORE_BULLET1,\nPACKAGE_HOMESTORE_BULLET2,\nPACKAGE_HOMESTORE_BULLET3,\nPACKAGE_HOMESTORE_BULLET4,\nPACKAGE_HOMESTORE_BULLET5,\nPACKAGE_HOMESTORE_BULLET6,\nPACKAGE_AFI_FLUFF,\nB_CREDATE,\nB_UPDDATE,\n'Semadmin' AS B_CREATOR,\n'Semadmin' AS B_UPDATOR,\nB_CLASSNAME,\n           ROW_NUMBER() OVER (PARTITION BY PACKAGE_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_PRODUCT_PACKAGE WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_PACKAGE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_KitComponentCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load_Retail_PIM_EDWProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProduct",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\r\n'semadmin' AS B_CREATOR,\r\n'ProductPackageCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_PKG_CROSSWALK_ID,\r\nPRODUCT_SOURCE_ID,\r\nPRODUCT_TYPE,\r\nPACKAGE_SOURCE_ID,\r\nF_PRODUCT_ID,\r\nF_PACKAGE_ID,\r\nB_CREDATE,\r\nB_UPDDATE\r\nFROM SA_PRODUCT_PACKAGE_CROSSWALK",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_PKG_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "PACKAGE_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PRODUCT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_PACKAGE_CROSSWALK",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "New_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'semadmin' AS B_CREATOR,\r\n'ProductKitCrosswalk' AS B_CLASSNAME,\r\nNEWID() AS PRODUCT_KIT_CROSSWALK_ID,\r\nPRODUCT_SOURCE_ID,\r\nPRODUCT_TYPE,\r\nKIT_SOURCE_ID,\r\nF_PRODUCT_MAIN_ID,\r\nF_KIT_ID,\r\nB_CREDATE,\r\nB_UPDDATE\r\nFROM SA_PRODUCT_KIT_CROSSWALK\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "New_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "PRODUCT_KIT_CROSSWALK_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "PRODUCT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRODUCT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "KIT_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "F_KIT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Old_SA_PRODUCT_KIT_CROSSWALK",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Old_SA_PRODUCT_KIT')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductKit')]",
				"[concat(variables('factoryId'), '/datasets/Old_SA_PRODUCT_MAIN')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_Product')]",
				"[concat(variables('factoryId'), '/datasets/Old_SA_PRODUCT_PACKAGE')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductPackage')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Old_SA_PRODUCT_PACKAGE_CROSSWALK')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductPackageCrosswalk')]",
				"[concat(variables('factoryId'), '/datasets/Old_SA_PRODUCT_KIT_CROSSWALK')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_KitComponentCrosswalk')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMaster_Retail_PIM_RPM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_Product_GD",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetDateVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select B_CREATOR,B_CLASSNAME,PRODUCT_MAIN_ID,SOURCE_ID,STATUS,LAST_MOD_DATE_TIME_UTC,SYSTEM_TIMESTAMP,ALTERNATE_DESCRIPTION2,ITEM_AFI_IMAGE_SET,ITEM_ALTERNATE_AFI_FLUFF1,ITEM_ALTER_DESC3,ITEM_ARVR_READY,ITEM_ASM_INSTR_INTERNAL,ITEM_ASM_INSTR_PUBLIC,ITEM_BOX_QTY,ITEM_CARTON_DEPTH_IN,ITEM_CARTON_DEPTH_MM,ITEM_CARTON_HEIGHT_IN,ITEM_CARTON_HEIGHT_MM,ITEM_CARTON_WIDTH_IN,ITEM_CARTON_WIDTH_MM,ITEM_CLASS,ITEM_CODE,ITEM_COLOR,ITEM_COLOR_SWATCH,ITEM_COMMODITY,ITEM_COMPONENT_QUANTITY,ITEM_CONSUMER_ASSEMBLY,ITEM_CUBES_FT,ITEM_CUBES_M,ITEM_DEAD,ITEM_DIMENSION_SKETCH,ITEM_DINING_CHAIR_QTY_CTN,ITEM_ENGINEERING_DIVISION,ITEM_EXCLUSIVE,ITEM_EXCLUSIVE_COMMENT,ITEM_EXPRESS_SHIP,ITEM_FOB_BASE_PRICE,ITEM_FORECAST_PLANNER_ID,ITEM_FRIENDLY_DIMENSIONS,ITEM_FUTURE_STATUS,ITEM_GNRL_DESC_ID,ITEM_GNRL_LONG_DESC,ITEM_GOOGLE_TITLE,ITEM_HOMSTORE_ASM_VIDEO1,ITEM_HTS_CODE,ITEM_IMPORT_DOMESTIC,ITEM_KEY_ITEM,ITEM_KNOCKOUT,ITEM_MTERIAL_REF_NEEDED,ITEM_MFG_WARRANTY,ITEM_NUMBER,ITEM_PHOTO,ITEM_PRODUCT_DEPTH_IN,ITEM_PRODUCT_DEPTH_MM,ITEM_PRODUCT_HEIGHT_IN,ITEM_PRODUCT_HEIGHT_MM,ITEM_PRODUCT_PAGE_URL,ITEM_PRODUCT_WIDTH_IN,ITEM_PRODUCT_WIDTH_MM,ITEM_RETAIL_BRAND_NAME,ITEM_RETAIL_TYPE,ITEM_ROLL_OVERIMAGE,ITEM_SALES_CATEGORY_CODE,ITEM_SCENE7_IMAGE_SET,ITEM_SEATS,ITEM_SERIES_NAME,ITEM_SERIES_NUMBER,ITEM_STAND_ALONE_FLAG,ITEM_STATUS,ITEM_STATUS_CHANGED,ITEM_SUPP_DT_SHIP_ONLY,ITEM_SUPP_WET_NET_WET_KG,ITEM_SUPP_WET_NET_WET_LBS,ITEM_THIRD_PARTY_ITEM,ITEM_TRACKING_PIECE,ITEM_TRADEMARK_TEXT,ITEM_TYPE,ITEM_UNIT_WEIGHT_KG,ITEM_UNIT_WEIGHT_LBS,ITEM_UPC,ITEM_VALIDATION_COMPLETE,ITEM_WHOLESALE_ASM_VIDEO1,ITEM_AFI_FEATURE_BULLET1,ITEM_AFI_FEATURE_BULLET2,ITEM_AFI_FEATURE_BULLET3,ITEM_AFI_FEATURE_BULLET4,ITEM_AFI_FEATURE_BULLET5,ITEM_AFI_FEATURE_BULLET6,ITEM_AFI_FEATURE_BULLET7,ITEM_CONSUMER_DESCRIPTION,ITEM_FLUFF_AFI,ITEM_FLUFF_PRINT,ITEM_FRIENDLY_DESCRIPTION,ITEM_HOMESTORE_FT_BULLET1,ITEM_HOMESTORE_FT_BULLET2,ITEM_HOMESTORE_FT_BULLET3,ITEM_HOMESTORE_FT_BULLET4,ITEM_HOMESTORE_FT_BULLET5,ITEM_HOMESTORE_FT_BULLET6,ITEM_HOMESTORE_FT_BULLET7,ITEM_HOMESTORE_FT_BULLET8,ITEM_HOMESTORE_ITEM_FLUFF,SERIES_ASHLEY_HOMESTORE,SERIES_CORP_ONLINE_SELLNG,SERIES_DIVISION,SERIES_EXCLUSIVE_COMMENT,SERIES_FEATURES,SERIES_ID,SERIES_INTERNATIONAL_HS,SERIES_INTRO_DATE,SERIES_MAIN_IMAGE,SERIES_NAME,SERIES_NUMBER,SERIES_RETAIL_SALES_CATEG,SERIES_SHOWROOM,SERIES_SOURCE_ID,SERIES_STATUS,SERIES_STYLE,SERIES_THIRD_PARTY,SERIES_PRIMARY,ITEM_UOM_KEY,ITEM_SHIPPABLE_UOM_KEY,ITEM_ELIG_PROTECTION_PLAN,ITEM_IS_PROTECTION_PLAN,ITEM_ASHCOMM_DLVR_MODE,ITEM_MATERIAL,ITEM_HS_PRODUCT_LINE,ITEM_ECOM_MERCHANT_NOTES,ITEM_AMAZON_BRAND_OWNER,ITEM_LIFESTYLE_DESC,B_DELETETYPE,\nB_DELETEDATE,B_DELETEAUTHOR,B_DELETEOPERATION\nfrom Retail.PIM_PRODUCT_VW_GD",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"PRODUCT_MAIN_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Package_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadIDGX')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SetDateVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "SystemTimestamp",
							"value": {
								"value": "@formatDateTime(utcnow(), 'yyyy-MM-dd HH:mm:ss')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SP_ProductMain_Archive",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Package_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[ArchiveProductTableData]",
							"storedProcedureParameters": {
								"InputDate": {
									"value": {
										"value": "@variables('SystemTimestamp')",
										"type": "Expression"
									},
									"type": "Datetime"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load_Retail_PIM_EDWProduct_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadIDGX')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select B_CREATOR,B_CLASSNAME,PRODUCT_MAIN_ID,SOURCE_ID,STATUS,LAST_MOD_DATE_TIME_UTC,SYSTEM_TIMESTAMP,ALTERNATE_DESCRIPTION2,ITEM_AFI_IMAGE_SET,ITEM_ALTERNATE_AFI_FLUFF1,ITEM_ALTER_DESC3,ITEM_ARVR_READY,ITEM_ASM_INSTR_INTERNAL,ITEM_ASM_INSTR_PUBLIC,ITEM_BOX_QTY,ITEM_CARTON_DEPTH_IN,ITEM_CARTON_DEPTH_MM,ITEM_CARTON_HEIGHT_IN,ITEM_CARTON_HEIGHT_MM,ITEM_CARTON_WIDTH_IN,ITEM_CARTON_WIDTH_MM,ITEM_CLASS,ITEM_CODE,ITEM_COLOR,ITEM_COLOR_SWATCH,ITEM_COMMODITY,ITEM_COMPONENT_QUANTITY,ITEM_CONSUMER_ASSEMBLY,ITEM_CUBES_FT,ITEM_CUBES_M,ITEM_DEAD,ITEM_DIMENSION_SKETCH,ITEM_DINING_CHAIR_QTY_CTN,ITEM_ENGINEERING_DIVISION,ITEM_EXCLUSIVE,ITEM_EXCLUSIVE_COMMENT,ITEM_EXPRESS_SHIP,ITEM_FOB_BASE_PRICE,ITEM_FORECAST_PLANNER_ID,ITEM_FRIENDLY_DIMENSIONS,ITEM_FUTURE_STATUS,ITEM_GNRL_DESC_ID,ITEM_GNRL_LONG_DESC,ITEM_GOOGLE_TITLE,ITEM_HOMSTORE_ASM_VIDEO1,ITEM_HTS_CODE,ITEM_IMPORT_DOMESTIC,ITEM_KEY_ITEM,ITEM_KNOCKOUT,ITEM_MTERIAL_REF_NEEDED,ITEM_MFG_WARRANTY,ITEM_NUMBER,ITEM_PHOTO,ITEM_PRODUCT_DEPTH_IN,ITEM_PRODUCT_DEPTH_MM,ITEM_PRODUCT_HEIGHT_IN,ITEM_PRODUCT_HEIGHT_MM,ITEM_PRODUCT_PAGE_URL,ITEM_PRODUCT_WIDTH_IN,ITEM_PRODUCT_WIDTH_MM,ITEM_RETAIL_BRAND_NAME,ITEM_RETAIL_TYPE,ITEM_ROLL_OVERIMAGE,ITEM_SALES_CATEGORY_CODE,ITEM_SCENE7_IMAGE_SET,ITEM_SEATS,ITEM_SERIES_NAME,ITEM_SERIES_NUMBER,ITEM_STAND_ALONE_FLAG,ITEM_STATUS,ITEM_STATUS_CHANGED,ITEM_SUPP_DT_SHIP_ONLY,ITEM_SUPP_WET_NET_WET_KG,ITEM_SUPP_WET_NET_WET_LBS,ITEM_THIRD_PARTY_ITEM,ITEM_TRACKING_PIECE,ITEM_TRADEMARK_TEXT,ITEM_TYPE,ITEM_UNIT_WEIGHT_KG,ITEM_UNIT_WEIGHT_LBS,ITEM_UPC,ITEM_VALIDATION_COMPLETE,ITEM_WHOLESALE_ASM_VIDEO1,ITEM_AFI_FEATURE_BULLET1,ITEM_AFI_FEATURE_BULLET2,ITEM_AFI_FEATURE_BULLET3,ITEM_AFI_FEATURE_BULLET4,ITEM_AFI_FEATURE_BULLET5,ITEM_AFI_FEATURE_BULLET6,ITEM_AFI_FEATURE_BULLET7,ITEM_CONSUMER_DESCRIPTION,ITEM_FLUFF_AFI,ITEM_FLUFF_PRINT,ITEM_FRIENDLY_DESCRIPTION,ITEM_HOMESTORE_FT_BULLET1,ITEM_HOMESTORE_FT_BULLET2,ITEM_HOMESTORE_FT_BULLET3,ITEM_HOMESTORE_FT_BULLET4,ITEM_HOMESTORE_FT_BULLET5,ITEM_HOMESTORE_FT_BULLET6,ITEM_HOMESTORE_FT_BULLET7,ITEM_HOMESTORE_FT_BULLET8,ITEM_HOMESTORE_ITEM_FLUFF,SERIES_ASHLEY_HOMESTORE,SERIES_CORP_ONLINE_SELLNG,SERIES_DIVISION,SERIES_EXCLUSIVE_COMMENT,SERIES_FEATURES,SERIES_ID,SERIES_INTERNATIONAL_HS,SERIES_INTRO_DATE,SERIES_MAIN_IMAGE,SERIES_NAME,SERIES_NUMBER,SERIES_RETAIL_SALES_CATEG,SERIES_SHOWROOM,SERIES_SOURCE_ID,SERIES_STATUS,SERIES_STYLE,SERIES_THIRD_PARTY,SERIES_PRIMARY,ITEM_UOM_KEY,ITEM_SHIPPABLE_UOM_KEY,ITEM_ELIG_PROTECTION_PLAN,ITEM_IS_PROTECTION_PLAN,ITEM_ASHCOMM_DLVR_MODE,ITEM_MATERIAL,ITEM_HS_PRODUCT_LINE,ITEM_ECOM_MERCHANT_NOTES,ITEM_AMAZON_BRAND_OWNER,ITEM_LIFESTYLE_DESC,B_DELETETYPE,\nB_DELETEDATE,B_DELETEAUTHOR,B_DELETEOPERATION\nfrom Retail.PIM_PRODUCT_VW_GX",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"PRODUCT_MAIN_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_MAIN_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SYSTEM_TIMESTAMP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ALTERNATE_DESCRIPTION2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTERNATE_AFI_FLUFF1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ALTER_DESC3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ARVR_READY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_INTERNAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASM_INSTR_PUBLIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_BOX_QTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_BOX_QTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CARTON_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CLASS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COLOR_SWATCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMMODITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_COMPONENT_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_ASSEMBLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_FT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_FT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_CUBES_M",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CUBES_M",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DIMENSION_SKETCH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_DINING_CHAIR_QTY_CTN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ENGINEERING_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FOB_BASE_PRICE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FORECAST_PLANNER_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DIMENSIONS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FUTURE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_DESC_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GNRL_LONG_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_GOOGLE_TITLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMSTORE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IMPORT_DOMESTIC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KEY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MTERIAL_REF_NEEDED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MFG_WARRANTY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PHOTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_DEPTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_HEIGHT_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_PAGE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_IN",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_PRODUCT_WIDTH_MM",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 21
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_BRAND_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ROLL_OVERIMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SEATS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STAND_ALONE_FLAG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_SUPP_WET_NET_WET_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_THIRD_PARTY_ITEM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRACKING_PIECE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TRADEMARK_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_KG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UNIT_WEIGHT_LBS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_UPC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_WHOLESALE_ASM_VIDEO1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AFI_FEATURE_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_CONSUMER_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_AFI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FLUFF_PRINT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_FRIENDLY_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET7",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_FT_BULLET8",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HOMESTORE_ITEM_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ASHLEY_HOMESTORE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_CORP_ONLINE_SELLNG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_DIVISION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_EXCLUSIVE_COMMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_FEATURES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTERNATIONAL_HS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_INTRO_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_INTRO_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_MAIN_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_RETAIL_SALES_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_SHOWROOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_STYLE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SERIES_PRIMARY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ITEM_SHIPPABLE_UOM_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ELIG_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_IS_PROTECTION_PLAN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_MATERIAL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HS_PRODUCT_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_ECOM_MERCHANT_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_AMAZON_BRAND_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_LIFESTYLE_DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ITEM_HTS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERIES_SOURCE_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SERIES_SOURCE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId_GX",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SubmitLoadIDGD",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_ProductMaster'\n,@P_PROGRAM_NAME = 'ProductMasterLoad'\n,@P_LOAD_DESCRIPTION = 'ProductMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId_GX",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadIDGX",
							"value": {
								"value": "@{activity('GetNewLoadId_GX').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadIDGD",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_ProductCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ProductMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load_Retail_PIM_Package_GD",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Product_GD",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select B_CREATOR,B_CLASSNAME,PACKAGE_ID,PACKAGE_KEY,HOMESTORE_PACKAGE_ID,LAST_MOD_DATE_TIME_UTC,PackageStatusChanged,PACKAGE_NUMBER,PACKAGE_ALT_PACKAGE_NAME,PACKAGE_HERO,PACKAGE_STATUS,PACKAGE_STATUS_CHANGED,PACKAGE_IS_THIRD_PARTY,PACKAGE_HOMESTORE_PACKAGE_ID,PACKAGE_WHOLESALE_ID,PACKAGE_RETAIL_TYPE,PACKAGE_ITEM_QUANTITY,PACKAGE_UOM,PACKAGE_COLOR,PACKAGE_KNOCKOUT,PACKAGE_SCENE7_IMAGE_SET,PACKAGE_VALIDATION_COMPLETE,PACKAGE_VALIDATION_NOTES,PACKAGE_ROLLOVER_IMAGE,PACKAGE_EXPRESS_SHIP,PACKAGE_SUPP_DIRECT_SHIP_ONLY,PACKAGE_SALES_CATEGORY_CODE,PACKAGE_SERIES_NUMBER,PACKAGE_SERIES_NAME,PACKAGE_CODE,PACKAGE_ASHCOMM_TRANSITION,PACKAGE_SWATCH_GROUP_ID,PACKAGE_DEFAULT_PRODUCT,PACKAGE_NEW_FLAG_DATE,PACKAGE_ASHCOMM_DLVR_MODE,PACKAGE_CHANNEL_CHANGE,PACKAGE_EXCLUSIVE,PACKAGE_HOTSPOTS_NEED_REVIEW,PACKAGE_ALT_DESC1,PACKAGE_ASHCOMM_TITLE_OVERRIDE,PACKAGE_HIDDEN_FIELD,PACKAGE_CONSUMER_CHOICE,PACKAGE_TOTAL_ASSEMBLY_TIME,PACKAGE_ASHCOMM_FLAGS,PACKAGE_NAVIGABLE_CATEGORIES,PACKAGE_NAME,PACKAGE_AFI_FLUFF,PACKAGE_HOMESTORE_PACKAGE_FLUFF,PACKAGE_AFI_BULLET1,PACKAGE_AFI_BULLET2,PACKAGE_AFI_BULLET3,PACKAGE_AFI_BULLET4,PACKAGE_AFI_BULLET5,PACKAGE_AFI_BULLET6,PACKAGE_HOMESTORE_BULLET1,PACKAGE_HOMESTORE_BULLET2,PACKAGE_HOMESTORE_BULLET3,PACKAGE_HOMESTORE_BULLET4,PACKAGE_HOMESTORE_BULLET5,PACKAGE_HOMESTORE_BULLET6,CREATED_DATE_TIME_UTC,\nB_DELETETYPE,B_DELETEDATE,B_DELETEAUTHOR,B_DELETEOPERATION\nfrom [Retail].[PIM_PACKAGE_VW_GD] ",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DIRECT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_TRANSITION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOTSPOTS_NEED_REVIEW",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_TITLE_OVERRIDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASSEMBLY_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEGORIES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_Package_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDWProduct_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadIDGX')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "Select B_CREATOR,B_CLASSNAME,PACKAGE_ID,PACKAGE_KEY,HOMESTORE_PACKAGE_ID,LAST_MOD_DATE_TIME_UTC,PackageStatusChanged,PACKAGE_NUMBER,PACKAGE_ALT_PACKAGE_NAME,PACKAGE_HERO,PACKAGE_STATUS,PACKAGE_STATUS_CHANGED,PACKAGE_IS_THIRD_PARTY,PACKAGE_HOMESTORE_PACKAGE_ID,PACKAGE_WHOLESALE_ID,PACKAGE_RETAIL_TYPE,PACKAGE_ITEM_QUANTITY,PACKAGE_UOM,PACKAGE_COLOR,PACKAGE_KNOCKOUT,PACKAGE_SCENE7_IMAGE_SET,PACKAGE_VALIDATION_COMPLETE,PACKAGE_VALIDATION_NOTES,PACKAGE_ROLLOVER_IMAGE,PACKAGE_EXPRESS_SHIP,PACKAGE_SUPP_DIRECT_SHIP_ONLY,PACKAGE_SALES_CATEGORY_CODE,PACKAGE_SERIES_NUMBER,PACKAGE_SERIES_NAME,PACKAGE_CODE,PACKAGE_ASHCOMM_TRANSITION,PACKAGE_SWATCH_GROUP_ID,PACKAGE_DEFAULT_PRODUCT,PACKAGE_NEW_FLAG_DATE,PACKAGE_ASHCOMM_DLVR_MODE,PACKAGE_CHANNEL_CHANGE,PACKAGE_EXCLUSIVE,PACKAGE_HOTSPOTS_NEED_REVIEW,PACKAGE_ALT_DESC1,PACKAGE_ASHCOMM_TITLE_OVERRIDE,PACKAGE_HIDDEN_FIELD,PACKAGE_CONSUMER_CHOICE,PACKAGE_TOTAL_ASSEMBLY_TIME,PACKAGE_ASHCOMM_FLAGS,PACKAGE_NAVIGABLE_CATEGORIES,PACKAGE_NAME,PACKAGE_AFI_FLUFF,PACKAGE_HOMESTORE_PACKAGE_FLUFF,PACKAGE_AFI_BULLET1,PACKAGE_AFI_BULLET2,PACKAGE_AFI_BULLET3,PACKAGE_AFI_BULLET4,PACKAGE_AFI_BULLET5,PACKAGE_AFI_BULLET6,PACKAGE_HOMESTORE_BULLET1,PACKAGE_HOMESTORE_BULLET2,PACKAGE_HOMESTORE_BULLET3,PACKAGE_HOMESTORE_BULLET4,PACKAGE_HOMESTORE_BULLET5,PACKAGE_HOMESTORE_BULLET6,CREATED_DATE_TIME_UTC,\nB_DELETETYPE,B_DELETEDATE,B_DELETEAUTHOR,B_DELETEOPERATION\nfrom [Retail].[PIM_PACKAGE_VW_GX] ",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PACKAGE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "LAST_MOD_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_UTC",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HERO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_STATUS_CHANGED",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_IS_THIRD_PARTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_PACKAGE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_WHOLESALE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_RETAIL_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ITEM_QUANTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_UOM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_COLOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_KNOCKOUT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_SCENE7_IMAGE_SET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_COMPLETE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_VALIDAT_COMPLETE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_VALIDATION_NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ROLLOVER_IMAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXPRESS_SHIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SUPP_DIRECT_SHIP_ONLY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SALES_CATEGORY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SALES_CATEG_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SERIES_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_TRANSITION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOM_TRANSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_SWATCH_GROUP_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_DEFAULT_PRODUCT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "PACKAGE_NEW_FLAG_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_DLVR_MODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CHANNEL_CHANGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_EXCLUSIVE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOTSPOTS_NEED_REVIEW",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_HOT_SPOTS_REVIEW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ALT_DESC1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_TITLE_OVERRIDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASH_TTL_OVERRIDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HIDDEN_FIELD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PACKAGE_CONSUMER_CHOICE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_TOTAL_ASSEMBLY_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_TOTAL_ASM_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_ASHCOMM_FLAGS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAVIGABLE_CATEGORIES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAVIGABLE_CATEG",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HS_PACKAGE_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_BULLETS6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PACKAGE_HOMESTORE_BULLET6",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PACKAGE_AFI_FLUFF",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductPackage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Load_Retail_PIM_ProductCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Stage_EDW_ProductCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'semadmin' AS B_CREATOR,\n'ProductCode' AS B_CLASSNAME,\nSYSUTCDATETIME() as LAST_MODIFIED_DATE,\nProductCodeKey AS PRODUCT_CODE_KEY,\nProductCode AS PRODUCT_CODE,\ncast(IsActive as bit) AS IS_ACTIVE\nFROM [Retail].[EDWProductCode]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"PRODUCT_CODE_KEY"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "PRODUCT_CODE_KEY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PRODUCT_CODE_KEY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_MODIFIED_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRODUCT_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRODUCT_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IS_ACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "IS_ACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_ProductMaster_EDW_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Stage_EDW_ProductCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_Package_GD",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "B_update",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select ProductCodeKey,ProductCode,SYSUTCDATETIME() as Last_modified_date from EDME_Datafactory.ProductCode",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ProductCodeKey"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"SystemTimestamp": {
						"type": "String"
					},
					"LoadIDGX": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_Product')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductPackage')]",
				"[concat(variables('factoryId'), '/datasets/Retail_ProductMaster_EDW_ProductCode')]",
				"[concat(variables('factoryId'), '/datasets/EDW_PIM_ProductCode')]",
				"[concat(variables('factoryId'), '/datasets/EDW_ProductCode')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Remove_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Enterprise_ReferenceMaster'\n,@P_PROGRAM_NAME = 'EnterpriseRefPostalCodeLoad'\n,@P_LOAD_DESCRIPTION = 'EnterpriseRefPostalCodeLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_POSTAL_CODE_REMOVE_RECORDS]",
							"storedProcedureParameters": {
								"COUNTRY": {
									"value": {
										"value": "US",
										"type": "Expression"
									},
									"type": "String"
								},
								"LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Enterprise_ReferenceMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "EnterpriseRefPostalCodeLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_POSTAL_CODE_REMOVE_RECORDS]",
							"storedProcedureParameters": {
								"COUNTRY": {
									"value": {
										"value": "CA",
										"type": "Expression"
									},
									"type": "String"
								},
								"LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Enterprise_ReferenceMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_US_RemovePostalCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CA_RemovePostalCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "US_RemovePostalCode_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_US_POSTAL_CODE_REMOVE_RECORDS",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('usp_US_POSTAL_CODE_REMOVE_RECORDS').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_POSTAL_CODE_MASTER",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CA_RemovePostalCode_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('usp_CA_POSTAL_CODE_REMOVE_RECORDS_copy1').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_POSTAL_CODE_MASTER",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "''",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2023-09-12T06:29:29Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/Enterprise_ReferenceMaster')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_CommunicationPreferencePhoneLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as Count FROM [RetailCustomer].[IncrementalLoadCommPrefEmail] WITH(NOLOCK)\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) as Count FROM [RetailCustomer].[IncrementalLoadCommPrefPhone] WITH(NOLOCK)\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(greater(activity('Masterdata_CDP_InitialLoadCommPrefEmail_MaxDate').output.firstRow.Count,0),greater(activity('Masterdata_CDP_InitialLoadCommPrefPhone_MaxDate').output.firstRow.Count,0))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Masterdata_CDP_Count_Data_Not_Found_Logs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_CDP_Customer_Prefrence_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT EmailAddress AS RAW_EMAIL_ADDRESS,\nCAST(OptedIn as bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nEmailCommunicationId AS EMAIL_COMMUNICATION_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [RetailCustomer].[IncrementalLoadCommPrefEmail] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "Byte[]",
														"physicalType": "varbinary"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Masterdata_CDP_preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT PhoneNumber AS RAW_PHONE_NUMBER,\nCAST(OptedIn AS Bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nPhoneCommunicationId AS PHONE_COMM_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [RetailCustomer].[IncrementalLoadCommPrefPhone] WITH(NOLOCK)",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Masterdata_CDP_preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_PHONE",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'CommunicationPreferenceLoad'\n,@P_LOAD_DESCRIPTION = 'CommunicationPreferenceLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "GetMaxCustPrefMasterID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "CommunicationPreferenceLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[RetailCustomer].[IncrementalLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Delete_Prefrence_Incremental_data",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[RetailCustomer].[usp_ArchiveDeleteIncrementalPreferenceLoad]",
										"storedProcedureParameters": {
											"MaxId_CustPrefMasterID": {
												"value": {
													"value": "@activity('GetMaxCustPrefMasterID').output.firstRow.MAXCustPrefMasterID",
													"type": "Expression"
												},
												"type": "Int32"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_EMAIL",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Fail_PHONE",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "GetMaxCustPrefMasterID",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": "SELECT ISNULL(MAX(CustPrefMasterID),'0') AS MAXCustPrefMasterID FROM RcmPrefsSubscriber.customer_preferences ",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "RcmPrefsSubscriber",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "usp_CommunicationPreferenceEmailLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[RcmCustSemarchy].[usp_CommunicationPreferenceEmailLoad]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_CommunicationPreferencePhoneLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_CommunicationPreferenceEmailLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[RcmCustSemarchy].[usp_CommunicationPreferencePhoneLoad]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:07Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_Prefrence_MaxDate')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_preferences')]",
				"[concat(variables('factoryId'), '/datasets/SD_COMMUNICTN_PREFERNC_EMAIL')]",
				"[concat(variables('factoryId'), '/datasets/SD_COMMUNICTN_PREFERNC_PHONE')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/RcmPrefsSubscriber')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_CommunicationPreferenceLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get_Email_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Get_Phone_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'CommunicationPreferenceLoad'\n,@P_LOAD_DESCRIPTION = 'CommunicationPreferenceLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Check_Phone_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "CommunicationPreferenceLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get_Email_Chunk",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select top 1 Id,ChunkNumber,TableName,Organization\nfrom Masterdata_CDP.PreferenceInitialLoadChunks with(nolock)\nwhere isloaded = 0 and ProcessedDate is NULL and channel ='email'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Email_Chunk",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Get_Phone_Chunk",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select top 1 Id,ChunkNumber,TableName,Organization\nfrom Masterdata_CDP.PreferenceInitialLoadChunks with(nolock)\nwhere isloaded = 0 and ProcessedDate is NULL and channel = 'SMS'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Get_Phone_Chunk",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_Email_Chunk",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@contains(activity('Get_Email_Chunk').output,'firstRow')",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "No_Data_Available_For_Email",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT EmailAddress AS RAW_EMAIL_ADDRESS,\nCAST(OptedIn as bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nEmailCommunicationId AS EMAIL_COMMUNICATION_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [Masterdata_CDP].[InitialLoadCommPrefEmail] WITH(NOLOCK) WHERE ChunkNumber = @{activity('Get_Email_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Email_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Email_Chunk').output.firstRow.Organization}' and channel = 'email'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "Byte[]",
														"physicalType": "varbinary"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EMAIL_COMMUNICATION_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "InitialLoad_CommPref",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_EMAIL_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_EMAIL",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefEmail]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_EMAIL').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Failed_Email",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_EMAIL').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Update_Email_Chunk",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_EMAIL",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "Update a set ProcessedDate = getdate() , isloaded = 1\nfrom Masterdata_CDP.PreferenceInitialLoadChunks a with(nolock)\nWHERE ChunkNumber = @{activity('Get_Email_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Email_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Email_Chunk').output.firstRow.Organization}' and channel = 'email';\nselect 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Update_Email_Chunk",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "Check_Phone_Chunk",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Check_Email_Chunk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@contains(activity('Get_Phone_Chunk').output,'firstRow')",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "No_Data_Available_For_Phone",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT PhoneNumber AS RAW_PHONE_NUMBER,\nCAST(OptedIn AS Bit) AS OPTED_IN,\nOrganization AS ORGANIZATION,\nPurpose AS PURPOSE,\nChannel AS CHANNEL,\nB_SourceID AS B_SOURCEID,\nPhoneCommunicationId AS PHONE_COMM_ID,\nSRC_UPDATE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATOR,\nB_UPDATE AS B_UPDDATE,\nB_CREDATE FROM [Masterdata_CDP].[InitialLoadCommPrefPhone] WITH(NOLOCK) WHERE ChunkNumber = @{activity('Get_Phone_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Phone_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Phone_Chunk').output.firstRow.Organization}' and channel = 'SMS'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "OPTED_IN",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ORGANIZATION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "PURPOSE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PHONE_COMM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "InitialLoad_CommPref",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_COMMUNICTN_PREFERNC_PHONE",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_COMMUNICTN_PREFERNC_PHONE_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SD_COMMUNICTN_PREFERNC_PHONE",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "[[Masterdata_CDP].[InitialLoadCommPrefPhone]",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('SD_COMMUNICTN_PREFERNC_PHONE').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Failed_Phone",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('SD_COMMUNICTN_PREFERNC_PHONE').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('SD_COMMUNICTN_PREFERNC_PHONE').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Update_Phone_Chunk",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "SD_COMMUNICTN_PREFERNC_PHONE",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "Update a set ProcessedDate = getdate() , isloaded = 1\nfrom Masterdata_CDP.PreferenceInitialLoadChunks a with(nolock)\nWHERE ChunkNumber = @{activity('Get_Phone_Chunk').output.firstRow.ChunkNumber} and TableName = '@{activity('Get_Phone_Chunk').output.firstRow.TableName}' and Organization = '@{activity('Get_Phone_Chunk').output.firstRow.Organization}' and channel = 'SMS';\nselect 1 as success;",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Phone_Chunk",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Email_Chunk')]",
				"[concat(variables('factoryId'), '/datasets/Get_Phone_Chunk')]",
				"[concat(variables('factoryId'), '/datasets/InitialLoad_CommPref')]",
				"[concat(variables('factoryId'), '/datasets/SD_COMMUNICTN_PREFERNC_EMAIL')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Update_Email_Chunk')]",
				"[concat(variables('factoryId'), '/datasets/SD_COMMUNICTN_PREFERNC_PHONE')]",
				"[concat(variables('factoryId'), '/datasets/Phone_Chunk')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_Crosswalk')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "TRUNCATE TABLE [dbo].[CrossWalk_MD_OUT]",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHGRP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MATCHGRP",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CONFIRMATIONSTATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_CUSTOMER_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "RETAIL_CUSTOMER_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CONFIRMEDSDPK",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_CONFIRMEDSDPK",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "masterdata_CDP_CrossWalk_MD_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "retailCustomer_dbo_CrossWalk_MD_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": {
									"value": "TRUNCATE TABLE [dbo].[CrossWalk_DU_OUT]",
									"type": "Expression"
								},
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHRULE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_MATCHRULE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_MATCHSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_MATCHSCORE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "masterData_CDP_CrossWalk_DU_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "RetailCustomer_CrossWalk_DU_OUT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Retail_Customer_Crosswalk_MD_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Retail_Customer_CrossWalk_MD_OUT').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": "Source is Crosswalk MD Table Data",
								"Source_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_MD_fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Retail_Customer_Crosswalk_MD_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Retail_Customer_CrossWalk_MD_OUT').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_DU_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Retail_Customer_CrossWalk_DU_OUT').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": "Source is Crosswalk DU Table Data",
								"Source_Type": {
									"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Retail_Customer_Crosswalk_DU_fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Retail_Customer_Crosswalk_DU_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Retail_Customer_CrossWalk_DU_OUT').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_MD_OUT_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_MD_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Retail_Customer_CrossWalk_MD_OUT').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_MD_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_MD_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Retail_Customer_CrossWalk_DU_OUT_ErrorLogS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Retail_Customer_CrossWalk_DU_OUT",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Retail_Customer_CrossWalk_DU_OUT').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "dbo.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Masterdata_CDP.CrossWalk_DU_OUT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Retail_Customer_CrossWalk_DU_OUT').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/masterdata_CDP_CrossWalk_MD_OUT')]",
				"[concat(variables('factoryId'), '/datasets/retailCustomer_dbo_CrossWalk_MD_OUT')]",
				"[concat(variables('factoryId'), '/datasets/masterData_CDP_CrossWalk_DU_OUT')]",
				"[concat(variables('factoryId'), '/datasets/RetailCustomer_CrossWalk_DU_OUT')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Retail_Customer_Failure_Notification')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Check_CustomerInfo_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get_Data_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(activity('Get_Data_Count').output.firstRow.COUNT),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": "No RAW Data Available For AllSourceCustomers",
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "GetNewLoadId",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "Semarchy_Repo",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Set_LoadID_Variable",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "GetNewLoadId",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "LoadID",
										"value": {
											"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_RetailCustomers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set_LoadID_Variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nDO_NOT_SELL,\nNamePrefix,\nNameSuffix,\nGenderCode,\nIsAshleyEmployee,\nLoadRetailCustomerID,\nMarketingOwner,\nChannel,\nFirstAcquisitionDate,\nFirstAcquisitionSource,\nFirstMarketingSmsSignupCode,\nFirstMarketingSmsSignupDate,\nFirstPurchaseChannel,\nLastMarketingSmsSignupCode,\nLastMarketingSmsSignupDate,\nLastOrderFulfilledDate,\nLastOrderPlacedDate,\nLastPurchaseChannel,\nLastStoreShopped,\nLastStoreShoppedDate,\nLastStorePurchased,\nPreferredStoreID,\nPreferredStoreChangeDate,\nClosestStoreID,\nCurrentMarketingRegion,\nCurrentMarketingRegionChangeDate,\nFirstOrderPlacedDate,\nLastAcquisitionSource,\nLastEmailSignupDate,\nLastEmailSignupStoreID,\nLastTechnicalSource,\nLifetimeGrossDollars,\nLifetimeOrderCount\nFROM RetailCustomer.RetailCustomersIncremental \nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWFIRSTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_FIRST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWLASTNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_LAST_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWMIDDLENAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_MIDDLE_NAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "GenderCode",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "GENDER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DO_NOT_SELL",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "DO_NOT_SELL",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "NamePrefix",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "NAME_PREFIX",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "NameSuffix",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "NAME_SUFFIX",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "IsAshleyEmployee",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_ASHLEY_EMPLOYEE",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LoadRetailCustomerID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													},
													"sink": {
														"name": "LOAD_RETAIL_CUSTOMER_ID",
														"type": "Guid",
														"physicalType": "uniqueidentifier"
													}
												},
												{
													"source": {
														"name": "MarketingOwner",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "MARKETING_OWNER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Channel",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FirstAcquisitionDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "FIRST_ACQUISITION_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FirstAcquisitionSource",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIRST_ACQUISITION_SOURCE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FirstMarketingSmsSignupCode",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIRST_MKTG_SMS_SU_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FirstMarketingSmsSignupDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "FIRST_MKTG_SMS_SU_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FirstPurchaseChannel",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FIRST_PURCHASE_CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastMarketingSmsSignupCode",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_MKTG_SMS_SU_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastMarketingSmsSignupDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_MKTG_SMS_SU_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastOrderFulfilledDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_ORDER_FULFILLED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastOrderPlacedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_ORDER_PLACED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastPurchaseChannel",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_PURCHASE_CHANNEL",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastStoreShopped",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_STORE_SHOPPED",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastStoreShoppedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_STORE_SHOPPED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastStorePurchased",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_STORE_PURCHASED",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PreferredStoreID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "PREFERRED_STORE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "PreferredStoreChangeDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "PREFERRED_STORE_CHG_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "ClosestStoreID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CLOSEST_STORE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CurrentMarketingRegion",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CURRENT_MARKETING_REGION",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "CurrentMarketingRegionChangeDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "CURRENT_MKTG_REG_CHG_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FirstOrderPlacedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "FIRST_ORDER_PLACED_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastAcquisitionSource",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_ACQUISITION_SOURCE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastEmailSignupDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_EMAIL_SU_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastEmailSignupStoreID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_EMAIL_SU_STORE_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LastTechnicalSource",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LAST_TECHNICAL_SOURCE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LifetimeGrossDollars",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 4,
														"precision": 19
													},
													"sink": {
														"name": "LIFETIME_GROSS_DOLLARS",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 4,
														"precision": 19
													}
												},
												{
													"source": {
														"name": "LifetimeOrderCount",
														"type": "Int32",
														"physicalType": "int"
													},
													"sink": {
														"name": "LIFETIME_ORDER_COUNT",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 10
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_RetailCustomersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_RETAIL_CUSTOMER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "RetailCustomers_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.message}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_RetailCustomers').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_RETAIL_CUSTOMER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.RetailCustomersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_RetailCustomers",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_RetailCustomers').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_RetailCustomers').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_RetailCustomers').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_RetailCustomers').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_RetailCustomers",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_RetailCustomers",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_RetailCustomers').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_RetailCustomers').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Customer_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_RETAIL_CUSTOMER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.RetailCustomersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_RetailCustomers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Load_EmailAddresses",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER,\nIsPrimary,\nLastClickDate,\nLastOpenDate\nFROM RetailCustomer.EmailAddressesIncremental \nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWEMAILADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_EMAIL_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "IsPrimary",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PRIMARY",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "LastClickDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_CLICK_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "LastOpenDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "LAST_OPEN_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_EmailAddressesIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_EMAIL_ADDRESS",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "EmailAddresses_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_EmailAddresses').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_EMAIL_ADDRESS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.EmailAddressesIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_EmailAddresses",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_EmailAddresses').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_EmailAddresses').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_EmailAddresses').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_EmailAddresses').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "EmailAddresses_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_EMAIL_ADDRESS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.EmailAddressesIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_EmailAddresses').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_EmailAddresses",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_EmailAddresses",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_EmailAddresses').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_EmailAddresses').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_PhoneNumbers",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER,\nIsPrimary\nFROM RetailCustomer.PhoneNumbersIncremental\nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWPHONENUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_PHONE_NUMBER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "IsPrimary",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PRIMARY",
														"type": "Boolean",
														"physicalType": "bit"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_PhoneNumbersIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_PHONE_NUMBER",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "PhoneNumbers_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_PhoneNumbers').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_PHONE_NUMBER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.PhoneNumbersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_PhoneNumbers",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_PhoneNumbers').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_PhoneNumbers').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_PhoneNumbers').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_PhoneNumbers').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "PhoneNumbers_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_PHONE_NUMBER",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.PhoneNumbersIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_PhoneNumbers').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_PhoneNumbers",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_PhoneNumbers",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_PhoneNumbers').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_PhoneNumbers').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load_AddressLocations",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": {
												"value": "SELECT B_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_UPDATE,\nB_UPDATOR,\nB_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER,\nTimezone, \nIsPrimary,\nADDRESSTYPE\nFROM RetailCustomer.AddressLocationsIncremental\nWITH(NOLOCK) ",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTREETADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STREET_ADDRESS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWADDRESSLINE2",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ADDRESS_LINE2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCITY",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_CITY",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWSTATEORPROVINCECODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_STATE_OR_PROV_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWZIPOSTALCODE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "RAW_ZIP_POSTAL_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "RAWCOUNTRYCODE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "RAW_COUNTRY_CODE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "SRC_UPDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "Timezone",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "TIME_ZONE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "IsPrimary",
														"type": "Boolean",
														"physicalType": "bit"
													},
													"sink": {
														"name": "IS_PRIMARY",
														"type": "Boolean",
														"physicalType": "bit"
													}
												},
												{
													"source": {
														"name": "ADDRESSTYPE",
														"type": "String",
														"physicalType": "varchar"
													},
													"sink": {
														"name": "ADDRESS_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Raw_AddressLocationsIncremental",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "SD_ADDRESS_LOCATION",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "AddressLocations_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_AddressLocations').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_AddressLocations').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_ADDRESS_LOCATION",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.AddressLocationsIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_AddressLocations",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_AddressLocations').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_AddressLocations').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_AddressLocations').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_AddressLocations').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "AddressLocations_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_ADDRESS_LOCATION",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RetailCustomer.AddressLocationsIncremental",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_AddressLocations').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Fail_AddressLocations",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_AddressLocations",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_AddressLocations').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_AddressLocations').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SubmitLoadID",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
										"storedProcedureParameters": {
											"P_INTEGRATION_JOB_NAME": {
												"value": {
													"value": "RetailCustomerLoad",
													"type": "Expression"
												},
												"type": "String"
											},
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											},
											"return_value_argument": {
												"value": null,
												"type": "Decimal"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_RetailCustomers_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_RetailCustomers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_EmailAddresses_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_EmailAddresses",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_PhoneNumbers_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_PhoneNumbers",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SD_Cancel_AddressLocations_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "usp_ArchiveDeleteCustomer",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SubmitLoadID",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "RcmCustSemarchy.usp_ArchiveDeleteCustomer"
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "usp_DeleteRFDLocalStage",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "usp_ArchiveDeleteCustomer",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[RcmCustSemarchy].[usp_DeleteRFDLocalStage]"
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Load_DiscountProgram",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_AddressLocations",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": "SELECT \tB_PUBID,\r\n\t\tB_SOURCEID,\r\n\t\tB_CLASSNAME,\r\n\t\tB_CREDATE,\r\n\t\tB_UPDDATE,\r\n\t\tB_CREATOR,\r\n\t\tB_UPDATOR,\r\n\t\tSTART_DATE,\r\n\t\tEND_DATE,\r\n\t\tFP_RETAIL_CUSTOMER,\r\n\t\tFS_RETAIL_CUSTOMER,\r\n\t\tLOAD_PROGRAM_ID\r\nFROM RetailCustomer.DiscountProgramMembershipIncremental\r\nWITH(NOLOCK)",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_PUBID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_SOURCEID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "START_DATE",
														"type": "DateTime",
														"physicalType": "date"
													},
													"sink": {
														"name": "START_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "END_DATE",
														"type": "DateTime",
														"physicalType": "date"
													},
													"sink": {
														"name": "END_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "LOAD_PROGRAM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "LOAD_PROGRAM_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_CustomerDiscountPrograms",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_SD_DISCOUNT_PROGRAM_MEMSHIP",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "DiscountProgram_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_DISCOUNT_PROGRAM_MEMSHIP",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.CustomerDiscountPrograms",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "DiscountProgram_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_DiscountProgram').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SD_DISCOUNT_PROGRAM_MEMSHIP",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.CustomerDiscountPrograms",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_DiscountProgram').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_DiscountProgram",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_DiscountProgram').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_DiscountProgram').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_DiscountProgram').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_DiscountProgram').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_DiscountProgram",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_DiscountProgram",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_DiscountProgram').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_DiscountProgram').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SD_Cancel_DiscountProgram_LoadId_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Load_Orders",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_DiscountProgram",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"additionalColumns": [
												{
													"name": "B_LOADID",
													"value": {
														"value": "@variables('LoadID')",
														"type": "Expression"
													}
												}
											],
											"sqlReaderQuery": "SELECT O.ORDER_ID,\n       O.B_CLASSNAME,\n       O.B_CREDATE,\n       O.B_UPDDATE,\n       O.B_CREATOR,\n       O.B_UPDATOR,\n       O.ORDER_DATE,\n       O.ORDER_TYPE,\n       O.SOURCE_ORDER_ID,\n       O.FP_RETAIL_CUSTOMER,\n       O.FS_RETAIL_CUSTOMER,\n       O.ORDER_STATUS\nFROM [RetailCustomer].[OrdersIncremental] AS O\nWITH(NOLOCK)",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "B_LOADID",
														"type": "String"
													},
													"sink": {
														"name": "B_LOADID",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 0,
														"precision": 38
													}
												},
												{
													"source": {
														"name": "ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CLASSNAME",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_CREDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "B_UPDDATE",
														"type": "DateTime",
														"physicalType": "datetime2"
													}
												},
												{
													"source": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_CREATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "B_UPDATOR",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "ORDER_DATE",
														"type": "DateTime",
														"physicalType": "date"
													},
													"sink": {
														"name": "ORDER_DATE",
														"type": "DateTime",
														"physicalType": "date"
													}
												},
												{
													"source": {
														"name": "ORDER_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ORDER_TYPE",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SOURCE_ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "SOURCE_ORDER_ID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FP_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "FS_RETAIL_CUSTOMER",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "ORDER_STATUS",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "ORDER_STATUS",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DS_Orders_RCM",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_SA_ORDERS_RCM",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Orders_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcnow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].start}\n\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Load_Orders').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Load_Orders').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Load_Orders').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "dbo.SA_ORDERS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.RetailSalesOrderHeader",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Orders_ErrorLogs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_Orders').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_Orders').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_Orders').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_Orders').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "SA_ORDERS",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "RcmCustSubscriber.RetailSalesOrderHeader",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Load_Orders').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_Orders",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Load_Orders').output.executionDetails[0].start",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_Orders').output.executionDetails[0].status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Load_Orders').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_Orders').output.copyDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_Orders",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_Orders",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_Orders').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_Orders').error.errorCode}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SD_Cancel_DiscountProgram_LoadId_Stored_Procedure_copy1",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Load_Orders",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
										"storedProcedureParameters": {
											"P_LOAD_ID": {
												"value": {
													"value": "@variables('LoadID')",
													"type": "Expression"
												},
												"type": "Decimal"
											},
											"P_USERNAME": {
												"value": {
													"value": "semadmin",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_repo",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "Get_Data_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_RetailCustomerLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT COUNT(1) AS [COUNT] FROM [RetailCustomer].[RetailCustomersIncremental]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Max_CustomerMasterId_CustomerInfo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "usp_RetailCustomerLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[RcmCustSemarchy].[usp_RetailCustomerLoad]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:08Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Max_CustomerMasterId_CustomerInfo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Raw_RetailCustomersIncremental')]",
				"[concat(variables('factoryId'), '/datasets/SD_RETAIL_CUSTOMER')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Raw_EmailAddressesIncremental')]",
				"[concat(variables('factoryId'), '/datasets/SD_EMAIL_ADDRESS')]",
				"[concat(variables('factoryId'), '/datasets/Raw_PhoneNumbersIncremental')]",
				"[concat(variables('factoryId'), '/datasets/SD_PHONE_NUMBER')]",
				"[concat(variables('factoryId'), '/datasets/Raw_AddressLocationsIncremental')]",
				"[concat(variables('factoryId'), '/datasets/SD_ADDRESS_LOCATION')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/DS_CustomerDiscountPrograms')]",
				"[concat(variables('factoryId'), '/datasets/DS_SD_DISCOUNT_PROGRAM_MEMSHIP')]",
				"[concat(variables('factoryId'), '/datasets/DS_Orders_RCM')]",
				"[concat(variables('factoryId'), '/datasets/DS_SA_ORDERS_RCM')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_RetailCustomer_RetailCustomerLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Initial_Load_RetailCustomers",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "usp_PreLoad_DROP_SD_Indexes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\nB_SOURCEID,\nRAWFIRSTNAME,\nRAWMIDDLENAME,\nRAWLASTNAME,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE\nFROM Masterdata_CDP.RetailCustomerInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWFIRSTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWLASTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWMIDDLENAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_RETAIL_CUSTOMER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_PhoneNumber",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_RetailCustomers",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWPHONENUMBER,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.PhoneNumbersInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPHONENUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersPhoneInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_PHONE_NUMBER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_EmailAddresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_PhoneNumber",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWEMAILADDRESS,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.EmailAddressesInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWEMAILADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersEmailInitial",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_EMAIL_ADDRESS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Initial_Load_Addresses",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Initial_Load_EmailAddresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadId')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \nB_SOURCEID,\nRAWSTREETADDRESS,\nRAWADDRESSLINE2,\nRAWCITY,\nRAWSTATEORPROVINCECODE,\nRAWZIPOSTALCODE,\nRAWCOUNTRYCODE,\nB_PUBID,\nB_CLASSNAME,\nB_CREATOR,\nB_CREATOR AS B_UPDATOR,\nB_UPDATE AS B_CREDATE,\nB_UPDATE AS SRC_UPDATE,\nGETDATE() AS B_UPDATE,\nFP_RETAIL_CUSTOMER,\nFS_RETAIL_CUSTOMER\nFROM Masterdata_CDP.AddressLocationsInitialLoad WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTREETADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STREET_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESSLINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATEORPROVINCECODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_OR_PROV_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWZIPOSTALCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ZIP_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRYCODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_RETAIL_CUSTOMER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SRC_UPDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Raw_RetailCustomersAddress",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "INITIAL_SD_ADDRESS_LOCATION",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "usp_InitialLoadRetail",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_CustomerMaster'\n,@P_PROGRAM_NAME = 'RetailCustomerLoad'\n,@P_LOAD_DESCRIPTION = 'RetailCustomerLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadId",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_PreSemarchy_ADD_SD_Indexes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailCustomerLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadId')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_InitialLoadRetail",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Masterdata_CDP].[usp_InitialLoadRetail]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_PreLoad_DROP_SD_Indexes",
						"description": "Drop SD table index",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_PreLoad_DROP_SD_Indexes]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_CustomerMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_PreSemarchy_ADD_SD_Indexes",
						"description": "Add indexing in SD table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Initial_Load_Addresses",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[usp_PreSemarchy_ADD_SD_Indexes]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_CustomerMaster",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadId": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Raw_RetailCustomersInitial')]",
				"[concat(variables('factoryId'), '/datasets/INITIAL_SD_RETAIL_CUSTOMER')]",
				"[concat(variables('factoryId'), '/datasets/Raw_RetailCustomersPhoneInitial')]",
				"[concat(variables('factoryId'), '/datasets/INITIAL_SD_PHONE_NUMBER')]",
				"[concat(variables('factoryId'), '/datasets/Raw_RetailCustomersEmailInitial')]",
				"[concat(variables('factoryId'), '/datasets/INITIAL_SD_EMAIL_ADDRESS')]",
				"[concat(variables('factoryId'), '/datasets/Raw_RetailCustomersAddress')]",
				"[concat(variables('factoryId'), '/datasets/INITIAL_SD_ADDRESS_LOCATION')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_ExternalRefCountry')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'ExternalRefCountryLoad'\n,@P_LOAD_DESCRIPTION = 'External Ref Country Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "External_Ref_Country",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ExternalRefCountryLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "External_Ref_Country",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[EXT_REF_COUNTRY_ID]\n       ,'ExternalRefCountry' as B_CLASSNAME\n      ,[COUNTRY_CODE_A2]\n      ,[COUNTRY_CODE_A3]\n      ,[COUNTRY_NAME]\n      ,[COUNTRY_LOCAL_NAME]\n      ,[COUNTRY_UN_CODE]\n  FROM [ISO].[countrycode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "EXT_REF_COUNTRY_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "EXTERNAL_REF_COUNTRY_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE_A2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE_A2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE_A3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE_A3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_LOCAL_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_LOCAL_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_UN_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_UN_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ISO_CountryCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_EXTERNAL_REF_COUNTRY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_ISO_CountryCode')]",
				"[concat(variables('factoryId'), '/datasets/masterDataHub_Retail_dbo_SA_EXTERNAL_REF_COUNTRY')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_ExternalRefUSState')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'ExternalRefUSStateLoad'\n,@P_LOAD_DESCRIPTION = 'External Ref US State Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "External_Ref_US_State",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "ExternalRefUSStateLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "External_Ref_US_State",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,'ExternalRefUSState' as B_CLASSNAME\n      ,[EXT_REF_US_STATE_ID]\n      ,[STATE_CODE]\n      ,[STATE_NAME]\n  FROM [ISO].[statecode]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "EXT_REF_US_STATE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "EXTERNAL_REF_US_STATE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_ISO_StateCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_EXTERNAL_REF_US_STATE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:53Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_ISO_StateCode')]",
				"[concat(variables('factoryId'), '/datasets/masterDataHub_Retail_dbo_SA_EXTERNAL_REF_US_STATE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_Retail_SiteMasterLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SD_SiteOwner",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Get_New_load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "WITH CTE AS(\n\nSELECT OWNER_NAME,\nOWNER_ADDRESS,\nOWNER_CITY,\nOWNER_STATE,\nOWNER_POSTAL_CODE,\nCOUNTRY_CODE,\nB_SOURCE_ID,\n--ROW_NUMBER() OVER(PARTITION BY B_SOURCE_ID ORDER BY OWNER_NAME,OWNER_ADDRESS DESC) AS RNK\nrank() over(partition by B_Source_ID order by ltrim(rtrim(OWNER_NAME))) as rnk\nFROM  [Retail].[InitialLoadSiteOwner]\n)\nSELECT  DISTINCT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID,\n      [OWNER_NAME] AS OWNER_NAME\n      ,[OWNER_ADDRESS] AS RAWADDRESS_LINE1\n      ,[OWNER_CITY] AS RAWCITY\n      ,[OWNER_STATE] AS RAWSTATE_CODE\n      ,[OWNER_POSTAL_CODE] AS RAWPOSTAL_CODE\n\t,'INITIALLOAD' as [B_PUBID]\n\t,'SiteOwner' AS B_CLASSNAME\n\t, B_Source_ID AS [B_SOURCEID]\n       ,Country_Code as RAWCOUNTRY_CODE FROM CTE WHERE RNK=1 ",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SD_SITE_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Get_New_load",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'masterDataHub_Retail'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'Site Master Load'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Submit_Load",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SA_SiteContact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@activity('Get_New_load').output.firstRow.RETURN_VALUE_ARGUMENT",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SD_SiteMain",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteMain_RDC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT \n      @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[SITE_NAME] AS SITE_NAME\n      ,[SITE_TYPE] AS SITE_TYPE\n      ,CONVERT(BIT, (CASE WHEN [IS_ACTIVE] ='NULL' THEN 0 ELSE CAST([IS_ACTIVE] AS BIT) END)) as ISACTIVE\n      ,[SITE_DESCRIPTION] AS SITE_DESCRIPTION\n      ,[OWNERSHIP_TYPE] AS SITE_OWNERSHIP_TYPE\n      ,[B_SOURCE_ID] AS B_SOURCEID\n      ,[ADDRESS_LINE1] AS RAWADDRESS_LINE1\n      ,[ADDRESS_LINE2] AS RAWADDRESS_LINE2\n      ,[CITY] AS RAWCITY\n      ,[STATE_CODE] AS RAWSTATE_CODE\n      ,[POSTAL_CODE] AS RAWPOSTAL_CODE\n      ,[COUNTRY_CODE] AS RAWCOUNTRY_CODE\n\t  ,[LOCAL_CURRENCY_CODE]\n      ,[LOCAL_UNIT_OF_MEASURE_AREA]\n      ,CAST(OPERATIONS_START_DATE AS DATE) AS OPERATIONS_START_DATE\n      ,CAST(CUSTOMER_OPEN_DATE AS DATE) AS CUSTOMER_OPEN_DATE\n      ,CONVERT(decimal(12,4),CONVERT(float,CUSTOMER_SITE_AREA)) AS CUSTOMER_SITE_AREA\n\t,'INITIALLOAD' AS B_PUBID\n\t,'SiteMain' as B_CLASSNAME\n\t,FS_SITE_OWNER as [FS_SITE_OWNER]\n\t,'INITIALLOAD' AS [FP_SITE_OWNER]\n\t,FP_WAREHOUSE_PARENT as [FP_WAREHOUSE_PARENT]\n\t,FS_WAREHOUSE_PARENT AS [FS_WAREHOUSE_PARENT]\n  FROM [Retail].[InitialLoadSiteMain]    \nWHERE FS_SITE_OWNER IS NOT NULL AND COUNTRY_CODE in ('USA','United States') AND [B_SOURCE_ID] IS NOT NULL",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SD_SiteMain_RDC",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteOwner",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n      ,[B_SOURCE_ID]\n      ,[SITE_NAME]\n      ,[SITE_TYPE]\n      ,CONVERT(BIT, (CASE WHEN [IS_ACTIVE] ='NULL' THEN 0 ELSE CAST([IS_ACTIVE] AS BIT) END)) AS ISACTIVE\n      ,[SITE_DESCRIPTION]\n      ,[OWNERSHIP_TYPE]\n      ,[ADDRESS_LINE1]\n      ,[CITY]\n      ,[STATE_CODE]\n      ,[POSTAL_CODE]\n      ,[COUNTRY_CODE]\n      ,[LOCAL_CURRENCY_CODE]\n      ,[LOCAL_UNIT_OF_MEASURE_AREA]\n      ,CASE WHEN OPERATIONS_SITE_AREA='?' THEN NULL ELSE  CONVERT(decimal(16,4),  convert(float,replace([OPERATIONS_SITE_AREA],',','') )) \n\t  END AS OPERATIONS_SITE_AREA\n      ,[FS_SITE_OWNER]\n\t  ,'INITIALLOAD' AS B_PUBID\n\t,'SiteMain' as B_CLASSNAME\n  ,'INITIALLOAD' AS [FP_SITE_OWNER]\n  FROM [Retail].[InitialLoadSiteMainRDC] WHERE RNK=1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_OWNER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 16
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SA_SiteContact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SD_SiteMain",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT   @{activity('Get_New_Load').output.firstRow.RETURN_VALUE_ARGUMENT} AS B_LoadID\n       ,FP_SITE_MAIN\n      ,NEWID() AS [Site_Contact_ID]\n      ,[CONTACT_FIRST_NAME]\n      ,[CONTACT_LAST_NAME]\n      ,[RAW_CONTACT_PHONE]\n      ,[RAW_CONTACT_EMAIL]\n      ,[SITE_CONTACT_TYPE]\n      ,[FS_SITE_MAIN]\n\t,'SiteContact' as B_CLASSNAME\nFROM [Retail].[InitialLoadSiteContact]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Site_Contact_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTACT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTACT_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTACT_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTACT_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTACT_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_CONTACT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_CONTACT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "masterDataHub_Retail_dbo_SA_SITE_CONTACT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/masterDataHub_Retail_dbo_SD_SITE_OWNER')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_SITE_MAIN')]",
				"[concat(variables('factoryId'), '/datasets/masterDataHub_Retail_dbo_SA_SITE_CONTACT')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteView",
						"description": "select all data from DACJSONLoadSite view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,DAC_ACCOUNT_ID\n      ,DAC_LOCATION_ID\n      ,SITE_NAME\n      ,RAW_PHONE\n      ,RAW_FAX\n      ,LAND_LINE\n      ,OPERATIONAL_STATUS\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,STORE_LOCATOR_DISABLED\n      ,Location_Number\n      ,B_ClassName\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM [Retail].[DACIncrementalSite_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Stored procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSite_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select \n[LocationNumber] AS SITE_CONTENT_ID\n,'SiteContent' AS B_CLASSNAME\n,[LocationNumber]\n,[ExteriorPhoto]\n,[FlyerLink]\n,[Promotion1Image]  \n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,convert(nvarchar(128),WebsiteURL) as WebsiteURL\n\t  ,convert(nvarchar(128),[BusinessDescription]) as BusinessDescription\n      ,[BusinessLongDescription]\n      ,convert(nvarchar(128),BusinessShortDescription) as BusinessShortDescription\n\t  ,convert(nvarchar(128),[BusinessName]) as BusinessName\n      ,[ContentLanguage]\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,FS_SITE_ID\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\nFROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SHORT_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LONG_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WEBSITE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContent_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n      B_CLASSNAME\n      ,SITE_HOURS_TYPE\n      ,DAY_OF_WEEK\n      \n\t  ,CASE\n    WHEN Cast (START_TIME as nvarchar(10)) = 'Closed' Then ''\n\tElse Cast (START_TIME as nvarchar(10)) end as Starttm\n\t,CASE\n    WHEN Cast (END_TIME as nvarchar(10))='' Then ''\n\tElse Cast (END_TIME as nvarchar(10)) end as endtm\n\n      ,FP_SITE\n      ,FS_SITE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n\t,Concat(FS_SITE,'_',DAY_OF_WEEK) as Key1\n      ,BUSINESS_STATE\n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Starttm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "endtm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Incrementalsdhsopctracking_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_Site",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteContent",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteContentView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_CONTENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteContent",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteContent",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteContentView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteContentView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteContent_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteDefaultHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteDefaultHoursView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteDefaultHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteDefaultHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteDefaultHoursView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteDefaultHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalsdhsopctrackingView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,AccountID\n      ,FS_SITE_ID\n      ,F_LEGAL_ENTITY_ID\n      ,SITE_NAME\n      ,SITE_TYPE\n      ,OWNERSHIP_TYPE\n      ,SITE_RAW_ADDR_LINE1\n      ,ADDRESS_LINE2\n      ,SITE_RAW_CITY\n      ,SITE_RAW_STATE_CODE\n      ,SITE_RAW_POSTAL_CODE\n      ,SITE_RAW_COUNTRY_CODE\n      ,SITE_RAW_LATITUDE\n      ,SITE_RAW_LONGITUDE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,B_CLASSNAME\n       ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM Retail.DACIncrementalOPCTracking_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OP_PC_Tracker_DAC",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SD_HS_OPC_TRACKING",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalsdhsopctrackingView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SD_HS_OPC_TRACKING",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalsdhsopctrackingView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SD_HS_OPC_TRACKING_LoadId_Stored_Procedure_",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteSpecialHours",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHours_HIs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n    'SiteSpecialHour' AS B_CLASSNAME,\n    SPH_Date,\n    SPH_StartTime,\n    SPH_Endtime,\n    SPH_State,\n    FP_SITE,\n    FS_SITE,\n    B_CREDATE,\n    B_CREATOR,\n    B_UPDATOR,\n    CASE \n        WHEN SPH_Date IS NULL THEN NULL\n        ELSE CONCAT(FS_SITE, '_', SPH_Date)\n    END AS key1\nFROM Retail.DACIncrementalSiteSpecialHours_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SPECIAL_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Date",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SPH_State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_StartTime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Endtime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_Special_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SpecialHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteSpecialHours').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteSpecialtHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteSpecialHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteSpecialHours').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteSpecialHours').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteSpecialHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSite_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "SchemaName",
								"value": "Retail"
							},
							{
								"name": "TableName",
								"value": "DACIncrementalSite_His"
							}
						],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[DAC_ACCOUNT_ID]\n      ,[DAC_LOCATION_ID]\n      ,[Location_Number]\n      ,[STORE_LOCATOR_DISABLED]\n      ,[RAW_PHONE]\n      ,[RAW_FAX]\n      ,[LAND_LINE]\n      ,[OPERATIONAL_STATUS]\n      ,[SITE_NAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_ClassName]\n      ,[IsActiveType]  \n      ,B_DELETETYPE\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSite_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_Number"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sit_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSite_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteContent_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [LocationNumber]\n      ,[ExteriorPhoto]\n      ,[FlyerLink]\n      ,[Promotion1Image]\n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,[WebsiteURL]\n      ,[BusinessDescription]\n      ,[BusinessLongDescription]\n      ,[BusinessShortDescription]\n      ,[BusinessName]\n      ,[ContentLanguage]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n      ,[IsActiveType]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationNumber"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sitecontent_His",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteContent_His"
								}
							}
						]
					},
					{
						"name": "Incrementalsdhsopctracking_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[AccountID]\n      ,[LocationID]\n      ,[F_LEGAL_ENTITY_ID]\n      ,[SITE_NAME]\n      ,[SITE_TYPE]\n      ,[OWNERSHIP_TYPE]\n      ,[SITE_RAW_ADDR_LINE1]\n      ,[ADDRESS_LINE2]\n      ,[SITE_RAW_CITY]\n      ,[SITE_RAW_STATE_CODE]\n      ,[SITE_RAW_POSTAL_CODE]\n      ,[SITE_RAW_COUNTRY_CODE]\n      ,[SITE_RAW_LATITUDE]\n      ,[SITE_RAW_LONGITUDE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_CLASSNAME]\n      ,[FS_SITE_ID]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n  FROM [Retail].[DACIncrementalOPCTracking_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_hsopc_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalOPCTracking_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHours_HIs",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_CLASSNAME]\n      ,[SITE_HOURS_TYPE]\n      ,[DAY_OF_WEEK]\n      ,[START_TIME]\n      ,[END_TIME]\n      ,[FP_SITE]\n      ,[FS_SITE]\n      ,[Location_ID]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[BUSINESS_STATE]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n      \n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_defaulthours_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteDefaultHours_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteSpecialHours_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [FS_SITE]\n      ,[SPH_Date]\n      ,[SPH_StartTime]\n      ,[SPH_Endtime]\n      ,[SPH_State]\n      ,[FP_SITE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[LocationID]\n      ,[B_DELETETYPE]\n      ,[IsActiveType]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteSpecialHours_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_specialh_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteSpecialHours_His"
								}
							}
						]
					},
					{
						"name": "Stored procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Load_Stores_Data]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate_DAC_Tables",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SubmitLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Truncate_DAC_Tables]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_SITE_MAIN')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_CONTENT')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_DEFAULT_HOURS')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_HS_OP_PC_Tracker_DAC')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_Special_HOURS')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_sit_his')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_sitecontent_His')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_hsopc_his')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_defaulthours_his')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_specialh_his')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_HS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LoadTrackingHS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LoadTrackingHS",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LoadLegalEntityHS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_TrackingHS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"B_LOADID": {
									"value": "@variables('LoadID')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LoadSiteHSAdditionalInfo",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadSiteHS",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "LoadSiteHSAdditionalInfo",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'Site' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nsite_id AS B_SOURCEID,\r\noperational_status AS OPERATIONAL_STATUS,\r\ntype AS TYPE,\r\naccount_num AS ACCOUNT_NUMBER,\r\nship_to_num AS SHIP_TO_NUM,\r\nmodel AS MODEL,\r\nversion AS VERSION,\r\ntime_zone AS TIME_ZONE,\r\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\r\nraw_phone AS RAW_PHONE,\r\nraw_cs_phone AS RAW_CS_PHONE,\r\nraw_fax AS RAW_FAX,\r\nsms_code AS SMS_CODE,\r\nsoft_open_date AS SOFT_OPEN_DATE,\r\ngrand_open_date AS GRAND_OPEN_DATE,\r\nclose_date AS CLOSE_DATE,\r\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\r\nbuilding_sqft AS BUILDING_SQFT,\r\nwarehouse_sqft AS WAREHOUSE_SQFT,\r\nshowroom_sqft AS SHOWROOM_SQFT,\r\noffice_sqft AS OFFICE_SQFT,\r\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\r\nretail_system_num AS RETAIL_SYSTEM_NUM, \r\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\r\ngoogle_id AS F_GOOGLE_ID,\r\nprospect_id  AS PROSPECT_ID,\r\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \r\ndma AS DMA,\r\nmsa_id AS MSA_ID,\r\nmsa AS MSA,\r\nmarket AS MARKET,\r\nregion AS REGION,\r\ndomestic_category AS DOMESTIC_CATEGORY,\r\ncountry_category AS COUNTRY_CATEGORY,\r\nCASE WHEN warehouse_account_ship_to IS NULL THEN NULL ELSE 'INITIALLOAD' END as FP_SUPPORTING_WAREHOUSE,\r\nwarehouse_account_ship_to AS FS_SUPPORTING_WAREHOUSE\r\nFROM Retail.v_site_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadLegalEntityHS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadSiteHS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_legal_entity_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"MaxHSOPCTrackingID": {
						"type": "Integer"
					},
					"B_LOADID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-20T10:34:43Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Load_TrackingHS')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SITE_ADDITIONAL_INFO')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteView",
						"description": "select all data from DACJSONLoadSite view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,DAC_ACCOUNT_ID\n      ,DAC_LOCATION_ID\n      ,SITE_NAME\n      ,RAW_PHONE\n      ,RAW_FAX\n      ,LAND_LINE\n      ,OPERATIONAL_STATUS\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,STORE_LOCATOR_DISABLED\n      ,Location_Number\n      ,B_ClassName\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM [Retail].[DACIncrementalSite_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Stored procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSite_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "select \n[LocationNumber] AS SITE_CONTENT_ID\n,'SiteContent' AS B_CLASSNAME\n,[LocationNumber]\n,[ExteriorPhoto]\n,[FlyerLink]\n,[Promotion1Image]  \n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,convert(nvarchar(128),WebsiteURL) as WebsiteURL\n\t  ,convert(nvarchar(128),[BusinessDescription]) as BusinessDescription\n      ,[BusinessLongDescription]\n      ,convert(nvarchar(128),BusinessShortDescription) as BusinessShortDescription\n\t  ,convert(nvarchar(128),[BusinessName]) as BusinessName\n      ,[ContentLanguage]\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,FS_SITE_ID\n      ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\nFROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SHORT_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LONG_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WEBSITE_URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContent_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n      B_CLASSNAME\n      ,SITE_HOURS_TYPE\n      ,DAY_OF_WEEK\n      \n\t  ,CASE\n    WHEN Cast (START_TIME as nvarchar(10)) = 'Closed' Then ''\n\tElse Cast (START_TIME as nvarchar(10)) end as Starttm\n\t,CASE\n    WHEN Cast (END_TIME as nvarchar(10))='' Then ''\n\tElse Cast (END_TIME as nvarchar(10)) end as endtm\n\n      ,FP_SITE\n      ,FS_SITE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n\t,Concat(FS_SITE,'_',DAY_OF_WEEK) as Key1\n      ,BUSINESS_STATE\n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Starttm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "endtm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Incrementalsdhsopctracking_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_Site",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteContent",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteContentView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_CONTENT",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteContent",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteContentView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteContent",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteContentView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteContentView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteContentView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteContent_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SiteDefaultHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteDefaultHoursView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteDefaultHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteDefaultHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteDefaultHoursView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteDefaultHoursView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteDefaultHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalsdhsopctrackingView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours_His",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT  B_PUBID\n      ,B_SOURCEID\n      ,AccountID\n      ,FS_SITE_ID\n      ,F_LEGAL_ENTITY_ID\n      ,SITE_NAME\n      ,SITE_TYPE\n      ,OWNERSHIP_TYPE\n      ,SITE_RAW_ADDR_LINE1\n      ,ADDRESS_LINE2\n      ,SITE_RAW_CITY\n      ,SITE_RAW_STATE_CODE\n      ,SITE_RAW_POSTAL_CODE\n      ,SITE_RAW_COUNTRY_CODE\n      ,SITE_RAW_LATITUDE\n      ,SITE_RAW_LONGITUDE\n      ,B_CREDATE\n      ,B_CREATOR\n      ,B_UPDATOR\n      ,FP_SITE_ID\n      ,B_CLASSNAME\n       ,B_DELETETYPE\n      ,B_DELETEDATE\n      ,B_DELETEAUTHOR\n      ,B_DELETEOPERATION\n  FROM Retail.DACIncrementalOPCTracking_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OP_PC_Tracker_DAC",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SD_HS_OPC_TRACKING",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalsdhsopctrackingView').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalsdhsopctrackingView').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SD_HS_OPC_TRACKING",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalsdhsopctrackingView').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalsdhsopctrackingView').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SD_HS_OPC_TRACKING_LoadId_Stored_Procedure_",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteSpecialHours",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHours_HIs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT \n    'SiteSpecialHour' AS B_CLASSNAME,\n    SPH_Date,\n    SPH_StartTime,\n    SPH_Endtime,\n    SPH_State,\n    FP_SITE,\n    FS_SITE,\n    B_CREDATE,\n    B_CREATOR,\n    B_UPDATOR,\n    CASE \n        WHEN SPH_Date IS NULL THEN NULL\n        ELSE CONCAT(FS_SITE, '_', SPH_Date)\n    END AS key1\nFROM Retail.DACIncrementalSiteSpecialHours_INC\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "key1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SPECIAL_HOUR_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Date",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SPH_State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_StartTime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SPH_Endtime",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_Special_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_SpecialHours",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSiteSpecialHours').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_DEFAULT_HOURS",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteSpecialtHours",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSiteSpecialHours').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteSpecialHours",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSiteSpecialHours').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSiteSpecialHours').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSiteSpecialHours').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_SiteSpecialHours_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSite_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "SchemaName",
								"value": "Retail"
							},
							{
								"name": "TableName",
								"value": "DACIncrementalSite_His"
							}
						],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[DAC_ACCOUNT_ID]\n      ,[DAC_LOCATION_ID]\n      ,[Location_Number]\n      ,[STORE_LOCATOR_DISABLED]\n      ,[RAW_PHONE]\n      ,[RAW_FAX]\n      ,[LAND_LINE]\n      ,[OPERATIONAL_STATUS]\n      ,[SITE_NAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_ClassName]\n      ,[IsActiveType]  \n      ,B_DELETETYPE\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSite_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_Number"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_ACCOUNT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAC_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAND_LINE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "STORE_LOCATOR_DISABLED",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_Number",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_ClassName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sit_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSite_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteContent_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [LocationNumber]\n      ,[ExteriorPhoto]\n      ,[FlyerLink]\n      ,[Promotion1Image]\n      ,[Promotion1URL]\n      ,[Promotion2URL]\n      ,[Promotion2Image]\n      ,[ScheduleApptURL]\n      ,[AlternateWebsiteURL]\n      ,[WebsiteURL]\n      ,[BusinessDescription]\n      ,[BusinessLongDescription]\n      ,[BusinessShortDescription]\n      ,[BusinessName]\n      ,[ContentLanguage]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n      ,[IsActiveType]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteContent_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationNumber"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ExteriorPhoto",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FlyerLink",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion1URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2URL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Promotion2Image",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ScheduleApptURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AlternateWebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WebsiteURL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessLongDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessShortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BusinessName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ContentLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_sitecontent_His",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteContent_His"
								}
							}
						]
					},
					{
						"name": "Incrementalsdhsopctracking_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalsdhsopctrackingView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_PUBID]\n      ,[B_SOURCEID]\n      ,[AccountID]\n      ,[LocationID]\n      ,[F_LEGAL_ENTITY_ID]\n      ,[SITE_NAME]\n      ,[SITE_TYPE]\n      ,[OWNERSHIP_TYPE]\n      ,[SITE_RAW_ADDR_LINE1]\n      ,[ADDRESS_LINE2]\n      ,[SITE_RAW_CITY]\n      ,[SITE_RAW_STATE_CODE]\n      ,[SITE_RAW_POSTAL_CODE]\n      ,[SITE_RAW_COUNTRY_CODE]\n      ,[SITE_RAW_LATITUDE]\n      ,[SITE_RAW_LONGITUDE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[B_CLASSNAME]\n      ,[FS_SITE_ID]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n  FROM [Retail].[DACIncrementalOPCTracking_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OWNERSHIP_TYPE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_hsopc_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalOPCTracking_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHours_HIs",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [B_CLASSNAME]\n      ,[SITE_HOURS_TYPE]\n      ,[DAY_OF_WEEK]\n      ,[START_TIME]\n      ,[END_TIME]\n      ,[FP_SITE]\n      ,[FS_SITE]\n      ,[Location_ID]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[BUSINESS_STATE]\n      ,[B_DELETETYPE]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n      ,[IsActiveType]\n      \n  FROM [Retail].[DACIncrementalSiteDefaultHours_INC]",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Location_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BUSINESS_STATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Activity_Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActiveType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_defaulthours_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteDefaultHours_His"
								}
							}
						]
					},
					{
						"name": "IncrementalSiteSpecialHours_His",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteSpecialHours",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [FS_SITE]\n      ,[SPH_Date]\n      ,[SPH_StartTime]\n      ,[SPH_Endtime]\n      ,[SPH_State]\n      ,[FP_SITE]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[LocationID]\n      ,[B_DELETETYPE]\n      ,[IsActiveType]\n      ,[B_DELETEDATE]\n      ,[B_DELETEAUTHOR]\n      ,[B_DELETEOPERATION]\n      ,[Activity_Type]\n  FROM [Retail].[DACIncrementalSiteSpecialHours_INC]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LocationID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging_specialh_his",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "DACIncrementalSiteSpecialHours_His"
								}
							}
						]
					},
					{
						"name": "Stored procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Load_Stores_Data]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate_DAC_Tables",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SubmitLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Truncate_DAC_Tables]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2022-05-26T06:05:04Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_SITE_MAIN')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_CONTENT')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_DEFAULT_HOURS')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_HS_OP_PC_Tracker_DAC')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_Special_HOURS')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_sit_his')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_sitecontent_His')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_hsopc_his')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_defaulthours_his')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_specialh_his')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_Delete')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId1').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site_Warehouse_Hist_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"OPERATIONAL_STATUS",
										"B_SOURCEID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_WareHouse_Hist"
								}
							}
						]
					},
					{
						"name": "SubmitLoadGX",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Hist_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('Loadid')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_Hist_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID0",
										"value": {
											"value": "@variables('LoadID')\n",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID as LOCATION_NUMBER, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY,\r\n   COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, \r\nFS_SUPPORTING_WAREHOUSE,'SOFT_DELETE' as B_DELETETYPE,\r\ngetdate() as B_DELETEDATE,\r\n'Semadmin' as B_DELETEAUTHOR,\r\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\r\n--change_type, record_insert_date, record_update_date\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='INACTIVE'\r\nand CLOSE_DATE <= CURRENT_DATE",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID0",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_GX').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_GX').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_GX').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_GX').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_GX').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_GX').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_GX').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_GX').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging_GX",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_GX').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_GX').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_GX').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Hist_GX",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY, \r\n  COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, FS_SUPPORTING_WAREHOUSE, \r\nchange_type, record_insert_date, record_update_date\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='INACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_SOURCEID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CHANGE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_insert_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_INSERT_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_update_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_UPDATE_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_StoreMaster_Hist"
								}
							}
						]
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure_copy1_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLogs_GX",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse_GX').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_copy1_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse_GX').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse_GX').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse_GX').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse_GX').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging_GX_WH",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse_GX",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse_GX').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-20T10:34:43Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_RSA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteRSADataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LocationCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select  LOCATION_CODE_ID,\r\nB_CLASSNAME,\r\nB_CREDATE,\r\nB_UPDDATE,\r\nB_CREATOR,\r\nB_UPDATOR,\r\nB_PUBID,\r\nFP_SITE_ID,\r\nFS_SITE_ID,\r\nOPERATION_ID,\r\nPROFIT_CENTER\r\n from Retail.locationcode_Initial_VW \r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "locationcode_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_LOCATION_CODE"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,'INCREMENTAL' as FP_SITE_ID\r\n,FS_SITE_ID\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\n,active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Assignment_Incremental_Vw\r\nwhere active_flag > 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_ASSOCIATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Incremental_Vw"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_RSA_ASSIGNMENT"
								}
							}
						]
					},
					{
						"name": "RSA_Associate",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Error_Log_LocationConstraint",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere active_flag > 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_ASSOCIATE"
								}
							}
						]
					},
					{
						"name": "LocationCode_ErrorLoags_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LocationCode').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LocationCode').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LocationCode').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LocationCode').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_LocationCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LocationCode').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LocationCode').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LocationCode').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LocationCode').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.locationcode_Initial_VW",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "RSA_Associate_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,Active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere Active_flag > 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ASSOCIATE_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_HIST"
								}
							}
						]
					},
					{
						"name": "GetNewLoadId_Delete",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SubmitLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId_Delete",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID1",
							"value": {
								"value": "@{activity('GetNewLoadId_Delete').output.firstRow.RETURN_VALUE_ARGUMENT}\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "RSA_Associate_Delete",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID1')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere active_flag = 0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_ASSOCIATE"
								}
							}
						]
					},
					{
						"name": "SubmitLoad_Delete",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteRSADataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID1')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "RSA_Associate_Hist_Delete",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nLegalentityID as F_LEGAL_ENTITY,\r\n'Associate' as B_CLASSNAME\r\n,getdate() as B_CREDATE\r\n,getdate() as B_UPDDATE\r\n,'semadmin' as B_CREATOR\r\n,'semadmin' as B_UPDATOR\r\n,Active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Associate_Incremental_VW\r\nwhere Active_flag =0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"ASSOCIATE_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Active_flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Activity_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Incremental_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_HIST"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Assignment_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,'INCREMENTAL' as FP_SITE_ID\r\n,FS_SITE_ID\r\nfrom Retail.RSA_Assignment_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.RSA_Assignment_HIST",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_Site_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Initial_vw"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_HIST"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment_Delete",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate_Hist_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID1')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,'INCREMENTAL' as FP_SITE_ID\r\n,FS_SITE_ID\r\n,B_DELETETYPE\r\n,B_DELETEDATE\r\n,B_DELETEAUTHOR\r\n,B_DELETEOPERATION\r\n,active_flag\r\n,Activity_type\r\nfrom Retail.RSA_Assignment_Incremental_Vw\r\nwhere active_flag=0\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_ASSOCIATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Incremental_Vw"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_RSA_ASSIGNMENT"
								}
							}
						]
					},
					{
						"name": "Archive_delete",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SubmitLoad_Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[usp_RSA_ARCHIIVE_DELETE]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "RSA_Error_Log_LocationConstraint",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select AssociatedID as Associate_ID,LastName AS LAST_NAME,MiddleName AS MIDDLE_NAME,FirstName AS FIRST_NAME,Status,EmailAddress AS EMAIL_ADDRESS,\r\nWorkType AS WORK_TYPE,RsaID,LocationCode,OPERATION_ID,Profit_center,entity,LegalentityID AS F_LEGAL_ENTITY,B_CLASSNAME,B_CREDATE,B_UPDDATE,B_CREATOR,B_UPDATOR,StartDate AS START_DATE,Lasthiredate AS LAST_HIRE_DATE,\r\nTerminationDate AS TERMINATION_DATE\r\nfrom Retail.RSA_ERROR_LOG_vw",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_Loadid",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RsaID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RsaID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LocationCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LocationCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Profit_center",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Profit_center",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "entity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "entity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_ERROR_LOG_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_ERROR_LOG"
								}
							}
						]
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment_Hist",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID1')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_RSA_Associate",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "RSA_Associate",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('RSA_Associate').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('RSA_Associate').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('RSA_Associate').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('RSA_Associate').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_RSA_Assignment",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('RSA_Assignment').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('RSA_Assignment').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('RSA_Assignment').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('RSA_Assignment').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					},
					"LoadID1": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:09Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/DS_SiteMaster')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_StoreMaster')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Site",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID as location_number, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY,\r\n   COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, \r\nFS_SUPPORTING_WAREHOUSE,'' as B_DELETETYPE,\r\ncast(Null as datetime) as B_DELETEDATE,\r\n'' as B_DELETEAUTHOR,\r\ncast (Null as uniqueidentifier) as B_DELETEOPERATION\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere soft_open_date <= CURRENT_DATE\r\n\r\n/*\r\nwhere upper(operational_status) ='ACTIVE'\r\nUNION \r\n\r\nselect B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID as location_number, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY,\r\n   COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, \r\nFS_SUPPORTING_WAREHOUSE,\r\n'SOFT_DELETE' as B_DELETETYPE,\r\ngetdate() as B_DELETEDATE,\r\n'Semadmin' as B_DELETEAUTHOR,\r\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='INACTIVE'\r\n*/",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "location_number",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LOCATION_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM [Retail].[v_StoreMaster_Inc_Legal_Entity]\n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking_hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_PUBID,\nSITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\n--change_type\nFROM Retail.v_SiteAdditionalInfo_Incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_HSOPCTracking_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('HSOPCTracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_HSOPCTracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('HSOPCTracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('HSOPCTracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteAdditionalInformation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Hist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select HS_OPC_TRACKING_ID,B_CLASSNAME,B_CREDATE,B_UPDDATE,B_CREATOR,B_PUBID,B_SOURCEID,OPERATION_ID,PRIMARY_PROFIT_CENTER,ERP_DATABASE_NAME,ERP_SYSTEM_NAME,EFFECTIVE_START_DATE,EFFECTIVE_END_DATE,LEGACY_LOCATION_ID,SITE_NAME,COMP_FLAG,ENTERPRISE_FLAG,TRAFFIC_SYSTEM_ID,LIC_TERRITORY,TUA_EXPIRATION_DATE,NOTES,OS_ID,OS_LOCATION_ID,SITE_RAW_ADDR_LINE1,SITE_RAW_ADDR_LINE2,SITE_RAW_CITY,SITE_RAW_STATE,SITE_RAW_STATE_CODE,SITE_RAW_POSTAL_CODE,SITE_RAW_COUNTRY,SITE_RAW_COUNTRY_CODE,\r\nSITE_RAW_LATITUDE,SITE_RAW_LONGITUDE,F_LEGAL_ENTITY_ID,FP_SITE_ID,FS_SITE_ID from (\r\nSELECT \r\n    cast(newid() as uniqueidentifier) HS_OPC_TRACKING_ID,\r\n    B_CLASSNAME,\r\n\tB_CREDATE,\r\n\tB_UPDDATE,\r\n\tB_CREATOR,\r\n\tB_PUBID,\r\n\tB_SOURCEID,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t FP_SITE_ID,\r\n\t FS_SITE_ID ,\r\n     ROW_NUMBER() OVER (PARTITION BY B_SOURCEID ORDER BY effective_start_date DESC) AS rn     \r\nFROM Retail.v_hs_opc_tracking_incremental)a\r\nwhere rn=1",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OP_PC_Tracker",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LegalEntity_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\n'1' as Current_flag\nFROM [Retail].[v_StoreMaster_Inc_Legal_Entity]\n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LEGAL_ENTITY_ID",
										"NAME"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Hist_Legal_Entity"
								}
							}
						]
					},
					{
						"name": "Site_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct B_CLASSNAME, B_CREDATE, B_UPDDATE, B_CREATOR, B_PUBID, B_SOURCEID, OPERATIONAL_STATUS, TYPE, ACCOUNT_NUMBER, \r\nSHIP_TO_NUM, MODEL, VERSION, TIME_ZONE, LOCAL_CURRENCY_CODE, RAW_PHONE, RAW_CS_PHONE, RAW_FAX, SMS_CODE, SOFT_OPEN_DATE,\r\n GRAND_OPEN_DATE, CLOSE_DATE, AREA_UNIT_OF_MEASURE, BUILDING_SQFT, WAREHOUSE_SQFT, SHOWROOM_SQFT, OFFICE_SQFT, NUM_OF_DOCK_DOORS,\r\n  RETAIL_SYSTEM_NUM, ENTERPRISE_STORE_NUM, F_GOOGLE_ID, PROSPECT_ID, DMA_ID, DMA, MSA_ID, MSA, MARKET, REGION, DOMESTIC_CATEGORY, \r\n  COUNTRY_CATEGORY, FP_SUPPORTING_WAREHOUSE, FS_SUPPORTING_WAREHOUSE, \r\nchange_type, record_insert_date, record_update_date\r\nfrom retail.v_Site_Storemaster_incremental\r\nwhere upper(operational_status) ='ACTIVE'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_SOURCEID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CHANGE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_insert_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_INSERT_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "record_update_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "RECORD_UPDATE_DATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_StoreMaster_Hist"
								}
							}
						]
					},
					{
						"name": "HSOPCTracking_hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    cast(newid() as uniqueidentifier) AS HS_OPC_TRACKING_ID,\r\n    B_CLASSNAME,\r\n\tB_CREDATE,\r\n\tB_UPDDATE,\r\n\tB_CREATOR,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t FP_SITE_ID,\r\n\t FS_SITE_ID ,   \r\n     CHANGE_TYPE  as CHANGE_TYPE \r\nFROM Retail.v_hs_opc_tracking_incremental",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_ID",
										"OPERATION_ID",
										"PRIMARY_PROFIT_CENTER"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "notes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CHANGE_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "b_loadid",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "HS_OPC_TRACKING_Hist"
								}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\nB_CLASSNAME,\nB_CREDATE,\nB_UPDDATE,\nB_CREATOR,\nB_PUBID,\nSITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME,\nchange_type\nFROM Retail.v_SiteAdditionalInfo_Incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"SITE_ADDITIONAL_INFO_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "change_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Change_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_addn_info_Hist"
								}
							}
						]
					},
					{
						"name": "SubmitLoadGD",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-20T10:34:43Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/SITE_ADDITIONAL_INFO')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_HS_OP_PC_Tracker')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_WareHouse')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'' as B_DELETETYPE,\ncast(Null as datetime) as B_DELETEDATE,\n'' as B_DELETEAUTHOR,\ncast (Null as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\n\n/*\nwhere upper(operational_status)='ACTIVE'\n\n\nUnion\nSELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'\n*/",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n--    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n--cast(newid() as uniqueidentifier) AS WH_LE_TRACKING_ID,\r\nsite_id as WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'SSMASTER_RDC' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"B_LOADID",
										"WH_LE_TRACKING_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION\n\nFROM Retail.v_wh_legal_entity_inc WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "masterDataHubStg",
										"type": "LinkedServiceReference"
									},
									"path": "raw-zone/Warehouses"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WH_LegalEntity_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nactive_flag,\nactivity_type\nFROM Retail.v_wh_legal_entity_inc \n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LEGAL_ENTITY_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "wh_legal_entity_Hist"
								}
							}
						]
					},
					{
						"name": "Site_Warehouse_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SSMASTER_RDC' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'' as B_DELETETYPE,\ncast(Null as datetime) as B_DELETEDATE,\n'' as B_DELETEAUTHOR,\ncast (Null as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='ACTIVE'\n/*\n\nUnion\nSELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'SMARTSHEET' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type ,\n'SOFT_DELETE' as B_DELETETYPE,\ngetdate() as B_DELETEDATE,\n'Semadmin' as B_DELETEAUTHOR,\ncast(newid() as uniqueidentifier) as B_DELETEOPERATION\nFROM Retail.v_Site_WareHouse_inc\nwhere upper(operational_status)='INACTIVE'\n*/",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_WareHouse_Hist"
								}
							}
						]
					},
					{
						"name": "WHLETracking_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \r\n    --ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n\t--cast(newid() as uniqueidentifier) AS WH_LE_TRACKING_ID,\r\n\tsite_id as WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'SSMASTER_RDC' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"WH_LE_TRACKING_ID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "WH_LE_Tracking_Hist"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-02-24T05:45:17Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_WH_LE_Tracking')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental_WareHouse_copy')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION,\nactive_flag,\nactivity_type \nFROM Retail.v_Site_WareHouse_inc\n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INCREMENTAL' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nB_DELETETYPE,\nB_DELETEDATE,\nB_DELETEAUTHOR,\nB_DELETEOPERATION\n\nFROM Retail.v_wh_legal_entity_inc WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "masterDataHubStg",
										"type": "LinkedServiceReference"
									},
									"path": "raw-zone/Warehouses"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WH_LegalEntity_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE,\nactive_flag,\nactivity_type\nFROM Retail.v_wh_legal_entity_inc \n WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.wh_legal_entity_Hist",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "wh_legal_entity_Hist"
								}
							}
						]
					},
					{
						"name": "Site_Warehouse_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INCREMENTAL' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG,\nactive_flag,\nactivity_type  \nFROM Retail.v_Site_WareHouse_inc WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.Site_WareHouse_Hist",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RETAIL_SYSTEM_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ENTERPRISE_STORE_NUM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "active_flag",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "activity_type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Site_WareHouse_Hist"
								}
							}
						]
					},
					{
						"name": "WHLETracking_Hist",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INCREMENTAL' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking_inc",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.WH_LE_Tracking_Hist",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "WH_LE_Tracking_Hist"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:08Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_GD_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/EDW_RSM_LicContact_CompanyCode')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_WH_LE_Tracking')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Incremental__ZipAllocation')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_SA_ZIP_ALLOCATION",
				"activities": [
					{
						"name": "IncrementalSAZipAllocation",
						"description": "select all data from ZipAllocation_INC_V view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									},
									{
										"name": "B_UPDDATE_C",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [ZIP_ALLOCATION_ID]\n      ,[CustomerNumber]\n      ,[Acct_ShipTo]\n      ,[TRADE_AREA]\n      ,[START_DATE]\n      ,[BUSINESS_TYPE]\n      ,[Status]\n      ,[PRICE_GROUP]\n      ,[ENABLE_WEB_SALE]\n      ,[IsActive]\n      ,[B_CLASSNAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n\t  ,[B_DELETETYPE]\n\t  ,[B_DELETEDATE] \n\t  ,[B_DELETEAUTHOR] \n\t  ,[B_DELETEOPERATION] \n  FROM [EDW].[ZipAllocation_INC_V]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "ZIP_ALLOCATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZIP_ALLOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TRADE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRADE_AREA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "BUSINESS_TYPE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "BUSINESS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRICE_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRICE_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ENABLE_WEB_SALE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENABLE_WEB_SALE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE_C",
											"type": "String"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_ZipAllocation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteDACLoad'\n,@P_LOAD_DESCRIPTION = 'SiteDACLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ZipAllocation_INC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteDACLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_zipallocation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('IncrementalSAZipAllocation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE_MAIN",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.DACIncrementalSiteMain",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('IncrementalSAZipAllocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_zipAllocation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('IncrementalSAZipAllocation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('IncrementalSAZipAllocation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('IncrementalSAZipAllocation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('IncrementalSAZipAllocation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Cancel_ZipAllocation_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "ZipAllocation_INC",
						"description": "select all data from ZipAllocation_INC_V view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSAZipAllocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT [ZIP_ALLOCATION_ID]\n      ,[CustomerNumber]\n      ,[Acct_ShipTo]\n      ,[TRADE_AREA]\n      ,[START_DATE]\n      ,[BUSINESS_TYPE]\n      ,[Status]\n      ,[PRICE_GROUP]\n      ,cast([ENABLE_WEB_SALE] as int) as ENABLE_WEB_SALE\n      ,cast([IsActive] as varchar(50)) as IsActive\n      ,[B_CLASSNAME]\n      ,[B_CREDATE]\n      ,[B_CREATOR]\n      ,[B_UPDATOR]\n      ,[FP_SITE_ID]\n      ,[FS_SITE_ID]\n\t  ,[B_DELETETYPE]\n\t  ,[B_DELETEDATE] \n\t  ,[B_DELETEAUTHOR] \n\t  ,[B_DELETEOPERATION] \n        ,IsActive\n  FROM [EDW].[ZipAllocation_INC_V]\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ZipCode"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ZIP_ALLOCATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZipCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CustomerNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CustomerNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Acct_ShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Acct_ShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TRADE_AREA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TradeArea",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StartDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BUSINESS_TYPE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "BusinessType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "PRICE_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PriceDiscGroup_GroupId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ENABLE_WEB_SALE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "EnableWebSale",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "IsActive",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "IsActive",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LoadID",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_zip_inc",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_ZipAllocation')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_zip_inc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Initial_00')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'Site' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nsite_id AS B_SOURCEID,\r\noperational_status AS OPERATIONAL_STATUS,\r\ntype AS TYPE,\r\naccount_num AS ACCOUNT_NUMBER,\r\nship_to_num AS SHIP_TO_NUM,\r\nmodel AS MODEL,\r\nversion AS VERSION,\r\ntime_zone AS TIME_ZONE,\r\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\r\nraw_phone AS RAW_PHONE,\r\nraw_cs_phone AS RAW_CS_PHONE,\r\nraw_fax AS RAW_FAX,\r\nsms_code AS SMS_CODE,\r\nsoft_open_date AS SOFT_OPEN_DATE,\r\ngrand_open_date AS GRAND_OPEN_DATE,\r\nclose_date AS CLOSE_DATE,\r\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\r\nbuilding_sqft AS BUILDING_SQFT,\r\nwarehouse_sqft AS WAREHOUSE_SQFT,\r\nshowroom_sqft AS SHOWROOM_SQFT,\r\noffice_sqft AS OFFICE_SQFT,\r\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\r\nretail_system_num AS RETAIL_SYSTEM_NUM, \r\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\r\ngoogle_id AS F_GOOGLE_ID,\r\nprospect_id  AS PROSPECT_ID,\r\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \r\ndma AS DMA,\r\nmsa_id AS MSA_ID,\r\nmsa AS MSA,\r\nmarket AS MARKET,\r\nregion AS REGION,\r\ndomestic_category AS DOMESTIC_CATEGORY,\r\ncountry_category AS COUNTRY_CATEGORY,\r\nCASE WHEN warehouse_account_ship_to IS NULL THEN NULL ELSE 'INITIALLOAD' END as FP_SUPPORTING_WAREHOUSE,\r\nwarehouse_account_ship_to AS FS_SUPPORTING_WAREHOUSE\r\nFROM Retail.v_site WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_HSOPCTracking_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "RSA_Assignment",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('HSOPCTracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_HSOPCTracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('HSOPCTracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('HSOPCTracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteAdditionalInformation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG\nFROM Retail.v_site_warehouse WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "HSOPCTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by operation_id, primary_profit_center ) AS HS_OPC_TRACKING_ID,\r\n    'HomeStoreOperationProfitCenterTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_hs_opc_tracking\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "SubmitLoad0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_wh_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select  LOCATION_CODE_ID,\r\nB_CLASSNAME,\r\nB_CREDATE,\r\nB_UPDDATE,\r\nB_CREATOR,\r\nB_UPDATOR,\r\nB_PUBID,\r\nFP_SITE_ID,\r\nFS_SITE_ID,\r\nOPERATION_ID,\r\nPROFIT_CENTER\r\n from Retail.locationcode_Initial_VW \r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCATION_CODE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "locationcode_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_LOCATION_CODE"
								}
							}
						]
					},
					{
						"name": "RSA_Assignment",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "RSA_Associate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct RSA_ID\r\n,AssociateID\r\n,B_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\n,FP_SITE_ID\r\n,FS_SITE_ID\r\nfrom Retail.RSA_Assignment_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RSA_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AssociateID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_ASSOCIATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Assignment_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_RSA_ASSIGNMENT"
								}
							}
						]
					},
					{
						"name": "RSA_Associate",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "b_loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select distinct AssociatedID as Associate_ID,\r\nLastName as LAST_NAME,\r\nMiddleName as MIDDLE_NAME,\r\nFirstName as FIRST_NAME,\r\nStartdate as START_DATE,\r\nlastHireDate as LAST_HIRE_DATE,\r\n[Status],\r\nTerminationDate as TERMINATION_DATE,\r\nemailAddress as EMAIL_ADDRESS,\r\nWorkType as WORK_TYPE,\r\nRsaID,\r\nLocationCode,\r\nLegalentityID as F_LEGAL_ENTITY,\r\nB_CLASSNAME\r\n,B_CREDATE\r\n,B_UPDDATE\r\n,B_CREATOR\r\n,B_UPDATOR\r\nfrom Retail.RSA_Associate_Initial_VW\r\nWITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "b_loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Associate_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASSOCIATE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MIDDLE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LAST_HIRE_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LAST_HIRE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TERMINATION_DATE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TERMINATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EMAIL_ADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WORK_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "RSA_Associate_Initial_VW"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "dbo",
									"TableName": "SA_ASSOCIATE"
								}
							}
						]
					},
					{
						"name": "LocationCode_ErrorLoags_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_LocationCode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "LocationCode_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LocationCode').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LocationCode').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.locationcode_Initial_VW",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-02-24T05:45:17Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/SITE_ADDITIONAL_INFO')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_GD_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/EDW_RSM_LicContact_CompanyCode')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_HS_OPC_Tracking')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_WH_LE_Tracking')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/DS_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Initial_StoreMaster')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n'Site' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nsite_id AS B_SOURCEID,\r\noperational_status AS OPERATIONAL_STATUS,\r\ntype AS TYPE,\r\naccount_num AS ACCOUNT_NUMBER,\r\nship_to_num AS SHIP_TO_NUM,\r\nmodel AS MODEL,\r\nversion AS VERSION,\r\ntime_zone AS TIME_ZONE,\r\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\r\nraw_phone AS RAW_PHONE,\r\nraw_cs_phone AS RAW_CS_PHONE,\r\nraw_fax AS RAW_FAX,\r\nsms_code AS SMS_CODE,\r\nsoft_open_date AS SOFT_OPEN_DATE,\r\ngrand_open_date AS GRAND_OPEN_DATE,\r\nclose_date AS CLOSE_DATE,\r\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\r\nbuilding_sqft AS BUILDING_SQFT,\r\nwarehouse_sqft AS WAREHOUSE_SQFT,\r\nshowroom_sqft AS SHOWROOM_SQFT,\r\noffice_sqft AS OFFICE_SQFT,\r\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\r\nretail_system_num AS RETAIL_SYSTEM_NUM, \r\nenterprise_store_num AS ENTERPRISE_STORE_NUM,\r\ngoogle_id AS F_GOOGLE_ID,\r\nprospect_id  AS PROSPECT_ID,\r\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \r\ndma AS DMA,\r\nmsa_id AS MSA_ID,\r\nmsa AS MSA,\r\nmarket AS MARKET,\r\nregion AS REGION,\r\ndomestic_category AS DOMESTIC_CATEGORY,\r\ncountry_category AS COUNTRY_CATEGORY,\r\nCASE WHEN warehouse_account_ship_to IS NULL THEN NULL ELSE 'INITIALLOAD' END as FP_SUPPORTING_WAREHOUSE,\r\nwarehouse_account_ship_to AS FS_SUPPORTING_WAREHOUSE\r\nFROM Retail.v_site WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "F_GOOGLE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SUPPORTING_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteAdditionalInformation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'SiteAdditionalInformation' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nid AS SITE_ADDITIONAL_INFO_ID,\nopr_monday_start_time AS OPR_MONDAY_START_TIME,\nopr_monday_end_time AS OPR_MONDAY_END_TIME,\nopr_tuesday_start_time AS OPR_TUESDAY_START_TIME,\nopr_tuesday_end_time AS OPR_TUESDAY_END_TIME,\nopr_wednesday_start_time AS OPR_WEDNESDAY_START_TIME,\nopr_wednesday_end_time AS OPR_WEDNESDAY_END_TIME,\nopr_thursday_start_time AS OPR_THURSDAY_START_TIME,\nopr_thursday_end_time AS OPR_THURSDAY_END_TIME,\nopr_friday_start_time AS OPR_FRIDAY_START_TIME,\nopr_friday_end_time AS OPR_FRIDAY_END_TIME,\nopr_saturday_start_time AS OPR_SATURDAY_START_TIME,\nopr_saturday_end_time AS OPR_SATURDAY_END_TIME,\nopr_sunday_start_time AS OPR_SUNDAY_START_TIME,\nopr_sunday_end_time AS OPR_SUNDAY_END_TIME\nFROM Retail.v_site_additional_info WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ADDITIONAL_INFO_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_MONDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_TUESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_WEDNESDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_THURSDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_FRIDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SATURDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPR_SUNDAY_END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SITE_ADDITIONAL_INFO",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_HSOPCTracking_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_SiteAdditionalInformation_LoadId_SP",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('HSOPCTracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('HSOPCTracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('SiteAdditionalInformation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_LegalEntity",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_HSOPCTracking",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('HSOPCTracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('HSOPCTracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('HSOPCTracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_SiteAdditionalInformation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('SiteAdditionalInformation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('SiteAdditionalInformation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('SiteAdditionalInformation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Site_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "HSOPCTracking_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "HSOPCTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_HS_OPC_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_hs_opc_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('HSOPCTracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SiteAdditionalInformation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteAdditionalInformation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_SITE_ADDITIONAL_INFO",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_additional_info",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('SiteAdditionalInformation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "HSOPCTracking",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Site",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by operation_id, primary_profit_center ) AS HS_OPC_TRACKING_ID,\r\n    'HomeStoreOperationProfitCenterTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t operation_id AS OPERATION_ID,\r\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\r\n\t erp_database_name AS ERP_DATABASE_NAME,\r\n\t erp_system_name AS ERP_SYSTEM_NAME,\r\n\t effective_start_date AS EFFECTIVE_START_DATE,\r\n\t effective_end_date AS EFFECTIVE_END_DATE,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t site_name AS SITE_NAME,\r\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\r\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\r\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\r\n\t lic_territory AS LIC_TERRITORY,\r\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\r\n\t notes AS NOTES,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_hs_opc_tracking\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-20T10:34:43Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/SITE_ADDITIONAL_INFO')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_GD_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/EDW_RSM_LicContact_CompanyCode')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_HS_OPC_Tracking')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_Initial_WareHouse')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TRUNCATE_SITE_TABLES",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Preserve_WebUI_CompanyCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[TRUNCATE_SITE_TABLES]"
						},
						"linkedServiceName": {
							"referenceName": "Retail_SiteMaster",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "GetNewLoadId0",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "TRUNCATE_SITE_TABLES",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId0",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID0",
							"value": {
								"value": "@{activity('GetNewLoadId0').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Site_Warehouse",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG\nFROM Retail.v_site_warehouse WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Site__Warehouse_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_Site_Warehouse_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Site_Warehouse_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Site_Warehouse').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Site_Warehouse').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SD_SITE",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_site_warehouse",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Site_Warehouse').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Site_Warehouse').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Site_Warehouse').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Site_Warehouse').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Preserve_WebUI_CompanyCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DISTINCT \n          LEGAL_ENTITY_ID,\n          LIC_CONTACT, \n          COMPANY_CODE,\n\t\t  GetDate() as LOAD_DATE\nFROM DBO.GD_LEGAL_ENTITY WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[RSM_LicContact_CompanyCode]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "LOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster_GD_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_RSM_LicContact_CompanyCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Site_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \r\n    ROW_NUMBER() OVER (PARTITION BY 1 order by legal_entity_id ) AS WH_LE_TRACKING_ID,\r\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\r\n\tGETDATE() AS B_CREDATE,\r\n\tGETDATE() AS B_UPDDATE,\r\n\t'semadmin' AS B_CREATOR,\r\n\t CAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\r\n\t --CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\r\n\t site_name AS SITE_NAME,\r\n\t notes AS NOTES,\r\n\t legacy_location_id AS LEGACY_LOCATION_ID,\r\n\t os_id AS OS_ID,\r\n\t os_location_id AS OS_LOCATION_ID,\r\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\r\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\r\n\t raw_city AS SITE_RAW_CITY,\r\n\t raw_state AS SITE_RAW_STATE,\r\n\t raw_state_code AS SITE_RAW_STATE_CODE,\r\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\r\n\t raw_country AS SITE_RAW_COUNTRY,\r\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\r\n\t raw_latitude AS SITE_RAW_LATITUDE,\r\n\t raw_longitude AS SITE_RAW_LONGITUDE,\r\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\r\n\t 'INITIALLOAD' AS FP_SITE_ID,\r\n\t site_id AS FS_SITE_ID      \r\nFROM Retail.v_wh_le_tracking",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WLETracking_SuccessLogging_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WHLETracking').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WHLETracking').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WLETracking_LoadId_Stored_Procedure_copy1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WLETracking_ErrorLoags_copy",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WHLETracking').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WHLETracking').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WHLETracking').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WHLETracking').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_WH_LE_TRACKING",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_le_tracking",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WHLETracking').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WLETracking_copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WHLETracking').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WHLETracking').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WHLETracking').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WHLETracking').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad0",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WHLETracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId0",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LoadID",
										"value": {
											"value": "@variables('LoadID0')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\n'LegalEntity' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nlegal_entity_id AS LEGAL_ENTITY_ID,\nname AS NAME,\ntype AS TYPE,\nlic_contact AS LIC_CONTACT,\nlic_contact_email AS LIC_CONTACT_EMAIL,\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\nraw_addr_line1 AS RAW_ADDR_LINE1,\nraw_addr_line2 AS RAW_ADDR_LINE2,\nraw_city AS RAW_CITY,\nraw_state AS RAW_STATE,\nraw_state_code AS RAW_STATE_CODE,\nraw_country AS RAW_COUNTRY,\nraw_country_code AS RAW_COUNTRY_CODE,\nraw_postal_code AS RAW_POSTAL_CODE,\nraw_longitude AS RAW_LONGITUDE,\nraw_latitude AS RAW_LATITUDE,\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\nmailing_city AS MAILING_CITY,\nmailing_state AS MAILING_STATE,\nmailing_state_code AS MAILING_STATE_CODE,\nmailing_country AS MAILING_COUNTRY,\nmailing_country_code AS MAILING_COUNTRY_CODE,\nmailing_postal_code AS MAILING_POSTAL_CODE,\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\ncompany_code AS COMPANY_CODE\nFROM Retail.v_wh_legal_entity WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LoadID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WH_LegalEntity_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cancel_WH_LegalEntity_LoadId_Stored_Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CANCEL_LOAD]",
							"storedProcedureParameters": {
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID0')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WH_LegalEntity_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WH_LegalEntity').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WH_LegalEntity').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "SA_LEGAL_ENTITY",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "Retail.v_wh_legal_entity",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WH_LegalEntity').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Site_Warehouse_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WH_LegalEntity",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WH_LegalEntity').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WH_LegalEntity').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WH_LegalEntity').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"LoadID0": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_GD_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/datasets/EDW_RSM_LicContact_CompanyCode')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_WH_LE_Tracking')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_SiteMaster_WH')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'RetailSiteDataLoad'\r\n,@P_LOAD_DESCRIPTION = 'RetailSiteDataLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LoadSiteWH",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n'Site' AS B_CLASSNAME,\nGETDATE() AS B_CREDATE,\nGETDATE() AS B_UPDDATE,\n'semadmin' AS B_CREATOR,\n'INITIALLOAD' AS B_PUBID,\nsite_id AS B_SOURCEID,\noperational_status AS OPERATIONAL_STATUS,\ntype AS TYPE,\naccount_num AS ACCOUNT_NUMBER,\nship_to_num AS SHIP_TO_NUM,\nmodel AS MODEL,\nversion AS VERSION,\ntime_zone AS TIME_ZONE,\nlocal_currency_code  AS LOCAL_CURRENCY_CODE,\nraw_phone AS RAW_PHONE,\nraw_cs_phone AS RAW_CS_PHONE,\nraw_fax AS RAW_FAX,\nsms_code AS SMS_CODE,\nsoft_open_date AS SOFT_OPEN_DATE,\ngrand_open_date AS GRAND_OPEN_DATE,\nclose_date AS CLOSE_DATE,\narea_unit_of_measure AS AREA_UNIT_OF_MEASURE,\nbuilding_sqft AS BUILDING_SQFT,\nwarehouse_sqft AS WAREHOUSE_SQFT,\nshowroom_sqft AS SHOWROOM_SQFT,\noffice_sqft AS OFFICE_SQFT,\nnum_of_dock_doors AS NUM_OF_DOCK_DOORS,\nretail_system_num AS RETAIL_SYSTEM_NUM, \nenterprise_store_num AS ENTERPRISE_STORE_NUM,\nprospect_id  AS PROSPECT_ID,\nCAST(dma_id AS DECIMAL(17,0)) AS DMA_ID, \ndma AS DMA,\nmsa_id AS MSA_ID,\nmsa AS MSA,\nmarket AS MARKET,\nregion AS REGION,\ndomestic_category AS DOMESTIC_CATEGORY,\ncountry_category AS COUNTRY_CATEGORY,\nCAST(ecom_fulfiller_flag AS BIT) AS ECOM_FULFILLER_FLAG\nFROM Retail.v_site_warehouse_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATIONAL_STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACCOUNT_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SHIP_TO_NUM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MODEL",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VERSION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "VERSION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SMS_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SMS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SOFT_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "GRAND_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AREA_UNIT_OF_MEASURE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BUILDING_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "BUILDING_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "WAREHOUSE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "SHOWROOM_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SHOWROOM_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "OFFICE_SQFT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OFFICE_SQFT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NUM_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PROSPECT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 17
										},
										"sink": {
											"name": "DMA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "DMA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DMA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MARKET",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MARKET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "REGION",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "REGION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DOMESTIC_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DOMESTIC_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CATEGORY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "COUNTRY_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ECOM_FULFILLER_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SD_SITE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadLegalEntityWH",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadSiteWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT\r\n'LegalEntity' AS B_CLASSNAME,\r\nGETDATE() AS B_CREDATE,\r\nGETDATE() AS B_UPDDATE,\r\n'semadmin' AS B_CREATOR,\r\n'INITIALLOAD' AS B_PUBID,\r\nlegal_entity_id AS LEGAL_ENTITY_ID,\r\nname AS NAME,\r\ntype AS TYPE,\r\nlic_contact AS LIC_CONTACT,\r\nlic_contact_email AS LIC_CONTACT_EMAIL,\r\nraw_lic_contact_phone AS RAW_LIC_CONTACT_PHONE,\r\nraw_addr_line1 AS RAW_ADDR_LINE1,\r\nraw_addr_line2 AS RAW_ADDR_LINE2,\r\nraw_city AS RAW_CITY,\r\nraw_state AS RAW_STATE,\r\nraw_state_code AS RAW_STATE_CODE,\r\nraw_country AS RAW_COUNTRY,\r\nraw_country_code AS RAW_COUNTRY_CODE,\r\nraw_postal_code AS RAW_POSTAL_CODE,\r\nraw_longitude AS RAW_LONGITUDE,\r\nraw_latitude AS RAW_LATITUDE,\r\nmailing_addr_line1 AS MAILING_ADDR_LINE1,\r\nmailing_addr_line2 AS MAILING_ADDR_LINE2,\r\nmailing_city AS MAILING_CITY,\r\nmailing_state AS MAILING_STATE,\r\nmailing_state_code AS MAILING_STATE_CODE,\r\nmailing_country AS MAILING_COUNTRY,\r\nmailing_country_code AS MAILING_COUNTRY_CODE,\r\nmailing_postal_code AS MAILING_POSTAL_CODE,\r\nos_legal_entity_id AS OS_LEGAL_ENTITY_ID,\r\ncompany_code AS COMPANY_CODE\r\nFROM Retail.v_wh_legal_entity_incremental WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE1",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_CITY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_STATE_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_POSTAL_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "MAILING_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LEGAL_ENTITY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RAW_LIC_CONTACT_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COMPANY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SA_LEGAL_ENTITY",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadTrackingWH",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "LoadLegalEntityWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_TrackingWH",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"B_LOADID": {
									"value": "@variables('LoadID')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "LoadTrackingWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "RetailSiteDataLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					},
					"MaxWHLETrackingID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/SD_SITE')]",
				"[concat(variables('factoryId'), '/datasets/SA_LEGAL_ENTITY')]",
				"[concat(variables('factoryId'), '/pipelines/Load_TrackingWH')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_TrackingHS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LoadRecordsForSiteTrackingDeletion",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT SITE_ID\nFROM Retail.v_site_changed",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "DELETE FROM dbo.ASH_REMOVE_SITE_TRACKING\nWHERE SITE_ID NOT LIKE '%-WAREHOUSE'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_ASH_REMOVE_SITE_TRACKING",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetMaxHSTrackingID",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeleteHSTracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT INT\n\nEXECUTE dbo.GET_MAX_TRACKING_ID @TrackingIdType = 'HS_OPC', @RETURN_VALUE_ARGUMENT=null\n\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "DeleteHSTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadRecordsForSiteTrackingDeletion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n     OPCTRACKING.HS_OPC_TRACKING_ID,\n     'HomeStoreOperationProfitCenterTracking' AS B_CLASSNAME,\n\t'HARD_DELETE' AS B_DELETETYPE,\n     CAST(NEWID() AS NVARCHAR(128)) AS B_DELETEOPERATION,\n     GETDATE() AS B_DELETEDATE,\n     'semadmin' AS B_DELETEAUTHOR\nFROM DBO.GD_HS_OPC_TRACKING AS OPCTRACKING\nINNER JOIN (SELECT * FROM DBO.ASH_REMOVE_SITE_TRACKING WHERE SITE_ID NOT LIKE '%-WAREHOUSE') AS REMOVEREC\n     ON OPCTRACKING.FS_SITE_ID = REMOVEREC.SITE_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LoadHSTracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetMaxHSTrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\n\t@{variables('MaxHSOPCTrackingID')} + ROW_NUMBER() OVER (PARTITION BY 1 order by site_id, operation_id, primary_profit_center ) AS HS_OPC_TRACKING_ID,\n    'HomeStoreOperationProfitCenterTracking' as B_CLASSNAME,\n\tGETDATE() AS B_CREDATE,\n\tGETDATE() AS B_UPDDATE,\n\t'semadmin' AS B_CREATOR,\n\t operation_id AS OPERATION_ID,\n\t primary_profit_center AS PRIMARY_PROFIT_CENTER,\n\t erp_database_name AS ERP_DATABASE_NAME,\n\t erp_system_name AS ERP_SYSTEM_NAME,\n\t effective_start_date AS EFFECTIVE_START_DATE,\n\t effective_end_date AS EFFECTIVE_END_DATE,\n\t legacy_location_id AS LEGACY_LOCATION_ID,\n\t site_name AS SITE_NAME,\n\t CAST(comp_flag AS BIT) AS COMP_FLAG,\n\t CAST(enterprise_flag AS BIT) AS ENTERPRISE_FLAG,\n\t traffic_system_id AS TRAFFIC_SYSTEM_ID,\n\t lic_territory AS LIC_TERRITORY,\n\t tua_expiration_date AS TUA_EXPIRATION_DATE,\n\t notes AS NOTES,\n\t os_id AS OS_ID,\n\t os_location_id AS OS_LOCATION_ID,\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\n\t raw_city AS SITE_RAW_CITY,\n\t raw_state AS SITE_RAW_STATE,\n\t raw_state_code AS SITE_RAW_STATE_CODE,\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\n\t raw_country AS SITE_RAW_COUNTRY,\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\n\t raw_latitude AS SITE_RAW_LATITUDE,\n\t raw_longitude AS SITE_RAW_LONGITUDE,\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\n\t 'INITIALLOAD' AS FP_SITE_ID,\n\t site_id AS FS_SITE_ID      \nFROM Retail.v_hs_opc_tracking_incremental",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "HS_OPC_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "OPERATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ERP_SYSTEM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "COMP_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ENTERPRISE_FLAG",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TRAFFIC_SYSTEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "LIC_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_HS_OPC_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SetMaxHSTrackingID",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetMaxHSTrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "MaxHSOPCTrackingID",
							"value": {
								"value": "@activity('GetMaxHSTrackingID').output.firstRow.RETURN_VALUE_ARGUMENT",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"B_LOADID": {
						"type": "string"
					}
				},
				"variables": {
					"MaxHSOPCTrackingID": {
						"type": "Integer"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2025-02-24T05:45:17Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_ASH_REMOVE_SITE_TRACKING')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_HS_OPC_Tracking')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_TrackingWH')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LoadRecordsForSiteTrackingWHDeletion",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT SITE_ID\nFROM Retail.v_site_warehouse_changed",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "DELETE FROM dbo.ASH_REMOVE_SITE_TRACKING\nWHERE SITE_ID LIKE '%-WAREHOUSE'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_ASH_REMOVE_SITE_TRACKING",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_WH_LE_Tracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LoadRecordsForSiteTrackingWHDeletion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "SELECT \n     TRACKING.WH_LE_TRACKING_ID,\n     'WarehouseLegalEntityTracking' AS B_CLASSNAME,\n\t'HARD_DELETE' AS B_DELETETYPE,\n     CAST(NEWID() AS NVARCHAR(128)) AS B_DELETEOPERATION,\n     GETDATE() AS B_DELETEDATE,\n     'semadmin' AS B_DELETEAUTHOR\nFROM DBO.GD_WH_LE_TRACKING AS TRACKING\nINNER JOIN (SELECT * FROM DBO.ASH_REMOVE_SITE_TRACKING WHERE SITE_ID LIKE '%WAREHOUSE') AS REMOVEREC\n     ON TRACKING.FS_SITE_ID = REMOVEREC.SITE_ID",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETETYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_DELETEDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_DELETEAUTHOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_DELETEOPERATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetMax_WH_LE_TrackingID",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Delete_WH_LE_Tracking",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT INT\n\nEXECUTE dbo.GET_MAX_TRACKING_ID @TrackingIdType = 'WH_LE', @RETURN_VALUE_ARGUMENT=null\n\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Retail_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "SetMax_WH_LE_TrackingID",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetMax_WH_LE_TrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "MaxWHLETrackingID",
							"value": {
								"value": "@activity('GetMax_WH_LE_TrackingID').output.firstRow.RETURN_VALUE_ARGUMENT",
								"type": "Expression"
							}
						}
					},
					{
						"name": "LoadWHLETracking",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetMax_WH_LE_TrackingID",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@pipeline().parameters.B_LOADID",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT\n\t@{variables('MaxWHLETrackingID')} + ROW_NUMBER() OVER (PARTITION BY 1 order by site_id, legal_entity_id ) AS WH_LE_TRACKING_ID,\n    'WarehouseLegalEntityTracking' as B_CLASSNAME,\n\tGETDATE() AS B_CREDATE,\n\tGETDATE() AS B_UPDDATE,\n\t'semadmin' AS B_CREATOR,\n\tCAST(effective_start_date AS DATE) AS EFFECTIVE_START_DATE,\n\t--CAST(effective_end_date AS DATE) AS EFFECTIVE_END_DATE,\n\t site_name AS SITE_NAME,\n\t notes AS NOTES,\n\t legacy_location_id AS LEGACY_LOCATION_ID,\n\t os_id AS OS_ID,\n\t os_location_id AS OS_LOCATION_ID,\n\t raw_addr_line1 AS SITE_RAW_ADDR_LINE1,\n\t raw_addr_line2 AS SITE_RAW_ADDR_LINE2,\n\t raw_city AS SITE_RAW_CITY,\n\t raw_state AS SITE_RAW_STATE,\n\t raw_state_code AS SITE_RAW_STATE_CODE,\n\t raw_postal_code AS SITE_RAW_POSTAL_CODE,\n\t raw_country AS SITE_RAW_COUNTRY,\n\t raw_country_code AS SITE_RAW_COUNTRY_CODE,\n\t raw_latitude AS SITE_RAW_LATITUDE,\n\t raw_longitude AS SITE_RAW_LONGITUDE,\n\t legal_entity_id AS F_LEGAL_ENTITY_ID,\n\t 'INITIALLOAD' AS FP_SITE_ID,\n\t site_id AS FS_SITE_ID       \nFROM Retail.v_wh_le_tracking_incremental",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "WH_LE_TRACKING_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "EFFECTIVE_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NOTES",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "NOTES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_ADDR_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SITE_RAW_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SITE_RAW_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_RAW_LATITUDE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SITE_RAW_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LEGACY_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LEGACY_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OS_LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OS_LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "F_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FP_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FS_SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Semarchy_Staging",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_WH_LE_Tracking",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"B_LOADID": {
						"type": "string"
					}
				},
				"variables": {
					"MaxWHLETrackingID": {
						"type": "Integer"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:05Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_ASH_REMOVE_SITE_TRACKING')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_WH_LE_Tracking')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_W_SiteMaster_SemarchyStaging_Semarchy')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_WHSMST_STG_Semarchy",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set_LoadID_Variable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_LOADID",
										"value": {
											"value": "@variables('B_LOADID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select DISTINCT\nWarehouse_ID,\n[Description],\nSite_ID,\nwmaIntransitWarehouse as INTRANSIT_WAREHOUSE,\nwmaWarehouseType as WAREHOUSE_TYPE,\nwmaWarehouseOrderGroup as WAREHOUSE_ORDER_GROUP,\nwmaDefaultPortId as DEFAULT_PORT_ID,\nwmaPrinterName as PRINTER_NAME,\nwmaZebraPrinter as Zebra_printer,\nwmaSendBolsToManu as SEND_BOLS_TO_MANU,\nwmaOrderReleaseMin as ORDER_RELEASE_MIN,\nwmaAsOverhead as AS_OVERHEAD,\nwmaAsFreight as AS_FREIGHT,\nwmaContainerDirectWhse as CONTAINER_DIRECT_WHSE,\nacrec as Status,\npltLocationID as LOCATION_ID,\npltPartyID as PARTY_ID,\npaaAddress1 as ADDRESS1,\npaaAddress2 as ADDRESS2,\npaaCity as CITY,\npaaState as STATE,\npaaCountry as COUNTRY,\npaaGeocodeLatitude as GEOCODE_LATITUDE,\npaaGeocodeLongitude as GEOCODE_LONGITUDE,\npaaZipCode as ZIP_CODE,\npaaCountyCode as COUNTY_CODE,\ndtea as DATE_AND_TIME,\nB_CLASSNAME,\nB_CREDATE,B_CREATOR,B_UPDDATE,B_UPDATOR\n from [Wholesale].[WHSMST_VW]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_LOADID",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "Warehouse_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WAREHOUSE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Site_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "INTRANSIT_WAREHOUSE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "INTRANSIT_WAREHOUSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_TYPE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "WAREHOUSE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WAREHOUSE_ORDER_GROUP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "WAREHOUSE_ORDER_GROUP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DEFAULT_PORT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "DEFAULT_PORT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRINTER_NAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PRINTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SEND_BOLS_TO_MANU",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SEND_BOLS_TO_MANU",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ORDER_RELEASE_MIN",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ORDER_RELEASE_MIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AS_OVERHEAD",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AS_OVERHEAD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AS_FREIGHT",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AS_FREIGHT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTAINER_DIRECT_WHSE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "CONTAINER_DIRECT_WHSE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCATION_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "LOCATION_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PARTY_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PARTY_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ADDRESS1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ADDRESS2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STATE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GEOCODE_LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "GEOCODE_LATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GEOCODE_LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "GEOCODE_LONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ZIP_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZIP_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTY_CODE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "COUNTY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DATE_AND_TIME",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "DATE_AND_TIME",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Zebra_printer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZEBRA_PRINTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_WHSMST",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Wholesale_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"Tablename": "SA_WAREHOUSE_MASTER",
									"Schemaname": "dbo"
								}
							}
						]
					},
					{
						"name": "Load_PortMaster_STG_Semarchy",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_WHSMST_STG_Semarchy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "B_loadId",
										"value": {
											"value": "@variables('B_LOADID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select \r\nASHLEY_PORT_ID,\r\nACE_PORT_CODE,\r\n[Description],\r\nCITY,\r\nCountry_code,\r\nB_CLASSNAME,\r\nB_CREDATE,\r\nB_CREATOR,\r\nB_UPDDATE,\r\nB_UPDATOR\r\nfrom [Wholesale].[PortMaster_vw]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "masterDataHubStg",
										"type": "LinkedServiceReference"
									},
									"path": "test"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "B_loadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "ASHLEY_PORT_ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ASHLEY_PORT_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ACE_PORT_CODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ACE_PORT_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Country_code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_SemStaging_Portmaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Wholesale_SiteMaster",
								"type": "DatasetReference",
								"parameters": {
									"Tablename": "SA_PORT_MASTER",
									"Schemaname": "dbo"
								}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\nEXECUTE [dbo].[GET_NEW_LOADID]\n@RETURN_VALUE_ARGUMENT OUTPUT\n,@P_DATA_LOCATION_NAME = 'Wholesale_SiteMaster'\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\n,@P_USERNAME = 'semadmin'\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set_LoadID_Variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "B_LOADID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoadID",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_PortMaster_STG_Semarchy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "PortWarehouseLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('B_LOADID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_WHSMST",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_WHSMST_STG_Semarchy",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_WHSMST_STG_Semarchy').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_WHSMST_STG_Semarchy').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_WHSMST_STG_Semarchy').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_WHSMST_STG_Semarchy').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_WHSMST_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_PortMaster_STG_Semarchy",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_PortMaster_STG_Semarchy').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_PortMaster_STG_Semarchy').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_PortMaster_STG_Semarchy').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_PortMaster_STG_Semarchy').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"B_LOADID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Wholesale/W_SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/DS_WHSMST')]",
				"[concat(variables('factoryId'), '/datasets/DS_Wholesale_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/DS_SemStaging_Portmaster')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/MasterData_Validation_Flow')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Customer_Fake_Address",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "FakeAddressPhrase",
											"type": "String"
										},
										"sink": {
											"name": "FakeAddressPhrase",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Address_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Address",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Address_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Address",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AddressLine1",
											"type": "String"
										},
										"sink": {
											"name": "AddressLine1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Zipcode",
											"type": "String"
										},
										"sink": {
											"name": "Zipcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Address_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Address_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Address_Exact_Schema_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Email",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Address_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "FakeEmailPhrase",
											"type": "String"
										},
										"sink": {
											"name": "FakeEmailPhrase",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Email_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Email",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Email_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Email",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Email",
											"type": "String"
										},
										"sink": {
											"name": "Email",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Email_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Email_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Email_Exact_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Customer_Fake_Phone_Exact",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Email_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Phone",
											"type": "String"
										},
										"sink": {
											"name": "Phone",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CandidateType",
											"type": "String"
										},
										"sink": {
											"name": "CandidateType",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "CleanseFlag",
											"type": "String"
										},
										"sink": {
											"name": "CleanseFlag",
											"type": "Byte"
										}
									},
									{
										"source": {
											"name": "IsLoaded",
											"type": "String"
										},
										"sink": {
											"name": "IsLoaded",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "LoadedDate",
											"type": "String"
										},
										"sink": {
											"name": "LoadedDate",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Fake_Phone_Exact_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Customer_Fake_Phone_Exact",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.Customer_Fake_Phone_Exact_TableName",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "StageInitialLoadRetailChunkControl",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_Fake_Phone_Exact",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SeqID",
											"type": "String"
										},
										"sink": {
											"name": "SeqID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "FirstNameInitial",
											"type": "String"
										},
										"sink": {
											"name": "FirstNameInitial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "dtComplete",
											"type": "String"
										},
										"sink": {
											"name": "dtComplete",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "RunCount",
											"type": "String"
										},
										"sink": {
											"name": "RunCount",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "ProdCountDec2022",
											"type": "String"
										},
										"sink": {
											"name": "ProdCountDec2022",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "dtPrevious",
											"type": "String"
										},
										"sink": {
											"name": "dtPrevious",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "StageInitialLoadRetailChunkControl_Blob",
								"type": "DatasetReference",
								"parameters": {
									"ContainerName": {
										"value": "@pipeline().parameters.ContainerName",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "StageInitialLoadRetailChunkControl",
								"type": "DatasetReference",
								"parameters": {
									"Schema": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_Schema",
										"type": "Expression"
									},
									"TableName": {
										"value": "@pipeline().parameters.StageInitialLoadRetailChunkControl_TableName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"Customer_Fake_Address_FileName": {
						"type": "String"
					},
					"Customer_Fake_Address_Schema": {
						"type": "String"
					},
					"Customer_Fake_Address_TableName": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_Schema_TableName": {
						"type": "String"
					},
					"Customer_Fake_Address_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_Schema": {
						"type": "String"
					},
					"Customer_Fake_Email_TableName": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Email_Exact_TableName": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_FileName": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_Schema": {
						"type": "String"
					},
					"Customer_Fake_Phone_Exact_TableName": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_FileName": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_Schema": {
						"type": "String"
					},
					"StageInitialLoadRetailChunkControl_TableName": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:55Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Address_Blob')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Address')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Address_Exact_Blob')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Address_Exact')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Email_Blob')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Email')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Email_Exact_Blob')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Email_Exact')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Phone_Exact_Blob')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Fake_Phone_Exact')]",
				"[concat(variables('factoryId'), '/datasets/StageInitialLoadRetailChunkControl_Blob')]",
				"[concat(variables('factoryId'), '/datasets/StageInitialLoadRetailChunkControl')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_For_Dynamics_PostalCodes')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GD_GBL_DYNAMICS_US",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as zipZctyab\n,left(CITY_NAME,25) as zipZctynm\n,case when COUNTRY_CODE='US' then 'USA' else COUNTRY_CODE end as zipZcountry\n,right(FIPS_Code,3) as zipZconyn\n,case when IS_PREFERRED_CITY_NAME='True' then 1\nelse 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as zipLat\n,cast(Longitude as decimal(8,4))as zipLong\n,case when MSA_CODE is not null then MSA_CODE\nelse '' end\nas zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as zipDayLightSavings\n,right(replicate('0',5)+ convert(varchar(5),POSTAL_CODE),5) as \n zipZzipcd\n,POSTAL_CODE_TYPE as zipType\n,STATE_OR_PROVINCE_CODE as zipZstate\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as zipTimeZoneCode,\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='US'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipDayLightSavings",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "zipDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipPreferred",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "zipPreferred",
											"type": "Boolean",
											"physicalType": "bit"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMGBLUS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_SQL_DYNAMICS_US",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_GBL_DYNAMICS_US",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as zipZctyab\n,left(CITY_NAME,25) as zipZctynm\n,case when COUNTRY_CODE='US' then 'USA' else COUNTRY_CODE end as zipZcountry\n,right(FIPS_Code,3) as zipZconyn\n,case when IS_PREFERRED_CITY_NAME='True' then 1\nelse 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as zipLat\n,cast(Longitude as decimal(8,4))as zipLong\n,case when MSA_CODE is not null then MSA_CODE\nelse '' end\nas zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as zipDayLightSavings\n,right(replicate('0',5)+ convert(varchar(5),POSTAL_CODE),5) as \n zipZzipcd\n,case when POSTAL_CODE_TYPE is null then '' \nelse POSTAL_CODE_TYPE end as zipType\n,STATE_OR_PROVINCE_CODE as zipZstate\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as zipTimeZoneCode,\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='US'\n\n\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipZzipcd",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZstate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctynm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZctyab",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipZconyn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipZcountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipTimeZoneCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipDayLightSavings",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "zipDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "zipLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "zipLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "zipPreferred",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "zipPreferred",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "zipType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "zipType",
											"type": "String",
											"physicalType": "char"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMSTGUSSQLDYNAMICS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_GBL_DYNAMICS_CAN",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_SQL_DYNAMICS_US",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as [znuCityAbbrev]\n,left(CITY_NAME,30) as [znuCity]\n,case when COUNTRY_CODE='CA' then 'CAN' else COUNTRY_CODE end as [znuCountryCode]\n--,right(FIPS_Code,3) as zipZconyn\n--,case when IS_PREFERRED_CITY_NAME='True' then 1\n--else 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as [znuLat]\n,cast(Longitude as decimal(8,4))as [znuLong]\n--,case when MSA_CODE is not null then MSA_CODE\n--else '' end as zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as [znuDayLightSavings]\n,concat(left(postal_code,3),' ',right(postal_code,3)) as\n[znuPostalCode]\n--,POSTAL_CODE_TYPE as zipType\n,case when \nSTATE_OR_PROVINCE_CODE ='NL' then 'NF' else STATE_OR_PROVINCE_CODE end as [znuProvince]\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as [znuTimeZone],\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='CA'\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMSTGGBLDYNAMICSCAN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GD_SQL_DYNAMICS_CAN",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GD_GBL_DYNAMICS_CAN",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select \ncase when CITY_ABBREVIATION is not null then \nleft(CITY_ABBREVIATION,10) \nelse '' end as [znuCityAbbrev]\n,left(CITY_NAME,30) as [znuCity]\n,case when COUNTRY_CODE='CA' then 'CAN' else COUNTRY_CODE end as [znuCountryCode]\n--,right(FIPS_Code,3) as zipZconyn\n--,case when IS_PREFERRED_CITY_NAME='True' then 1\n--else 0 end as zipPreferred\n,cast(Latitude as decimal(7,4) )as [znuLat]\n,cast(Longitude as decimal(8,4))as [znuLong]\n--,case when MSA_CODE is not null then MSA_CODE\n--else '' end as zipMSA\n,case when OBSERVES_DST=1 then 'Y' \nelse 'N' end as [znuDayLightSavings]\n,concat(left(postal_code,3),' ',right(postal_code,3)) as\n[znuPostalCode]\n--,POSTAL_CODE_TYPE as zipType\n,case when \nSTATE_OR_PROVINCE_CODE ='NL' then 'NF' else STATE_OR_PROVINCE_CODE end as [znuProvince]\n,case when Time_Zone='UTC-03:00' then 'EST+2'\n when Time_Zone='UTC-03:30' then 'NST'\n when Time_Zone='UTC-04:00' then 'EST+1'\n when Time_Zone='UTC-05:00' then 'EST'\n when Time_Zone='UTC-06:00' then 'CST'\n when Time_Zone='UTC-07:00' then 'MST'\n when Time_Zone='UTC-08:00' then 'PST'\n when Time_Zone='UTC-09:00' then 'PST-1'\n when Time_Zone='UTC-10:00' then 'PST-2'\n when Time_Zone='UTC-11:00' then 'PST-3'\n when Time_Zone='UTC+01:00' then 'GMT+1'\n when Time_Zone='UTC+09:00' then 'PST-7'\n when Time_Zone='UTC+10:00' then 'PST-6'\n when Time_Zone='UTC+11:00' then 'PST-5'\n when Time_Zone='UTC+12:00' then 'PST-4'\nelse '' end as [znuTimeZone],\n'edme_initial' as usrc,\ngetutcdate() as dtec,\ngetutcdate() as dtea,\n'edme_initial' as usra,\nnull as acrec\nfrom [GD_ENT_REF_POSTAL_CODE] GD\nwhere GD.COUNTRY_CODE='CA'\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuPostalCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuProvince",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCountryCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "znuCityAbbrev",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "znuDayLightSavings",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "znuLat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "znuLong",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "smalldatetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": true
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DSSEMSTGSQLDYNAMICSCAN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2024-05-22T18:40:49Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/DSSEMGBLUS')]",
				"[concat(variables('factoryId'), '/datasets/DSSEMSTGUSSQLDYNAMICS')]",
				"[concat(variables('factoryId'), '/datasets/DSSEMSTGGBLDYNAMICSCAN')]",
				"[concat(variables('factoryId'), '/datasets/DSSEMSTGSQLDYNAMICSCAN')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_PostalCode')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Mtce_Stage_PostalCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT * FROM [dbo].[GD_ENT_REF_POSTAL_CODE]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE Scratch.GD_ENT_REF_POSTAL_CODE",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "ENT_REF_POSTAL_CODE_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "B_BATCHID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_UPDDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CREATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_UPDATOR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STATE_OR_PROVINCE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CITY_ABBREVIATION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "TIME_ZONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OBSERVES_DST",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "OBSERVES_DST",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										},
										"sink": {
											"name": "LATITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										},
										"sink": {
											"name": "LONGITUDE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "IS_PREFERRED_CITY_NAME",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "POSTAL_CODE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MSA_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FIPS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GD_Enterprise_REF_TABLE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Scratch_GD_ENT_REF_POSTAL_CODE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-26T17:07:17Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/GD_Enterprise_REF_TABLE')]",
				"[concat(variables('factoryId'), '/datasets/Scratch_GD_ENT_REF_POSTAL_CODE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mtce_Stage_SiteMaster_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetJsongFilesList",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Store_Details_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "JsonReadSettings"
							}
						}
					},
					{
						"name": "LoadJsonFiles",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "GetJsongFilesList",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('GetJsongFilesList').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "GetJsoncontains",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"dataset": {
											"referenceName": "Fetch_Location_Json",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									}
								},
								{
									"name": "LoadJsonContainsToJsonPayLoad",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "GetJsoncontains",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('GetJsoncontains').output.firstRow}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@{activity('GetJsoncontains').output.firstRow.LocationID}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:05Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Store_Details_Files')]",
				"[concat(variables('factoryId'), '/datasets/Fetch_Location_Json')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Notify_Teams_Channale_Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set_Webhook_JSON_Schema",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "messageCard",
							"value": {
								"value": "{\n    \"@type\": \"MessageCard\",\n    \"@context\": \"http://schema.org/extensions\",\n    \"themeColor\": \"0076D7\",\n    \"summary\": \"Pipeline status alert message\",\n    \"sections\": [\n        {\n            \"activityTitle\": \"Pipeline execution alert\",\n            \"facts\": [\n                {\n                    \"name\": \"Subscription Id:\",\n                    \"value\": \"@{pipeline().parameters.subscription}\"\n                },\n                {\n                    \"name\": \"Resource Group:\",\n                    \"value\": \"@{pipeline().parameters.resourceGroup}\"\n                },\n                {\n                    \"name\": \"Data Factory Name:\",\n                    \"value\": \"@{pipeline().DataFactory}\"\n                },\n                {\n                    \"name\": \"Pipeline RunId:\",\n                    \"value\": \"@{pipeline().parameters.runId}\"\n                },\n                {\n                    \"name\": \"Pipline Name:\",\n                    \"value\": \"@{pipeline().parameters.name}\"\n                },\n                {\n                    \"name\": \"Pipeline Status:\",\n                    \"value\": \"@{pipeline().parameters.status}\"\n                },\n                {\n                    \"name\": \"Execution Start Time (UTC):\",\n                    \"value\": \"@{pipeline().parameters.triggerTime}\"\n                },\n                {\n                    \"name\": \"Execution Finish Time (UTC):\",\n                    \"value\": \"@{pipeline().parameters.executionEndTime}\"\n                },\n                {\n                    \"name\": \"Execution Duration (s):\",\n                    \"value\": \"@{pipeline().parameters.runDuration}\"\n                },\n                {\n                    \"name\": \"Message:\",\n                    \"value\": \"@{pipeline().parameters.message}\"\n                },\n                {\n                    \"name\": \"Notification Time (UTC):\",\n                    \"value\": \"@{utcnow()}\"\n                }\n            ],\n            \"markdown\": true\n        }\n    ],\n    \"potentialAction\": [\n        {\n            \"@type\": \"OpenUri\",\n            \"name\": \"View pipeline run\",\n            \"targets\": [\n                {\n                    \"os\": \"default\",\n                    \"uri\": \"@{concat('https://adf.azure.com/monitoring/pipelineruns/',pipeline().parameters.runId,'?factory=/subscriptions/',pipeline().parameters.subscription,'/resourceGroups/',pipeline().parameters.resourceGroup,'/providers/Microsoft.DataFactory/factories/',pipeline().DataFactory)}\"\n                }\n            ]\n        }\n    ]\n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Invoke_Teams_Webhook_Url",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set_Webhook_JSON_Schema",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {},
							"url": {
								"value": "@pipeline().parameters.teamWebhookUrl",
								"type": "Expression"
							},
							"body": {
								"value": "@json(variables('messageCard'))",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"subscription": {
						"type": "string"
					},
					"resourceGroup": {
						"type": "string"
					},
					"runId": {
						"type": "string"
					},
					"name": {
						"type": "string"
					},
					"triggerTime": {
						"type": "string"
					},
					"status": {
						"type": "string"
					},
					"message": {
						"type": "string"
					},
					"executionEndTime": {
						"type": "string"
					},
					"runDuration": {
						"type": "string"
					},
					"teamWebhookUrl": {
						"type": "string"
					}
				},
				"variables": {
					"messageCard": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:05Z"
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Containerrate_WHSMST_PortMaster')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_W_SiteMaster_SemarchyStaging_Semarchy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_W_SiteMaster_SemarchyStaging_Semarchy",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification_WHSMST",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_WHSMST_copy1_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_W_SiteMaster_SemarchyStaging_Semarchy",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_W_SiteMaster_SemarchyStaging_Semarchy').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_W_SiteMaster_SemarchyStaging_Semarchy').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_W_SiteMaster_SemarchyStaging_Semarchy').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_W_SiteMaster_SemarchyStaging_Semarchy').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Wholesale/W_SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:28Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl')]",
				"[concat(variables('factoryId'), '/pipelines/Load_W_SiteMaster_SemarchyStaging_Semarchy')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Load_EnterpriseRef')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_EnterpriseRef_Country",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_Country_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Country_Table_Name": {
									"value": "@pipeline().parameters.Sink_Country_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.Country_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Country_Class_Name": {
									"value": "@pipeline().parameters.Country_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_Currency_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_Currency_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Currency_Table_Name": {
									"value": "@pipeline().parameters.Sink_Currency_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.Currency_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Currency_Class_Name": {
									"value": "@pipeline().parameters.Currency_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_DMA_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_DMA_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Dma_Table_Name": {
									"value": "@pipeline().parameters.Sink_Dma_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.DMA_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Dma_Class_Name": {
									"value": "@pipeline().parameters.Dma_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Time_Zone_Table_Name": {
									"value": "@pipeline().parameters.Sink_Time_Zone_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.TimeZone_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Time_Zone_Class_Name": {
									"value": "@pipeline().parameters.Time_Zone_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_Time_Zone_EFF_DT_Table_Name": {
									"value": "@pipeline().parameters.Sink_Time_Zone_EFF_DT_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.TimeZoneEF_Semarchy_Job_Name",
									"type": "Expression"
								},
								"Time_Zone_EFF_DT_Class_Name": {
									"value": "@pipeline().parameters.Time_Zone_EFF_DT_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_EnterpriseRef_US_STATE_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Database_Name": {
									"value": "@pipeline().parameters.Database_Name",
									"type": "Expression"
								},
								"Sink_US_State_Table_Name": {
									"value": "@pipeline().parameters.Sink_US_State_Table_Name",
									"type": "Expression"
								},
								"Semarchy_Job_Name": {
									"value": "@pipeline().parameters.USState_Semarchy_Job_Name",
									"type": "Expression"
								},
								"US_State_Class_Name": {
									"value": "@pipeline().parameters.US_State_Class_Name",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CountryLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_Country').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_Country').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_Country').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_Country').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_Country').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_Country').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_Country').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_CurrencyLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_Currency_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_DMALoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_DMA_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_TimeZoneLoad_copy1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_TimeZoneEFFLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_USStateLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Country_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Country",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_Country').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Country').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Currency_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_Currency_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_Currency_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_Currency_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DMA_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_DMA_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_DMA_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_DMA_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Time_Zone_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "TimeZone_EFF_DT_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "USState_StoreErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_EnterpriseRef_US_STATE_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_EnterpriseRef_US_STATE_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_EnterpriseRef_US_STATE_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Sink_US_State_Table_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_EFF_DT_Table_Name": {
						"type": "string"
					},
					"Sink_Time_Zone_Table_Name": {
						"type": "string"
					},
					"Sink_Currency_Table_Name": {
						"type": "string"
					},
					"Sink_Country_Table_Name": {
						"type": "string"
					},
					"Sink_Dma_Table_Name": {
						"type": "string"
					},
					"Country_Class_Name": {
						"type": "string"
					},
					"Currency_Class_Name": {
						"type": "string"
					},
					"Dma_Class_Name": {
						"type": "string"
					},
					"Time_Zone_Class_Name": {
						"type": "string"
					},
					"Time_Zone_EFF_DT_Class_Name": {
						"type": "string"
					},
					"US_State_Class_Name": {
						"type": "string"
					},
					"Country_Semarchy_Job_Name": {
						"type": "string"
					},
					"Currency_Semarchy_Job_Name": {
						"type": "string"
					},
					"DMA_Semarchy_Job_Name": {
						"type": "string"
					},
					"TimeZone_Semarchy_Job_Name": {
						"type": "string"
					},
					"TimeZoneEF_Semarchy_Job_Name": {
						"type": "string"
					},
					"USState_Semarchy_Job_Name": {
						"type": "string"
					}
				},
				"folder": {
					"name": "EnterPriceRef_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:17:03Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_EnterpriseRef_Country_InitialLoad')]",
				"[concat(variables('factoryId'), '/pipelines/Load_EnterpriseRef_Currency_InitialLoad')]",
				"[concat(variables('factoryId'), '/pipelines/Load_EnterpriseRef_DMA_InitialLoad')]",
				"[concat(variables('factoryId'), '/pipelines/Load_EnterpriseRef_TIME_ZONE_InitialLoad')]",
				"[concat(variables('factoryId'), '/pipelines/Load_EnterpriseRef_TIME_ZONE_EFF_DT_InitialLoad')]",
				"[concat(variables('factoryId'), '/pipelines/Load_EnterpriseRef_US_STATE_InitialLoad')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Load_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_RetailCustomer_RetailCustomerLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_RetailCustomer_RetailCustomerLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification_Load_RetailCustomer",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_RetailCustomer_RetailCustomerLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_RetailCustomer_RetailCustomerLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_RetailCustomer_RetailCustomerLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_RetailCustomer_RetailCustomerLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_RetailCustomer_RetailCustomerLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_RetailCustomer_RetailCustomerLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_RetailCustomer_RetailCustomerLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_RetailCustomer_RetailCustomerLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_RetailCustomer_RetailCustomerLoad_Incremental",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification_Load_RFD_RetailCustomer",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_RetailCustomer_RetailCustomerLoad_Incremental')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/pipelines/Load_GetEntity_RCM_RFD_RetailCustomerLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Load_Retail_ProductMasterLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_Retail_PIM_EDW_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_Retail_PIM_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_ProductMasterLoad_Retail_PIM_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_EDW').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg_InitialLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_Retail_PIM_EDW_InitialLoad').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_InitialLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW_InitialLoad",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_EDW_InitialLoad').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_EDW_InitialLoad').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_MasterLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_Retail_PIM_EDW",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_Retail_PIM_EDW').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_Retail_PIM_EDW').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_Retail_PIM_EDW').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_Retail_PIM_EDW').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_Retail_PIM_EDW').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_Retail_PIM_EDW').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_Retail_PIM_EDW').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad')]",
				"[concat(variables('factoryId'), '/pipelines/Load_ProductMasterLoad_Retail_PIM_EDW')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_National_Assortment_SemarchyToEDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_National_Assortment_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_National_Assortment_SemarchyToEDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_Historical_National_Assortment_SemarchyToEDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_National_Assortment_SemarchyToEDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_Historical_National_Assortment_SemarchyToEDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2023-10-12T06:28:35Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_National_Assortment_SemarchyToEDW')]",
				"[concat(variables('factoryId'), '/pipelines/Load_Historical_National_Assortment_SemarchyToEDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_PostalCode_ReferenceDataLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"US_PostalCode_FileName": {
									"value": "@pipeline().parameters.US_PostalCode_FileName",
									"type": "Expression"
								},
								"CANADA_PostalCode_FileName": {
									"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load_PostalCode_ReferenceDataLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_PostalCode_EnterpriseRefPostalCodeLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification_Stage_PostalCode_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_PostalCode_ReferenceDataLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_PostalCode_ReferenceDataLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Teams_Failed_Notification_Load_PostalCode_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_PostalCode_ReferenceDataLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_PostalCode_ReferenceDataLoad_Incremental').error.message,'\"','')\n",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_PostalCode_ReferenceDataLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "z5max.txt"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "PCensusNWE.csv"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_PostalCode_ReferenceDataLoad_Incremental')]",
				"[concat(variables('factoryId'), '/pipelines/Load_PostalCode_EnterpriseRefPostalCodeLoad_Incremental')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_ProductMasterLoad_PIM_RPM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load_ProductMaster_PIM_RPM",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_ProductMaster_Retail_PIM_RPM",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "SPCallStoreDetailsErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_ProductMaster_PIM_RPM",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Load_ProductMaster_PIM_RPM').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Load_ProductMaster_PIM_RPM').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Load_ProductMaster_PIM_RPM').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Load_ProductMaster_PIM_RPM').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_MasterLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_ProductMaster_PIM_RPM",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@activity('Load_ProductMaster_PIM_RPM').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Load_ProductMaster_PIM_RPM').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Load_ProductMaster_PIM_RPM').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_ProductMaster_PIM_RPM').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Load_ProductMaster_PIM_RPM').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_ProductMaster_PIM_RPM').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_ProductMaster_PIM_RPM').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-02-03T21:58:11Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_ProductMaster_Retail_PIM_RPM')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_RetailCustomer_CommunicationPreferenceLoad",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_RetailCustomer_CommunicationPreferenceLoad",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_RetailCustomer_CommunicationPreferenceLoad",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_RetailCustomer_CommunicationPreferenceLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:17:03Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
				"[concat(variables('factoryId'), '/pipelines/Load_RetailCustomer_CommunicationPreferenceLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_SiteMaster_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_EDW",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_SiteMaster_Mappings",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_EDW",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_RDC_Smartsheet",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_RDC_Smartsheet",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_SiteMaster_Mappings",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Storemaster_Smartsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_SiteMaster_Mappings_Automate",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Stage_Storemaster_Smartsheet",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_RDC_Smartsheet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Storemaster_Smartsheet",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_incremental_Warehouse",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_EDW",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_SiteMaster_Incremental_WareHouse",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Load_Incremental_StoreMaster",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Wait1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_SiteMaster_Incremental_StoreMaster",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "usp_RDC_Masterlist_ARCHIVE",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load_Incremental_StoreMaster",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[usp_RDC_Masterlist_ARCHIVE]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "usp_STORE_MASTER_ARCHIVE",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "usp_RDC_Masterlist_ARCHIVE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[usp_STORE_MASTER_ARCHIVE]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Wait1",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Load_incremental_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 30
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:57Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_EDW')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_RDC_Smartsheet')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_Mappings_Automate')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Storemaster_Smartsheet')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Incremental_WareHouse')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Incremental_StoreMaster')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Orchestrate_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Teams_Failed_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_RetailCustomerLoad_Incremental",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').output['pipelineRunId']",
									"type": "Expression"
								},
								"name": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').output['pipelineName']",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Stage_Retail_Customer_RetailCustomerLoad_Incremental').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:17:03Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Province_Code_Validation')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LUP_STATEORPROVINCECODE",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Concate_Postal_code",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select Count(*) as STATE_OR_PROVINCE_CODE from [Ref_PostalCode].[PostalCode]   WHERE COUNTRY_CODE = 'CA' AND STATE_OR_PROVINCE_CODE = '--'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_postalcode_StateOrProvinceCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "CHK_PROVINCE_CODE",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "LUP_STATEORPROVINCECODE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('LUP_STATEORPROVINCECODE').output.firstRow.STATE_OR_PROVINCE_CODE, 0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "NoActionRequired",
									"description": "NoActionRequired",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "NoActionRequired",
										"value": {
											"value": "NoActionRequired",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Notification_State_Or_Provencecode",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "'STATE_OR_PROVINCE_CODE having --'",
												"type": "Expression"
											},
											"status": {
												"value": "'LUP_STATEORPROVINCECODE'",
												"type": "Expression"
											},
											"message": {
												"value": "@{concat('The following PostalCodes not assigned the STATE_OR_PROVINCE_CODE: ', variables('Concate_Postal'))}",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@{utcnow()}",
												"type": "Expression"
											},
											"runDuration": {
												"value": "''",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "LUP_STATEORPROVINCECODE_Value",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "Select Postal_code from [Ref_PostalCode].[PostalCode]   WHERE COUNTRY_CODE = 'CA' AND \nSTATE_OR_PROVINCE_CODE = '--'\n\nselect 1 as ret",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ds_postalcode_StateOrProvinceCode",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Postal_Code_Append",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "LUP_STATEORPROVINCECODE_Value",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@array(activity('LUP_STATEORPROVINCECODE_Value').output.value)",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Append_Postalcodes",
									"description": "Append_Postalcodes",
									"type": "AppendVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Append_PC",
										"value": {
											"value": "@item().Postal_code",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Concate_Postal_code",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Postal_Code_Append",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Concate_Postal",
							"value": {
								"value": "@{join(variables('Append_PC'), ', ')}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"NoActionRequired": {
						"type": "String"
					},
					"notificaon": {
						"type": "String"
					},
					"Concate_Postal": {
						"type": "String"
					},
					"Append_PC": {
						"type": "Array"
					},
					"StateOrProvinceCode": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-20T05:23:12Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/ds_postalcode_StateOrProvinceCode')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ReProcess_ErrorFiles_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move_Error_Container_Files",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"wildcardFolderPath": "Error",
									"wildcardFileName": {
										"value": "*.csv",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Error_Files_From_ErrorFolder",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Move_Error_Files_RetailCustomer_Container",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Remove_Error_Files_From_ErrorFolder",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": false,
								"wildcardFileName": {
									"value": "*.csv",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Error_Folder_Reprocess_Error_Logs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Move_Error_Container_Files').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Reprocess_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Move_Error_Container_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": null,
									"type": "Int32"
								},
								"RowsRead": {
									"value": null,
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "@concat('retail-customer/','Files')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "@concat('retail-customer/Error/','*.csv')",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Move_Error_Container_Files').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"FileCheck": {
						"type": "String"
					},
					"TableSchema": {
						"type": "String"
					},
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Error_Files_From_ErrorFolder')]",
				"[concat(variables('factoryId'), '/datasets/Move_Error_Files_RetailCustomer_Container')]",
				"[concat(variables('factoryId'), '/datasets/Remove_Error_Files')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Remove_RetailCustomerLoad_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Remove_Archive_Files",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Remove_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@adddays(startOfDay(utcnow()),-100)",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@adddays(startOfDay(utcnow()),-20)",
									"type": "Expression"
								},
								"wildcardFileName": "*.csv",
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:54Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Remove_Archive_Files')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Incremental_SiteMaster_Mappings')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Assign_new_legalEntity_Id",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Assign_new_legalEntity_Id_Warehouse",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Load Legal entity id to new Licensee"
							}
						],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[StoreMasterCustom_Sites_JoinCodes]\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Assign_new_legalEntity_Id_Warehouse",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Load Legal entity id to new Licensee"
							}
						],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_WH_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Assign_new_legalEntity_Id",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE EDW.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/Retail_StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_LegalEntities_CompanyCodes')]",
				"[concat(variables('factoryId'), '/datasets/EDW_StoreMasterCustom_LegalEntities_CompanyCodes')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCodeAutomation_US')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Getlicensekey_Melissa",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "To get license key from KV"
							}
						],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"url": {
								"value": "@pipeline().globalParameters.Melissa_LicenseKey",
								"type": "Expression"
							},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "Set Licensekey",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Getlicensekey_Melissa",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set License key to variable"
							}
						],
						"typeProperties": {
							"variableName": "license_key",
							"value": {
								"value": "@activity('Getlicensekey_Melissa').output.value",
								"type": "Expression"
							}
						}
					},
					{
						"name": "GetFilelist",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set Licensekey",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Get folder available list from Release URL"
							}
						],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"httpRequestTimeout": "00:10:00",
							"url": {
								"value": "@concat('https://releases.melissadata.net/releases/data/z5max.txt?FORMAT=JSON&ID=',variables('license_key'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Filter_LatestFileProcessed",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Set ProcessedForYearMonth",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [
							{
								"name": "Task",
								"value": "Filter latest file to be processed in this run"
							}
						],
						"typeProperties": {
							"items": {
								"value": "@variables('parsedatelist')",
								"type": "Expression"
							},
							"condition": {
								"value": "@greater(item(), variables('Processed_for_YrMonth_lkp'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Datelist",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetFilelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set Folderlist to variable"
							}
						],
						"typeProperties": {
							"variableName": "datelist",
							"value": {
								"value": "@activity('GetFilelist').output.Response",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set parsedatelist",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Datelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Parse Json to array"
							}
						],
						"typeProperties": {
							"variableName": "parsedatelist",
							"value": {
								"value": "@json(variables('datelist'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup_LastFileProcessed",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set parsedatelist",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Get processed file list from previous run"
							}
						],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select max(Processed_for_YrMonth) as Processed_for_YrMonth from Retail.Postalcode_Processed_files",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Postalcode_Processed_files",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Set ProcessedForYearMonth",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_LastFileProcessed",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "Set previously processed file to variable"
							}
						],
						"typeProperties": {
							"variableName": "Processed_for_YrMonth_lkp",
							"value": {
								"value": "@activity('Lookup_LastFileProcessed').output.firstRow.Processed_for_YrMonth\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter_LatestFileProcessed",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [
							{
								"name": "Task",
								"value": "For each Files"
							}
						],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter_LatestFileProcessed').output.Value\n",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "If Condition1",
									"type": "IfCondition",
									"dependsOn": [
										{
											"activity": "Set variable",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [
										{
											"name": "Task",
											"value": "Will execute if latest file from Release url > previously processed file"
										}
									],
									"typeProperties": {
										"expression": {
											"value": "@greater(length(activity('Filter_LatestFileProcessed').output.value),0)\n",
											"type": "Expression"
										},
										"ifFalseActivities": [
											{
												"name": "Teams_Failed_Notification_PostalCode",
												"type": "ExecutePipeline",
												"dependsOn": [],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team "
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Filter_LatestFileProcessed').output.executionDetails[0].start\n",
															"type": "Expression"
														},
														"status": {
															"value": "'Success'",
															"type": "Expression"
														},
														"message": {
															"value": "'Not yet received Melissa data'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Filter_LatestFileProcessed').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
															"type": "Expression"
														}
													}
												}
											}
										],
										"ifTrueActivities": [
											{
												"name": "Set variable2",
												"type": "SetVariable",
												"dependsOn": [],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Set new file to be processed"
													}
												],
												"typeProperties": {
													"variableName": "New_processed_YearMonth",
													"value": {
														"value": "@item()",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Copy_PostalCode_US",
												"type": "Copy",
												"dependsOn": [
													{
														"activity": "Set variable2",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "0.10:00:00",
													"retry": 2,
													"retryIntervalInSeconds": 60,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Copy File from download URL to Blob container"
													}
												],
												"typeProperties": {
													"source": {
														"type": "HttpSource",
														"httpRequestTimeout": "00:01:40"
													},
													"sink": {
														"type": "BinarySink",
														"storeSettings": {
															"type": "AzureBlobFSWriteSettings"
														}
													},
													"enableStaging": false
												},
												"inputs": [
													{
														"referenceName": "HttpDataset2",
														"type": "DatasetReference",
														"parameters": {
															"ID": {
																"value": "@variables('license_key')",
																"type": "Expression"
															},
															"Currentmonthyear": {
																"value": "@variables('New_processed_YearMonth')",
																"type": "Expression"
															}
														}
													}
												],
												"outputs": [
													{
														"referenceName": "DS_PostalCode_US",
														"type": "DatasetReference",
														"parameters": {
															"Filename": {
																"value": "@concat('z5max','.txt')",
																"type": "Expression"
															},
															"FolderName": {
																"value": "@pipeline().parameters.FolderName",
																"type": "Expression"
															}
														}
													}
												]
											},
											{
												"name": "Teams_Success_Notification_PostalCode_copy1",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Script1",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team about new file processed"
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Copy_PostalCode_US').output.executionDetails[0].start",
															"type": "Expression"
														},
														"status": {
															"value": "@activity('Copy_PostalCode_US').output.executionDetails[0].status",
															"type": "Expression"
														},
														"message": {
															"value": "'Postal codes file available in blob container'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Copy_PostalCode_US').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
															"type": "Expression"
														}
													}
												}
											},
											{
												"name": "Script1",
												"type": "Script",
												"dependsOn": [
													{
														"activity": "Set ApiPath",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "0.12:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Update file processed to Retail.Postalcode_Processed_files table"
													}
												],
												"linkedServiceName": {
													"referenceName": "semarchy_staging",
													"type": "LinkedServiceReference"
												},
												"typeProperties": {
													"scripts": [
														{
															"type": "Query",
															"text": {
																"value": "@concat('INSERT INTO Retail.Postalcode_Processed_files ',\n'(',\n'Country, ',\n'API_path, ',\n'Processed_date, ',\n'Processed_for_YrMonth',\n') ',\n'VALUES ',\n'(',\n'''US'', ',\n'''', variables('Api_Path'), ''', ',\n'GETDATE(), ',\n'''', variables('New_processed_YearMonth'), '''',\n')'\n)",
																"type": "Expression"
															}
														}
													],
													"scriptBlockExecutionTimeout": "02:00:00"
												}
											},
											{
												"name": "Set ApiPath",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "Copy_PostalCode_US",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Set API path"
													}
												],
												"typeProperties": {
													"variableName": "Api_Path",
													"value": {
														"value": "@concat('https://releases.melissadata.net/Download/Data/',variables('New_processed_YearMonth'),'/z5max.txt?ID={{licenseKey}}')",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Teams_Failed_Notification_PostalCode_Failed",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Copy_PostalCode_US",
														"dependencyConditions": [
															"Failed"
														]
													}
												],
												"policy": {
													"secureInput": false
												},
												"userProperties": [
													{
														"name": "Task",
														"value": "Notify Team "
													}
												],
												"typeProperties": {
													"pipeline": {
														"referenceName": "Notify_Teams_Channale_Pipeline",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"subscription": {
															"value": "@pipeline().globalParameters.ADF_SubscriptionID",
															"type": "Expression"
														},
														"resourceGroup": "afi-edme-rg",
														"runId": {
															"value": "@pipeline().RunId",
															"type": "Expression"
														},
														"name": {
															"value": "@pipeline().Pipeline",
															"type": "Expression"
														},
														"triggerTime": {
															"value": "@activity('Filter_LatestFileProcessed').output.executionDetails[0].start\n",
															"type": "Expression"
														},
														"status": {
															"value": "'Failure'",
															"type": "Expression"
														},
														"message": {
															"value": "'File Copy failed . Please have a look'",
															"type": "Expression"
														},
														"executionEndTime": {
															"value": "@{utcnow()}",
															"type": "Expression"
														},
														"runDuration": {
															"value": "@activity('Filter_LatestFileProcessed').output.copyDuration",
															"type": "Expression"
														},
														"teamWebhookUrl": {
															"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
															"type": "Expression"
														}
													}
												}
											}
										]
									}
								},
								{
									"name": "Set variable",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Task",
											"value": "Latest file from Release URL"
										}
									],
									"typeProperties": {
										"variableName": "New_processed_YearMonth",
										"value": {
											"value": "@item()",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"FolderName": {
						"type": "string",
						"defaultValue": "Postal_Code_Source_Files"
					},
					"GetLicensekey": {
						"type": "string",
						"defaultValue": "https://afide-edmekv.vault.azure.net/secrets/melissa-data-license-key/b0d3207214ea4b0b9fef24ac132a17e1?api-version=7.0"
					}
				},
				"variables": {
					"license_key": {
						"type": "String"
					},
					"folder": {
						"type": "Array"
					},
					"datelist": {
						"type": "String"
					},
					"parsedatelist": {
						"type": "Array"
					},
					"dummy": {
						"type": "String"
					},
					"Processed_for_YrMonth_lkp": {
						"type": "String"
					},
					"Api_Path": {
						"type": "String"
					},
					"insert_stmt": {
						"type": "String"
					},
					"New_processed_YearMonth": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:55Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/DS_Postalcode_Processed_files')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/HttpDataset2')]",
				"[concat(variables('factoryId'), '/datasets/DS_PostalCode_US')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCode_ReferenceDataLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "US_Postal_Code",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "US"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ST",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ZIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "A/C",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "FIPS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "County",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "County",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Pref?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Pref",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "T/Z",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TZ",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DST?",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Lat",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Lat",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Long",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Long",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "MSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PMSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Abbreviation",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CBSA",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Div",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Div",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Population",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Population",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USA_Zip_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_USA": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "US_Zip_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CANADA_Postal_Code",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "CountryCode",
										"value": "CA"
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PostCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Latitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Longitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 9
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Province",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Province",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CityAlt",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Neighborhood",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Time Zone",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Area Code",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Canada_Postal_Code_File",
								"type": "DatasetReference",
								"parameters": {
									"filename_canada": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "CANADA_Postal_Code_Table",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": "*.*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_Code_Archive",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Postal_Code_Succeed_Files_Delete",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": "*.*",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.US_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_US_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.US_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Error_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Postal_Code_Source_Files",
									"wildcardFileName": {
										"value": "@pipeline().parameters.CANADA_PostalCode_FileName",
										"type": "Expression"
									},
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Postal_code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_CANADA_Postal_Code_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_Error_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Postal_Code_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"wildcardFileName": {
									"value": "@{pipeline().parameters.CANADA_PostalCode_FileName}",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "US_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "US_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('US_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('US_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('US_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is US Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('US_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('US_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('US_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('US_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "US_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "US_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('US_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('US_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_failure_Notification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('CANADA_Postal_Code').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('CANADA_Postal_Code').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is Canada Postal Code Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('CANADA_Postal_Code').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CANADA_Postal_Code').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CANADA_Postal_Code').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('CANADA_Postal_Code').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "CANADA_Postal_Code_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "CANADA_Postal_Code_failure_Notification",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('CANADA_Postal_Code').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('CANADA_Postal_Code').error.errorCode}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"US_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "z5max.txt"
					},
					"CANADA_PostalCode_FileName": {
						"type": "string",
						"defaultValue": "zipcodeset.txt"
					}
				},
				"folder": {
					"name": "Postal_Code"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:05Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/USA_Zip_Code_File')]",
				"[concat(variables('factoryId'), '/datasets/US_Zip_Code_Table')]",
				"[concat(variables('factoryId'), '/datasets/Canada_Postal_Code_File')]",
				"[concat(variables('factoryId'), '/datasets/CANADA_Postal_Code_Table')]",
				"[concat(variables('factoryId'), '/datasets/Postal_Code_Archive_Files')]",
				"[concat(variables('factoryId'), '/datasets/Sink_Postal_Code_Archive')]",
				"[concat(variables('factoryId'), '/datasets/Postal_Code_Succeed_Files_Delete')]",
				"[concat(variables('factoryId'), '/datasets/Postal_Code_Error_Files')]",
				"[concat(variables('factoryId'), '/datasets/Sink_Postal_code_Error_Files')]",
				"[concat(variables('factoryId'), '/datasets/Delete_Postal_Code_Error_Files')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Retail_Customer_Failure_Notification')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_ProductMasterLoad_Retail_PIM_EDW_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "LOAD_EDW_Kit",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Kit]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "SeriesID",
											"type": "String"
										},
										"sink": {
											"name": "SeriesID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesKey",
											"type": "Int64"
										},
										"sink": {
											"name": "SeriesKey",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailBrandNameKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailTypeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitColorKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitColorKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitStatusKey",
											"type": "String"
										},
										"sink": {
											"name": "KitStatusKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitImportDomesticKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitEngineeringDivisionKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitClassKey",
											"type": "String"
										},
										"sink": {
											"name": "KitClassKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										},
										"sink": {
											"name": "KitSalesCategoryCodeKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDefaultGroupingLookupCodeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitFamilyofBusinessKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitSeriesRetailSalesCategoryKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitType",
											"type": "String"
										},
										"sink": {
											"name": "KitType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "KitExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										},
										"sink": {
											"name": "KitPrimaryLifestyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAXKitNumber",
											"type": "String"
										},
										"sink": {
											"name": "KitAXKitNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "KitStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "KitDead",
											"type": "String"
										},
										"sink": {
											"name": "KitDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitBoxQty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitBoxQty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitSeats",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSeats",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										},
										"sink": {
											"name": "KitDiningChairQtyCtn",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitUPC",
											"type": "String"
										},
										"sink": {
											"name": "KitUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "KitARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "KitStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "KitSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionsConfirmed",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										},
										"sink": {
											"name": "KitMfgWarranty",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										},
										"sink": {
											"name": "KitGeneralDescriptionID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "KitGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "KitForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitProductWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										},
										"sink": {
											"name": "KitAdditionalDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitUnitWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightLbs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitSuppWeightNetWeightKg",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitSelllingCountries",
											"type": "String"
										},
										"sink": {
											"name": "KitSelllingCountries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitThirdPartyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitThirdPartyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "KitScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "KitRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKnockout",
											"type": "String"
										},
										"sink": {
											"name": "KitKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "KitColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPhoto",
											"type": "String"
										},
										"sink": {
											"name": "KitPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "KitGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "KitProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCubesFt",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesFt",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCubesM",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCubesM",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "KitHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitFOBBasePrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitKeyKit",
											"type": "String"
										},
										"sink": {
											"name": "KitKeyKit",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "KitTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										},
										"sink": {
											"name": "KitShowroomMarketStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "KitTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "KitValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "KitAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusive",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "KitExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCommodity",
											"type": "String"
										},
										"sink": {
											"name": "KitCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitUpholsteryCover",
											"type": "String"
										},
										"sink": {
											"name": "KitUpholsteryCover",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonVolume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonDensity",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitCartonFreightClass",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "KitShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										},
										"sink": {
											"name": "KitNotAvailableforIndividualSale",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPurchaseType",
											"type": "String"
										},
										"sink": {
											"name": "KitPurchaseType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitPartsDrawings",
											"type": "String"
										},
										"sink": {
											"name": "KitPartsDrawings",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										},
										"sink": {
											"name": "KitRetailRoomKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingDepthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingHeightMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										},
										"sink": {
											"name": "KitShippingWidthMm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										},
										"sink": {
											"name": "KitPKLegacySellablePackage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										},
										"sink": {
											"name": "KitConditionalHomeDeliveryEligible",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitATPSeries",
											"type": "String"
										},
										"sink": {
											"name": "KitATPSeries",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitVendorName",
											"type": "String"
										},
										"sink": {
											"name": "KitVendorName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "KitAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "KitComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "KitDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "KitWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitAfiFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitConsumerDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffAFIEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFluffPrintEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitFriendlyDescriptionEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet1English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet2English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet3English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet4English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet5English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet6English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet7English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										},
										"sink": {
											"name": "KitHomstoreFeatureBullet8English",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitHomestoreKitFluffEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "KitIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "KitAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitMaterialEnglish",
											"type": "String"
										},
										"sink": {
											"name": "KitMaterialEnglish",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "KitEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "KitAmazonBrandOwner",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Kit",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KIT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Package",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Kit",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Package]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PackageID",
											"type": "String"
										},
										"sink": {
											"name": "PackageID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKey",
											"type": "Int32"
										},
										"sink": {
											"name": "PackageKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "HomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "HomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDateTimeUtc",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternatePackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHero",
											"type": "String"
										},
										"sink": {
											"name": "PackageHero",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatus",
											"type": "String"
										},
										"sink": {
											"name": "PackageStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageStatusChanged",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageIsThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "PackageIsThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageWholesaleID",
											"type": "String"
										},
										"sink": {
											"name": "PackageWholesaleID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRetailType",
											"type": "String"
										},
										"sink": {
											"name": "PackageRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageItemQuantity",
											"type": "String"
										},
										"sink": {
											"name": "PackageItemQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageUOM",
											"type": "String"
										},
										"sink": {
											"name": "PackageUOM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageColor",
											"type": "String"
										},
										"sink": {
											"name": "PackageColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageKnockout",
											"type": "String"
										},
										"sink": {
											"name": "PackageKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "PackageScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageValidationNotes",
											"type": "String"
										},
										"sink": {
											"name": "PackageValidationNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageRolloverImage",
											"type": "String"
										},
										"sink": {
											"name": "PackageRolloverImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "PackageExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "PackageSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "PackageSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageCode",
											"type": "String"
										},
										"sink": {
											"name": "PackageCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTransition",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTransition",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										},
										"sink": {
											"name": "PackageSwatchGroupID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageDefaultProduct",
											"type": "String"
										},
										"sink": {
											"name": "PackageDefaultProduct",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "PackageNewFlagDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageChannelChange",
											"type": "String"
										},
										"sink": {
											"name": "PackageChannelChange",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageExclusive",
											"type": "String"
										},
										"sink": {
											"name": "PackageExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										},
										"sink": {
											"name": "PackageHotSpotsNeedReview",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAlternateDescription1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommTitleOverride",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHiddenField",
											"type": "String"
										},
										"sink": {
											"name": "PackageHiddenField",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageConsumerChoice",
											"type": "String"
										},
										"sink": {
											"name": "PackageConsumerChoice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										},
										"sink": {
											"name": "PackageTotalAssemblyTime",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAshcommFlags",
											"type": "String"
										},
										"sink": {
											"name": "PackageAshcommFlags",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageNavigableCategories",
											"type": "String"
										},
										"sink": {
											"name": "PackageNavigableCategories",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageName",
											"type": "String"
										},
										"sink": {
											"name": "PackageName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomestorePackageFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageAFIBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageAFIBullets6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										},
										"sink": {
											"name": "PackageHomeStoreBullets6",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Package",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_Product",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Package",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[Product]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "id",
											"type": "String"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										},
										"sink": {
											"name": "LastModifiedDateTimeUtc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SystemTimestamp",
											"type": "Int32"
										},
										"sink": {
											"name": "SystemTimestamp",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "AlternateDescription2",
											"type": "String"
										},
										"sink": {
											"name": "AlternateDescription2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateAFIFluff1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAlternateDescription3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemARVRReady",
											"type": "String"
										},
										"sink": {
											"name": "ItemARVRReady",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsInternal",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										},
										"sink": {
											"name": "ItemAssemblyInstructionsPublic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemBoxQty",
											"type": "String"
										},
										"sink": {
											"name": "ItemBoxQty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemCartonWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemClass",
											"type": "String"
										},
										"sink": {
											"name": "ItemClass",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColor",
											"type": "String"
										},
										"sink": {
											"name": "ItemColor",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemColorSwatch",
											"type": "String"
										},
										"sink": {
											"name": "ItemColorSwatch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCommodity",
											"type": "String"
										},
										"sink": {
											"name": "ItemCommodity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemComponentQuantity",
											"type": "String"
										},
										"sink": {
											"name": "ItemComponentQuantity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerAssembly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesFt",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesFt",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemCubesM",
											"type": "String"
										},
										"sink": {
											"name": "ItemCubesM",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDead",
											"type": "String"
										},
										"sink": {
											"name": "ItemDead",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDimensionSketch",
											"type": "String"
										},
										"sink": {
											"name": "ItemDimensionSketch",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										},
										"sink": {
											"name": "ItemDiningChairQtyCtn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										},
										"sink": {
											"name": "ItemEngineeringDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusive",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusive",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "ItemExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemExpressShip",
											"type": "String"
										},
										"sink": {
											"name": "ItemExpressShip",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										},
										"sink": {
											"name": "ItemFOBBasePrice",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										},
										"sink": {
											"name": "ItemForecastPlannerID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDimensions",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFutureStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemFutureStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralDescriptionID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemGeneralLongDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemGoogleTitle",
											"type": "String"
										},
										"sink": {
											"name": "ItemGoogleTitle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHTSCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemHTSCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemImportDomestic",
											"type": "String"
										},
										"sink": {
											"name": "ItemImportDomestic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKeyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemKeyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemKnockout",
											"type": "String"
										},
										"sink": {
											"name": "ItemKnockout",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterialReferenceNeeded",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMfgWarranty",
											"type": "String"
										},
										"sink": {
											"name": "ItemMfgWarranty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemPhoto",
											"type": "String"
										},
										"sink": {
											"name": "ItemPhoto",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductDepthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductDepthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductHeightMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductHeightMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductPageURL",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductPageURL",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthIn",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthIn",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemProductWidthMm",
											"type": "String"
										},
										"sink": {
											"name": "ItemProductWidthMm",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailBrandName",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailBrandName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRetailType",
											"type": "String"
										},
										"sink": {
											"name": "ItemRetailType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemRollOverimage",
											"type": "String"
										},
										"sink": {
											"name": "ItemRollOverimage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemSalesCategoryCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										},
										"sink": {
											"name": "ItemScene7ImageSet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeats",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeats",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesName",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "ItemSeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										},
										"sink": {
											"name": "ItemStandAloneFlag",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatus",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemStatusChanged",
											"type": "String"
										},
										"sink": {
											"name": "ItemStatusChanged",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										},
										"sink": {
											"name": "ItemSupplierDirectShipOnly",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemSuppWeightNetWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										},
										"sink": {
											"name": "ItemThirdPartyItem",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrackingPiece",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrackingPiece",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemTrademarkText",
											"type": "String"
										},
										"sink": {
											"name": "ItemTrademarkText",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemType",
											"type": "String"
										},
										"sink": {
											"name": "ItemType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightKg",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										},
										"sink": {
											"name": "ItemUnitWeightLbs",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUPC",
											"type": "String"
										},
										"sink": {
											"name": "ItemUPC",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemValidationComplete",
											"type": "String"
										},
										"sink": {
											"name": "ItemValidationComplete",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										},
										"sink": {
											"name": "ItemWholesaleAssemblyVideo1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemAFIFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemConsumerDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemConsumerDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffAFI",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffAFI",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFluffPrint",
											"type": "String"
										},
										"sink": {
											"name": "ItemFluffPrint",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemFriendlyDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet1",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet2",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet3",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet4",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet5",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet6",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet7",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreFeatureBullet8",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomestoreItemFluff",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesAshleyHomestore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										},
										"sink": {
											"name": "SeriesCorporateOnlineSelling",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesDivision",
											"type": "String"
										},
										"sink": {
											"name": "SeriesDivision",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										},
										"sink": {
											"name": "SeriesExclusiveComment",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesFeatures",
											"type": "String"
										},
										"sink": {
											"name": "SeriesFeatures",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesId",
											"type": "String"
										},
										"sink": {
											"name": "SeriesId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										},
										"sink": {
											"name": "SeriesInternationalHomeStore",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesIntroDate",
											"type": "String"
										},
										"sink": {
											"name": "SeriesIntroDate",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesMainImage",
											"type": "String"
										},
										"sink": {
											"name": "SeriesMainImage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesName",
											"type": "String"
										},
										"sink": {
											"name": "SeriesName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesNumber",
											"type": "String"
										},
										"sink": {
											"name": "SeriesNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										},
										"sink": {
											"name": "SeriesRetailSalesCategory",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesShowroom",
											"type": "String"
										},
										"sink": {
											"name": "SeriesShowroom",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesSourceId",
											"type": "Int32"
										},
										"sink": {
											"name": "SeriesSourceId",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "SeriesStatus",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesStyle",
											"type": "String"
										},
										"sink": {
											"name": "SeriesStyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesThirdParty",
											"type": "String"
										},
										"sink": {
											"name": "SeriesThirdParty",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SeriesPrimary",
											"type": "String"
										},
										"sink": {
											"name": "SeriesPrimary",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemShippableUomKey",
											"type": "String"
										},
										"sink": {
											"name": "ItemShippableUomKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemEligibleforProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										},
										"sink": {
											"name": "ItemIsProtectionPlan",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										},
										"sink": {
											"name": "ItemAshcommDeliveryMode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemMaterial",
											"type": "String"
										},
										"sink": {
											"name": "ItemMaterial",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										},
										"sink": {
											"name": "ItemHomeStoreProductLine",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										},
										"sink": {
											"name": "ItemEcomMerchantNotes",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										},
										"sink": {
											"name": "ItemAmazonBrandOwner",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										},
										"sink": {
											"name": "ItemLifestyleDescription",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_Product",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_ProductPackageCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_Product",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE  [EDW].[ProductPackageCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "ProductSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PackageID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "PackageSourceID",
											"type": "Int64",
											"physicalType": "bigint"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductPackageCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_KitComponentCrosswalk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_ProductPackageCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[KitComponentCrosswalk]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "KitID",
											"type": "String"
										},
										"sink": {
											"name": "KitID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "KitSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "KitSourceID",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "ComponentType",
											"type": "String"
										},
										"sink": {
											"name": "ComponentType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentID",
											"type": "String"
										},
										"sink": {
											"name": "ComponentID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ComponentSourceID",
											"type": "Int64"
										},
										"sink": {
											"name": "ComponentSourceID",
											"type": "Int64"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_KitComponentCrosswalk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "LOAD_EDW_ProductCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LOAD_EDW_KitComponentCrosswalk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "B_update",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": "select ProductCodeKey,ProductCode,SYSUTCDATETIME() as Last_modified_date from EDME_Datafactory.ProductCode",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ProductCodeKey"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ProductCodeKey",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProductCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Last_modified_date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_PIM_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_ProductCode",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Product_Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2024-05-22T18:40:49Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/EDW_PIM_Kit')]",
				"[concat(variables('factoryId'), '/datasets/EDW_KIT')]",
				"[concat(variables('factoryId'), '/datasets/EDW_PIM_Package')]",
				"[concat(variables('factoryId'), '/datasets/EDW_Package')]",
				"[concat(variables('factoryId'), '/datasets/EDW_PIM_Product')]",
				"[concat(variables('factoryId'), '/datasets/EDW_Product')]",
				"[concat(variables('factoryId'), '/datasets/EDW_PIM_ProductPackageCrosswalk')]",
				"[concat(variables('factoryId'), '/datasets/EDW_ProductPackageCrosswalk')]",
				"[concat(variables('factoryId'), '/datasets/EDW_PIM_KitComponentCrosswalk')]",
				"[concat(variables('factoryId'), '/datasets/EDW_KitComponentCrosswalk')]",
				"[concat(variables('factoryId'), '/datasets/EDW_PIM_ProductCode')]",
				"[concat(variables('factoryId'), '/datasets/EDW_ProductCode')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RDC_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Load RDC masterlist data from smartsheet to Semarchy staging",
				"activities": [
					{
						"name": "DF_Smartsheet_SemStg",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_Stage_SiteMaster_RDC_Smartsheet",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"SRCSMARTSHEET": {},
									"RDCMasterlist": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/dataflows/DF_Stage_SiteMaster_RDC_Smartsheet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(DTStamp) AS MaxDate FROM [Masterdata_CDP].[cdp_customer_preferences_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "OptOut_MaxDate",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(EmailChannelOptStatusDate) AS MaxDate FROM [Masterdata_CDP].[OptOut_archive] WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Prefrence_MaxDate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_CDP_Customer_Prefrence_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS CDPCustomerPreferencesCount FROM EDME_DataFactory.cdp_customer_preferences_v2 with(nolock) where DTStamp is not null AND DTStamp>'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "EDW_OptOut_Count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "OptOut_MaxDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "SELECT COUNT(1) AS OptOutCount FROM EDME_DataFactory.OptOut with(nolock) where EmailChannelOptStatusDate>'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Check_EDW_CDP_Customer_Prefrence_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_CDP_Customer_Prefrence_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_CDP_Customer_Prefrence_Count').output.firstRow.CDPCustomerPreferencesCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_CDP_Customer_Prefrence_Count_Data_Not_Found_Logs_SP",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_CDP_Customer_Prefrence_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Cdp_Customer_Preferences",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType ,\nDTStamp\nfrom EDME_DataFactory.cdp_customer_preferences_v2 WITH(NOLOCK) WHERE DTStamp is not null AND DTStamp >'@{activity('Cdp_Customer_Preferences_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "globalId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "customerContact",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "opt_in_type",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "dtec",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "contactType",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime2"
													},
													"sink": {
														"name": "DTStamp",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Cdp_Customer_Preferences_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP_Cdp_Customer_Preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Cdp_Customer_Preferences_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Cdp_Customer_Preferences').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.cdp_customer_preferences",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Cdp_Customer_Preferences').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Cdp_Customer_Preferences').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_Cdp_Customer_Preferences",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_Cdp_Customer_Preferences",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Check_EDW_OptOut_Count",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "EDW_OptOut_Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(activity('EDW_OptOut_Count').output.firstRow.OptOutCount,0)\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "EDW_OptOutCount_Data_Not_Found_Logs_Stored_Procedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": "404",
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "No RAW Data Available For EDW_OptOut_Count",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": "404",
												"type": "String"
											},
											"FailureType": {
												"value": "Data Not available",
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "OptOut",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": {
												"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)\nwhere EmailChannelOptStatusDate >'@{activity('OptOut_MaxDate').output.firstRow.MaxDate}'",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "CustomerKey",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailAddress",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EmailChannelOptOutFlag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													},
													"sink": {
														"name": "EmailChannelOptStatusDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "DSG_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													},
													"sink": {
														"name": "EAGR_Brand_Flag",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "EDME_DataFactory_OptOut",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_OptOut_INC",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "OptOut_copy_SuccessLogging",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
										"storedProcedureParameters": {
											"CopyActivity_End_Time": {
												"value": {
													"value": "@{utcNow()}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_Start_Time": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"CopyActivity_transferDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"CopyDuration_in_secs": {
												"value": {
													"value": "@{activity('OptOut').output.copyDuration}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"Execution_Status": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].status}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Pipeline_Name": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RowsCopied": {
												"value": {
													"value": "@{activity('OptOut').output.rowsCopied}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RowsRead": {
												"value": {
													"value": "@{activity('OptOut').output.rowsRead}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"RunId": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "DateTime"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "OptOut_copy_ErrorLoags",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('OptOut').error.errorCode}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('OptOut').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('OptOut').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('OptOut').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@{pipeline().RunId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "Masterdata_CDP.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "EDME_DataFactory.OptOut",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Teams_Failed_Notification_OptOut",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "OptOut",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": {
												"value": "afi-edme-rg",
												"type": "Expression"
											},
											"runId": {
												"value": "@pipeline().RunId",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().Pipeline",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@activity('OptOut').ExecutionStartTime",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('OptOut').Status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(activity('OptOut').error.message,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('OptOut').ExecutionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('OptOut').Duration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Fail_OptOut",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Teams_Failed_Notification_OptOut",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('OptOut').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('OptOut').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:17:03Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/Prefrence_MaxDate')]",
				"[concat(variables('factoryId'), '/datasets/EDME_DataFactory_Cdp_Customer_Preferences')]",
				"[concat(variables('factoryId'), '/datasets/EDME_DataFactory_OptOut')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_Cdp_Customer_Preferences_INC')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_OptOut_INC')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_RetailCustomer_CommunicationPreferenceLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cdp_Customer_Preferences",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select globalId,\ncustomerContact,\nopt_in,\nopt_in_type,\nsourceSystem,\ndtec,\ncontactType \nfrom EDME_DataFactory.cdp_customer_preferences WITH(NOLOCK) where dtec<>'null.null'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "globalId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "customerContact",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "opt_in_type",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "contactType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_Cdp_Customer_Preferences",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "OptOut",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": {
									"value": "select CustomerKey,\nEmailAddress,\nEmailChannelOptOutFlag,\nEmailChannelOptStatusDate,\nDSG_Brand_Flag,\nEAGR_Brand_Flag\nfrom EDME_DataFactory.OptOut WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailAddress",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EmailChannelOptOutFlag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "EmailChannelOptStatusDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DSG_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EAGR_Brand_Flag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_DataFactory_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_OptOut",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Cdp_Customer_Preferences_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Cdp_Customer_Preferences_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('Cdp_Customer_Preferences').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.cdp_customer_preferences",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('Cdp_Customer_Preferences').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Cdp_Customer_Preferences",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Cdp_Customer_Preferences",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Cdp_Customer_Preferences').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('Cdp_Customer_Preferences').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Cdp_Customer_Preferences').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Cdp_Customer_Preferences').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OptOut_copy_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcNow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OptOut').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OptOut').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OptOut').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OptOut_copy_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OptOut').error.errorCode}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OptOut').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OptOut').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OptOut').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Masterdata_CDP.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].sink.type}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OptOut",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OptOut').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_OptOut",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OptOut",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": {
									"value": "afi-edme-rg",
									"type": "Expression"
								},
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OptOut').ExecutionStartTime",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OptOut').Status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OptOut').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('OptOut').ExecutionEndTime",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OptOut').Duration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Communication_Preference_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:17:03Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/EDME_DataFactory_Cdp_Customer_Preferences')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_Cdp_Customer_Preferences')]",
				"[concat(variables('factoryId'), '/datasets/EDME_DataFactory_OptOut')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_OptOut')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Retail_Customer_Failure_Notification')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Check_Error_Type",
						"type": "IfCondition",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@contains(pipeline().parameters.ErrorMsg,'The specified path does not exist' )",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Teams_Failed_Notification",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "ASHCOMM_ErrorLogs",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Notify_Teams_Channale_Pipeline",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"subscription": {
												"value": "@pipeline().globalParameters.ADF_SubscriptionID",
												"type": "Expression"
											},
											"resourceGroup": "afi-edme-rg",
											"runId": {
												"value": "@pipeline().parameters.RunID",
												"type": "Expression"
											},
											"name": {
												"value": "@pipeline().parameters.PipelineName",
												"type": "Expression"
											},
											"triggerTime": {
												"value": "@pipeline().parameters.TriggerTime",
												"type": "Expression"
											},
											"status": {
												"value": "@pipeline().parameters.status",
												"type": "Expression"
											},
											"message": {
												"value": "@replace(pipeline().parameters.ErrorMsg,'\"','')",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@pipeline().parameters.executionEndTime",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@pipeline().parameters.runDuration",
												"type": "Expression"
											},
											"teamWebhookUrl": {
												"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "ASHCOMM_ErrorLogs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@pipeline().parameters.ErrorCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@pipeline().parameters.ErrorMsg",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@pipeline().parameters.ErrorStatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@pipeline().parameters.FailureType",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@pipeline().parameters.PipelineName",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().parameters.RunID",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": {
													"value": "@pipeline().parameters.Sink",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink_Type": {
												"value": {
													"value": "@pipeline().parameters.Sink_Type",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source": {
												"value": {
													"value": "@pipeline().parameters.Source",
													"type": "Expression"
												},
												"type": "String"
											},
											"Source_Type": {
												"value": {
													"value": "@pipeline().parameters.Source_Type",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@pipeline().parameters.TriggerId",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@pipeline().parameters.TriggerName",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@pipeline().parameters.TriggerTime",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@pipeline().parameters.TriggerType",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "FileNotFound_Igonre_This_Error",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "FileNotFound",
										"value": {
											"value": "@pipeline().parameters.ErrorMsg",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"ErrorCode": {
						"type": "string"
					},
					"ErrorMsg": {
						"type": "string"
					},
					"ErrorStatusCode": {
						"type": "string"
					},
					"FailureType": {
						"type": "string"
					},
					"PipelineName": {
						"type": "string"
					},
					"RunID": {
						"type": "string"
					},
					"Sink": {
						"type": "string"
					},
					"Sink_Type": {
						"type": "string"
					},
					"Source": {
						"type": "string"
					},
					"Source_Type": {
						"type": "string"
					},
					"TriggerId": {
						"type": "string"
					},
					"TriggerName": {
						"type": "string"
					},
					"TriggerTime": {
						"type": "string"
					},
					"TriggerType": {
						"type": "string"
					},
					"status": {
						"type": "string"
					},
					"runDuration": {
						"type": "string"
					},
					"executionEndTime": {
						"type": "string"
					}
				},
				"variables": {
					"FileNotFound": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-21T09:16:45Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Retail_Customer_RetailCustomerLoad_Incremental')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get_Last_Trigger_Time",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT MAX(LasteTriggerDateTime) AS LasteTriggerDateTime FROM Audit.ADFRetailCustomerWatermark WITH(NOLOCK)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "GetLastTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Current_UTCTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get_Last_Trigger_Time",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ToDateTime",
							"value": {
								"value": "@utcNow()",
								"type": "Expression"
							}
						}
					},
					{
						"name": "UpdateTriggerTime",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "UPDATE Audit.ADFRetailCustomerWatermark SET LasteTriggerDateTime='@{formatDateTime(variables('ToDateTime'),'yyyy-MM-ddTHH:mm:ss')}';\nselect 1 as success;",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "UpdateTriggerTime",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Error_ECM_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_Customer_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Delete_ECM_Error_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Error_ECM_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Error_Files",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"wildcardFileName": "D365Ecm*.csv",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Stage_Retail_Customer_Failure_Notification_ECM",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Stage_Retail_Customer_Failure_Notification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"ErrorCode": {
									"value": "@{activity('Load_ECM_Customer').error.errorCode}",
									"type": "Expression"
								},
								"ErrorMsg": {
									"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
									"type": "Expression"
								},
								"ErrorStatusCode": {
									"value": "@activity('Load_ECM_Customer').StatusCode",
									"type": "Expression"
								},
								"FailureType": {
									"value": "@{activity('Load_ECM_Customer').error.failureType}",
									"type": "Expression"
								},
								"PipelineName": {
									"value": "@{pipeline().Pipeline}",
									"type": "Expression"
								},
								"RunID": {
									"value": "@{pipeline().RunId}",
									"type": "Expression"
								},
								"Sink": {
									"value": "Scratch.CustomerInfo",
									"type": "Expression"
								},
								"Sink_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].sink.type}",
									"type": "Expression"
								},
								"Source": {
									"value": "Source is D365 ECM Customers Files",
									"type": "Expression"
								},
								"Source_Type": {
									"value": "@{activity('Load_ECM_Customer').output.executionDetails[0].source.type}",
									"type": "Expression"
								},
								"TriggerId": {
									"value": "@{pipeline().TriggerId}",
									"type": "Expression"
								},
								"TriggerName": {
									"value": "@{pipeline().TriggerName}",
									"type": "Expression"
								},
								"TriggerTime": {
									"value": "@{pipeline().TriggerTime}",
									"type": "Expression"
								},
								"TriggerType": {
									"value": "@{pipeline().TriggerType}",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('Load_ECM_Customer').Status",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('Load_ECM_Customer').Duration",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@activity('Load_ECM_Customer').ExecutionEndTime",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "ECM_Files_Fail",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Stage_Retail_Customer_Failure_Notification_ECM",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@replace(activity('Load_ECM_Customer').error.message,'\"','')",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@{activity('Load_ECM_Customer').error.errorCode}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Archive_Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Validate_value",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Sink_Retail_Customer_Archive_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Deleta_Files",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Archive_Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Delete_Succeed_Files",
								"type": "DatasetReference",
								"parameters": {
									"filename_d": {
										"value": "@variables('File_Name')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"modifiedDatetimeStart": {
									"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
									"type": "Expression"
								},
								"modifiedDatetimeEnd": {
									"value": "@variables('ToDateTime')",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Get_File_ Metadata",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Load_ECM_Customer",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Homes_Files_GetMetaData",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "File_Name",
						"description": "Find the File Name from Get_File_Metadata",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "FilterActivity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "File_Name",
							"value": {
								"value": "@activity('FilterActivity').output.value[0].name",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Valiadate_File_Name",
						"description": "validate the file name received from get file metadata",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "File_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT SUBSTRING('@{variables('File_Name')}', CHARINDEX('_', '@{variables('File_Name')}') + 1, CHARINDEX('.','@{variables('File_Name')}') - CHARINDEX('_', '@{variables('File_Name')}')-1) as FinalVar;\n",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Masterdata_CDP_AllSourceCustomers_FileName",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "C_Varibale",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Valiadate_File_Name",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "C_Value",
							"value": {
								"value": "@activity('Valiadate_File_Name').output.firstRow.FinalVar",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load_ECM_Customer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Current_UTCTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "updateddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									},
									{
										"name": "csourceid",
										"value": {
											"value": "@variables('C_Value')",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": {
										"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
										"type": "Expression"
									},
									"modifiedDatetimeEnd": {
										"value": "@variables('ToDateTime')",
										"type": "Expression"
									},
									"wildcardFolderPath": "Retail-Customer-Source-Files",
									"wildcardFileName": "D365Ecm*.csv",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "posRawContainerRecID"
										},
										"sink": {
											"name": "sourceCustomerId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posFirstName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "firstName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posMiddleInitial",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "middleInitial",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posLastName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "lastName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerEmail3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerEmail3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "posCustomerPhone3",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerPhone3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_address",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_addr2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "addressLine2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_city",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "city",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_state",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "state",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "n_zip9",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "zipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "market_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "marketId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "customer_type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "customerType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SourceSubSystem",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "sourceSubSystem",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "createdDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "updateddate",
											"type": "String"
										},
										"sink": {
											"name": "updatedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ECM_Files",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Masterdata_CDP_AllSourceCustomers",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "FilterActivity",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get_File_ Metadata",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get_File_ Metadata').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@startswith(item().name, 'Homes')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Validate_value",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "C_Varibale",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(equals(sub(length(variables('C_Value')), length(replace(variables('C_Value'), '_', ''))), 2), equals(sub(length(variables('C_Value')), length(replace(variables('C_Value'), '_', ''))), 0))\n\n\n",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Set variable1",
									"description": "No action",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "NoACtion",
										"value": {
											"value": "'NoRecordinserted'",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Load_HOME_Customer",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "createddate",
													"value": {
														"value": "@utcNow()",
														"type": "Expression"
													}
												},
												{
													"name": "updateddate",
													"value": {
														"value": "@utcNow()",
														"type": "Expression"
													}
												},
												{
													"name": "csourceid",
													"value": {
														"value": "@variables('C_Value')",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": {
													"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
													"type": "Expression"
												},
												"modifiedDatetimeEnd": {
													"value": "@variables('ToDateTime')",
													"type": "Expression"
												},
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"sourceCustomerId"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "csourceid",
														"type": "String"
													},
													"sink": {
														"name": "sourceCustomerId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posFirstName",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "firstName",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posMiddleInitial",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "middleInitial",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posLastName",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "lastName",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerEmail1",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerEmail1",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerEmail2",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerEmail2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerEmail3",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerEmail3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerPhone1",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerPhone1",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerPhone2",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerPhone2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "posCustomerPhone3",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerPhone3",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_address",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "addressLine1",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_addr2",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "addressLine2",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_city",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "city",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_state",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "state",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "n_zip9",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "zipCode",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "market_id",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "marketId",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "customer_type",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "customerType",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SourceSystem",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "sourceSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "SourceSubSystem",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "sourceSubSystem",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "createddate",
														"type": "String"
													},
													"sink": {
														"name": "createdDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												},
												{
													"source": {
														"name": "updateddate",
														"type": "String"
													},
													"sink": {
														"name": "updatedDate",
														"type": "DateTime",
														"physicalType": "datetime"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Homes_Files",
											"type": "DatasetReference",
											"parameters": {
												"FileName_Prm": {
													"value": "@variables('File_Name')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "Masterdata_CDP_AllSourceCustomers",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Error_Homes_Files",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Load_HOME_Customer",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": {
													"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
													"type": "Expression"
												},
												"modifiedDatetimeEnd": {
													"value": "@variables('ToDateTime')",
													"type": "Expression"
												},
												"wildcardFolderPath": "Retail-Customer-Source-Files",
												"wildcardFileName": "Homes*.csv",
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Homes_Files",
											"type": "DatasetReference",
											"parameters": {
												"FileName_Prm": {
													"value": "@activity('Get_File_ Metadata').output.itemName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "Retail_Customer_Error_Files",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Delete_Homes_Error_Files",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Error_Homes_Files",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "Delete_Error_Files",
											"type": "DatasetReference",
											"parameters": {}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"modifiedDatetimeStart": {
												"value": "@activity('Get_Last_Trigger_Time').output.firstRow.LasteTriggerDateTime",
												"type": "Expression"
											},
											"modifiedDatetimeEnd": {
												"value": "@variables('ToDateTime')",
												"type": "Expression"
											},
											"wildcardFileName": "Homes*.csv",
											"enablePartitionDiscovery": false
										}
									}
								},
								{
									"name": "Stage_Retail_Customer_Failure_Notification_Homes",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Load_HOME_Customer",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Stage_Retail_Customer_Failure_Notification",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"ErrorCode": {
												"value": "@{activity('Load_HOME_Customer').error.errorCode}",
												"type": "Expression"
											},
											"ErrorMsg": {
												"value": "@replace(activity('Load_HOME_Customer').error.message,'\"','')",
												"type": "Expression"
											},
											"ErrorStatusCode": {
												"value": "@activity('Load_HOME_Customer').StatusCode",
												"type": "Expression"
											},
											"FailureType": {
												"value": "@{activity('Load_HOME_Customer').error.failureType}",
												"type": "Expression"
											},
											"PipelineName": {
												"value": "@{pipeline().Pipeline}",
												"type": "Expression"
											},
											"RunID": {
												"value": "@{pipeline().RunId}",
												"type": "Expression"
											},
											"Sink": {
												"value": "Scratch.CustomerInfo",
												"type": "Expression"
											},
											"Sink_Type": {
												"value": "@{activity('Load_HOME_Customer').output.executionDetails[0].sink.type}",
												"type": "Expression"
											},
											"Source": {
												"value": "Source is Homes RET Customers Files",
												"type": "Expression"
											},
											"Source_Type": {
												"value": "@{activity('Load_HOME_Customer').output.executionDetails[0].source.type}",
												"type": "Expression"
											},
											"TriggerId": {
												"value": "@{pipeline().TriggerId}",
												"type": "Expression"
											},
											"TriggerName": {
												"value": "@{pipeline().TriggerName}",
												"type": "Expression"
											},
											"TriggerTime": {
												"value": "@{pipeline().TriggerTime}",
												"type": "Expression"
											},
											"TriggerType": {
												"value": "@{pipeline().TriggerType}",
												"type": "Expression"
											},
											"status": {
												"value": "@activity('Load_HOME_Customer').Status",
												"type": "Expression"
											},
											"runDuration": {
												"value": "@activity('Load_HOME_Customer').Duration",
												"type": "Expression"
											},
											"executionEndTime": {
												"value": "@activity('Load_HOME_Customer').ExecutionEndTime",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Homes_Files_Fail",
									"type": "Fail",
									"dependsOn": [
										{
											"activity": "Stage_Retail_Customer_Failure_Notification_Homes",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"message": {
											"value": "@replace(activity('Load_HOME_Customer').error.message,'\"','')",
											"type": "Expression"
										},
										"errorCode": {
											"value": "@{activity('Load_HOME_Customer').error.errorCode}",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"ToDateTime": {
						"type": "String"
					},
					"filename": {
						"type": "String"
					},
					"LastModified": {
						"type": "String"
					},
					"File_Name": {
						"type": "String"
					},
					"lastmodified1": {
						"type": "String"
					},
					"LSTM": {
						"type": "String"
					},
					"setvalue": {
						"type": "String"
					},
					"Finalvalue": {
						"type": "String"
					},
					"C_Value": {
						"type": "String"
					},
					"NoACtion": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Retail_Customer_Flow"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/GetLastTriggerTime')]",
				"[concat(variables('factoryId'), '/datasets/UpdateTriggerTime')]",
				"[concat(variables('factoryId'), '/datasets/ECM_Files')]",
				"[concat(variables('factoryId'), '/datasets/Retail_Customer_Error_Files')]",
				"[concat(variables('factoryId'), '/datasets/Delete_Error_Files')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Retail_Customer_Failure_Notification')]",
				"[concat(variables('factoryId'), '/datasets/Customer_Archive_Files')]",
				"[concat(variables('factoryId'), '/datasets/Sink_Retail_Customer_Archive_Files')]",
				"[concat(variables('factoryId'), '/datasets/Delete_Succeed_Files')]",
				"[concat(variables('factoryId'), '/datasets/Homes_Files_GetMetaData')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_AllSourceCustomers_FileName')]",
				"[concat(variables('factoryId'), '/datasets/Masterdata_CDP_AllSourceCustomers')]",
				"[concat(variables('factoryId'), '/datasets/Homes_Files')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_DAC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "UntilLastPage",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "SetTrueloop",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(variables('loop_var'),false)",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "CheckCount",
									"type": "IfCondition",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"expression": {
											"value": "@not(equals(variables('token_var'), ''))",
											"type": "Expression"
										},
										"ifFalseActivities": [
											{
												"name": "LoggingStoredProcedure",
												"type": "SqlServerStoredProcedure",
												"dependsOn": [],
												"policy": {
													"timeout": "7.00:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
													"storedProcedureParameters": {
														"ErrorCode": {
															"value": "404",
															"type": "String"
														},
														"ErrorMsg": {
															"value": {
																"value": "@concat('Data Not Found from Date ',variables('ModifiedDateFrom'),' to Date ',variables('ModifiedDateTo'))",
																"type": "Expression"
															},
															"type": "String"
														},
														"ErrorStatusCode": {
															"value": "404",
															"type": "String"
														},
														"FailureType": {
															"value": "Data Not Available",
															"type": "String"
														},
														"PipelineName": {
															"value": {
																"value": "@{pipeline().Pipeline}",
																"type": "Expression"
															},
															"type": "String"
														},
														"RunID": {
															"value": {
																"value": "@pipeline().RunId",
																"type": "Expression"
															},
															"type": "String"
														},
														"Sink": {
															"value": null,
															"type": "String"
														},
														"Sink_Type": {
															"value": null,
															"type": "String"
														},
														"Source": {
															"value": null,
															"type": "String"
														},
														"Source_Type": {
															"value": null,
															"type": "String"
														},
														"TriggerId": {
															"value": {
																"value": "@{pipeline().TriggerId}",
																"type": "Expression"
															},
															"type": "String"
														},
														"TriggerName": {
															"value": {
																"value": "@{pipeline().TriggerName}",
																"type": "Expression"
															},
															"type": "String"
														},
														"TriggerTime": {
															"value": {
																"value": "@{pipeline().TriggerTime}",
																"type": "Expression"
															},
															"type": "String"
														},
														"TriggerType": {
															"value": {
																"value": "@{pipeline().TriggerType}",
																"type": "Expression"
															},
															"type": "String"
														}
													}
												},
												"linkedServiceName": {
													"referenceName": "semarchy_staging",
													"type": "LinkedServiceReference"
												}
											},
											{
												"name": "SetLoopValueFalse",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "LoggingStoredProcedure",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"variableName": "loop_var",
													"value": false
												}
											}
										],
										"ifTrueActivities": [
											{
												"name": "CopyDACApiResponse",
												"type": "Copy",
												"dependsOn": [],
												"policy": {
													"timeout": "7.00:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"source": {
														"type": "RestSource",
														"httpRequestTimeout": "00:01:40",
														"requestInterval": "00.00:00:00.010",
														"requestMethod": "GET",
														"additionalHeaders": {
															"Ocp-Apim-Subscription-Key": {
																"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
																"type": "Expression"
															}
														},
														"paginationRules": {
															"MaxRequestNumber": "48",
															"supportRFC5988": "true"
														}
													},
													"sink": {
														"type": "JsonSink",
														"storeSettings": {
															"type": "AzureBlobFSWriteSettings"
														},
														"formatSettings": {
															"type": "JsonWriteSettings"
														}
													},
													"enableStaging": false,
													"dataIntegrationUnits": 2
												},
												"inputs": [
													{
														"referenceName": "DataAnyWhereProdRestResource",
														"type": "DatasetReference",
														"parameters": {
															"relative_url_param": {
																"value": "@concat('locations-api-read/locations?AccountID=',pipeline().globalParameters.DAC_Accountid,'&PageSize=25&ModifiedDateFrom=',variables('ModifiedDateFrom'),'&ModifiedDateTo=',variables('ModifiedDateTo'),'&ContinuationToken=')",
																"type": "Expression"
															},
															"continuation_token_param": {
																"value": "@variables('token_var')",
																"type": "Expression"
															}
														}
													}
												],
												"outputs": [
													{
														"referenceName": "DAC_Location_List_Write",
														"type": "DatasetReference",
														"parameters": {
															"FileName": {
																"value": "@concat('Json_Output_', convertFromUtc(utcnow(), 'Eastern Standard Time'))",
																"type": "Expression"
															}
														}
													}
												]
											},
											{
												"name": "GetNextToken",
												"type": "WebActivity",
												"dependsOn": [
													{
														"activity": "CopyDACApiResponse",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "7.00:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"method": "GET",
													"headers": {
														"Ocp-Apim-Subscription-Key": {
															"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
															"type": "Expression"
														}
													},
													"url": {
														"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/locations?AccountID=',pipeline().globalParameters.DAC_Accountid,'&PageSize=25&ModifiedDateFrom=',variables('ModifiedDateFrom'),'&ModifiedDateTo=',variables('ModifiedDateTo'),'&ContinuationToken=', variables('token_var'))",
														"type": "Expression"
													}
												}
											},
											{
												"name": "SetNextToken",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "GetNextToken",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"variableName": "token_var",
													"value": {
														"value": "@coalesce(activity('GetNextToken')?.output?.ContinuationToken, '') ",
														"type": "Expression"
													}
												}
											},
											{
												"name": "SetLoopValueTrue",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "SetNextToken",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"variableName": "loop_var",
													"value": true
												}
											}
										]
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "GetContinuationToken",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "DeleteJsonAPIs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "GET",
							"headers": {
								"Ocp-Apim-Subscription-Key": {
									"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
									"type": "Expression"
								}
							},
							"url": {
								"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/locations?AccountID=',pipeline().globalParameters.DAC_Accountid,'&PageSize=25&&ContinuationToken=')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetContinuationToken",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetContinuationToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "token_var",
							"value": {
								"value": "@activity('GetContinuationToken').output.ContinuationToken",
								"type": "Expression"
							}
						}
					},
					{
						"name": "DeleteJsonAPIs",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DAC_Location_List_Read",
								"type": "DatasetReference",
								"parameters": {}
							},
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "masterDataHubStg",
									"type": "LinkedServiceReference"
								}
							},
							"enableLogging": true,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "SetModifiedDateTo",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "DeleteJsonAPIs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ModifiedDateTo",
							"value": {
								"value": "@formatDateTime(convertTimeZone(utcnow(),'UTC','Eastern Standard Time'),'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetModifiedDateFrom",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "DeleteJsonAPIs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ModifiedDateFrom",
							"value": {
								"value": "@formatDateTime(convertTimeZone(adddays(startOfDay(utcnow()), -779),'UTC','Eastern Standard Time'),'yyyy-MM-dd')\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "GetCountOfData",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "SetContinuationToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "GET",
							"headers": {
								"Ocp-Apim-Subscription-Key": {
									"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
									"type": "Expression"
								}
							},
							"url": {
								"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/locations?AccountID=',pipeline().globalParameters.DAC_Accountid,'&PageSize=25&ModifiedDateFrom=',variables('ModifiedDateFrom'),'&ModifiedDateTo=',variables('ModifiedDateTo'),'&ContinuationToken=', variables('token_var'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SetDataCount",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetCountOfData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "GetCountData",
							"value": {
								"value": "@string(activity('GetCountOfData').output.Count)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "CheckCountProcessPipeline",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "UntilLastPage",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('GetCountData')),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "NoDataFound",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "GetCountData",
										"value": {
											"value": "@string(activity('GetCountOfData').output.Count)",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Stage_SiteMaster_DAC_Tables",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Stage_SiteMaster_DAC_Tables",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								},
								{
									"name": "Load_SiteMaster_DAC",
									"type": "ExecutePipeline",
									"state": "Inactive",
									"onInactiveMarkAs": "Failed",
									"dependsOn": [
										{
											"activity": "Stage_SiteMaster_DAC_Tables",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Load_SiteMaster_DAC",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								},
								{
									"name": "SPCallStoreLocationDetailsErrorMsg",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Stage_SiteMaster_DAC_Tables",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Stage_SiteMaster_DAC_Tables').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Stage_SiteMaster_DAC_Tables').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Stage_SiteMaster_DAC_Tables').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Stage_SiteMaster_DAC_Tables').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "SPCallDacSiteMasterLoadErrorMsg",
									"type": "SqlServerStoredProcedure",
									"state": "Inactive",
									"onInactiveMarkAs": "Succeeded",
									"dependsOn": [
										{
											"activity": "Load_SiteMaster_DAC",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('Load_SiteMaster_DAC').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('Load_SiteMaster_DAC').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('Load_SiteMaster_DAC').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('Load_SiteMaster_DAC').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "SetTrueloop",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "SetDataCount",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "loop_var",
							"value": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"token_var": {
						"type": "String"
					},
					"loop_var": {
						"type": "Boolean",
						"defaultValue": false
					},
					"ModifiedDateTo": {
						"type": "String"
					},
					"ModifiedDateFrom": {
						"type": "String"
					},
					"GetCountData": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:57Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/DAC_Location_List_Read')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_DAC_Tables')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_DAC')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/DataAnyWhereProdRestResource')]",
				"[concat(variables('factoryId'), '/datasets/DAC_Location_List_Write')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_DAC_Payload')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEachLocationIds",
						"description": "Loop through location ids sequentially",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.item_param",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "WebLocationsAPI",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationsAPI').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFile",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationsAPI').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "SetErrorMsg",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "WebLocationsAPI",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "ErrorMsg",
										"value": {
											"value": "@activity('WebLocationsAPI').error.message",
											"type": "Expression"
										}
									}
								},
								{
									"name": "WaitTime",
									"type": "Wait",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 3
									}
								},
								{
									"name": "LoggingStoredProcedure",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "SetErrorMsg",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
										"storedProcedureParameters": {
											"ErrorCode": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.errorCode}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMsg": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.message}",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorStatusCode": {
												"value": {
													"value": "@activity('WebLocationsAPI').StatusCode",
													"type": "Expression"
												},
												"type": "String"
											},
											"FailureType": {
												"value": {
													"value": "@{activity('WebLocationsAPI').error.failureType}",
													"type": "Expression"
												},
												"type": "String"
											},
											"PipelineName": {
												"value": {
													"value": "@{pipeline().Pipeline}",
													"type": "Expression"
												},
												"type": "String"
											},
											"RunID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"Sink": {
												"value": null,
												"type": "String"
											},
											"Sink_Type": {
												"value": null,
												"type": "String"
											},
											"Source": {
												"value": null,
												"type": "String"
											},
											"Source_Type": {
												"value": null,
												"type": "String"
											},
											"TriggerId": {
												"value": {
													"value": "@{pipeline().TriggerId}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerName": {
												"value": {
													"value": "@{pipeline().TriggerName}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerTime": {
												"value": {
													"value": "@{pipeline().TriggerTime}",
													"type": "Expression"
												},
												"type": "String"
											},
											"TriggerType": {
												"value": {
													"value": "@{pipeline().TriggerType}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "WebLocationAPIFailed",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "WaitTime",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"method": "GET",
										"headers": {
											"Ocp-Apim-Subscription-Key": {
												"value": "@pipeline().globalParameters.DAC_SubscriptionKey",
												"type": "Expression"
											}
										},
										"url": {
											"value": "@concat('https://dataanywhereprod.azure-api.net/locations-api-read/location?LocationID=', item().LocationID)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Load_Json_Payload_AfterFailed",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[DAC].[Load_Json_Payload]",
										"storedProcedureParameters": {
											"JsonPayload": {
												"value": {
													"value": "@{activity('WebLocationAPIFailed').output}",
													"type": "Expression"
												},
												"type": "String"
											},
											"LocationID": {
												"value": {
													"value": "@item().locationID",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "semarchy_staging",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "LoadJsonFileAfterFailed",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "WebLocationAPIFailed",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "input",
													"value": {
														"value": "@{activity('WebLocationAPIFailed').output}",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "input",
														"type": "String"
													},
													"sink": {
														"type": "String",
														"physicalType": "String",
														"ordinal": 1
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DAC_Location_Details_Read1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "DAC_Location_Details_Write1",
											"type": "DatasetReference",
											"parameters": {
												"FileName": {
													"value": "@concat('Store_Location_',item().LocationID,'.json')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"item_param": {
						"type": "array"
					}
				},
				"variables": {
					"FailedActivity": {
						"type": "String"
					},
					"ErrorMsg": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-26T17:07:17Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/DAC_Location_Details_Read1')]",
				"[concat(variables('factoryId'), '/datasets/DAC_Location_Details_Write1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_DAC_Tables')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GetAllJsonFiles",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DAC_Location_List_Read",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "JsonReadSettings"
							}
						}
					},
					{
						"name": "ForEachJsonFile",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "SP_Truncate_DAC_Tables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('GetAllJsonFiles').output.childItems",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "LookupJsonFile",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"dataset": {
											"referenceName": "Dac_Stage_Location_List_Load",
											"type": "DatasetReference",
											"parameters": {
												"fileName": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									}
								},
								{
									"name": "Store_DAC_Store_Details",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "LookupJsonFile",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Stage_SiteMaster_DAC_Payload",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"item_param": {
												"value": "@activity('LookupJsonFile').output.firstRow.Data",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "SP_Load_Stores_Details",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ForEachJsonFile",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Load_Stores_Data]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP_Truncate_DAC_Tables",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GetAllJsonFiles",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[DAC].[Truncate_DAC_Tables]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SPCallStoreLocationDetailsErrorMsg",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GetAllJsonFiles",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('GetAllJsonFiles').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('GetAllJsonFiles').error.message}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('GetAllJsonFiles').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('GetAllJsonFiles').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": null,
									"type": "String"
								},
								"Sink_Type": {
									"value": null,
									"type": "String"
								},
								"Source": {
									"value": null,
									"type": "String"
								},
								"Source_Type": {
									"value": null,
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"location_id_var": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-26T17:07:18Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/DAC_Location_List_Read')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/Dac_Stage_Location_List_Load')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_SiteMaster_DAC_Payload')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_EDW')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "OSLocation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLocationID,\r\noslAccountNo,\r\noslShipTo,\r\noslLocationName,\r\noslAddress1,\r\noslAddress2,\r\noslCity,\r\noslState,\r\noslZip,\r\noslCountry,\r\noslCounty,\r\noslPrimaryPhone,\r\noslPrimaryFax,\r\noslPrimaryEmail,\r\noslLatitude,\r\noslLongitude,\r\noslLocationStatus,\r\noslLocationStatusNotes,\r\noslLegacyLocationID,\r\noslWhseShipTo,\r\noslProspectID,\r\noslOwnerType,\r\noslLta,\r\noslDMA,\r\noslMSA,\r\noslCountyFips,\r\noslMarketZone,\r\noslOpAreaZone,\r\noslCurrency,\r\noslLanguage,\r\noslTimeZone,\r\noslGeographicZone,\r\noslStatus,\r\noslStatusNotes,\r\noslLocationType,\r\noslSoftOpenDate,\r\noslGrandOpenDate,\r\noslClosed,\r\noslClosedDate,\r\noslClosedAuthorization,\r\noslRelocated,\r\noslRelocationCloseDate,\r\noslRelocationOpenDate,\r\noslRelocationNotes,\r\noslAcquisition,\r\noslAcquisitionDate,\r\noslAcquisitionNotes,\r\noslPreOpenComments,\r\noslTUAID,\r\noslTUADate,\r\noslTUAExpireDate,\r\noslTUATerm,\r\noslTUADateComplete,\r\noslTurnoverDate,\r\noslRecordChangesFlag,\r\noslOperationsIntroDate,\r\noslMsPipelineDate,\r\noslLicenseeID,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\noslAddress3,\r\noslStoreRefresh,\r\noslStoreRefreshDate,\r\noslStoreRefreshNotes,\r\noslmPlansSubToDesign,\r\noslmPRMeeting,\r\noslmPlansSentToOwnerLic,\r\noslURLRegistration,\r\noslEnterpriseStoreNumber FROM [EDME_DataFactory].OSLocation WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLocation]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslAccountNo",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCounty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryPhone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryFax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryEmail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLatitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLongitude",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslWhseShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslProspectID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOwnerType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLta",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslDMA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMSA",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslCountyFips",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMarketZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslOpAreaZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "oslCurrency",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLanguage",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTimeZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGeographicZone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatusNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLocationType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslSoftOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslGrandOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslClosed",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslClosedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslClosedAuthorization",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRelocated",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationCloseDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslRelocationOpenDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslRelocationNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslAcquisition",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslAcquisitionDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAcquisitionNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPreOpenComments",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUAID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUAExpireDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslTUATerm",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTUADateComplete",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslTurnoverDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslRecordChangesFlag",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslOperationsIntroDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslMsPipelineDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslAddress3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslStoreRefresh",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslStoreRefreshDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreRefreshNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSubToDesign",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPRMeeting",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslmPlansSentToOwnerLic",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslURLRegistration",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslEnterpriseStoreNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLocation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLocation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLocation').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLocation').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLocation').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLocation').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLocation_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLocation').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLocation').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLocation').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLocation').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLocation_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLocation').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLocation').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLocation').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLocation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT osOneSourceID,\r\nosOneSourceName,\r\nosLegacyLocationID,\r\nosLegacyStoreID,\r\nosProfitCenter,\r\nosChannel,\r\nosActive,\r\nosStoreType,\r\nosSource,\r\nosLocationID,\r\nosStartDate,\r\nosEndDate,\r\nusra,\r\ndtea,\r\nusrc,\r\ndtec,\r\nosProfitCenterType,\r\nosProfitCenterStatus FROM [EDME_DataFactory].OSOneSource WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OsOneSource]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osOneSourceID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osOneSourceName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osLegacyLocationID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osLegacyStoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "osProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osChannel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "osActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osSource",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "osLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osStartDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "osEndDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "osProfitCenterStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSOneSource",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OsOneSource",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OsOneSource').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OsOneSource').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OsOneSource').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OsOneSource').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OsOneSource_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OsOneSource').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OsOneSource').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OsOneSource').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OsOneSource').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OsOneSource_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OsOneSource').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OsOneSource').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OsOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSOneSource",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OsOneSource').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OsOneSource",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT oslLicenseeID,\r\noslStoreType,\r\noslLicenseeNotes,\r\noslPrimaryCountry,\r\noslStatus,\r\noslActive,\r\noslActiveDate,\r\noslActiveNotes,\r\noslGuarantors,\r\noslMailingAddress1,\r\noslMailingAddress2,\r\noslMailingCity,\r\noslMailingState,\r\noslMailingZip,\r\noslMailingCountry,\r\noslLegalEntityName,\r\noslLegalEntityAddress1,\r\noslLegalEntityAddress2,\r\noslLegalEntityCity,\r\noslLegalEntityState,\r\noslLegalEntityZip,\r\noslLegalEntityCountry,\r\nusra,\r\ndtea,\r\nusrc,\r\ndetc,\r\noslLicensedTerritory,\r\noslDisclosureDocument,\r\noslMailingAdd FROM [EDME_DataFactory].OSLicensee WITH(NOLOCK)",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[OSLicensee]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "oslLicenseeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStoreType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicenseeNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslPrimaryCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "oslActive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "oslActiveDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslActiveNotes",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslGuarantors",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityAddress2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityState",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityZip",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLegalEntityCountry",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "detc",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslLicensedTerritory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "oslDisclosureDocument",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "oslMailingAdd",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_OSLicensee",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_OSLicensee",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('OSLicensee').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('OSLicensee').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('OSLicensee').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('OSLicensee').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "OSLicensee_ErrorLoags",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('OSLicensee').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('OSLicensee').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('OSLicensee').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('OSLicensee').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "OSLicensee_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('OSLicensee').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('OSLicensee').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLicensee",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('OSLicensee').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WholesaleCustomersShippingLocations",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "OSLicensee",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"sqlReaderQuery": "SELECT * \nFROM EDME_DataFactory.CustomersShippingLocations",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [EDW].[WholesaleCustomersShippingLocations]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCustomerNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShiptoNumber",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "cslMapicsSequenceNumber",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpa3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmshpzp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpst",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmshpco",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmfaxtn",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTaxExempt",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmwebsite",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCommissionCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslFreightCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPriceCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDiscountCode",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										},
										"sink": {
											"name": "cslCommissionSplit",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultWarehouse",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShippingTerritory",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslBusinessType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslShipType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslTranscomPrimaryID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmcontact",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslcomment2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslTerritoryEffectivityDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslCrmID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsphone",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsfax",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcscontact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmcsemail",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslMemo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmmsa_fips",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmRMCityNumber",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslTranscomAlternateID",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmDirections",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "csmCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgAddr",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShip",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgShipExt",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "csmChgCust",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "commaudit2",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "csmCounty",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslBlockRepOrderEntry",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										},
										"sink": {
											"name": "cslCustomerSegment",
											"type": "Byte",
											"physicalType": "tinyint"
										}
									},
									{
										"source": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "cslLastStatusChangeDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslBuyerAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslPartyLocationID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslRouteAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType1",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType2",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType3",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultOrderType4",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "csmshled",
											"type": "Int16",
											"physicalType": "smallint"
										}
									},
									{
										"source": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "csmAppcd",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslAllowFax",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectConsumer",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasure",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										},
										"sink": {
											"name": "cslDeliveryUnitOfMeasureFence",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 7
										}
									},
									{
										"source": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsLCLConsolidationFlag",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsDocumentCountry",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsProductOnPallets",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExportsAppointmentsRequired",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "cslHasDock",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslHasDockUserDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslExpressShippingMethod",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDirectIncludeShipto",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										},
										"sink": {
											"name": "cslExpressHandlingCharge",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 3,
											"precision": 4
										}
									},
									{
										"source": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMinimum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										},
										"sink": {
											"name": "cslExpressMaximum",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDefaultLanguage",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslExpressServiceContractNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseNegotiatedFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslUseStandardFreightRate",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslDoNotRepriceOrders",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "cslPricingUseOfflineFiles",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "cslReturnAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "cslReturnAddressName",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_CustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_WholesaleCustomersShippingLocations",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "WholesaleCustomersShippingLocations_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_CustomersShippingLocations",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('WholesaleCustomersShippingLocations').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('WholesaleCustomersShippingLocations').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "WHolesaleCustomersShippingLocations_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('WholesaleCustomersShippingLocations').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.WholesaleCustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.CustomersShippingLocations",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('WholesaleCustomersShippingLocations').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CP_EDW_Units_SemStaging",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "load_date",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "DELETE from [EDW].[Units]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AdminDivisionID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "AdminDivisionID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FinancialDivisionID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "FinancialDivisionID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CustomerNumber",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 8
										},
										"sink": {
											"name": "CustomerNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProfitCenter",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "ProfitCenter",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UserAdded",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UserAdded",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DateAdded",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "DateAdded",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProgramAdded",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProgramAdded",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UserChanged",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UserChanged",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DateChanged",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "DateChanged",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProgramChanged",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProgramChanged",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StoreID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "StoreID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Facility",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "Facility",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RetailChannel",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RetailChannel",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "load_date",
											"type": "String"
										},
										"sink": {
											"name": "load_date",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDME_Datafactory",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "Units",
									"SchemaName": "EDME_DataFactory"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "EDW",
									"TableName": "Units"
								}
							}
						]
					},
					{
						"name": "Units_Success_Logging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].start}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Units_Failure",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('CP_EDW_Units_SemStaging').output.executionDetails[0].start",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CP_EDW_Units_SemStaging').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('CP_EDW_Units_SemStaging').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CP_EDW_Units_SemStaging').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Units_Error_logging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_EDW_Units_SemStaging",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('CP_EDW_Units_SemStaging').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.OSLocation",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_EDW_Units_SemStaging').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CP_LocationCode",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "WholesaleCustomersShippingLocations_SuccessLogging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "Select OPERATION_ID,Profit_center,Account_Number,SHIP_TO_NUM,TYPE,LocationCode\r\nfrom \r\nRetail.RSA_LocationCode_VW\r\nWITH(NOLOCK)\r\n\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table Retail.Location_Code",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_DB_Query",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "Location_Code"
								}
							}
						]
					},
					{
						"name": "RSALocations_SuccessLogging",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_LocationCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFLogging]",
							"storedProcedureParameters": {
								"CopyActivity_End_Time": {
									"value": {
										"value": "@{utcnow()}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_Start_Time": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].start}\n",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"CopyActivity_transferDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0]. detailedDurations.transferDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"CopyDuration_in_secs": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.copyDuration}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"Execution_Status": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].status}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Pipeline_Name": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RowsCopied": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.rowsCopied}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RowsRead": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.rowsRead}",
										"type": "Expression"
									},
									"type": "Int32"
								},
								"RunId": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "Retail.Location_Code",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDW.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Teams_Failed_Notification_Locationcode",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "CP_LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('CP_LocationCode').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('CP_LocationCode').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('CP_LocationCode').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('CP_LocationCode').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Locationcode_ErrorLogs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CP_LocationCode",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Audit].[uspInsertADFErrorLog]",
							"storedProcedureParameters": {
								"ErrorCode": {
									"value": {
										"value": "@{activity('CP_LocationCode').error.errorCode}",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMsg": {
									"value": {
										"value": "@{activity('CP_LocationCode').error.message}\n",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorStatusCode": {
									"value": {
										"value": "@activity('CP_LocationCode').StatusCode",
										"type": "Expression"
									},
									"type": "String"
								},
								"FailureType": {
									"value": {
										"value": "@{activity('CP_LocationCode').error.failureType}",
										"type": "Expression"
									},
									"type": "String"
								},
								"PipelineName": {
									"value": {
										"value": "@{pipeline().Pipeline}",
										"type": "Expression"
									},
									"type": "String"
								},
								"RunID": {
									"value": {
										"value": "@{pipeline().RunId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink": {
									"value": {
										"value": "EDW.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Sink_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].sink.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source": {
									"value": {
										"value": "EDME_DataFactory.Units",
										"type": "Expression"
									},
									"type": "String"
								},
								"Source_Type": {
									"value": {
										"value": "@{activity('CP_LocationCode').output.executionDetails[0].source.type}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerId": {
									"value": {
										"value": "@{pipeline().TriggerId}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerName": {
									"value": {
										"value": "@{pipeline().TriggerName}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerTime": {
									"value": {
										"value": "@{pipeline().TriggerTime}",
										"type": "Expression"
									},
									"type": "String"
								},
								"TriggerType": {
									"value": {
										"value": "@{pipeline().TriggerType}",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/EDW_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/EDW_OSLocation')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/EDW_OSOneSource')]",
				"[concat(variables('factoryId'), '/datasets/EDW_OSLicensee')]",
				"[concat(variables('factoryId'), '/datasets/EDW_CustomersShippingLocations')]",
				"[concat(variables('factoryId'), '/datasets/EDW_WholesaleCustomersShippingLocations')]",
				"[concat(variables('factoryId'), '/datasets/EDME_Datafactory')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/datasets/DS_DB_Query')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Mappings')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "StoreMasterCustom_LegalEntities_Mapping",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_companycode_GD_STG",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "createddate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesMapping_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_Mapping",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "Createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LegalEntityID",
										"EntityName",
										"LicContact"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "utcnow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "\n",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location",
										"SiteID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CP_companycode_GD_STG",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select legal_entity_id,Name,LIC_contact,company_code,\r\ngetdate() as created_date from  dbo.gd_legal_entity\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "delete from retail.StoreMasterCustom_LegalEntities_CompanyCodes",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"LegalEntityID",
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LIC_contact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "created_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_CompanyCodes"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"LegalEntitiesMapping_FileName": {
						"type": "String",
						"defaultValue": "StoreMasterCustom_LegalEntities_Mapping.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					},
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_LegalEntities_Mapping')]",
				"[concat(variables('factoryId'), '/datasets/EDW_StoreMasterCustom_LegalEntities_Mapping')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_LegalEntities_CompanyCodes')]",
				"[concat(variables('factoryId'), '/datasets/EDW_StoreMasterCustom_LegalEntities_CompanyCodes')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/Retail_StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/Retail_Sitemaster_Tables')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Mappings_Automate')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_companycode_GD_STG",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "utcnow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "\n",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location",
										"SiteID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CP_companycode_GD_STG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Sp_LegalEntityID_Assign_Stores",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select legal_entity_id,Name,LIC_contact,company_code,\r\ngetdate() as created_date from  dbo.gd_legal_entity\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"LegalEntityID",
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LIC_contact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "created_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_CompanyCodes"
								}
							}
						]
					},
					{
						"name": "cp_LegalEntityID_GD_Staging",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select legal_entity_id as LegalEntityID,Name as Entityname,\nCONVERT(VARCHAR(30), b_credate, 126) as createddate from  dbo.gd_legal_entity",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"LegalEntityID",
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Entityname",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_Mapping"
								}
							}
						]
					},
					{
						"name": "Sp_LegalEntityID_Assign_Stores",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Sp_LegalEntityID_Assign_RDC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Sp_LegalEntityID_Assign_RDC",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "cp_LegalEntityID_GD_Staging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_WH_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"LegalEntitiesMapping_FileName": {
						"type": "String",
						"defaultValue": "StoreMasterCustom_LegalEntities_Mapping.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					},
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/Retail_StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/Retail_Sitemaster_Tables')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_SiteMaster_Mappings_Automate_bkp')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "StoreMasterCustom_LegalEntities_Mapping",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "CP_companycode_GD_STG",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "createddate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesMapping_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_Mapping",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_Mapping",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "Createddate",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LegalEntityID",
										"EntityName",
										"LicContact"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "lic_contact",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.LegalEntitiesCompanyCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "EDW_StoreMasterCustom_LegalEntities_CompanyCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "StoreMasterCustom_JoinCodes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "StoreMasterCustom_LegalEntities_CompanyCodes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "createddate",
										"value": {
											"value": "utcnow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "\n",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"Location",
										"SiteID"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Location",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "JoinCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SiteID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Account",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StoreFrontShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@pipeline().parameters.Sites_JoinCodes_FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_StoreMasterCustom_Sites_JoinCodes",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CP_companycode_GD_STG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Sp_LegalEntityID_Assign_RDC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select legal_entity_id,Name,LIC_contact,company_code,\r\ngetdate() as created_date from  dbo.gd_legal_entity\r\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"LegalEntityID",
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "legal_entity_id",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LIC_contact",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LicContact",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "company_code",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CompanyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "created_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_CompanyCodes"
								}
							}
						]
					},
					{
						"name": "cp_LegalEntityID_GD_Staging",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select legal_entity_id as LegalEntityID,Name as Entityname,\nCONVERT(VARCHAR(30), b_credate, 126) as createddate from  dbo.gd_legal_entity",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": false,
									"keys": [
										"LegalEntityID",
										"EntityName"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Entityname",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "EntityName",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LegalEntityID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "LegalEntityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "createddate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "createddate",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Retail_Sitemaster_Tables",
								"type": "DatasetReference",
								"parameters": {
									"Schemaname": "dbo",
									"Tablename": "gd_legal_entity"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Semarchy_staging",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Retail",
									"TableName": "StoreMasterCustom_LegalEntities_Mapping"
								}
							}
						]
					},
					{
						"name": "Sp_LegalEntityID_Assign_Stores",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "cp_LegalEntityID_GD_Staging",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Sp_LegalEntityID_Assign_RDC",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Sp_LegalEntityID_Assign_Stores",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[Retail].[Assign_WH_new_legal_entity_id]"
						},
						"linkedServiceName": {
							"referenceName": "semarchy_staging",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"LegalEntitiesMapping_FileName": {
						"type": "String",
						"defaultValue": "StoreMasterCustom_LegalEntities_Mapping.csv"
					},
					"LegalEntitiesCompanyCodes_FileName": {
						"type": "string",
						"defaultValue": "LegalEntitiesCompanyCodes.csv"
					},
					"Sites_JoinCodes_FileName": {
						"type": "string",
						"defaultValue": "StoreMasterCustom_Sites_JoinCodes.csv"
					}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:56Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_LegalEntities_Mapping')]",
				"[concat(variables('factoryId'), '/datasets/EDW_StoreMasterCustom_LegalEntities_Mapping')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_LegalEntities_CompanyCodes')]",
				"[concat(variables('factoryId'), '/datasets/EDW_StoreMasterCustom_LegalEntities_CompanyCodes')]",
				"[concat(variables('factoryId'), '/datasets/StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/Retail_StoreMasterCustom_Sites_JoinCodes')]",
				"[concat(variables('factoryId'), '/datasets/Retail_Sitemaster_Tables')]",
				"[concat(variables('factoryId'), '/datasets/DS_Semarchy_staging')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Site_EDW_Staging_ZipAllocation')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "AshleyNetEDW_PostalCode",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table [EDW].[ZipAllocation]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ZipCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ZipCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Customer#",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "CustomerNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Acct_ShipTo",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Acct_ShipTo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TradeArea",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "TradeArea",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "startDate",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "StartDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ChangedBy",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ChangedBy",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ChangedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "ChangedDate",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Address",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Address",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "City",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Country",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "Country",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BusinessType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "BusinessType",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "char"
										}
									},
									{
										"source": {
											"name": "PriceDiscGroup_GroupId",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PriceDiscGroup_GroupId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EnableWebSale",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "EnableWebSale",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EDW_ashley_zipallocation",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Semarchy_Staging_AshlyNet",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Execute_INC_zipallocation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "AshleyNetEDW_PostalCode",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Load_SiteMaster_Incremental__ZipAllocation",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2025-03-19T14:56:57Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/EDW_ashley_zipallocation')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Staging_AshlyNet')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Incremental__ZipAllocation')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_Storemaster_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_Stage_SiteMaster_Store_Smartsheet",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_Stage_SiteMaster_Store_Smartsheet",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"SRCStoremasterlist": {},
									"sink": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/dataflows/DF_Stage_SiteMaster_Store_Smartsheet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_W_SiteMaster_EDW_SemarchyStaging_Tbl')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CP_EDW_Staging_WHSMST",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "To copy WHSMST from EDW to Semarchy stg"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "load_date",
										"value": {
											"value": "@utcNow()",
											"type": "Expression"
										}
									}
								],
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Delete from wholesale.whsmst",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "WHID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "WHID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DESC",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "DESC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SELL",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SELL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PRPL",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PRPL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PLCD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "PLCD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LSPD",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 7
										},
										"sink": {
											"name": "LSPD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LDEP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "LDEP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RPDS",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "RPDS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FCDS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "FCDS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BCDS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 4
										},
										"sink": {
											"name": "BCDS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECCUCD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ECCUCD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ECSTCD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ECSTCD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "IIRO",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "IIRO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SCPI",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "SCPI",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GSCD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "GSCD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WHLC",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "WHLC",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CWHS",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "CWHS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UUCAWH",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "UUCAWH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ETPO",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ETPO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CNTY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "CNTY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STCD",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STCD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TXCNT",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "TXCNT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TXCIY",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "TXCIY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WZIP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "WZIP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STID",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "STID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BFFL",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 1
										},
										"sink": {
											"name": "BFFL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AA0B",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "AA0B",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UUIAWH",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "UUIAWH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CALP",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "CALP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CALR",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "CALR",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ALST",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "ALST",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "APSW",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "APSW",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "load_date",
											"type": "String"
										},
										"sink": {
											"name": "load_date",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_EDW_WHSMST",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SemStaging_WHSMST",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CP_EDW_Staging_PortMaster",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_EDW_Staging_WHSMST",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Task",
								"value": "To copy Portmater from EDW to Semarchy stg"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "Load_date",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Delete from wholesale.PortMaster",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "pteID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "pteID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "pteAESPortCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "pteAESPortCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ptePortDescription",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ptePortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteCityOfPort",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "pteCityOfPort",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteStateOfPort",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "pteStateOfPort",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteCountryOfPort",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "pteCountryOfPort",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteFobPortCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "pteFobPortCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteFOBPortActiveRecordFlag",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "pteFOBPortActiveRecordFlag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteEndPortCode",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "pteEndPortCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteEndPortActiveRecordFlag",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "pteEndPortActiveRecordFlag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteLastModifiedUser",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "pteLastModifiedUser",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteShortPortDescription",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "pteShortPortDescription",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtea",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "dtec",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteCanadaActiveRecordFlag",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "pteCanadaActiveRecordFlag",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteCanadaBorderServiceAgency",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "pteCanadaBorderServiceAgency",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteZipCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "pteZipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteGeoLatitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 13
										},
										"sink": {
											"name": "pteGeoLatitude",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteGeoLongitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 11
										},
										"sink": {
											"name": "pteGeoLongitude",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "pteGeoAccuracy",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "pteGeoAccuracy",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Load_date",
											"type": "String"
										},
										"sink": {
											"name": "load_date",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_EDW_portmater",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_SemStaging_Portmaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Teams_Failed_Notification_WH_Port",
						"type": "ExecutePipeline",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "AddressMaster",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Notify_Teams_Channale_Pipeline",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"subscription": {
									"value": "@pipeline().globalParameters.ADF_SubscriptionID",
									"type": "Expression"
								},
								"resourceGroup": "afi-edme-rg",
								"runId": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"name": {
									"value": "@pipeline().Pipeline",
									"type": "Expression"
								},
								"triggerTime": {
									"value": "@activity('AddressMaster').output.executionDetails[0].start\n",
									"type": "Expression"
								},
								"status": {
									"value": "@activity('AddressMaster').output.executionDetails[0].status",
									"type": "Expression"
								},
								"message": {
									"value": "@replace(activity('AddressMaster').error.message,'\"','')",
									"type": "Expression"
								},
								"executionEndTime": {
									"value": "@{utcnow()}",
									"type": "Expression"
								},
								"runDuration": {
									"value": "@activity('AddressMaster').output.copyDuration",
									"type": "Expression"
								},
								"teamWebhookUrl": {
									"value": "https://masterashley.webhook.office.com/webhookb2/c31879ef-6dfb-470f-b788-de8363ae3c17@5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/IncomingWebhook/147e6de5d4454f53bc64a6a9bae90283/276c88be-8000-43f8-b798-97215f5a2fda",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "AshleyWarehouseMaster",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CP_EDW_Staging_PortMaster",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "Load_date",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "wmaWarehouse",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaWarehouse",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaLocationId",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "wmaLocationId",
											"type": "Decimal",
											"physicalType": "decimal"
										}
									},
									{
										"source": {
											"name": "wmaIntransitWarehouse",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaIntransitWarehouse",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaSiteId",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaSiteId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaMROSiteId",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaMROSiteId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaWarehouseType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaWarehouseType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaWarehouseOrderGroup",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "wmaWarehouseOrderGroup",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaWarehouseSourceId",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "wmaWarehouseSourceId",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaRouteType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaRouteType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaDefaultPortId",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "wmaDefaultPortId",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "wmaControlled",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "wmaControlled",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "wmaPrinterName",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "wmaPrinterName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaZebraPrinter",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "wmaZebraPrinter",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaSendBolsToManu",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaSendBolsToManu",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaOrderReleaseMin",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "wmaOrderReleaseMin",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "wmaOrderReleaseMinType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaOrderReleaseMinType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaDefaultShipId",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "wmaDefaultShipId",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "wmaSortOrder",
											"type": "Byte",
											"physicalType": "tinyint"
										},
										"sink": {
											"name": "wmaSortOrder",
											"type": "Byte",
											"physicalType": "tinyint"
										}
									},
									{
										"source": {
											"name": "wmaAsOverhead",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "wmaAsOverhead",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "wmaAsFreight",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "wmaAsFreight",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "wmaContainerDirectWhse",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaContainerDirectWhse",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "acrec",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "acrec",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "wmaWhereMade",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "wmaWhereMade",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaManufacturingSite",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "wmaManufacturingSite",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "wmaSellableWarehouse",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "wmaSellableWarehouse",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Load_date",
											"type": "String"
										},
										"sink": {
											"name": "Load_date",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_AshleyWarehouseMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Sem_Staging_wholesale",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Wholesale",
									"TableName": "AshleyWarehouseMaster"
								}
							}
						]
					},
					{
						"name": "Locations",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "AshleyWarehouseMaster",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "Load_date",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Locations",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Sem_Staging_wholesale",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Wholesale",
									"TableName": "Locations"
								}
							}
						]
					},
					{
						"name": "AddressMaster",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Locations",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlDWSource",
								"additionalColumns": [
									{
										"name": "Load_date",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "paaAddressID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "paaAddressID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "paaAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaAddress1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaAddress2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaAddress3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaAddress3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaAddress4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaAddress4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaAddress5",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaAddress5",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaCity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaState",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "paaState",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaCountry",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "paaCountry",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaGeocodeLatitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "paaGeocodeLatitude",
											"type": "Decimal",
											"physicalType": "decimal"
										}
									},
									{
										"source": {
											"name": "paaGeocodeLongitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 8
										},
										"sink": {
											"name": "paaGeocodeLongitude",
											"type": "Decimal",
											"physicalType": "decimal"
										}
									},
									{
										"source": {
											"name": "paaZipCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaZipCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaCountyCode",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "paaCountyCode",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaCustomsIDNumber",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaCustomsIDNumber",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaGeocodeAccuracy",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "paaGeocodeAccuracy",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "paaTranscomCityCode",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "paaTranscomCityCode",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "paaDirections",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaDirections",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaCrossStreet",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaCrossStreet",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaGeocodeVerificationDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "paaGeocodeVerificationDate",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "paaTimeZone",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "paaTimeZone",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaGeocodeType",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "paaGeocodeType",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaMsa_Fips",
											"type": "String",
											"physicalType": "char"
										},
										"sink": {
											"name": "paaMsa_Fips",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaShortAddress1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaShortAddress1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaShortAddress2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaShortAddress2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaShortAddress3",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaShortAddress3",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaShortAddress4",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaShortAddress4",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "paaShortCity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "paaShortCity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "usra",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usra",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtea",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "usrc",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "usrc",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "dtec",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Load_date",
											"type": "String"
										},
										"sink": {
											"name": "Load_date",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ASHLEY_EDW_EDME",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Edme_datafactory",
									"TableName": "AddressMaster"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_Sem_Staging_wholesale",
								"type": "DatasetReference",
								"parameters": {
									"SchemaName": "Wholesale",
									"TableName": "AddressMaster"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Wholesale/W_SiteMaster"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:26Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/DS_EDW_WHSMST')]",
				"[concat(variables('factoryId'), '/datasets/DS_SemStaging_WHSMST')]",
				"[concat(variables('factoryId'), '/datasets/DS_EDW_portmater')]",
				"[concat(variables('factoryId'), '/datasets/DS_SemStaging_Portmaster')]",
				"[concat(variables('factoryId'), '/pipelines/Notify_Teams_Channale_Pipeline')]",
				"[concat(variables('factoryId'), '/datasets/DS_AshleyWarehouseMaster')]",
				"[concat(variables('factoryId'), '/datasets/DS_Sem_Staging_wholesale')]",
				"[concat(variables('factoryId'), '/datasets/Locations')]",
				"[concat(variables('factoryId'), '/datasets/DS_ASHLEY_EDW_EDME')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Zeta_File_Export_Template')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "test cdp dedupe func",
						"type": "AzureFunctionActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"functionName": "input-incremental-dedupe-func",
							"headers": {},
							"method": "TRACE"
						},
						"linkedServiceName": {
							"referenceName": "agr_cdp_func",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Fail1",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "test cdp dedupe func",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": "FAILURE",
							"errorCode": "500"
						}
					},
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "test cdp dedupe func",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "pipelineReturnValue",
							"value": [
								{
									"key": "success",
									"value": {
										"type": "String",
										"content": "true"
									}
								}
							],
							"setSystemVariable": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-30T12:31:10Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/agr_cdp_func')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_old_Load_Retail_LegalEntityLoad_InitialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SiteLegalEntityOWNER",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SiteLegalEntity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "Loadid",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_SOURCEID,\nB_PUBID,\nB_CREDATE,\nOWNER_FIRST_NAME,\nOWNER_LAST_NAME,\nRAW_OWNER_PHONE,\nRAW_CONTACT_EMAIL,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY_OWNER WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Loadid",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_FIRST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OWNER_LAST_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_OWNER_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CONTACT_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity_OWNER",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SiteLegalEntity",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT SITE_LEGAL_ENTITY_ID,\nB_PUBID,\nB_CLASSNAME,\nB_CREDATE,\nSITE_LEGAL_ENTITY_NAME,\nRAW_SITE_ADDRESS_LINE1,\nRAW_SITE_ADDRESS_LINE2,\nRAW_SITE_CITY,\nRAW_SITE_STATE_CODE,\nRAW_SITE_POSTAL_CODE,\nRAW_SITE_COUNTRY_CODE,\nSITE_LEGAL_ENTITY_TYPE,\nF_SITE_LEGAL_ENTITY,\nFD_SITE_LEGAL_ENTITY,\nROW_NUMBER() OVER (PARTITION BY SITE_LEGAL_ENTITY_ID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_LEGAL_ENTITY WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_ADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_CITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_STATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_POSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SITE_COUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_LEGAL_ENTITY_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FD_SITE_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_Site_Legal_Entity",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'LegalEntityLoad'\r\n,@P_LOAD_DESCRIPTION = 'LegalEntityLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SiteLegalEntityOWNER",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "LegalEntityLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:05Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/MasterDataHub_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_Site_Legal_Entity_OWNER')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_Site_Legal_Entity')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/z_old_Load_Retail_SiteMasterLoad_DAC_initialLoad')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Upsert_DACJSONLoadSiteMain",
				"activities": [
					{
						"name": "IncrementalSiteMainView",
						"description": "select all data from DACJSONLoadSiteMain view",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT \nB_CLASSNAME,\nB_PUBID,\nB_SOURCEID,\nB_CREDATE,\nSITE_NAME,\nSITE_TYPE,\nISACTIVE,\nSITE_DESCRIPTION,\nSITE_OWNERSHIP_TYPE,\nADDRESS_STATUS_CODE,\nADDRESS_ERROR_CODE,\nRAWADDRESS_LINE1,\nRAWADDRESS_LINE2,\nRAWCITY,\nRAWSTATE_CODE,\nRAWPOSTAL_CODE,\nRAWCOUNTRY_CODE,\nSTASTREET_NAME,\nSTASTREET_NUMBER,\nSTACITY,\nSTASTATE_CODE,\nSTAPOSTAL_CODE,\nSTACOUNTRY_CODE,\nSTALATITUDE,\nSTALONGITUDE,\nOPERATIONS_START_DATE,\nOPERATIONS_END_DATE,\nCUSTOMER_OPEN_DATE,\nCUSTOMER_CLOSE_DATE,\nLOCAL_CURRENCY_CODE,\nLOCAL_UNIT_OF_MEASURE_ARE,\nTOTAL_SITE_AREA,\nOPERATIONS_SITE_AREA,\nCUSTOMER_SITE_AREA,\nSITE_SHIP_TO,\nRAW_MAIN_PHONE,\nSTD_MAIN_PHONE,\nMAIN_PHONE_STATUS_CODE,\nRAW_FAX,\nSTD_FAX,\nFAX_STATUS_CODE,\nRAW_CS_PHONE,\nSTD_CS_PHONE,\nCS_PHONE_STATUS_CODE,\nRAW_CS_EMAIL,\nVLD_CS_EMAIL,\nRAW_SALES_PHONE,\nSTD_SALES_PHONE,\nSALES_PHONE_STATUS_CODE,\nRAW_SALES_CHAT,\nRAW_SERVICE_PHONE,\nSTD_SERVICE_PHONE,\nSERVICE_PHONE_STATUS_CODE,\nRAW_SERVICE_CHAT,\nFP_WAREHOUSE_PARENT,\nFS_WAREHOUSE_PARENT,\nLICENSED_TERRITORY,\nDISTRICT_MANAGER,\nSTORE_MODEL,\nTUA_EXPIRATION_DATE,\nF_SITE_LEGAL_ENTITY,\nSTORE_PROSPECT_ID,\nNUMBER_OF_DOCK_DOORS,\nPRIMARY_PROFIT_CENTER,\nRETAIL_SYSTEMS_NUMBER,\nGOOGLE_ID,\nLEGACY_STORE_NUMBER,\nLEGACY_ERP_DATABASE_NAME,\nROW_NUMBER() OVER (PARTITION BY B_SOURCEID, B_PUBID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SD_SITE_MAIN WITH (NOLOCK) \n) SL     WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_PUBID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_SOURCEID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										},
										"sink": {
											"name": "ISACTIVE",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_DESCRIPTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_OWNERSHIP_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ADDRESS_ERROR_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "OPERATIONS_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_OPEN_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "CUSTOMER_CLOSE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_CURRENCY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LOCAL_UNIT_OF_MEASURE_ARE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "TOTAL_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "OPERATIONS_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										},
										"sink": {
											"name": "CUSTOMER_SITE_AREA",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 12
										}
									},
									{
										"source": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_SHIP_TO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_MAIN_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "MAIN_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_FAX",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FAX_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_CS_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CS_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "VLD_CS_EMAIL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SALES_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SALES_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SALES_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STD_SERVICE_PHONE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SERVICE_PHONE_STATUS_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAW_SERVICE_CHAT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LICENSED_TERRITORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DISTRICT_MANAGER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_MODEL",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "TUA_EXPIRATION_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STORE_PROSPECT_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "NUMBER_OF_DOCK_DOORS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PRIMARY_PROFIT_CENTER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "RETAIL_SYSTEMS_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "GOOGLE_ID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										},
										"sink": {
											"name": "LEGACY_STORE_NUMBER",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 10
										}
									},
									{
										"source": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "LEGACY_ERP_DATABASE_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE1",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWADDRESS_LINE2",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWSTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "RAWCOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTREET_NUMBER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STASTATE_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STAPOSTAL_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STACOUNTRY_CODE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALATITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "STALONGITUDE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										},
										"sink": {
											"name": "F_SITE_LEGAL_ENTITY",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_WAREHOUSE_PARENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SD_SITE_MAIN",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetNewLoadId",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "DECLARE @RETURN_VALUE_ARGUMENT DECIMAL\r\nEXECUTE [dbo].[GET_NEW_LOADID]\r\n@RETURN_VALUE_ARGUMENT OUTPUT\r\n,@P_DATA_LOCATION_NAME = 'Retail_SiteMaster'\r\n,@P_PROGRAM_NAME = 'SiteMasterLoad'\r\n,@P_LOAD_DESCRIPTION = 'SiteMasterLoad'\r\n,@P_USERNAME = 'semadmin'\r\nSELECT @RETURN_VALUE_ARGUMENT AS RETURN_VALUE_ARGUMENT",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Semarchy_Repo",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "SetNewLoadId",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetNewLoadId",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "LoadID",
							"value": {
								"value": "@{activity('GetNewLoadId').output.firstRow.RETURN_VALUE_ARGUMENT}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "IncrementalSiteContentView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteMainView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nCONTENT_CATEGORY,\nCONTENT_TYPE,\nCONTENT_SHORT_TEXT,\nCONTENT_LONG_TEXT,\nCONTENT_LANGUAGE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CONTENT_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CONTENT_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CONTENT WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"CONTENT_TYPE"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CONTENT_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_CATEGORY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_SHORT_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LONG_TEXT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CONTENT_LANGUAGE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_CONTENT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteDefaultHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteContentView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nDAY_OF_WEEK,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_DEFAULT_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_DEFAULT_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_DEFAULT_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBatchTimeout": "00:30:00",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"FS_SITE_MAIN",
										"SITE_HOURS_TYPE",
										"DAY_OF_WEEK"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_DEFAULT_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DAY_OF_WEEK",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_SITE_DEFAULT_HOURS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "SubmitLoad",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IncrementalSiteProgramView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SUBMIT_LOAD]",
							"storedProcedureParameters": {
								"P_INTEGRATION_JOB_NAME": {
									"value": {
										"value": "SiteMasterLoad",
										"type": "Expression"
									},
									"type": "String"
								},
								"P_LOAD_ID": {
									"value": {
										"value": "@variables('LoadID')",
										"type": "Expression"
									},
									"type": "Decimal"
								},
								"P_USERNAME": {
									"value": {
										"value": "semadmin",
										"type": "Expression"
									},
									"type": "String"
								},
								"return_value_argument": {
									"value": null,
									"type": "Decimal"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "semarchy_repo",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IncrementalSiteCustomeHoursView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteDefaultHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nSITE_HOURS_TYPE,\nCUSTOM_HOURS_REASON,\nSITE_DATE,\nSTART_TIME,\nEND_TIME,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_CUSTOM_HOURS_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_CUSTOM_HOURS_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_CUSTOM_HOURS WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_CUSTOM_HOURS_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SITE_HOURS_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "CUSTOM_HOURS_REASON",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "SITE_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "START_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "END_TIME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Custome_Hours",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IncrementalSiteProgramView",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IncrementalSiteCustomeHoursView",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"additionalColumns": [
									{
										"name": "LoadId",
										"value": {
											"value": "@variables('LoadID')",
											"type": "Expression"
										}
									}
								],
								"sqlReaderQuery": {
									"value": "SELECT * FROM (\nSELECT B_CLASSNAME,\nB_CREDATE,\nPROGRAM_NAME,\nPROGRAM_START_DATE,\nPROGRAM_END_DATE,\nFP_SITE_MAIN,\nFS_SITE_MAIN,\nSITE_PROGRAM_ID,\nROW_NUMBER() OVER (PARTITION BY SITE_PROGRAM_ID ORDER BY B_UPDDATE DESC) RowOneWins\n    FROM SA_SITE_PROGRAM WITH (NOLOCK) \n) SL WHERE SL.RowOneWins = 1",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "LoadId",
											"type": "String"
										},
										"sink": {
											"name": "B_LOADID",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 38
										}
									},
									{
										"source": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										},
										"sink": {
											"name": "SITE_PROGRAM_ID",
											"type": "Guid",
											"physicalType": "uniqueidentifier"
										}
									},
									{
										"source": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "B_CLASSNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "B_CREDATE",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PROGRAM_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_START_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "PROGRAM_END_DATE",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FP_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "FS_SITE_MAIN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MasterDataHub_SiteMaster",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Retail_SiteMaster_SA_Site_Program",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"LoadID": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SiteMaster/Archive"
				},
				"annotations": [],
				"lastPublishTime": "2024-12-27T12:10:05Z"
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/datasets/MasterDataHub_SiteMaster')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SD_SITE_MAIN')]",
				"[concat(variables('factoryId'), '/datasets/Semarchy_Repo')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_CONTENT')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_SITE_DEFAULT_HOURS')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_Custome_Hours')]",
				"[concat(variables('factoryId'), '/datasets/Retail_SiteMaster_SA_Site_Program')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/All_Max_CustomerMasterId_CustomerInfo')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CANADA_Postal_Code_Table')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Ref_PostalCode",
					"table": "GeocoderCA_PCensusNWE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CDP_Customer_Dedeped')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"CDP_TableName": {
						"type": "string"
					},
					"Table_Schema": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Table_Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().CDP_TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CDP_Customer_Deduped_csv')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "String"
					},
					"Container_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().Container_Name",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Canada_Postal_Code_File')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"filename_canada": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().filename_canada",
							"type": "Expression"
						},
						"folderPath": "Postal_Code_Source_Files",
						"fileSystem": "postal-code"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "PostCode",
						"type": "String"
					},
					{
						"name": "Latitude",
						"type": "String"
					},
					{
						"name": "Longitude",
						"type": "String"
					},
					{
						"name": "City",
						"type": "String"
					},
					{
						"name": "Province",
						"type": "String"
					},
					{
						"name": "CityAlt",
						"type": "String"
					},
					{
						"name": "Neighborhood",
						"type": "String"
					},
					{
						"name": "Time Zone",
						"type": "String"
					},
					{
						"name": "Name",
						"type": "String"
					},
					{
						"name": "Area Code",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_cmauid",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_pruid",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_ername",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_csdtype",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_cmatype",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_cdname",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_csduid",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_cdtype",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_sactype",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_saccode",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_prname",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_cmapuid",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_csdname",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_cduid",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_ccsname",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_eruid",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_ccsuid",
						"type": "String"
					},
					{
						"name": "Census_Subdivision_cmaname",
						"type": "String"
					},
					{
						"name": "Aggregate_Dissemination_pruid",
						"type": "String"
					},
					{
						"name": "Aggregate_Dissemination_cdname",
						"type": "String"
					},
					{
						"name": "Aggregate_Dissemination_cdtype",
						"type": "String"
					},
					{
						"name": "Aggregate_Dissemination_cduid",
						"type": "String"
					},
					{
						"name": "Aggregate_Dissemination_adauid",
						"type": "String"
					},
					{
						"name": "Aggregate_Dissemination_prname",
						"type": "String"
					},
					{
						"name": "Population_Ecumene_ecumene",
						"type": "String"
					},
					{
						"name": "Population_Ecumene_ecuid",
						"type": "String"
					},
					{
						"name": "Census_Consolidated_Subdivision_pruid",
						"type": "String"
					},
					{
						"name": "Census_Consolidated_Subdivision_cdname",
						"type": "String"
					},
					{
						"name": "Census_Consolidated_Subdivision_cdtype",
						"type": "String"
					},
					{
						"name": "Census_Consolidated_Subdivision_ccsname",
						"type": "String"
					},
					{
						"name": "Census_Consolidated_Subdivision_cduid",
						"type": "String"
					},
					{
						"name": "Census_Consolidated_Subdivision_ccsuid",
						"type": "String"
					},
					{
						"name": "Census_Consolidated_Subdivision_prname",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_cmauid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_pruid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_ctuid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_ername",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_csdtype",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_ctname",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_cmatype",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_csduid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_cdname",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_dbuid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_cdtype",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_sactype",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_adauid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_saccode",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_dauid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_prname",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_cmapuid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_dbrplamx",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_feduid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_dbrplamy",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_csdname",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_fedname",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_cduid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_ccsname",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_eruid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_ccsuid",
						"type": "String"
					},
					{
						"name": "Dissemination_Block_cmaname",
						"type": "String"
					},
					{
						"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_pruid",
						"type": "String"
					},
					{
						"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmauid",
						"type": "String"
					},
					{
						"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmatype",
						"type": "String"
					},
					{
						"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_prname",
						"type": "String"
					},
					{
						"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmaname",
						"type": "String"
					},
					{
						"name": "Census_Metropolitan_Areas_And_Census_Agglomeration_cmapuid",
						"type": "String"
					},
					{
						"name": "Designated_Place_pruid",
						"type": "String"
					},
					{
						"name": "Designated_Place_dpluid",
						"type": "String"
					},
					{
						"name": "Designated_Place_dplname",
						"type": "String"
					},
					{
						"name": "Designated_Place_prname",
						"type": "String"
					},
					{
						"name": "Designated_Place_dpltype",
						"type": "String"
					},
					{
						"name": "Census_Division_pruid",
						"type": "String"
					},
					{
						"name": "Census_Division_cdname",
						"type": "String"
					},
					{
						"name": "Census_Division_cdtype",
						"type": "String"
					},
					{
						"name": "Census_Division_cduid",
						"type": "String"
					},
					{
						"name": "Census_Division_prname",
						"type": "String"
					},
					{
						"name": "Federal_Election_frname",
						"type": "String"
					},
					{
						"name": "Federal_Election_revdt",
						"type": "String"
					},
					{
						"name": "Federal_Election_creadt",
						"type": "String"
					},
					{
						"name": "Federal_Election_enname",
						"type": "String"
					},
					{
						"name": "Federal_Election_nid",
						"type": "String"
					},
					{
						"name": "Federal_Election_provcode",
						"type": "String"
					},
					{
						"name": "Federal_Election_quipopcnt",
						"type": "String"
					},
					{
						"name": "Federal_Election_fednum",
						"type": "String"
					},
					{
						"name": "Federal_Election_decpopcnt",
						"type": "String"
					},
					{
						"name": "Federal_Election_reporder",
						"type": "String"
					},
					{
						"name": "Census_Tract_cmauid",
						"type": "String"
					},
					{
						"name": "Census_Tract_pruid",
						"type": "String"
					},
					{
						"name": "Census_Tract_ctuid",
						"type": "String"
					},
					{
						"name": "Census_Tract_cmatype",
						"type": "String"
					},
					{
						"name": "Census_Tract_ctname",
						"type": "String"
					},
					{
						"name": "Census_Tract_prname",
						"type": "String"
					},
					{
						"name": "Census_Tract_cmaname",
						"type": "String"
					},
					{
						"name": "Census_Tract_cmapuid",
						"type": "String"
					},
					{
						"name": "Economic_Region_pruid",
						"type": "String"
					},
					{
						"name": "Economic_Region_ername",
						"type": "String"
					},
					{
						"name": "Economic_Region_eruid",
						"type": "String"
					},
					{
						"name": "Economic_Region_prname",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_cmauid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_pruid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_ctuid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_ername",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_csdtype",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_ctname",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_cmatype",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_csduid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_cdname",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_cdtype",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_sactype",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_adauid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_saccode",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_dauid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_prname",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_cmapuid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_csdname",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_cduid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_ccsname",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_eruid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_ccsuid",
						"type": "String"
					},
					{
						"name": "Dissemination_Area_cmaname",
						"type": "String"
					},
					{
						"name": "Population_Centre_cmauid",
						"type": "String"
					},
					{
						"name": "Population_Centre_pruid",
						"type": "String"
					},
					{
						"name": "Population_Centre_pcclass",
						"type": "String"
					},
					{
						"name": "Population_Centre_pcuid",
						"type": "String"
					},
					{
						"name": "Population_Centre_cmatype",
						"type": "String"
					},
					{
						"name": "Population_Centre_pcname",
						"type": "String"
					},
					{
						"name": "Population_Centre_pctype",
						"type": "String"
					},
					{
						"name": "Population_Centre_pcpuid",
						"type": "String"
					},
					{
						"name": "Population_Centre_prname",
						"type": "String"
					},
					{
						"name": "Population_Centre_cmaname",
						"type": "String"
					},
					{
						"name": "Population_Centre_cmapuid",
						"type": "String"
					},
					{
						"name": "Census_Agricultural_pruid",
						"type": "String"
					},
					{
						"name": "Census_Agricultural_caruid",
						"type": "String"
					},
					{
						"name": "Census_Agricultural_carename",
						"type": "String"
					},
					{
						"name": "Census_Agricultural_carfname",
						"type": "String"
					},
					{
						"name": "Census_Agricultural_prname",
						"type": "String"
					},
					{
						"name": "ISED",
						"type": "String"
					},
					{
						"name": "ISEDname",
						"type": "String"
					},
					{
						"name": "Provincial_Riding_of",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Colorwheel')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Colorwheel.parquet",
						"folderPath": "Retail/SupplyChain/Colorwheel",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Colorwheel_Historical')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "HistoricalColorwheel.parquet",
						"folderPath": "Retail/SupplyChain/HistoricalColorwheel",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Contaierrate')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "MonthEndContainerStandards1.csv",
						"folderPath": "Retail/SupplyChain/MonthEndContainerStandards",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Containerrate_Parquet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "containerrate.parquet",
						"fileSystem": "test"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Containerrate_csv')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Containerrate.csv",
						"fileSystem": "test"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID\tglobalID\tconfidence_score\tRecID\tposRawContainerRecID\tmarket_id\tposFirstName\tposMiddleInitial\tposLastName\tposCustomerEmail1\tposCustomerEmail2\tposCustomerEmail3\tposCustomerPhone1\tposCustomerPhone2\tposCustomerPhone3\tn_address\tn_addr2\tn_city\tn_state\tn_zip9\tposFaceBookID\tposTwitterID\ttimestamp\tcustomer_type\tcustomer_since\tSourceSystem\tSourceSubSystem",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Address')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "String"
					},
					"TableName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Address_Blob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Address_Exact')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "String"
					},
					"TableName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Address_Exact_Blob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Email')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "String"
					},
					"TableName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Email_Blob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Email_Exact')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "String"
					},
					"TableName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Email_Exact_Blob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Phone_Exact')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "String"
					},
					"TableName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_Fake_Phone_Exact_Blob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DAC_Location_Details_Read')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "input.txt",
						"folderPath": "dac_store_details",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DAC_Location_Details_Read1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "input.txt",
						"folderPath": "dac_store_details",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DAC_Location_Details_Write')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "dac_store_details",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "",
					"quoteChar": ""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DAC_Location_Details_Write1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "dac_store_details",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "",
					"quoteChar": ""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DAC_Location_List_Read')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "dac_api_staging",
						"fileSystem": "raw-zone"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DAC_Location_List_Write')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "dac_api_staging",
						"fileSystem": "raw-zone"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DSPOSTALCODEHIST')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ENT_REF_POSTAL_CODE_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "varchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_OR_PROVINCE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "CITY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "CITY_ABBREVIATION",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "varchar"
					},
					{
						"name": "TIME_ZONE",
						"type": "varchar"
					},
					{
						"name": "OBSERVES_DST",
						"type": "bit"
					},
					{
						"name": "LATITUDE",
						"type": "decimal",
						"precision": 9,
						"scale": 5
					},
					{
						"name": "LONGITUDE",
						"type": "decimal",
						"precision": 9,
						"scale": 5
					},
					{
						"name": "IS_PREFERRED_CITY_NAME",
						"type": "bit"
					},
					{
						"name": "POSTAL_CODE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "MSA_CODE",
						"type": "nvarchar"
					},
					{
						"name": "FIPS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					},
					{
						"name": "active_flag",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Ref_PostalCode",
					"table": "PostalCode_History"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DSSEMGBLUS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "zipZzipcd",
						"type": "varchar"
					},
					{
						"name": "zipZstate",
						"type": "varchar"
					},
					{
						"name": "zipZctynm",
						"type": "varchar"
					},
					{
						"name": "zipZctyab",
						"type": "varchar"
					},
					{
						"name": "zipZconyn",
						"type": "varchar"
					},
					{
						"name": "zipZcountry",
						"type": "varchar"
					},
					{
						"name": "zipMSA",
						"type": "varchar"
					},
					{
						"name": "zipTimeZoneCode",
						"type": "varchar"
					},
					{
						"name": "zipDayLightSavings",
						"type": "char"
					},
					{
						"name": "zipLat",
						"type": "decimal",
						"precision": 7,
						"scale": 4
					},
					{
						"name": "zipLong",
						"type": "decimal",
						"precision": 8,
						"scale": 4
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "acrec",
						"type": "varchar"
					},
					{
						"name": "zipPreferred",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "GBLDynamic",
					"table": "tblZipCode"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DSSEMSTGGBLDYNAMICSCAN')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "znuPostalCode",
						"type": "varchar"
					},
					{
						"name": "znuCity",
						"type": "varchar"
					},
					{
						"name": "znuProvince",
						"type": "varchar"
					},
					{
						"name": "znuCountryCode",
						"type": "varchar"
					},
					{
						"name": "znuCityAbbrev",
						"type": "varchar"
					},
					{
						"name": "znuTimeZone",
						"type": "varchar"
					},
					{
						"name": "znuDayLightSavings",
						"type": "char"
					},
					{
						"name": "znuLat",
						"type": "decimal",
						"precision": 7,
						"scale": 4
					},
					{
						"name": "znuLong",
						"type": "decimal",
						"precision": 8,
						"scale": 4
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "smalldatetime",
						"precision": 16,
						"scale": 0
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "smalldatetime",
						"precision": 16,
						"scale": 0
					}
				],
				"typeProperties": {
					"schema": "GBLDynamic",
					"table": "tblZipNonUSA"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DSSEMSTGSQLDYNAMICSCAN')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "znuPostalCode",
						"type": "varchar"
					},
					{
						"name": "znuCity",
						"type": "varchar"
					},
					{
						"name": "znuProvince",
						"type": "varchar"
					},
					{
						"name": "znuCountryCode",
						"type": "varchar"
					},
					{
						"name": "znuCityAbbrev",
						"type": "varchar"
					},
					{
						"name": "znuTimeZone",
						"type": "varchar"
					},
					{
						"name": "znuDayLightSavings",
						"type": "char"
					},
					{
						"name": "znuLat",
						"type": "decimal",
						"precision": 7,
						"scale": 4
					},
					{
						"name": "znuLong",
						"type": "decimal",
						"precision": 8,
						"scale": 4
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "smalldatetime",
						"precision": 16,
						"scale": 0
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "smalldatetime",
						"precision": 16,
						"scale": 0
					}
				],
				"typeProperties": {
					"schema": "SQLDynamic",
					"table": "tblZipNonUSA"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DSSEMSTGUSSQLDYNAMICS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "zipZzipcd",
						"type": "varchar"
					},
					{
						"name": "zipZstate",
						"type": "varchar"
					},
					{
						"name": "zipZctynm",
						"type": "varchar"
					},
					{
						"name": "zipZctyab",
						"type": "varchar"
					},
					{
						"name": "zipZconyn",
						"type": "varchar"
					},
					{
						"name": "zipZcountry",
						"type": "varchar"
					},
					{
						"name": "zipMSA",
						"type": "varchar"
					},
					{
						"name": "zipTimeZoneCode",
						"type": "varchar"
					},
					{
						"name": "zipDayLightSavings",
						"type": "char"
					},
					{
						"name": "zipLat",
						"type": "decimal",
						"precision": 7,
						"scale": 4
					},
					{
						"name": "zipLong",
						"type": "decimal",
						"precision": 8,
						"scale": 4
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "acrec",
						"type": "varchar"
					},
					{
						"name": "zipPreferred",
						"type": "bit"
					},
					{
						"name": "zipType",
						"type": "char"
					}
				],
				"typeProperties": {
					"schema": "SQLDynamic",
					"table": "tblZipCode"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_ASHLEY_EDW_EDME')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SchemaName": {
						"type": "string"
					},
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_AshleyWarehouseMaster')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "wmaWarehouse",
						"type": "char"
					},
					{
						"name": "wmaLocationId",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "wmaIntransitWarehouse",
						"type": "char"
					},
					{
						"name": "wmaSiteId",
						"type": "char"
					},
					{
						"name": "wmaMROSiteId",
						"type": "char"
					},
					{
						"name": "wmaWarehouseType",
						"type": "char"
					},
					{
						"name": "wmaWarehouseOrderGroup",
						"type": "varchar"
					},
					{
						"name": "wmaWarehouseSourceId",
						"type": "varchar"
					},
					{
						"name": "wmaRouteType",
						"type": "char"
					},
					{
						"name": "wmaDefaultPortId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "wmaControlled",
						"type": "bit"
					},
					{
						"name": "wmaPrinterName",
						"type": "varchar"
					},
					{
						"name": "wmaZebraPrinter",
						"type": "varchar"
					},
					{
						"name": "wmaSendBolsToManu",
						"type": "char"
					},
					{
						"name": "wmaOrderReleaseMin",
						"type": "int",
						"precision": 10
					},
					{
						"name": "wmaOrderReleaseMinType",
						"type": "char"
					},
					{
						"name": "wmaDefaultShipId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "wmaSortOrder",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "wmaAsOverhead",
						"type": "int",
						"precision": 10
					},
					{
						"name": "wmaAsFreight",
						"type": "int",
						"precision": 10
					},
					{
						"name": "wmaContainerDirectWhse",
						"type": "char"
					},
					{
						"name": "acrec",
						"type": "char"
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "wmaWhereMade",
						"type": "char"
					},
					{
						"name": "wmaManufacturingSite",
						"type": "varchar"
					},
					{
						"name": "wmaSellableWarehouse",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "AshleyWarehouseMaster"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_CustomerDiscountPrograms')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "START_DATE",
						"type": "date"
					},
					{
						"name": "END_DATE",
						"type": "date"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "LOAD_PROGRAM_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_DB_Query')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EDW_Dev')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SchemaName": {
						"type": "string"
					},
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "Masterdata_Finance",
					"table": "MonthEndContainerStandards"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EDW_WHSMST')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "WHID",
						"type": "char"
					},
					{
						"name": "DESC",
						"type": "char"
					},
					{
						"name": "TYPE",
						"type": "char"
					},
					{
						"name": "SELL",
						"type": "char"
					},
					{
						"name": "PRPL",
						"type": "char"
					},
					{
						"name": "PLCD",
						"type": "char"
					},
					{
						"name": "LSPD",
						"type": "decimal",
						"precision": 7,
						"scale": 0
					},
					{
						"name": "LDEP",
						"type": "char"
					},
					{
						"name": "RPDS",
						"type": "char"
					},
					{
						"name": "FCDS",
						"type": "decimal",
						"precision": 4,
						"scale": 0
					},
					{
						"name": "BCDS",
						"type": "decimal",
						"precision": 4,
						"scale": 0
					},
					{
						"name": "ECCUCD",
						"type": "char"
					},
					{
						"name": "ECSTCD",
						"type": "char"
					},
					{
						"name": "IIRO",
						"type": "char"
					},
					{
						"name": "SCPI",
						"type": "char"
					},
					{
						"name": "GSCD",
						"type": "char"
					},
					{
						"name": "WHLC",
						"type": "char"
					},
					{
						"name": "CWHS",
						"type": "char"
					},
					{
						"name": "UUCAWH",
						"type": "char"
					},
					{
						"name": "ETPO",
						"type": "char"
					},
					{
						"name": "CNTY",
						"type": "char"
					},
					{
						"name": "STCD",
						"type": "char"
					},
					{
						"name": "TXCNT",
						"type": "char"
					},
					{
						"name": "TXCIY",
						"type": "char"
					},
					{
						"name": "WZIP",
						"type": "char"
					},
					{
						"name": "STID",
						"type": "char"
					},
					{
						"name": "BFFL",
						"type": "decimal",
						"precision": 1,
						"scale": 0
					},
					{
						"name": "AA0B",
						"type": "char"
					},
					{
						"name": "UUIAWH",
						"type": "char"
					},
					{
						"name": "CALP",
						"type": "char"
					},
					{
						"name": "CALR",
						"type": "char"
					},
					{
						"name": "ALST",
						"type": "char"
					},
					{
						"name": "APSW",
						"type": "char"
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "WHSMST"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_EDW_portmater')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "pteID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "pteAESPortCode",
						"type": "char"
					},
					{
						"name": "ptePortDescription",
						"type": "varchar"
					},
					{
						"name": "pteCityOfPort",
						"type": "varchar"
					},
					{
						"name": "pteStateOfPort",
						"type": "char"
					},
					{
						"name": "pteCountryOfPort",
						"type": "char"
					},
					{
						"name": "pteFobPortCode",
						"type": "char"
					},
					{
						"name": "pteFOBPortActiveRecordFlag",
						"type": "bit"
					},
					{
						"name": "pteEndPortCode",
						"type": "int",
						"precision": 10
					},
					{
						"name": "pteEndPortActiveRecordFlag",
						"type": "bit"
					},
					{
						"name": "pteLastModifiedUser",
						"type": "varchar"
					},
					{
						"name": "pteShortPortDescription",
						"type": "varchar"
					},
					{
						"name": "acrec",
						"type": "char"
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "pteCanadaActiveRecordFlag",
						"type": "bit"
					},
					{
						"name": "pteCanadaBorderServiceAgency",
						"type": "char"
					},
					{
						"name": "pteZipCode",
						"type": "varchar"
					},
					{
						"name": "pteGeoLatitude",
						"type": "decimal",
						"precision": 13,
						"scale": 4
					},
					{
						"name": "pteGeoLongitude",
						"type": "decimal",
						"precision": 11,
						"scale": 4
					},
					{
						"name": "pteGeoAccuracy",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "PortMaster"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Orders_RCM')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_PIM_PRODUCT_HIST')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Retail",
					"table": "PIM_PRODUCT_HIST"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_PostalCode_US')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Filename": {
						"type": "string"
					},
					"FolderName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().Filename",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().FolderName",
							"type": "Expression"
						},
						"fileSystem": "postal-code"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Postalcode_Processed_files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Postalcode_ReleaseURL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Postalcode",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ID": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat('/releases/data/z5max.txt','?FORMAT=JSON&ID=',dataset().ID)",
							"type": "Expression"
						}
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Postalcode')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Postalcode_releaseurl_src')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Postalcode",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ID": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "HttpFile",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat('/releases/data/z5max.txt','?FORMAT=JSON&ID=',dataset().ID)",
						"type": "Expression"
					},
					"requestMethod": "GET",
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat('/releases/data/z5max.txt','?FORMAT=JSON&ID=',dataset().ID)",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Postalcode')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Releaseurl_Sink')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "release.txt",
						"folderPath": "Archive",
						"fileSystem": "postal-code"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_SA_ORDERS_RCM')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ORDER_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "ORDER_DATE",
						"type": "date"
					},
					{
						"name": "ORDER_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "SOURCE_ORDER_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "CUSTOMER_PUBLISHER_ID",
						"type": "nvarchar"
					},
					{
						"name": "CUSTOMER_SOURCE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_ORDERS"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_SD_DISCOUNT_PROGRAM_MEMSHIP')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PROGRAM_ID",
						"type": "nvarchar"
					},
					{
						"name": "SOURCE_PROGRAM_ID",
						"type": "nvarchar"
					},
					{
						"name": "START_DATE",
						"type": "date"
					},
					{
						"name": "END_DATE",
						"type": "date"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_DISCOUNT_PROGRAM_MEMSHIP"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_SEM_STG_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Location",
						"type": "varchar"
					},
					{
						"name": "BindyID",
						"type": "varchar"
					},
					{
						"name": "Account",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ShipTo",
						"type": "varchar"
					},
					{
						"name": "Entity",
						"type": "varchar"
					},
					{
						"name": "LicenseeContact",
						"type": "varchar"
					},
					{
						"name": "Address",
						"type": "varchar"
					},
					{
						"name": "City",
						"type": "varchar"
					},
					{
						"name": "State",
						"type": "varchar"
					},
					{
						"name": "Zip",
						"type": "varchar"
					},
					{
						"name": "Country",
						"type": "varchar"
					},
					{
						"name": "WarehouseSqFt",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WarehouseDockDoors",
						"type": "int",
						"precision": 10
					},
					{
						"name": "IsEcomFulfiller",
						"type": "varchar"
					},
					{
						"name": "AcquisitionDate",
						"type": "date"
					},
					{
						"name": "ModifiedDate",
						"type": "datetime2",
						"scale": 7
					}
				],
				"typeProperties": {
					"schema": "Smartsheet",
					"table": "RDCMasterlist"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_SemStaging_Portmaster')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "pteID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "pteAESPortCode",
						"type": "char"
					},
					{
						"name": "ptePortDescription",
						"type": "varchar"
					},
					{
						"name": "pteCityOfPort",
						"type": "varchar"
					},
					{
						"name": "pteStateOfPort",
						"type": "char"
					},
					{
						"name": "pteCountryOfPort",
						"type": "char"
					},
					{
						"name": "pteFobPortCode",
						"type": "char"
					},
					{
						"name": "pteFOBPortActiveRecordFlag",
						"type": "bit"
					},
					{
						"name": "pteEndPortCode",
						"type": "int",
						"precision": 10
					},
					{
						"name": "pteEndPortActiveRecordFlag",
						"type": "bit"
					},
					{
						"name": "pteLastModifiedUser",
						"type": "varchar"
					},
					{
						"name": "pteShortPortDescription",
						"type": "varchar"
					},
					{
						"name": "acrec",
						"type": "char"
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "pteCanadaActiveRecordFlag",
						"type": "bit"
					},
					{
						"name": "pteCanadaBorderServiceAgency",
						"type": "char"
					},
					{
						"name": "pteZipCode",
						"type": "varchar"
					},
					{
						"name": "pteGeoLatitude",
						"type": "decimal",
						"precision": 13,
						"scale": 4
					},
					{
						"name": "pteGeoLongitude",
						"type": "decimal",
						"precision": 11,
						"scale": 4
					},
					{
						"name": "pteGeoAccuracy",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wholesale",
					"table": "PortMaster"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_SemStaging_WHSMST')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Wholesale",
					"table": "WHSMST"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Sem_Staging_wholesale')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SchemaName": {
						"type": "string"
					},
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Semarchy_Wholesale_GD')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Wholesale_sitemaster",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SchemaName": {
						"type": "string"
					},
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Wholesale_sitemaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Semarchy_staging')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SchemaName": {
						"type": "string"
					},
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_CLASSNAME",
						"type": "varchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "B_CREATOR",
						"type": "varchar"
					},
					{
						"name": "B_PUBID",
						"type": "varchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "varchar"
					},
					{
						"name": "OPERATIONAL_STATUS",
						"type": "varchar"
					},
					{
						"name": "TYPE",
						"type": "varchar"
					},
					{
						"name": "ACCOUNT_NUMBER",
						"type": "varchar"
					},
					{
						"name": "SHIP_TO_NUM",
						"type": "varchar"
					},
					{
						"name": "MODEL",
						"type": "varchar"
					},
					{
						"name": "VERSION",
						"type": "varchar"
					},
					{
						"name": "TIME_ZONE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LOCAL_CURRENCY_CODE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "RAW_PHONE",
						"type": "varchar"
					},
					{
						"name": "RAW_CS_PHONE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "RAW_FAX",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SMS_CODE",
						"type": "varchar"
					},
					{
						"name": "SOFT_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "GRAND_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "CLOSE_DATE",
						"type": "date"
					},
					{
						"name": "AREA_UNIT_OF_MEASURE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "BUILDING_SQFT",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WAREHOUSE_SQFT",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SHOWROOM_SQFT",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "OFFICE_SQFT",
						"type": "int",
						"precision": 10
					},
					{
						"name": "NUM_OF_DOCK_DOORS",
						"type": "int",
						"precision": 10
					},
					{
						"name": "RETAIL_SYSTEM_NUM",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ENTERPRISE_STORE_NUM",
						"type": "int",
						"precision": 10
					},
					{
						"name": "F_GOOGLE_ID",
						"type": "varchar"
					},
					{
						"name": "PROSPECT_ID",
						"type": "varchar"
					},
					{
						"name": "DMA_ID",
						"type": "decimal",
						"precision": 17,
						"scale": 0
					},
					{
						"name": "DMA",
						"type": "varchar"
					},
					{
						"name": "MSA_ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "MSA",
						"type": "int",
						"precision": 10
					},
					{
						"name": "MARKET",
						"type": "varchar"
					},
					{
						"name": "REGION",
						"type": "varchar"
					},
					{
						"name": "DOMESTIC_CATEGORY",
						"type": "varchar"
					},
					{
						"name": "COUNTRY_CATEGORY",
						"type": "varchar"
					},
					{
						"name": "FP_SUPPORTING_WAREHOUSE",
						"type": "varchar"
					},
					{
						"name": "FS_SUPPORTING_WAREHOUSE",
						"type": "varchar"
					},
					{
						"name": "CHANGE_TYPE",
						"type": "varchar"
					},
					{
						"name": "RECORD_INSERT_DATE",
						"type": "varchar"
					},
					{
						"name": "RECORD_UPDATE_DATE",
						"type": "varchar"
					},
					{
						"name": "B_LoadID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SchemaName": {
						"type": "string"
					},
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_StoreMasterlist')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "LocationKey",
						"type": "varchar"
					},
					{
						"name": "ProspectID",
						"type": "varchar"
					},
					{
						"name": "GoogleID",
						"type": "varchar"
					},
					{
						"name": "BindyID",
						"type": "varchar"
					},
					{
						"name": "StoreID",
						"type": "varchar"
					},
					{
						"name": "ProfitCenter",
						"type": "varchar"
					},
					{
						"name": "Location",
						"type": "varchar"
					},
					{
						"name": "Country",
						"type": "varchar"
					},
					{
						"name": "Account",
						"type": "varchar"
					},
					{
						"name": "StoreFrontShipTo",
						"type": "varchar"
					},
					{
						"name": "Entity",
						"type": "varchar"
					},
					{
						"name": "LicenseeContact",
						"type": "varchar"
					},
					{
						"name": "SoftOpenDate",
						"type": "date"
					},
					{
						"name": "AcquisitionDate",
						"type": "date"
					},
					{
						"name": "ClosureDate",
						"type": "date"
					},
					{
						"name": "ShopperTrakLocID",
						"type": "varchar"
					},
					{
						"name": "StoreAddress",
						"type": "varchar"
					},
					{
						"name": "City",
						"type": "varchar"
					},
					{
						"name": "StateProvince",
						"type": "varchar"
					},
					{
						"name": "ZIP",
						"type": "varchar"
					},
					{
						"name": "DMAID",
						"type": "varchar"
					},
					{
						"name": "DMARegion",
						"type": "varchar"
					},
					{
						"name": "ShowroomSqFt",
						"type": "varchar"
					},
					{
						"name": "StoreType",
						"type": "varchar"
					},
					{
						"name": "StoreModel",
						"type": "varchar"
					},
					{
						"name": "StoreVersion",
						"type": "varchar"
					},
					{
						"name": "Market",
						"type": "varchar"
					},
					{
						"name": "Region",
						"type": "varchar"
					},
					{
						"name": "BuildingOwnership",
						"type": "varchar"
					},
					{
						"name": "CountryCategory",
						"type": "varchar"
					},
					{
						"name": "DomesticCategory",
						"type": "varchar"
					},
					{
						"name": "Classification",
						"type": "varchar"
					},
					{
						"name": "StorePhone",
						"type": "varchar"
					},
					{
						"name": "DistrictManager",
						"type": "varchar"
					},
					{
						"name": "BDDirector",
						"type": "varchar"
					},
					{
						"name": "LicenseeEmail",
						"type": "varchar"
					},
					{
						"name": "LicenseePhone",
						"type": "varchar"
					},
					{
						"name": "CorporationAddress",
						"type": "varchar"
					},
					{
						"name": "CorpCity",
						"type": "varchar"
					},
					{
						"name": "CorpState",
						"type": "varchar"
					},
					{
						"name": "CorpZip",
						"type": "varchar"
					},
					{
						"name": "RDCAddress",
						"type": "varchar"
					},
					{
						"name": "RDCCity",
						"type": "varchar"
					},
					{
						"name": "RDCState",
						"type": "varchar"
					},
					{
						"name": "RDCZip",
						"type": "varchar"
					},
					{
						"name": "RDCShipTo",
						"type": "varchar"
					},
					{
						"name": "RDCSqFt",
						"type": "varchar"
					},
					{
						"name": "RDCDockDoors",
						"type": "varchar"
					},
					{
						"name": "TUAExpirationDate",
						"type": "date"
					},
					{
						"name": "LicensedTerritory",
						"type": "varchar"
					},
					{
						"name": "Latitude",
						"type": "varchar"
					},
					{
						"name": "Longitude",
						"type": "varchar"
					},
					{
						"name": "Notes",
						"type": "varchar"
					},
					{
						"name": "StoreEmail",
						"type": "varchar"
					},
					{
						"name": "Unit",
						"type": "varchar"
					},
					{
						"name": "OneSourceID",
						"type": "varchar"
					},
					{
						"name": "HSDatabaseName",
						"type": "varchar"
					},
					{
						"name": "SVP",
						"type": "varchar"
					},
					{
						"name": "VP",
						"type": "varchar"
					},
					{
						"name": "SrRD",
						"type": "varchar"
					},
					{
						"name": "RD",
						"type": "varchar"
					},
					{
						"name": "StoreManager",
						"type": "varchar"
					},
					{
						"name": "StoreMgrPhone",
						"type": "varchar"
					},
					{
						"name": "SalesManager1",
						"type": "varchar"
					},
					{
						"name": "SalesManager2",
						"type": "varchar"
					},
					{
						"name": "SalesManager3",
						"type": "varchar"
					},
					{
						"name": "SalesManager4",
						"type": "varchar"
					},
					{
						"name": "OfficeManager",
						"type": "varchar"
					},
					{
						"name": "DirectorOfOps",
						"type": "varchar"
					},
					{
						"name": "RegionalOpsMgr",
						"type": "varchar"
					},
					{
						"name": "OpsMgr",
						"type": "varchar"
					},
					{
						"name": "CompStatus",
						"type": "varchar"
					},
					{
						"name": "Kit",
						"type": "varchar"
					},
					{
						"name": "TrafficDivisor",
						"type": "varchar"
					},
					{
						"name": "ERP",
						"type": "varchar"
					},
					{
						"name": "DTCTechnology",
						"type": "varchar"
					},
					{
						"name": "DTCBrand",
						"type": "varchar"
					},
					{
						"name": "ForumID",
						"type": "varchar"
					},
					{
						"name": "AccountType",
						"type": "varchar"
					},
					{
						"name": "FacadeCurrentImage",
						"type": "varchar"
					},
					{
						"name": "WebsiteFacadeCurrent",
						"type": "varchar"
					},
					{
						"name": "StoreManagerImage",
						"type": "varchar"
					},
					{
						"name": "EnterpriseFacadeImage",
						"type": "varchar"
					},
					{
						"name": "LicenseeSalesDistrict",
						"type": "varchar"
					},
					{
						"name": "LicenseeSalesRegion",
						"type": "varchar"
					},
					{
						"name": "ModifiedDate",
						"type": "date"
					},
					{
						"name": "LicenseeMarketingManager",
						"type": "nvarchar"
					},
					{
						"name": "IMS",
						"type": "nvarchar"
					},
					{
						"name": "LeaseTerms",
						"type": "nvarchar"
					},
					{
						"name": "StatusReports",
						"type": "nvarchar"
					},
					{
						"name": "ModelCounts",
						"type": "nvarchar"
					},
					{
						"name": "Comments",
						"type": "nvarchar"
					},
					{
						"name": "DAC_ID",
						"type": "varchar"
					},
					{
						"name": "createddate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "LicenseeSalesFieldManager",
						"type": "varchar"
					},
					{
						"name": "DACID",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "Smartsheet",
					"table": "StoreMasterCustom"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_WHSMST')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_WHSMST_Semarchy')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Wholesale_sitemaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "WAREHOUSE_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "DESCRIPTION",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_WAREHOUSE_MASTER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Wholesale_sitemaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Wholesale_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Wholesale_sitemaster",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Tablename": {
						"type": "string"
					},
					"Schemaname": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schemaname",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().Tablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Wholesale_sitemaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_postalcode_releaseurl_sink')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "releaseurl.txt",
						"folderPath": "Archive",
						"fileSystem": "postal-code"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Dac_Stage_Location_List_Load')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"fileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().fileName",
							"type": "Expression"
						},
						"folderPath": "dac_api_staging",
						"fileSystem": "raw-zone"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DataAnyWhereProdRestResource')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DataAnyWhereProdRestAPI",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"relative_url_param": {
						"type": "string"
					},
					"continuation_token_param": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().relative_url_param,dataset().continuation_token_param)",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/DataAnyWhereProdRestAPI')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Delete_Error_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Retail-Customer-Source-Files",
						"fileSystem": "retail-customer"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Delete_Postal_Code_Error_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Postal_Code_Source_Files",
						"fileSystem": "postal-code"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Delete_Staging_CustomerInfo')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Delete_Succeed_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"filename_d": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().filename_d",
							"type": "Expression"
						},
						"folderPath": "Retail-Customer-Source-Files",
						"fileSystem": "retail-customer"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Test.csv",
						"folderPath": "Retail/SupplyChain/MonthEndContainterStandards",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText2')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Hist_Mar.csv",
						"folderPath": "Postal_Code_Source_Files",
						"fileSystem": "postal-code"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "B_LOADID",
						"type": "String"
					},
					{
						"name": "ENT_REF_POSTAL_CODE_ID",
						"type": "String"
					},
					{
						"name": "B_CLASSNAME",
						"type": "String"
					},
					{
						"name": "B_DELETETYPE",
						"type": "String"
					},
					{
						"name": "B_DELETEDATE",
						"type": "String"
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "String"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "String"
					},
					{
						"name": "B_CREDATE",
						"type": "String"
					},
					{
						"name": "B_UPDDATE",
						"type": "String"
					},
					{
						"name": "B_CREATOR",
						"type": "String"
					},
					{
						"name": "B_UPDATOR",
						"type": "String"
					},
					{
						"name": "POSTAL_CODE",
						"type": "String"
					},
					{
						"name": "STATE_OR_PROVINCE_CODE",
						"type": "String"
					},
					{
						"name": "CITY_NAME",
						"type": "String"
					},
					{
						"name": "CITY_ABBREVIATION",
						"type": "String"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "String"
					},
					{
						"name": "TIME_ZONE",
						"type": "String"
					},
					{
						"name": "OBSERVES_DST",
						"type": "String"
					},
					{
						"name": "LATITUDE",
						"type": "String"
					},
					{
						"name": "LONGITUDE",
						"type": "String"
					},
					{
						"name": "IS_PREFERRED_CITY_NAME",
						"type": "String"
					},
					{
						"name": "POSTAL_CODE_TYPE",
						"type": "String"
					},
					{
						"name": "MSA_CODE",
						"type": "String"
					},
					{
						"name": "FIPS_CODE",
						"type": "String"
					},
					{
						"name": "NAME",
						"type": "String"
					},
					{
						"name": "active_flag",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ECM_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Retail-Customer-Source-Files",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"nullValue": "NA",
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID",
						"type": "String"
					},
					{
						"name": "confidence_score",
						"type": "String"
					},
					{
						"name": "globalID",
						"type": "String"
					},
					{
						"name": "RecID",
						"type": "String"
					},
					{
						"name": "posRawContainerRecID",
						"type": "String"
					},
					{
						"name": "posFirstName",
						"type": "String"
					},
					{
						"name": "posMiddleInitial",
						"type": "String"
					},
					{
						"name": "posLastName",
						"type": "String"
					},
					{
						"name": "posCustomerEmail1",
						"type": "String"
					},
					{
						"name": "posCustomerEmail2",
						"type": "String"
					},
					{
						"name": "posCustomerEmail3",
						"type": "String"
					},
					{
						"name": "posCustomerPhone1",
						"type": "String"
					},
					{
						"name": "posCustomerPhone2",
						"type": "String"
					},
					{
						"name": "posCustomerPhone3",
						"type": "String"
					},
					{
						"name": "n_address",
						"type": "String"
					},
					{
						"name": "n_addr2",
						"type": "String"
					},
					{
						"name": "n_city",
						"type": "String"
					},
					{
						"name": "n_state",
						"type": "String"
					},
					{
						"name": "n_zip9",
						"type": "String"
					},
					{
						"name": "market_id",
						"type": "String"
					},
					{
						"name": "customer_type",
						"type": "String"
					},
					{
						"name": "timestamp",
						"type": "String"
					},
					{
						"name": "customer_since",
						"type": "String"
					},
					{
						"name": "SourceSystem",
						"type": "String"
					},
					{
						"name": "SourceSubSystem",
						"type": "String"
					},
					{
						"name": "racSalesNumber",
						"type": "String"
					},
					{
						"name": "racProfitCenter",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDME_DataFactory_Cdp_Customer_Preferences')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDME_DataFactory_OptOut')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDME_Datafactory')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"SchemaName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_ContainerRate_Parquet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "MonthEndContainerStandards.parquet",
						"folderPath": "Retail/SupplyChain/MonthEndContainerStandards",
						"fileSystem": "raw-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_Containerrate')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "string"
					},
					"Foldername": {
						"type": "string"
					},
					"FileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().Foldername",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_CustomersShippingLocations')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "cslCustomerNumber",
						"type": "char"
					},
					{
						"name": "cslShiptoNumber",
						"type": "char"
					},
					{
						"name": "cslMapicsSequenceNumber",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "cslName",
						"type": "varchar"
					},
					{
						"name": "csmshpa1",
						"type": "varchar"
					},
					{
						"name": "csmshpa2",
						"type": "varchar"
					},
					{
						"name": "csmshpa3",
						"type": "varchar"
					},
					{
						"name": "csmshpzp",
						"type": "varchar"
					},
					{
						"name": "csmshpst",
						"type": "char"
					},
					{
						"name": "csmshpco",
						"type": "char"
					},
					{
						"name": "csmphone",
						"type": "varchar"
					},
					{
						"name": "csmfaxtn",
						"type": "varchar"
					},
					{
						"name": "cslTaxExempt",
						"type": "char"
					},
					{
						"name": "csmwebsite",
						"type": "varchar"
					},
					{
						"name": "csmemail",
						"type": "varchar"
					},
					{
						"name": "cslCommissionCode",
						"type": "char"
					},
					{
						"name": "cslFreightCode",
						"type": "char"
					},
					{
						"name": "cslPriceCode",
						"type": "char"
					},
					{
						"name": "cslDiscountCode",
						"type": "char"
					},
					{
						"name": "cslCommissionSplit",
						"type": "decimal",
						"precision": 7,
						"scale": 4
					},
					{
						"name": "cslDefaultWarehouse",
						"type": "char"
					},
					{
						"name": "cslShippingTerritory",
						"type": "char"
					},
					{
						"name": "cslBusinessType",
						"type": "char"
					},
					{
						"name": "cslShipType",
						"type": "char"
					},
					{
						"name": "cslTranscomPrimaryID",
						"type": "varchar"
					},
					{
						"name": "csmcontact",
						"type": "char"
					},
					{
						"name": "cslcomment1",
						"type": "varchar"
					},
					{
						"name": "cslcomment2",
						"type": "varchar"
					},
					{
						"name": "cslTerritoryEffectivityDate",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "cslCrmID",
						"type": "char"
					},
					{
						"name": "csmcsphone",
						"type": "varchar"
					},
					{
						"name": "csmcsfax",
						"type": "varchar"
					},
					{
						"name": "csmcscontact",
						"type": "varchar"
					},
					{
						"name": "csmcsemail",
						"type": "varchar"
					},
					{
						"name": "cslMemo",
						"type": "varchar"
					},
					{
						"name": "csmmsa_fips",
						"type": "char"
					},
					{
						"name": "csmRMCityNumber",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslTranscomAlternateID",
						"type": "char"
					},
					{
						"name": "csmDirections",
						"type": "varchar"
					},
					{
						"name": "csmCrossStreet",
						"type": "varchar"
					},
					{
						"name": "csmChgAddr",
						"type": "bit"
					},
					{
						"name": "csmChgShip",
						"type": "bit"
					},
					{
						"name": "csmChgShipExt",
						"type": "bit"
					},
					{
						"name": "csmChgCust",
						"type": "bit"
					},
					{
						"name": "commaudit",
						"type": "bit"
					},
					{
						"name": "commaudit2",
						"type": "bit"
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "acrec",
						"type": "char"
					},
					{
						"name": "csmCounty",
						"type": "char"
					},
					{
						"name": "cslBlockRepOrderEntry",
						"type": "bit"
					},
					{
						"name": "cslCustomerSegment",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "cslLastStatusChangeDate",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "cslBuyerAddressID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslPartyLocationID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslRouteAddressID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslDefaultOrderType1",
						"type": "char"
					},
					{
						"name": "cslDefaultOrderType2",
						"type": "char"
					},
					{
						"name": "cslDefaultOrderType3",
						"type": "char"
					},
					{
						"name": "cslDefaultOrderType4",
						"type": "char"
					},
					{
						"name": "csmshled",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "csmAppcd",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslAllowFax",
						"type": "char"
					},
					{
						"name": "cslDirectConsumer",
						"type": "char"
					},
					{
						"name": "cslDeliveryUnitOfMeasure",
						"type": "char"
					},
					{
						"name": "cslDeliveryUnitOfMeasureFence",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "cslExportsLCLConsolidationFlag",
						"type": "char"
					},
					{
						"name": "cslExportsDocumentCountry",
						"type": "char"
					},
					{
						"name": "cslExportsProductOnPallets",
						"type": "char"
					},
					{
						"name": "cslExportsAppointmentsRequired",
						"type": "char"
					},
					{
						"name": "cslHasDock",
						"type": "bit"
					},
					{
						"name": "cslHasDockUserDate",
						"type": "varchar"
					},
					{
						"name": "cslExpressShippingMethod",
						"type": "char"
					},
					{
						"name": "cslDirectIncludeShipto",
						"type": "char"
					},
					{
						"name": "cslExpressHandlingCharge",
						"type": "decimal",
						"precision": 4,
						"scale": 3
					},
					{
						"name": "cslExpressMinimum",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "cslExpressMaximum",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "cslDefaultLanguage",
						"type": "char"
					},
					{
						"name": "cslExpressServiceContractNumber",
						"type": "varchar"
					},
					{
						"name": "cslUseNegotiatedFreightRate",
						"type": "char"
					},
					{
						"name": "cslUseStandardFreightRate",
						"type": "char"
					},
					{
						"name": "cslDoNotRepriceOrders",
						"type": "char"
					},
					{
						"name": "cslPricingUseOfflineFiles",
						"type": "char"
					},
					{
						"name": "cslReturnAddressID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslReturnAddressName",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "CustomersShippingLocations"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_KIT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "KitID",
						"type": "varchar"
					},
					{
						"name": "KitSourceID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "KitStatus",
						"type": "varchar"
					},
					{
						"name": "LastModifiedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "CreatedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "SeriesID",
						"type": "varchar"
					},
					{
						"name": "SeriesKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "KitRetailBrandNameKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitRetailTypeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitColorKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitStatusKey",
						"type": "char"
					},
					{
						"name": "KitImportDomesticKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitEngineeringDivisionKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitClassKey",
						"type": "char"
					},
					{
						"name": "KitCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSalesCategoryCodeKey",
						"type": "char"
					},
					{
						"name": "KitDefaultGroupingLookupCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitFamilyofBusinessKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSeriesRetailSalesCategoryKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitNumber",
						"type": "varchar"
					},
					{
						"name": "KitType",
						"type": "varchar"
					},
					{
						"name": "KitSeriesNumber",
						"type": "varchar"
					},
					{
						"name": "KitExpressShip",
						"type": "char"
					},
					{
						"name": "KitPrimaryLifestyle",
						"type": "varchar"
					},
					{
						"name": "KitAXKitNumber",
						"type": "varchar"
					},
					{
						"name": "KitStatusChanged",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "KitDead",
						"type": "char"
					},
					{
						"name": "KitBoxQty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSeats",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitDiningChairQtyCtn",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitUPC",
						"type": "varchar"
					},
					{
						"name": "KitARVRReady",
						"type": "char"
					},
					{
						"name": "KitStandAloneFlag",
						"type": "char"
					},
					{
						"name": "KitSupplierDirectShipOnly",
						"type": "char"
					},
					{
						"name": "KitDimensionsConfirmed",
						"type": "char"
					},
					{
						"name": "KitMfgWarranty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitFriendlyDimensions",
						"type": "varchar"
					},
					{
						"name": "KitGeneralDescriptionID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitGeneralLongDescription",
						"type": "varchar"
					},
					{
						"name": "KitForecastPlannerID",
						"type": "varchar"
					},
					{
						"name": "KitUomKey",
						"type": "varchar"
					},
					{
						"name": "KitProductDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitAdditionalDimensions",
						"type": "nvarchar"
					},
					{
						"name": "KitCartonDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitUnitWeightKg",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitUnitWeightLbs",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSuppWeightNetWeightLbs",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSuppWeightNetWeightKg",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSelllingCountries",
						"type": "nvarchar"
					},
					{
						"name": "KitThirdPartyKit",
						"type": "char"
					},
					{
						"name": "KitAFIImageSet",
						"type": "varchar"
					},
					{
						"name": "KitScene7ImageSet",
						"type": "varchar"
					},
					{
						"name": "KitRollOverimage",
						"type": "varchar"
					},
					{
						"name": "KitKnockout",
						"type": "varchar"
					},
					{
						"name": "KitColorSwatch",
						"type": "varchar"
					},
					{
						"name": "KitPhoto",
						"type": "varchar"
					},
					{
						"name": "KitGoogleTitle",
						"type": "varchar"
					},
					{
						"name": "KitProductPageURL",
						"type": "varchar"
					},
					{
						"name": "KitCubesFt",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCubesM",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitHTSCode",
						"type": "varchar"
					},
					{
						"name": "KitFOBBasePrice",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitConsumerAssembly",
						"type": "varchar"
					},
					{
						"name": "KitFutureStatus",
						"type": "varchar"
					},
					{
						"name": "KitKeyKit",
						"type": "char"
					},
					{
						"name": "KitTrackingPiece",
						"type": "char"
					},
					{
						"name": "KitAlternateDescription2",
						"type": "varchar"
					},
					{
						"name": "KitShowroomMarketStatus",
						"type": "varchar"
					},
					{
						"name": "KitTrademarkText",
						"type": "varchar"
					},
					{
						"name": "KitAlternateAFIFluff1",
						"type": "nvarchar"
					},
					{
						"name": "KitValidationComplete",
						"type": "char"
					},
					{
						"name": "KitAlternateDescription3",
						"type": "varchar"
					},
					{
						"name": "KitExclusive",
						"type": "char"
					},
					{
						"name": "KitExclusiveComment",
						"type": "varchar"
					},
					{
						"name": "KitCommodity",
						"type": "char"
					},
					{
						"name": "KitUpholsteryCover",
						"type": "nvarchar"
					},
					{
						"name": "KitCartonVolume",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCartonDensity",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCartonFreightClass",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitShippableUomKey",
						"type": "char"
					},
					{
						"name": "KitNotAvailableforIndividualSale",
						"type": "varchar"
					},
					{
						"name": "KitPurchaseType",
						"type": "varchar"
					},
					{
						"name": "KitPartsDrawings",
						"type": "varchar"
					},
					{
						"name": "KitHomestoreProductLine",
						"type": "varchar"
					},
					{
						"name": "KitRetailRoomKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitShippingDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitPKLegacySellablePackage",
						"type": "varchar"
					},
					{
						"name": "KitConditionalHomeDeliveryEligible",
						"type": "varchar"
					},
					{
						"name": "KitATPSeries",
						"type": "varchar"
					},
					{
						"name": "KitVendorName",
						"type": "varchar"
					},
					{
						"name": "KitAssemblyInstructionsInternal",
						"type": "varchar"
					},
					{
						"name": "KitAssemblyInstructionsPublic",
						"type": "varchar"
					},
					{
						"name": "KitComponentQuantity",
						"type": "varchar"
					},
					{
						"name": "KitDimensionSketch",
						"type": "varchar"
					},
					{
						"name": "KitHomeStoreAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "KitWholesaleAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet1English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet2English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet3English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet4English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet5English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet6English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet7English",
						"type": "varchar"
					},
					{
						"name": "KitConsumerDescriptionEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFluffAFIEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFluffPrintEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFriendlyDescriptionEnglish",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet1English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet2English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet3English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet4English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet5English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet6English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet7English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet8English",
						"type": "varchar"
					},
					{
						"name": "KitHomestoreKitFluffEnglish",
						"type": "varchar"
					},
					{
						"name": "KitEligibleforProtectionPlan",
						"type": "char"
					},
					{
						"name": "KitIsProtectionPlan",
						"type": "char"
					},
					{
						"name": "KitAshcommDeliveryMode",
						"type": "char"
					},
					{
						"name": "KitMaterialEnglish",
						"type": "varchar"
					},
					{
						"name": "KitEcomMerchantNotes",
						"type": "varchar"
					},
					{
						"name": "KitAmazonBrandOwner",
						"type": "char"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "Kit"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_KitComponentCrosswalk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "KitID",
						"type": "varchar"
					},
					{
						"name": "KitSourceID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "ComponentType",
						"type": "varchar"
					},
					{
						"name": "ComponentID",
						"type": "varchar"
					},
					{
						"name": "ComponentSourceID",
						"type": "bigint",
						"precision": 19
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "KitComponentCrosswalk"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_OSLicensee')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "oslLicenseeID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "oslStoreType",
						"type": "varchar"
					},
					{
						"name": "oslLicenseeNotes",
						"type": "varchar"
					},
					{
						"name": "oslPrimaryCountry",
						"type": "varchar"
					},
					{
						"name": "oslStatus",
						"type": "varchar"
					},
					{
						"name": "oslActive",
						"type": "bit"
					},
					{
						"name": "oslActiveDate",
						"type": "date"
					},
					{
						"name": "oslActiveNotes",
						"type": "varchar"
					},
					{
						"name": "oslGuarantors",
						"type": "varchar"
					},
					{
						"name": "oslMailingAddress1",
						"type": "varchar"
					},
					{
						"name": "oslMailingAddress2",
						"type": "varchar"
					},
					{
						"name": "oslMailingCity",
						"type": "varchar"
					},
					{
						"name": "oslMailingState",
						"type": "varchar"
					},
					{
						"name": "oslMailingZip",
						"type": "varchar"
					},
					{
						"name": "oslMailingCountry",
						"type": "varchar"
					},
					{
						"name": "oslLegalEntityName",
						"type": "varchar"
					},
					{
						"name": "oslLegalEntityAddress1",
						"type": "varchar"
					},
					{
						"name": "oslLegalEntityAddress2",
						"type": "varchar"
					},
					{
						"name": "oslLegalEntityCity",
						"type": "varchar"
					},
					{
						"name": "oslLegalEntityState",
						"type": "varchar"
					},
					{
						"name": "oslLegalEntityZip",
						"type": "varchar"
					},
					{
						"name": "oslLegalEntityCountry",
						"type": "varchar"
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "detc",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslLicensedTerritory",
						"type": "varchar"
					},
					{
						"name": "oslDisclosureDocument",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslMailingAdd",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "OSLicensee"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_OSLocation')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "oslLocationID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "oslAccountNo",
						"type": "char"
					},
					{
						"name": "oslShipTo",
						"type": "varchar"
					},
					{
						"name": "oslLocationName",
						"type": "varchar"
					},
					{
						"name": "oslAddress1",
						"type": "varchar"
					},
					{
						"name": "oslAddress2",
						"type": "varchar"
					},
					{
						"name": "oslCity",
						"type": "varchar"
					},
					{
						"name": "oslState",
						"type": "varchar"
					},
					{
						"name": "oslZip",
						"type": "varchar"
					},
					{
						"name": "oslCountry",
						"type": "varchar"
					},
					{
						"name": "oslCounty",
						"type": "varchar"
					},
					{
						"name": "oslPrimaryPhone",
						"type": "varchar"
					},
					{
						"name": "oslPrimaryFax",
						"type": "varchar"
					},
					{
						"name": "oslPrimaryEmail",
						"type": "varchar"
					},
					{
						"name": "oslLatitude",
						"type": "varchar"
					},
					{
						"name": "oslLongitude",
						"type": "varchar"
					},
					{
						"name": "oslLocationStatus",
						"type": "varchar"
					},
					{
						"name": "oslLocationStatusNotes",
						"type": "varchar"
					},
					{
						"name": "oslLegacyLocationID",
						"type": "varchar"
					},
					{
						"name": "oslWhseShipTo",
						"type": "varchar"
					},
					{
						"name": "oslProspectID",
						"type": "varchar"
					},
					{
						"name": "oslOwnerType",
						"type": "varchar"
					},
					{
						"name": "oslLta",
						"type": "varchar"
					},
					{
						"name": "oslDMA",
						"type": "varchar"
					},
					{
						"name": "oslMSA",
						"type": "varchar"
					},
					{
						"name": "oslCountyFips",
						"type": "varchar"
					},
					{
						"name": "oslMarketZone",
						"type": "varchar"
					},
					{
						"name": "oslOpAreaZone",
						"type": "varchar"
					},
					{
						"name": "oslCurrency",
						"type": "char"
					},
					{
						"name": "oslLanguage",
						"type": "varchar"
					},
					{
						"name": "oslTimeZone",
						"type": "varchar"
					},
					{
						"name": "oslGeographicZone",
						"type": "varchar"
					},
					{
						"name": "oslStatus",
						"type": "varchar"
					},
					{
						"name": "oslStatusNotes",
						"type": "varchar"
					},
					{
						"name": "oslLocationType",
						"type": "varchar"
					},
					{
						"name": "oslSoftOpenDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslGrandOpenDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslClosed",
						"type": "bit"
					},
					{
						"name": "oslClosedDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslClosedAuthorization",
						"type": "varchar"
					},
					{
						"name": "oslRelocated",
						"type": "bit"
					},
					{
						"name": "oslRelocationCloseDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslRelocationOpenDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslRelocationNotes",
						"type": "varchar"
					},
					{
						"name": "oslAcquisition",
						"type": "bit"
					},
					{
						"name": "oslAcquisitionDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslAcquisitionNotes",
						"type": "varchar"
					},
					{
						"name": "oslPreOpenComments",
						"type": "varchar"
					},
					{
						"name": "oslTUAID",
						"type": "varchar"
					},
					{
						"name": "oslTUADate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslTUAExpireDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslTUATerm",
						"type": "varchar"
					},
					{
						"name": "oslTUADateComplete",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslTurnoverDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslRecordChangesFlag",
						"type": "bit"
					},
					{
						"name": "oslOperationsIntroDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslMsPipelineDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslLicenseeID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslAddress3",
						"type": "varchar"
					},
					{
						"name": "oslStoreRefresh",
						"type": "bit"
					},
					{
						"name": "oslStoreRefreshDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslStoreRefreshNotes",
						"type": "varchar"
					},
					{
						"name": "oslmPlansSubToDesign",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslmPRMeeting",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslmPlansSentToOwnerLic",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "oslURLRegistration",
						"type": "varchar"
					},
					{
						"name": "oslEnterpriseStoreNumber",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "OSLocation"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_OSOneSource')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "osOneSourceID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "osOneSourceName",
						"type": "varchar"
					},
					{
						"name": "osLegacyLocationID",
						"type": "varchar"
					},
					{
						"name": "osLegacyStoreID",
						"type": "decimal",
						"precision": 4,
						"scale": 0
					},
					{
						"name": "osProfitCenter",
						"type": "decimal",
						"precision": 4,
						"scale": 0
					},
					{
						"name": "osChannel",
						"type": "varchar"
					},
					{
						"name": "osActive",
						"type": "bit"
					},
					{
						"name": "osStoreType",
						"type": "varchar"
					},
					{
						"name": "osSource",
						"type": "varchar"
					},
					{
						"name": "osLocationID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "osStartDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "osEndDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "osProfitCenterType",
						"type": "varchar"
					},
					{
						"name": "osProfitCenterStatus",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "OsOneSource"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_PIM_Kit')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "KitID",
						"type": "varchar"
					},
					{
						"name": "KitSourceID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "KitStatus",
						"type": "varchar"
					},
					{
						"name": "LastModifiedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "CreatedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "SeriesID",
						"type": "varchar"
					},
					{
						"name": "SeriesKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "KitRetailBrandNameKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitRetailTypeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitColorKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitStatusKey",
						"type": "char"
					},
					{
						"name": "KitImportDomesticKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitEngineeringDivisionKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitClassKey",
						"type": "char"
					},
					{
						"name": "KitCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSalesCategoryCodeKey",
						"type": "char"
					},
					{
						"name": "KitDefaultGroupingLookupCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitFamilyofBusinessKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSeriesRetailSalesCategoryKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitNumber",
						"type": "varchar"
					},
					{
						"name": "KitType",
						"type": "varchar"
					},
					{
						"name": "KitSeriesNumber",
						"type": "varchar"
					},
					{
						"name": "KitExpressShip",
						"type": "char"
					},
					{
						"name": "KitPrimaryLifestyle",
						"type": "varchar"
					},
					{
						"name": "KitAXKitNumber",
						"type": "varchar"
					},
					{
						"name": "KitStatusChanged",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "KitDead",
						"type": "char"
					},
					{
						"name": "KitBoxQty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSeats",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitDiningChairQtyCtn",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitUPC",
						"type": "varchar"
					},
					{
						"name": "KitARVRReady",
						"type": "char"
					},
					{
						"name": "KitStandAloneFlag",
						"type": "char"
					},
					{
						"name": "KitSupplierDirectShipOnly",
						"type": "char"
					},
					{
						"name": "KitDimensionsConfirmed",
						"type": "char"
					},
					{
						"name": "KitMfgWarranty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitFriendlyDimensions",
						"type": "varchar"
					},
					{
						"name": "KitGeneralDescriptionID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitGeneralLongDescription",
						"type": "varchar"
					},
					{
						"name": "KitForecastPlannerID",
						"type": "varchar"
					},
					{
						"name": "KitUomKey",
						"type": "varchar"
					},
					{
						"name": "KitProductDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitAdditionalDimensions",
						"type": "nvarchar"
					},
					{
						"name": "KitCartonDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitUnitWeightKg",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitUnitWeightLbs",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSuppWeightNetWeightLbs",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSuppWeightNetWeightKg",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSelllingCountries",
						"type": "nvarchar"
					},
					{
						"name": "KitThirdPartyKit",
						"type": "char"
					},
					{
						"name": "KitAFIImageSet",
						"type": "varchar"
					},
					{
						"name": "KitScene7ImageSet",
						"type": "varchar"
					},
					{
						"name": "KitRollOverimage",
						"type": "varchar"
					},
					{
						"name": "KitKnockout",
						"type": "varchar"
					},
					{
						"name": "KitColorSwatch",
						"type": "varchar"
					},
					{
						"name": "KitPhoto",
						"type": "varchar"
					},
					{
						"name": "KitGoogleTitle",
						"type": "varchar"
					},
					{
						"name": "KitProductPageURL",
						"type": "varchar"
					},
					{
						"name": "KitCubesFt",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCubesM",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitHTSCode",
						"type": "varchar"
					},
					{
						"name": "KitFOBBasePrice",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitConsumerAssembly",
						"type": "varchar"
					},
					{
						"name": "KitFutureStatus",
						"type": "varchar"
					},
					{
						"name": "KitKeyKit",
						"type": "char"
					},
					{
						"name": "KitTrackingPiece",
						"type": "char"
					},
					{
						"name": "KitAlternateDescription2",
						"type": "varchar"
					},
					{
						"name": "KitShowroomMarketStatus",
						"type": "varchar"
					},
					{
						"name": "KitTrademarkText",
						"type": "varchar"
					},
					{
						"name": "KitAlternateAFIFluff1",
						"type": "nvarchar"
					},
					{
						"name": "KitValidationComplete",
						"type": "char"
					},
					{
						"name": "KitAlternateDescription3",
						"type": "varchar"
					},
					{
						"name": "KitExclusive",
						"type": "char"
					},
					{
						"name": "KitExclusiveComment",
						"type": "varchar"
					},
					{
						"name": "KitCommodity",
						"type": "char"
					},
					{
						"name": "KitUpholsteryCover",
						"type": "nvarchar"
					},
					{
						"name": "KitCartonVolume",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCartonDensity",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCartonFreightClass",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitShippableUomKey",
						"type": "char"
					},
					{
						"name": "KitNotAvailableforIndividualSale",
						"type": "varchar"
					},
					{
						"name": "KitPurchaseType",
						"type": "varchar"
					},
					{
						"name": "KitPartsDrawings",
						"type": "varchar"
					},
					{
						"name": "KitHomestoreProductLine",
						"type": "varchar"
					},
					{
						"name": "KitRetailRoomKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitShippingDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitPKLegacySellablePackage",
						"type": "varchar"
					},
					{
						"name": "KitConditionalHomeDeliveryEligible",
						"type": "varchar"
					},
					{
						"name": "KitATPSeries",
						"type": "varchar"
					},
					{
						"name": "KitVendorName",
						"type": "varchar"
					},
					{
						"name": "KitAssemblyInstructionsInternal",
						"type": "varchar"
					},
					{
						"name": "KitAssemblyInstructionsPublic",
						"type": "varchar"
					},
					{
						"name": "KitComponentQuantity",
						"type": "varchar"
					},
					{
						"name": "KitDimensionSketch",
						"type": "varchar"
					},
					{
						"name": "KitHomeStoreAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "KitWholesaleAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet1English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet2English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet3English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet4English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet5English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet6English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet7English",
						"type": "varchar"
					},
					{
						"name": "KitConsumerDescriptionEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFluffAFIEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFluffPrintEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFriendlyDescriptionEnglish",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet1English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet2English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet3English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet4English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet5English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet6English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet7English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet8English",
						"type": "varchar"
					},
					{
						"name": "KitHomestoreKitFluffEnglish",
						"type": "varchar"
					},
					{
						"name": "KitEligibleforProtectionPlan",
						"type": "char"
					},
					{
						"name": "KitIsProtectionPlan",
						"type": "char"
					},
					{
						"name": "KitAshcommDeliveryMode",
						"type": "char"
					},
					{
						"name": "KitMaterialEnglish",
						"type": "varchar"
					},
					{
						"name": "KitEcomMerchantNotes",
						"type": "varchar"
					},
					{
						"name": "KitAmazonBrandOwner",
						"type": "char"
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "Kit"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_PIM_KitComponentCrosswalk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "KitID",
						"type": "varchar"
					},
					{
						"name": "KitSourceID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "ComponentType",
						"type": "varchar"
					},
					{
						"name": "ComponentID",
						"type": "varchar"
					},
					{
						"name": "ComponentSourceID",
						"type": "bigint",
						"precision": 19
					}
				],
				"typeProperties": {
					"schema": "EDME_Datafactory",
					"table": "KitComponentCrosswalk "
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_PIM_Package')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "PackageID",
						"type": "varchar"
					},
					{
						"name": "PackageKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "HomestorePackageId",
						"type": "varchar"
					},
					{
						"name": "LastModifiedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "CreatedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "PackageNumber",
						"type": "varchar"
					},
					{
						"name": "PackageAlternatePackageName",
						"type": "varchar"
					},
					{
						"name": "PackageHero",
						"type": "varchar"
					},
					{
						"name": "PackageStatus",
						"type": "varchar"
					},
					{
						"name": "PackageStatusChanged",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "PackageIsThirdParty",
						"type": "char"
					},
					{
						"name": "PackageHomestorePackageId",
						"type": "varchar"
					},
					{
						"name": "PackageWholesaleID",
						"type": "varchar"
					},
					{
						"name": "PackageRetailType",
						"type": "varchar"
					},
					{
						"name": "PackageItemQuantity",
						"type": "varchar"
					},
					{
						"name": "PackageUOM",
						"type": "varchar"
					},
					{
						"name": "PackageColor",
						"type": "varchar"
					},
					{
						"name": "PackageKnockout",
						"type": "varchar"
					},
					{
						"name": "PackageScene7ImageSet",
						"type": "varchar"
					},
					{
						"name": "PackageValidationComplete",
						"type": "char"
					},
					{
						"name": "PackageValidationNotes",
						"type": "varchar"
					},
					{
						"name": "PackageRolloverImage",
						"type": "varchar"
					},
					{
						"name": "PackageExpressShip",
						"type": "char"
					},
					{
						"name": "PackageSupplierDirectShipOnly",
						"type": "varchar"
					},
					{
						"name": "PackageSalesCategoryCode",
						"type": "varchar"
					},
					{
						"name": "PackageSeriesNumber",
						"type": "varchar"
					},
					{
						"name": "PackageSeriesName",
						"type": "varchar"
					},
					{
						"name": "PackageCode",
						"type": "varchar"
					},
					{
						"name": "PackageAshcommTransition",
						"type": "varchar"
					},
					{
						"name": "PackageSwatchGroupID",
						"type": "varchar"
					},
					{
						"name": "PackageDefaultProduct",
						"type": "char"
					},
					{
						"name": "PackageNewFlagDate",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "PackageAshcommDeliveryMode",
						"type": "varchar"
					},
					{
						"name": "PackageChannelChange",
						"type": "char"
					},
					{
						"name": "PackageExclusive",
						"type": "char"
					},
					{
						"name": "PackageHotSpotsNeedReview",
						"type": "char"
					},
					{
						"name": "PackageAlternateDescription1",
						"type": "varchar"
					},
					{
						"name": "PackageAshcommTitleOverride",
						"type": "varchar"
					},
					{
						"name": "PackageHiddenField",
						"type": "varchar"
					},
					{
						"name": "PackageConsumerChoice",
						"type": "char"
					},
					{
						"name": "PackageTotalAssemblyTime",
						"type": "varchar"
					},
					{
						"name": "PackageAshcommFlags",
						"type": "varchar"
					},
					{
						"name": "PackageNavigableCategories",
						"type": "varchar"
					},
					{
						"name": "PackageName",
						"type": "varchar"
					},
					{
						"name": "PackageAFIFluff",
						"type": "nvarchar"
					},
					{
						"name": "PackageHomestorePackageFluff",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets1",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets2",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets3",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets4",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets5",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets6",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets1",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets2",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets3",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets4",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets5",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets6",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "Package"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_PIM_Product')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "id",
						"type": "varchar"
					},
					{
						"name": "SourceId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "LastModifiedDateTimeUtc",
						"type": "varchar"
					},
					{
						"name": "SystemTimestamp",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AlternateDescription2",
						"type": "varchar"
					},
					{
						"name": "ItemAFIImageSet",
						"type": "varchar"
					},
					{
						"name": "ItemAlternateAFIFluff1",
						"type": "varchar"
					},
					{
						"name": "ItemAlternateDescription3",
						"type": "varchar"
					},
					{
						"name": "ItemARVRReady",
						"type": "varchar"
					},
					{
						"name": "ItemAssemblyInstructionsInternal",
						"type": "varchar"
					},
					{
						"name": "ItemAssemblyInstructionsPublic",
						"type": "varchar"
					},
					{
						"name": "ItemBoxQty",
						"type": "varchar"
					},
					{
						"name": "ItemCartonDepthIn",
						"type": "varchar"
					},
					{
						"name": "ItemCartonDepthMm",
						"type": "varchar"
					},
					{
						"name": "ItemCartonHeightIn",
						"type": "varchar"
					},
					{
						"name": "ItemCartonHeightMm",
						"type": "varchar"
					},
					{
						"name": "ItemCartonWidthIn",
						"type": "varchar"
					},
					{
						"name": "ItemCartonWidthMm",
						"type": "varchar"
					},
					{
						"name": "ItemClass",
						"type": "varchar"
					},
					{
						"name": "ItemCode",
						"type": "varchar"
					},
					{
						"name": "ItemColor",
						"type": "varchar"
					},
					{
						"name": "ItemColorSwatch",
						"type": "varchar"
					},
					{
						"name": "ItemCommodity",
						"type": "varchar"
					},
					{
						"name": "ItemComponentQuantity",
						"type": "varchar"
					},
					{
						"name": "ItemConsumerAssembly",
						"type": "varchar"
					},
					{
						"name": "ItemCubesFt",
						"type": "varchar"
					},
					{
						"name": "ItemCubesM",
						"type": "varchar"
					},
					{
						"name": "ItemDead",
						"type": "varchar"
					},
					{
						"name": "ItemDimensionSketch",
						"type": "varchar"
					},
					{
						"name": "ItemDiningChairQtyCtn",
						"type": "varchar"
					},
					{
						"name": "ItemEngineeringDivision",
						"type": "varchar"
					},
					{
						"name": "ItemExclusive",
						"type": "varchar"
					},
					{
						"name": "ItemExclusiveComment",
						"type": "varchar"
					},
					{
						"name": "ItemExpressShip",
						"type": "varchar"
					},
					{
						"name": "ItemFOBBasePrice",
						"type": "varchar"
					},
					{
						"name": "ItemForecastPlannerID",
						"type": "varchar"
					},
					{
						"name": "ItemFriendlyDimensions",
						"type": "varchar"
					},
					{
						"name": "ItemFutureStatus",
						"type": "varchar"
					},
					{
						"name": "ItemGeneralDescriptionID",
						"type": "varchar"
					},
					{
						"name": "ItemGeneralLongDescription",
						"type": "varchar"
					},
					{
						"name": "ItemGoogleTitle",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "ItemHTSCode",
						"type": "varchar"
					},
					{
						"name": "ItemImportDomestic",
						"type": "varchar"
					},
					{
						"name": "ItemKeyItem",
						"type": "varchar"
					},
					{
						"name": "ItemKnockout",
						"type": "varchar"
					},
					{
						"name": "ItemMaterialReferenceNeeded",
						"type": "varchar"
					},
					{
						"name": "ItemMfgWarranty",
						"type": "varchar"
					},
					{
						"name": "ItemNumber",
						"type": "varchar"
					},
					{
						"name": "ItemPhoto",
						"type": "varchar"
					},
					{
						"name": "ItemProductDepthIn",
						"type": "varchar"
					},
					{
						"name": "ItemProductDepthMm",
						"type": "varchar"
					},
					{
						"name": "ItemProductHeightIn",
						"type": "varchar"
					},
					{
						"name": "ItemProductHeightMm",
						"type": "varchar"
					},
					{
						"name": "ItemProductPageURL",
						"type": "varchar"
					},
					{
						"name": "ItemProductWidthIn",
						"type": "varchar"
					},
					{
						"name": "ItemProductWidthMm",
						"type": "varchar"
					},
					{
						"name": "ItemRetailBrandName",
						"type": "varchar"
					},
					{
						"name": "ItemRetailType",
						"type": "varchar"
					},
					{
						"name": "ItemRollOverimage",
						"type": "varchar"
					},
					{
						"name": "ItemSalesCategoryCode",
						"type": "varchar"
					},
					{
						"name": "ItemScene7ImageSet",
						"type": "varchar"
					},
					{
						"name": "ItemSeats",
						"type": "varchar"
					},
					{
						"name": "ItemSeriesName",
						"type": "varchar"
					},
					{
						"name": "ItemSeriesNumber",
						"type": "varchar"
					},
					{
						"name": "ItemStandAloneFlag",
						"type": "varchar"
					},
					{
						"name": "ItemStatus",
						"type": "varchar"
					},
					{
						"name": "ItemStatusChanged",
						"type": "varchar"
					},
					{
						"name": "ItemSupplierDirectShipOnly",
						"type": "varchar"
					},
					{
						"name": "ItemSuppWeightNetWeightKg",
						"type": "varchar"
					},
					{
						"name": "ItemSuppWeightNetWeightLbs",
						"type": "varchar"
					},
					{
						"name": "ItemThirdPartyItem",
						"type": "varchar"
					},
					{
						"name": "ItemTrackingPiece",
						"type": "varchar"
					},
					{
						"name": "ItemTrademarkText",
						"type": "varchar"
					},
					{
						"name": "ItemType",
						"type": "varchar"
					},
					{
						"name": "ItemUnitWeightKg",
						"type": "varchar"
					},
					{
						"name": "ItemUnitWeightLbs",
						"type": "varchar"
					},
					{
						"name": "ItemUPC",
						"type": "varchar"
					},
					{
						"name": "ItemValidationComplete",
						"type": "varchar"
					},
					{
						"name": "ItemWholesaleAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet1",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet2",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet3",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet4",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet5",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet6",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet7",
						"type": "varchar"
					},
					{
						"name": "ItemConsumerDescription",
						"type": "varchar"
					},
					{
						"name": "ItemFluffAFI",
						"type": "varchar"
					},
					{
						"name": "ItemFluffPrint",
						"type": "varchar"
					},
					{
						"name": "ItemFriendlyDescription",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet1",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet2",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet3",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet4",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet5",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet6",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet7",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet8",
						"type": "varchar"
					},
					{
						"name": "ItemHomestoreItemFluff",
						"type": "varchar"
					},
					{
						"name": "SeriesAshleyHomestore",
						"type": "varchar"
					},
					{
						"name": "SeriesCorporateOnlineSelling",
						"type": "varchar"
					},
					{
						"name": "SeriesDivision",
						"type": "varchar"
					},
					{
						"name": "SeriesExclusiveComment",
						"type": "varchar"
					},
					{
						"name": "SeriesFeatures",
						"type": "varchar"
					},
					{
						"name": "SeriesId",
						"type": "varchar"
					},
					{
						"name": "SeriesInternationalHomeStore",
						"type": "varchar"
					},
					{
						"name": "SeriesIntroDate",
						"type": "varchar"
					},
					{
						"name": "SeriesMainImage",
						"type": "varchar"
					},
					{
						"name": "SeriesName",
						"type": "varchar"
					},
					{
						"name": "SeriesNumber",
						"type": "varchar"
					},
					{
						"name": "SeriesRetailSalesCategory",
						"type": "varchar"
					},
					{
						"name": "SeriesShowroom",
						"type": "varchar"
					},
					{
						"name": "SeriesSourceId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SeriesStatus",
						"type": "varchar"
					},
					{
						"name": "SeriesStyle",
						"type": "varchar"
					},
					{
						"name": "SeriesThirdParty",
						"type": "varchar"
					},
					{
						"name": "SeriesPrimary",
						"type": "varchar"
					},
					{
						"name": "ItemUomKey",
						"type": "char"
					},
					{
						"name": "ItemShippableUomKey",
						"type": "char"
					},
					{
						"name": "ItemEligibleforProtectionPlan",
						"type": "varchar"
					},
					{
						"name": "ItemIsProtectionPlan",
						"type": "varchar"
					},
					{
						"name": "ItemAshcommDeliveryMode",
						"type": "varchar"
					},
					{
						"name": "ItemMaterial",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreProductLine",
						"type": "varchar"
					},
					{
						"name": "ItemEcomMerchantNotes",
						"type": "varchar"
					},
					{
						"name": "ItemAmazonBrandOwner",
						"type": "varchar"
					},
					{
						"name": "ItemLifestyleDescription",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "Product"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_PIM_ProductCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "ProductCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProductCode",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDME_Datafactory",
					"table": "ProductCode"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_PIM_ProductPackageCrosswalk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "ProductID",
						"type": "varchar"
					},
					{
						"name": "ProductSourceID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "ProductType",
						"type": "varchar"
					},
					{
						"name": "PackageID",
						"type": "varchar"
					},
					{
						"name": "PackageSourceID",
						"type": "bigint",
						"precision": 19
					}
				],
				"typeProperties": {
					"schema": "EDME_DATAFACTORY",
					"table": "ProductPackageCrosswalk"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_Package')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "PackageID",
						"type": "varchar"
					},
					{
						"name": "PackageKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "HomestorePackageId",
						"type": "varchar"
					},
					{
						"name": "LastModifiedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "CreatedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "PackageNumber",
						"type": "varchar"
					},
					{
						"name": "PackageAlternatePackageName",
						"type": "varchar"
					},
					{
						"name": "PackageHero",
						"type": "varchar"
					},
					{
						"name": "PackageStatus",
						"type": "varchar"
					},
					{
						"name": "PackageStatusChanged",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "PackageIsThirdParty",
						"type": "char"
					},
					{
						"name": "PackageHomestorePackageId",
						"type": "varchar"
					},
					{
						"name": "PackageWholesaleID",
						"type": "varchar"
					},
					{
						"name": "PackageRetailType",
						"type": "varchar"
					},
					{
						"name": "PackageItemQuantity",
						"type": "varchar"
					},
					{
						"name": "PackageUOM",
						"type": "varchar"
					},
					{
						"name": "PackageColor",
						"type": "varchar"
					},
					{
						"name": "PackageKnockout",
						"type": "varchar"
					},
					{
						"name": "PackageScene7ImageSet",
						"type": "varchar"
					},
					{
						"name": "PackageValidationComplete",
						"type": "char"
					},
					{
						"name": "PackageValidationNotes",
						"type": "varchar"
					},
					{
						"name": "PackageRolloverImage",
						"type": "varchar"
					},
					{
						"name": "PackageExpressShip",
						"type": "char"
					},
					{
						"name": "PackageSupplierDirectShipOnly",
						"type": "varchar"
					},
					{
						"name": "PackageSalesCategoryCode",
						"type": "varchar"
					},
					{
						"name": "PackageSeriesNumber",
						"type": "varchar"
					},
					{
						"name": "PackageSeriesName",
						"type": "varchar"
					},
					{
						"name": "PackageCode",
						"type": "varchar"
					},
					{
						"name": "PackageAshcommTransition",
						"type": "varchar"
					},
					{
						"name": "PackageSwatchGroupID",
						"type": "varchar"
					},
					{
						"name": "PackageDefaultProduct",
						"type": "char"
					},
					{
						"name": "PackageNewFlagDate",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "PackageAshcommDeliveryMode",
						"type": "varchar"
					},
					{
						"name": "PackageChannelChange",
						"type": "char"
					},
					{
						"name": "PackageExclusive",
						"type": "char"
					},
					{
						"name": "PackageHotSpotsNeedReview",
						"type": "char"
					},
					{
						"name": "PackageAlternateDescription1",
						"type": "varchar"
					},
					{
						"name": "PackageAshcommTitleOverride",
						"type": "varchar"
					},
					{
						"name": "PackageHiddenField",
						"type": "varchar"
					},
					{
						"name": "PackageConsumerChoice",
						"type": "char"
					},
					{
						"name": "PackageTotalAssemblyTime",
						"type": "varchar"
					},
					{
						"name": "PackageAshcommFlags",
						"type": "varchar"
					},
					{
						"name": "PackageNavigableCategories",
						"type": "varchar"
					},
					{
						"name": "PackageName",
						"type": "varchar"
					},
					{
						"name": "PackageAFIFluff",
						"type": "nvarchar"
					},
					{
						"name": "PackageHomestorePackageFluff",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets1",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets2",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets3",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets4",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets5",
						"type": "varchar"
					},
					{
						"name": "PackageAFIBullets6",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets1",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets2",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets3",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets4",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets5",
						"type": "varchar"
					},
					{
						"name": "PackageHomeStoreBullets6",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "Package"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_Product')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "id",
						"type": "varchar"
					},
					{
						"name": "SourceId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "LastModifiedDateTimeUtc",
						"type": "varchar"
					},
					{
						"name": "SystemTimestamp",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AlternateDescription2",
						"type": "varchar"
					},
					{
						"name": "ItemAFIImageSet",
						"type": "varchar"
					},
					{
						"name": "ItemAlternateAFIFluff1",
						"type": "varchar"
					},
					{
						"name": "ItemAlternateDescription3",
						"type": "varchar"
					},
					{
						"name": "ItemARVRReady",
						"type": "varchar"
					},
					{
						"name": "ItemAssemblyInstructionsInternal",
						"type": "varchar"
					},
					{
						"name": "ItemAssemblyInstructionsPublic",
						"type": "varchar"
					},
					{
						"name": "ItemBoxQty",
						"type": "varchar"
					},
					{
						"name": "ItemCartonDepthIn",
						"type": "varchar"
					},
					{
						"name": "ItemCartonDepthMm",
						"type": "varchar"
					},
					{
						"name": "ItemCartonHeightIn",
						"type": "varchar"
					},
					{
						"name": "ItemCartonHeightMm",
						"type": "varchar"
					},
					{
						"name": "ItemCartonWidthIn",
						"type": "varchar"
					},
					{
						"name": "ItemCartonWidthMm",
						"type": "varchar"
					},
					{
						"name": "ItemClass",
						"type": "varchar"
					},
					{
						"name": "ItemCode",
						"type": "varchar"
					},
					{
						"name": "ItemColor",
						"type": "varchar"
					},
					{
						"name": "ItemColorSwatch",
						"type": "varchar"
					},
					{
						"name": "ItemCommodity",
						"type": "varchar"
					},
					{
						"name": "ItemComponentQuantity",
						"type": "varchar"
					},
					{
						"name": "ItemConsumerAssembly",
						"type": "varchar"
					},
					{
						"name": "ItemCubesFt",
						"type": "varchar"
					},
					{
						"name": "ItemCubesM",
						"type": "varchar"
					},
					{
						"name": "ItemDead",
						"type": "varchar"
					},
					{
						"name": "ItemDimensionSketch",
						"type": "varchar"
					},
					{
						"name": "ItemDiningChairQtyCtn",
						"type": "varchar"
					},
					{
						"name": "ItemEngineeringDivision",
						"type": "varchar"
					},
					{
						"name": "ItemExclusive",
						"type": "varchar"
					},
					{
						"name": "ItemExclusiveComment",
						"type": "varchar"
					},
					{
						"name": "ItemExpressShip",
						"type": "varchar"
					},
					{
						"name": "ItemFOBBasePrice",
						"type": "varchar"
					},
					{
						"name": "ItemForecastPlannerID",
						"type": "varchar"
					},
					{
						"name": "ItemFriendlyDimensions",
						"type": "varchar"
					},
					{
						"name": "ItemFutureStatus",
						"type": "varchar"
					},
					{
						"name": "ItemGeneralDescriptionID",
						"type": "varchar"
					},
					{
						"name": "ItemGeneralLongDescription",
						"type": "varchar"
					},
					{
						"name": "ItemGoogleTitle",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "ItemHTSCode",
						"type": "varchar"
					},
					{
						"name": "ItemImportDomestic",
						"type": "varchar"
					},
					{
						"name": "ItemKeyItem",
						"type": "varchar"
					},
					{
						"name": "ItemKnockout",
						"type": "varchar"
					},
					{
						"name": "ItemMaterialReferenceNeeded",
						"type": "varchar"
					},
					{
						"name": "ItemMfgWarranty",
						"type": "varchar"
					},
					{
						"name": "ItemNumber",
						"type": "varchar"
					},
					{
						"name": "ItemPhoto",
						"type": "varchar"
					},
					{
						"name": "ItemProductDepthIn",
						"type": "varchar"
					},
					{
						"name": "ItemProductDepthMm",
						"type": "varchar"
					},
					{
						"name": "ItemProductHeightIn",
						"type": "varchar"
					},
					{
						"name": "ItemProductHeightMm",
						"type": "varchar"
					},
					{
						"name": "ItemProductPageURL",
						"type": "varchar"
					},
					{
						"name": "ItemProductWidthIn",
						"type": "varchar"
					},
					{
						"name": "ItemProductWidthMm",
						"type": "varchar"
					},
					{
						"name": "ItemRetailBrandName",
						"type": "varchar"
					},
					{
						"name": "ItemRetailType",
						"type": "varchar"
					},
					{
						"name": "ItemRollOverimage",
						"type": "varchar"
					},
					{
						"name": "ItemSalesCategoryCode",
						"type": "varchar"
					},
					{
						"name": "ItemScene7ImageSet",
						"type": "varchar"
					},
					{
						"name": "ItemSeats",
						"type": "varchar"
					},
					{
						"name": "ItemSeriesName",
						"type": "varchar"
					},
					{
						"name": "ItemSeriesNumber",
						"type": "varchar"
					},
					{
						"name": "ItemStandAloneFlag",
						"type": "varchar"
					},
					{
						"name": "ItemStatus",
						"type": "varchar"
					},
					{
						"name": "ItemStatusChanged",
						"type": "varchar"
					},
					{
						"name": "ItemSupplierDirectShipOnly",
						"type": "varchar"
					},
					{
						"name": "ItemSuppWeightNetWeightKg",
						"type": "varchar"
					},
					{
						"name": "ItemSuppWeightNetWeightLbs",
						"type": "varchar"
					},
					{
						"name": "ItemThirdPartyItem",
						"type": "varchar"
					},
					{
						"name": "ItemTrackingPiece",
						"type": "varchar"
					},
					{
						"name": "ItemTrademarkText",
						"type": "varchar"
					},
					{
						"name": "ItemType",
						"type": "varchar"
					},
					{
						"name": "ItemUnitWeightKg",
						"type": "varchar"
					},
					{
						"name": "ItemUnitWeightLbs",
						"type": "varchar"
					},
					{
						"name": "ItemUPC",
						"type": "varchar"
					},
					{
						"name": "ItemValidationComplete",
						"type": "varchar"
					},
					{
						"name": "ItemWholesaleAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet1",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet2",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet3",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet4",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet5",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet6",
						"type": "varchar"
					},
					{
						"name": "ItemAFIFeatureBullet7",
						"type": "varchar"
					},
					{
						"name": "ItemConsumerDescription",
						"type": "varchar"
					},
					{
						"name": "ItemFluffAFI",
						"type": "varchar"
					},
					{
						"name": "ItemFluffPrint",
						"type": "varchar"
					},
					{
						"name": "ItemFriendlyDescription",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet1",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet2",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet3",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet4",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet5",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet6",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet7",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreFeatureBullet8",
						"type": "varchar"
					},
					{
						"name": "ItemHomestoreItemFluff",
						"type": "varchar"
					},
					{
						"name": "SeriesAshleyHomestore",
						"type": "varchar"
					},
					{
						"name": "SeriesCorporateOnlineSelling",
						"type": "varchar"
					},
					{
						"name": "SeriesDivision",
						"type": "varchar"
					},
					{
						"name": "SeriesExclusiveComment",
						"type": "varchar"
					},
					{
						"name": "SeriesFeatures",
						"type": "varchar"
					},
					{
						"name": "SeriesId",
						"type": "varchar"
					},
					{
						"name": "SeriesInternationalHomeStore",
						"type": "varchar"
					},
					{
						"name": "SeriesIntroDate",
						"type": "varchar"
					},
					{
						"name": "SeriesMainImage",
						"type": "varchar"
					},
					{
						"name": "SeriesName",
						"type": "varchar"
					},
					{
						"name": "SeriesNumber",
						"type": "varchar"
					},
					{
						"name": "SeriesRetailSalesCategory",
						"type": "varchar"
					},
					{
						"name": "SeriesShowroom",
						"type": "varchar"
					},
					{
						"name": "SeriesSourceId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SeriesStatus",
						"type": "varchar"
					},
					{
						"name": "SeriesStyle",
						"type": "varchar"
					},
					{
						"name": "SeriesThirdParty",
						"type": "varchar"
					},
					{
						"name": "SeriesPrimary",
						"type": "varchar"
					},
					{
						"name": "ItemUomKey",
						"type": "char"
					},
					{
						"name": "ItemShippableUomKey",
						"type": "char"
					},
					{
						"name": "ItemEligibleforProtectionPlan",
						"type": "varchar"
					},
					{
						"name": "ItemIsProtectionPlan",
						"type": "varchar"
					},
					{
						"name": "ItemAshcommDeliveryMode",
						"type": "varchar"
					},
					{
						"name": "ItemMaterial",
						"type": "varchar"
					},
					{
						"name": "ItemHomeStoreProductLine",
						"type": "varchar"
					},
					{
						"name": "ItemEcomMerchantNotes",
						"type": "varchar"
					},
					{
						"name": "ItemAmazonBrandOwner",
						"type": "varchar"
					},
					{
						"name": "ItemLifestyleDescription",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "Product"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_ProductCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ProductCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProductCode",
						"type": "varchar"
					},
					{
						"name": "Last_modified_date",
						"type": "datetime2",
						"scale": 7
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "ProductCode"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_ProductPackageCrosswalk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ProductID",
						"type": "varchar"
					},
					{
						"name": "ProductSourceID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "ProductType",
						"type": "varchar"
					},
					{
						"name": "PackageID",
						"type": "varchar"
					},
					{
						"name": "PackageSourceID",
						"type": "bigint",
						"precision": 19
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "ProductPackageCrosswalk"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_RSM_LicContact_CompanyCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "LIC_CONTACT",
						"type": "varchar"
					},
					{
						"name": "COMPANY_CODE",
						"type": "varchar"
					},
					{
						"name": "LOAD_DATE",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "Retail",
					"table": "RSM_LicContact_CompanyCode"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_StoreMasterCustom')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "LocationKey",
						"type": "varchar"
					},
					{
						"name": "ProspectID",
						"type": "varchar"
					},
					{
						"name": "GoogleID",
						"type": "varchar"
					},
					{
						"name": "BindyID",
						"type": "varchar"
					},
					{
						"name": "StoreID",
						"type": "varchar"
					},
					{
						"name": "ProfitCenter",
						"type": "varchar"
					},
					{
						"name": "Location",
						"type": "varchar"
					},
					{
						"name": "Country",
						"type": "varchar"
					},
					{
						"name": "Account",
						"type": "varchar"
					},
					{
						"name": "StoreFrontShipTo",
						"type": "varchar"
					},
					{
						"name": "Entity",
						"type": "varchar"
					},
					{
						"name": "LicenseeContact",
						"type": "varchar"
					},
					{
						"name": "SoftOpenDate",
						"type": "date"
					},
					{
						"name": "AcquisitionDate",
						"type": "date"
					},
					{
						"name": "ClosureDate",
						"type": "date"
					},
					{
						"name": "ShopperTrakLocID",
						"type": "varchar"
					},
					{
						"name": "StoreAddress",
						"type": "varchar"
					},
					{
						"name": "City",
						"type": "varchar"
					},
					{
						"name": "StateProvince",
						"type": "varchar"
					},
					{
						"name": "ZIP",
						"type": "varchar"
					},
					{
						"name": "DMAID",
						"type": "varchar"
					},
					{
						"name": "DMARegion",
						"type": "varchar"
					},
					{
						"name": "ShowroomSqFt",
						"type": "varchar"
					},
					{
						"name": "StoreType",
						"type": "varchar"
					},
					{
						"name": "StoreModel",
						"type": "varchar"
					},
					{
						"name": "StoreVersion",
						"type": "varchar"
					},
					{
						"name": "Market",
						"type": "varchar"
					},
					{
						"name": "Region",
						"type": "varchar"
					},
					{
						"name": "BuildingOwnership",
						"type": "varchar"
					},
					{
						"name": "CountryCategory",
						"type": "varchar"
					},
					{
						"name": "DomesticCategory",
						"type": "varchar"
					},
					{
						"name": "Classification",
						"type": "varchar"
					},
					{
						"name": "StorePhone",
						"type": "varchar"
					},
					{
						"name": "DistrictManager",
						"type": "varchar"
					},
					{
						"name": "BDDirector",
						"type": "varchar"
					},
					{
						"name": "LicenseeEmail",
						"type": "varchar"
					},
					{
						"name": "LicenseePhone",
						"type": "varchar"
					},
					{
						"name": "CorporationAddress",
						"type": "varchar"
					},
					{
						"name": "CorpCity",
						"type": "varchar"
					},
					{
						"name": "CorpState",
						"type": "varchar"
					},
					{
						"name": "CorpZip",
						"type": "varchar"
					},
					{
						"name": "RDCAddress",
						"type": "varchar"
					},
					{
						"name": "RDCCity",
						"type": "varchar"
					},
					{
						"name": "RDCState",
						"type": "varchar"
					},
					{
						"name": "RDCZip",
						"type": "varchar"
					},
					{
						"name": "RDCShipTo",
						"type": "varchar"
					},
					{
						"name": "RDCSqFt",
						"type": "varchar"
					},
					{
						"name": "RDCDockDoors",
						"type": "varchar"
					},
					{
						"name": "TUAExpirationDate",
						"type": "date"
					},
					{
						"name": "LicensedTerritory",
						"type": "varchar"
					},
					{
						"name": "Latitude",
						"type": "varchar"
					},
					{
						"name": "Longitude",
						"type": "varchar"
					},
					{
						"name": "Notes",
						"type": "varchar"
					},
					{
						"name": "StoreEmail",
						"type": "varchar"
					},
					{
						"name": "Unit",
						"type": "varchar"
					},
					{
						"name": "OneSourceID",
						"type": "varchar"
					},
					{
						"name": "HSDatabaseName",
						"type": "varchar"
					},
					{
						"name": "SVP",
						"type": "varchar"
					},
					{
						"name": "VP",
						"type": "varchar"
					},
					{
						"name": "SrRD",
						"type": "varchar"
					},
					{
						"name": "RD",
						"type": "varchar"
					},
					{
						"name": "StoreManager",
						"type": "varchar"
					},
					{
						"name": "StoreMgrPhone",
						"type": "varchar"
					},
					{
						"name": "SalesManager1",
						"type": "varchar"
					},
					{
						"name": "SalesManager2",
						"type": "varchar"
					},
					{
						"name": "SalesManager3",
						"type": "varchar"
					},
					{
						"name": "SalesManager4",
						"type": "varchar"
					},
					{
						"name": "OfficeManager",
						"type": "varchar"
					},
					{
						"name": "DirectorOfOps",
						"type": "varchar"
					},
					{
						"name": "RegionalOpsMgr",
						"type": "varchar"
					},
					{
						"name": "OpsMgr",
						"type": "varchar"
					},
					{
						"name": "CompStatus",
						"type": "varchar"
					},
					{
						"name": "Kit",
						"type": "varchar"
					},
					{
						"name": "TrafficDivisor",
						"type": "varchar"
					},
					{
						"name": "ERP",
						"type": "varchar"
					},
					{
						"name": "DTCTechnology",
						"type": "varchar"
					},
					{
						"name": "DTCBrand",
						"type": "varchar"
					},
					{
						"name": "ForumID",
						"type": "varchar"
					},
					{
						"name": "AccountType",
						"type": "varchar"
					},
					{
						"name": "FacadeCurrentImage",
						"type": "varchar"
					},
					{
						"name": "WebsiteFacadeCurrent",
						"type": "varchar"
					},
					{
						"name": "StoreManagerImage",
						"type": "varchar"
					},
					{
						"name": "EnterpriseFacadeImage",
						"type": "varchar"
					},
					{
						"name": "LicenseeSalesDistrict",
						"type": "varchar"
					},
					{
						"name": "LicenseeSalesRegion",
						"type": "varchar"
					},
					{
						"name": "ModifiedDate",
						"type": "date"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "StoreMasterCustom"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_StoreMasterCustom_LegalEntities_CompanyCodes')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "LegalEntityID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EntityName",
						"type": "varchar"
					},
					{
						"name": "LicContact",
						"type": "varchar"
					},
					{
						"name": "CompanyCode",
						"type": "varchar"
					},
					{
						"name": "Createddate",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "RETAIL",
					"table": "StoreMasterCustom_LegalEntities_CompanyCodes"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_StoreMasterCustom_LegalEntities_Mapping')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "EntityName",
						"type": "varchar"
					},
					{
						"name": "LegalEntityID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "createddate",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "Retail",
					"table": "StoreMasterCustom_LegalEntities_Mapping"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_WholesaleCustomersShippingLocations')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "cslCustomerNumber",
						"type": "char"
					},
					{
						"name": "cslShiptoNumber",
						"type": "char"
					},
					{
						"name": "cslMapicsSequenceNumber",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "cslName",
						"type": "varchar"
					},
					{
						"name": "csmshpa1",
						"type": "varchar"
					},
					{
						"name": "csmshpa2",
						"type": "varchar"
					},
					{
						"name": "csmshpa3",
						"type": "varchar"
					},
					{
						"name": "csmshpzp",
						"type": "varchar"
					},
					{
						"name": "csmshpst",
						"type": "char"
					},
					{
						"name": "csmshpco",
						"type": "char"
					},
					{
						"name": "csmphone",
						"type": "varchar"
					},
					{
						"name": "csmfaxtn",
						"type": "varchar"
					},
					{
						"name": "cslTaxExempt",
						"type": "char"
					},
					{
						"name": "csmwebsite",
						"type": "varchar"
					},
					{
						"name": "csmemail",
						"type": "varchar"
					},
					{
						"name": "cslCommissionCode",
						"type": "char"
					},
					{
						"name": "cslFreightCode",
						"type": "char"
					},
					{
						"name": "cslPriceCode",
						"type": "char"
					},
					{
						"name": "cslDiscountCode",
						"type": "char"
					},
					{
						"name": "cslCommissionSplit",
						"type": "decimal",
						"precision": 7,
						"scale": 4
					},
					{
						"name": "cslDefaultWarehouse",
						"type": "char"
					},
					{
						"name": "cslShippingTerritory",
						"type": "char"
					},
					{
						"name": "cslBusinessType",
						"type": "char"
					},
					{
						"name": "cslShipType",
						"type": "char"
					},
					{
						"name": "cslTranscomPrimaryID",
						"type": "varchar"
					},
					{
						"name": "csmcontact",
						"type": "char"
					},
					{
						"name": "cslcomment1",
						"type": "varchar"
					},
					{
						"name": "cslcomment2",
						"type": "varchar"
					},
					{
						"name": "cslTerritoryEffectivityDate",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "cslCrmID",
						"type": "char"
					},
					{
						"name": "csmcsphone",
						"type": "varchar"
					},
					{
						"name": "csmcsfax",
						"type": "varchar"
					},
					{
						"name": "csmcscontact",
						"type": "varchar"
					},
					{
						"name": "csmcsemail",
						"type": "varchar"
					},
					{
						"name": "cslMemo",
						"type": "varchar"
					},
					{
						"name": "csmmsa_fips",
						"type": "char"
					},
					{
						"name": "csmRMCityNumber",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslTranscomAlternateID",
						"type": "char"
					},
					{
						"name": "csmDirections",
						"type": "varchar"
					},
					{
						"name": "csmCrossStreet",
						"type": "varchar"
					},
					{
						"name": "csmChgAddr",
						"type": "bit"
					},
					{
						"name": "csmChgShip",
						"type": "bit"
					},
					{
						"name": "csmChgShipExt",
						"type": "bit"
					},
					{
						"name": "csmChgCust",
						"type": "bit"
					},
					{
						"name": "commaudit",
						"type": "bit"
					},
					{
						"name": "commaudit2",
						"type": "bit"
					},
					{
						"name": "usra",
						"type": "varchar"
					},
					{
						"name": "dtea",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "usrc",
						"type": "varchar"
					},
					{
						"name": "dtec",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "acrec",
						"type": "char"
					},
					{
						"name": "csmCounty",
						"type": "char"
					},
					{
						"name": "cslBlockRepOrderEntry",
						"type": "bit"
					},
					{
						"name": "cslCustomerSegment",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "cslLastStatusChangeDate",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "cslBuyerAddressID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslPartyLocationID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslRouteAddressID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslDefaultOrderType1",
						"type": "char"
					},
					{
						"name": "cslDefaultOrderType2",
						"type": "char"
					},
					{
						"name": "cslDefaultOrderType3",
						"type": "char"
					},
					{
						"name": "cslDefaultOrderType4",
						"type": "char"
					},
					{
						"name": "csmshled",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "csmAppcd",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslAllowFax",
						"type": "char"
					},
					{
						"name": "cslDirectConsumer",
						"type": "char"
					},
					{
						"name": "cslDeliveryUnitOfMeasure",
						"type": "char"
					},
					{
						"name": "cslDeliveryUnitOfMeasureFence",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "cslExportsLCLConsolidationFlag",
						"type": "char"
					},
					{
						"name": "cslExportsDocumentCountry",
						"type": "char"
					},
					{
						"name": "cslExportsProductOnPallets",
						"type": "char"
					},
					{
						"name": "cslExportsAppointmentsRequired",
						"type": "char"
					},
					{
						"name": "cslHasDock",
						"type": "bit"
					},
					{
						"name": "cslHasDockUserDate",
						"type": "varchar"
					},
					{
						"name": "cslExpressShippingMethod",
						"type": "char"
					},
					{
						"name": "cslDirectIncludeShipto",
						"type": "char"
					},
					{
						"name": "cslExpressHandlingCharge",
						"type": "decimal",
						"precision": 4,
						"scale": 3
					},
					{
						"name": "cslExpressMinimum",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "cslExpressMaximum",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "cslDefaultLanguage",
						"type": "char"
					},
					{
						"name": "cslExpressServiceContractNumber",
						"type": "varchar"
					},
					{
						"name": "cslUseNegotiatedFreightRate",
						"type": "char"
					},
					{
						"name": "cslUseStandardFreightRate",
						"type": "char"
					},
					{
						"name": "cslDoNotRepriceOrders",
						"type": "char"
					},
					{
						"name": "cslPricingUseOfflineFiles",
						"type": "char"
					},
					{
						"name": "cslReturnAddressID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cslReturnAddressName",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "EDW",
					"table": "WholesaleCustomersShippingLocations"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_ashley_zipallocation')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "KitID",
						"type": "varchar"
					},
					{
						"name": "KitSourceID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "KitStatus",
						"type": "varchar"
					},
					{
						"name": "LastModifiedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "CreatedDateTimeUtc",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "SeriesID",
						"type": "varchar"
					},
					{
						"name": "SeriesKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "KitRetailBrandNameKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitRetailTypeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitColorKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitStatusKey",
						"type": "char"
					},
					{
						"name": "KitImportDomesticKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitEngineeringDivisionKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitClassKey",
						"type": "char"
					},
					{
						"name": "KitCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSalesCategoryCodeKey",
						"type": "char"
					},
					{
						"name": "KitDefaultGroupingLookupCodeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitFamilyofBusinessKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSeriesRetailSalesCategoryKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitNumber",
						"type": "varchar"
					},
					{
						"name": "KitType",
						"type": "varchar"
					},
					{
						"name": "KitSeriesNumber",
						"type": "varchar"
					},
					{
						"name": "KitExpressShip",
						"type": "char"
					},
					{
						"name": "KitPrimaryLifestyle",
						"type": "varchar"
					},
					{
						"name": "KitAXKitNumber",
						"type": "varchar"
					},
					{
						"name": "KitStatusChanged",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "KitDead",
						"type": "char"
					},
					{
						"name": "KitBoxQty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitSeats",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitDiningChairQtyCtn",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitUPC",
						"type": "varchar"
					},
					{
						"name": "KitARVRReady",
						"type": "char"
					},
					{
						"name": "KitStandAloneFlag",
						"type": "char"
					},
					{
						"name": "KitSupplierDirectShipOnly",
						"type": "char"
					},
					{
						"name": "KitDimensionsConfirmed",
						"type": "char"
					},
					{
						"name": "KitMfgWarranty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitFriendlyDimensions",
						"type": "varchar"
					},
					{
						"name": "KitGeneralDescriptionID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitGeneralLongDescription",
						"type": "varchar"
					},
					{
						"name": "KitForecastPlannerID",
						"type": "varchar"
					},
					{
						"name": "KitUomKey",
						"type": "varchar"
					},
					{
						"name": "KitProductDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitProductWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitAdditionalDimensions",
						"type": "nvarchar"
					},
					{
						"name": "KitCartonDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitCartonWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitUnitWeightKg",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitUnitWeightLbs",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSuppWeightNetWeightLbs",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSuppWeightNetWeightKg",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitSelllingCountries",
						"type": "nvarchar"
					},
					{
						"name": "KitThirdPartyKit",
						"type": "char"
					},
					{
						"name": "KitAFIImageSet",
						"type": "varchar"
					},
					{
						"name": "KitScene7ImageSet",
						"type": "varchar"
					},
					{
						"name": "KitRollOverimage",
						"type": "varchar"
					},
					{
						"name": "KitKnockout",
						"type": "varchar"
					},
					{
						"name": "KitColorSwatch",
						"type": "varchar"
					},
					{
						"name": "KitPhoto",
						"type": "varchar"
					},
					{
						"name": "KitGoogleTitle",
						"type": "varchar"
					},
					{
						"name": "KitProductPageURL",
						"type": "varchar"
					},
					{
						"name": "KitCubesFt",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCubesM",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitHTSCode",
						"type": "varchar"
					},
					{
						"name": "KitFOBBasePrice",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitConsumerAssembly",
						"type": "varchar"
					},
					{
						"name": "KitFutureStatus",
						"type": "varchar"
					},
					{
						"name": "KitKeyKit",
						"type": "char"
					},
					{
						"name": "KitTrackingPiece",
						"type": "char"
					},
					{
						"name": "KitAlternateDescription2",
						"type": "varchar"
					},
					{
						"name": "KitShowroomMarketStatus",
						"type": "varchar"
					},
					{
						"name": "KitTrademarkText",
						"type": "varchar"
					},
					{
						"name": "KitAlternateAFIFluff1",
						"type": "nvarchar"
					},
					{
						"name": "KitValidationComplete",
						"type": "char"
					},
					{
						"name": "KitAlternateDescription3",
						"type": "varchar"
					},
					{
						"name": "KitExclusive",
						"type": "char"
					},
					{
						"name": "KitExclusiveComment",
						"type": "varchar"
					},
					{
						"name": "KitCommodity",
						"type": "char"
					},
					{
						"name": "KitUpholsteryCover",
						"type": "nvarchar"
					},
					{
						"name": "KitCartonVolume",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCartonDensity",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitCartonFreightClass",
						"type": "decimal",
						"precision": 7,
						"scale": 2
					},
					{
						"name": "KitShippableUomKey",
						"type": "char"
					},
					{
						"name": "KitNotAvailableforIndividualSale",
						"type": "varchar"
					},
					{
						"name": "KitPurchaseType",
						"type": "varchar"
					},
					{
						"name": "KitPartsDrawings",
						"type": "varchar"
					},
					{
						"name": "KitHomestoreProductLine",
						"type": "varchar"
					},
					{
						"name": "KitRetailRoomKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "KitShippingDepthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingDepthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingHeightIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingHeightMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingWidthIn",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitShippingWidthMm",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "KitPKLegacySellablePackage",
						"type": "varchar"
					},
					{
						"name": "KitConditionalHomeDeliveryEligible",
						"type": "varchar"
					},
					{
						"name": "KitATPSeries",
						"type": "varchar"
					},
					{
						"name": "KitVendorName",
						"type": "varchar"
					},
					{
						"name": "KitAssemblyInstructionsInternal",
						"type": "varchar"
					},
					{
						"name": "KitAssemblyInstructionsPublic",
						"type": "varchar"
					},
					{
						"name": "KitComponentQuantity",
						"type": "varchar"
					},
					{
						"name": "KitDimensionSketch",
						"type": "varchar"
					},
					{
						"name": "KitHomeStoreAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "KitWholesaleAssemblyVideo1",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet1English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet2English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet3English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet4English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet5English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet6English",
						"type": "varchar"
					},
					{
						"name": "KitAfiFeatureBullet7English",
						"type": "varchar"
					},
					{
						"name": "KitConsumerDescriptionEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFluffAFIEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFluffPrintEnglish",
						"type": "varchar"
					},
					{
						"name": "KitFriendlyDescriptionEnglish",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet1English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet2English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet3English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet4English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet5English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet6English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet7English",
						"type": "varchar"
					},
					{
						"name": "KitHomstoreFeatureBullet8English",
						"type": "varchar"
					},
					{
						"name": "KitHomestoreKitFluffEnglish",
						"type": "varchar"
					},
					{
						"name": "KitEligibleforProtectionPlan",
						"type": "char"
					},
					{
						"name": "KitIsProtectionPlan",
						"type": "char"
					},
					{
						"name": "KitAshcommDeliveryMode",
						"type": "char"
					},
					{
						"name": "KitMaterialEnglish",
						"type": "varchar"
					},
					{
						"name": "KitEcomMerchantNotes",
						"type": "varchar"
					},
					{
						"name": "KitAmazonBrandOwner",
						"type": "char"
					}
				],
				"typeProperties": {
					"schema": "EDME_DataFactory",
					"table": "ZipAllocation"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EastFoundation')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "EastFoundation.parquet",
						"folderPath": "Retail/SupplyChain/EastFoundation",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EastFoundation_Historical')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "HistoricalEastFoundation.parquet",
						"folderPath": "Retail/SupplyChain/HistoricalEastFoundation",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Email_Chunk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Error_Files_From_ErrorFolder')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Error",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID\tglobalID\tconfidenceScore\tRecID\tposRawContainerRecID\tmarket_id\tposFirstName\tposMiddleInitial\tposLastName\tposCustomerEmail1\tposCustomerEmail2\tposCustomerEmail3\tposCustomerPhone1\tposCustomerPhone2\tposCustomerPhone3\tn_address\tn_addr2\tn_city\tn_state\tn_zip9\tposFaceBookID\tposTwitterID\ttimestamp\tcustomer_type\tcustomer_since\tSourceSystem",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Fetch_Location_Json')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "dac_store_details",
						"fileSystem": "raw-zone"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"AccountID": {
							"type": "string"
						},
						"LocationID": {
							"type": "string"
						},
						"LocationNumber": {
							"type": "string"
						},
						"ReferenceCode": {
							"type": "string"
						},
						"CreatedBy": {
							"type": "string"
						},
						"ModifiedBy": {
							"type": "string"
						},
						"Created": {
							"type": "string"
						},
						"Modified": {
							"type": "string"
						},
						"LocationData": {
							"type": "object",
							"properties": {
								"KeyFields": {
									"type": "object",
									"properties": {
										"CSOLocationID": {
											"type": "string"
										},
										"ITGAccountId": {
											"type": "string"
										},
										"ITGAccountNumber": {
											"type": "string"
										},
										"ITGClientId": {
											"type": "string"
										},
										"ITGClientNumber": {
											"type": "string"
										},
										"AgencyCode": {
											"type": "string"
										},
										"Reference Code": {
											"type": "string"
										},
										"CMR": {
											"type": "string"
										},
										"Open Holidays": {
											"type": "string"
										},
										"Exteriorphoto": {
											"type": "string"
										},
										"CustomerServiceHours": {
											"type": "string"
										},
										"HideAddress": {
											"type": "string"
										},
										"PinMarker": {
											"type": "string"
										},
										"AutoDisplayPoint": {
											"type": "string"
										},
										"ScheduleApptURL": {
											"type": "string"
										},
										"GoogleBusinessDescription": {
											"type": "string"
										},
										"primarylanguage": {
											"type": "string"
										},
										"ChainName": {
											"type": "string"
										},
										"StoreLocatorDisabled": {
											"type": "string"
										},
										"AppleBusinessName": {
											"type": "string"
										},
										"StoreStatus": {
											"type": "string"
										},
										"Flyerlink": {
											"type": "string"
										},
										"ManagerName": {
											"type": "string"
										},
										"ManagerDescription": {
											"type": "string"
										},
										"Promotion1Image": {
											"type": "string"
										},
										"PodiumID": {
											"type": "string"
										},
										"ReportGroup": {
											"type": "string"
										},
										"Promotion2Image": {
											"type": "string"
										},
										"Reference Code 2": {
											"type": "string"
										},
										"Google Preferred Photo": {
											"type": "string"
										},
										"Promotion1URL": {
											"type": "string"
										},
										"Promotion2URL": {
											"type": "string"
										}
									}
								},
								"DisplayPoint": {
									"type": "object",
									"properties": {
										"Type": {
											"type": "string"
										},
										"Latitude": {
											"type": "number"
										},
										"Longitude": {
											"type": "number"
										},
										"VerificationType": {
											"type": "string"
										}
									}
								},
								"BusinessStatus": {
									"type": "string"
								},
								"Status": {
									"type": "string"
								},
								"BusinessName": {
									"type": "object",
									"properties": {
										"Name": {
											"type": "string"
										},
										"LongName": {
											"type": "string"
										},
										"Locale": {
											"type": "integer"
										}
									}
								},
								"BusinessDescription": {
									"type": "object",
									"properties": {
										"Description": {
											"type": "string"
										},
										"ShortDescription": {
											"type": "string"
										},
										"LongDescription": {
											"type": "string"
										}
									}
								},
								"PrimaryAddress": {
									"type": "object",
									"properties": {
										"AddressLine1": {
											"type": "string"
										},
										"Locality": {
											"type": "string"
										},
										"Region": {
											"type": "string"
										},
										"PostalCode": {
											"type": "string"
										},
										"CountryCode": {
											"type": "string"
										},
										"AddressLine2": {
											"type": "string"
										}
									}
								},
								"PhoneNumbers": {
									"type": "object",
									"properties": {
										"PrimaryPhoneNumber": {
											"type": "string"
										},
										"Landline": {
											"type": "string"
										},
										"TollFree": {
											"type": "string"
										},
										"Fax": {
											"type": "string"
										}
									}
								},
								"WebsiteURL": {
									"type": "string"
								},
								"AlternateWebsiteURL": {
									"type": "string"
								},
								"MediaURLs": {
									"type": "object",
									"properties": {
										"FacebookURL": {
											"type": "string"
										},
										"TwitterURL": {
											"type": "string"
										},
										"InstagramURL": {
											"type": "string"
										},
										"PinterestURL": {
											"type": "string"
										},
										"SocialNetworkURL": {
											"type": "string"
										}
									}
								},
								"HoursOfOperationStructured": {
									"type": "object",
									"properties": {
										"Su": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Mo": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Tu": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"We": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Th": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Fr": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Sa": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"SpecialHours": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"Date": {
														"type": "string"
													},
													"Ranges": {
														"type": "array",
														"items": {
															"type": "object",
															"properties": {
																"StartTime": {
																	"type": "string"
																},
																"EndTime": {
																	"type": "string"
																}
															}
														}
													},
													"State": {
														"type": "string"
													}
												}
											}
										}
									}
								},
								"BusinessCategories": {
									"type": "object",
									"properties": {
										"Category1": {
											"type": "string"
										},
										"Category2": {
											"type": "string"
										},
										"Category3": {
											"type": "string"
										},
										"Category4": {
											"type": "string"
										},
										"Category5": {
											"type": "string"
										},
										"Category6": {
											"type": "string"
										},
										"Category7": {
											"type": "string"
										},
										"Category8": {
											"type": "string"
										},
										"Category9": {
											"type": "string"
										},
										"Category10": {
											"type": "string"
										}
									}
								},
								"EmailAddress": {
									"type": "string"
								},
								"PhotoURLs": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"Type": {
												"type": "string"
											},
											"URL": {
												"type": "string"
											},
											"Name": {
												"type": "string"
											}
										}
									}
								},
								"KeywordsSpecialties": {
									"type": "string"
								},
								"Products": {
									"type": "string"
								},
								"Services": {
									"type": "string"
								},
								"Brands": {
									"type": "string"
								},
								"Tagline": {
									"type": "string"
								},
								"AreasServed": {
									"type": "string"
								},
								"Languages": {
									"type": "string"
								},
								"PaymentMethods": {
									"type": "string"
								},
								"YearFounded": {
									"type": "string"
								},
								"NumberEmployees": {
									"type": "string"
								}
							}
						},
						"ADFWebActivityResponseHeaders": {
							"type": "object",
							"properties": {
								"Pragma": {
									"type": "string"
								},
								"Access-Control-Expose-Headers": {
									"type": "string"
								},
								"Cache-Control": {
									"type": "string"
								},
								"Set-Cookie": {
									"type": "string"
								},
								"Request-Context": {
									"type": "string"
								},
								"Date": {
									"type": "string"
								},
								"Content-Length": {
									"type": "string"
								},
								"Content-Type": {
									"type": "string"
								},
								"Expires": {
									"type": "string"
								}
							}
						},
						"effectiveIntegrationRuntime": {
							"type": "string"
						},
						"executionDuration": {
							"type": "integer"
						},
						"durationInQueue": {
							"type": "object",
							"properties": {
								"integrationRuntimeQueue": {
									"type": "integer"
								}
							}
						},
						"billingReference": {
							"type": "object",
							"properties": {
								"activityType": {
									"type": "string"
								},
								"billableDuration": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"meterType": {
												"type": "string"
											},
											"duration": {
												"type": "number"
											},
											"unit": {
												"type": "string"
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GD_COLORWHEEL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GD_EAST_FOUNDATION')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GD_Enterprise_REF_TABLE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Enterprise_ReferenceMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Enterprise_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GD_NATIONAL_ASSORTMENT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GD_SISTER_SKU')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GD_WEST_FOUNDATION')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GetLastTriggerTime')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Get_Max_CustID_Customerall_Tbl')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Get_Phone_Chunk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Homes_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName_Prm": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName_Prm",
							"type": "Expression"
						},
						"folderPath": "Retail-Customer-Source-Files",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID",
						"type": "String"
					},
					{
						"name": "globalID",
						"type": "String"
					},
					{
						"name": "confidence_score",
						"type": "String"
					},
					{
						"name": "RecID",
						"type": "String"
					},
					{
						"name": "posRawContainerRecID",
						"type": "String"
					},
					{
						"name": "market_id",
						"type": "String"
					},
					{
						"name": "posFirstName",
						"type": "String"
					},
					{
						"name": "posMiddleInitial",
						"type": "String"
					},
					{
						"name": "posLastName",
						"type": "String"
					},
					{
						"name": "posCustomerEmail1",
						"type": "String"
					},
					{
						"name": "posCustomerEmail2",
						"type": "String"
					},
					{
						"name": "posCustomerEmail3",
						"type": "String"
					},
					{
						"name": "posCustomerPhone1",
						"type": "String"
					},
					{
						"name": "posCustomerPhone2",
						"type": "String"
					},
					{
						"name": "posCustomerPhone3",
						"type": "String"
					},
					{
						"name": "n_address",
						"type": "String"
					},
					{
						"name": "n_addr2",
						"type": "String"
					},
					{
						"name": "n_city",
						"type": "String"
					},
					{
						"name": "n_state",
						"type": "String"
					},
					{
						"name": "n_zip9",
						"type": "String"
					},
					{
						"name": "posFaceBookID",
						"type": "String"
					},
					{
						"name": "posTwitterID",
						"type": "String"
					},
					{
						"name": "timestamp",
						"type": "String"
					},
					{
						"name": "customer_type",
						"type": "String"
					},
					{
						"name": "customer_since",
						"type": "String"
					},
					{
						"name": "SourceSystem",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Homes_Files_GetMetaData')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Retail-Customer-Source-Files",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID",
						"type": "String"
					},
					{
						"name": "globalID",
						"type": "String"
					},
					{
						"name": "confidence_score",
						"type": "String"
					},
					{
						"name": "RecID",
						"type": "String"
					},
					{
						"name": "posRawContainerRecID",
						"type": "String"
					},
					{
						"name": "market_id",
						"type": "String"
					},
					{
						"name": "posFirstName",
						"type": "String"
					},
					{
						"name": "posMiddleInitial",
						"type": "String"
					},
					{
						"name": "posLastName",
						"type": "String"
					},
					{
						"name": "posCustomerEmail1",
						"type": "String"
					},
					{
						"name": "posCustomerEmail2",
						"type": "String"
					},
					{
						"name": "posCustomerEmail3",
						"type": "String"
					},
					{
						"name": "posCustomerPhone1",
						"type": "String"
					},
					{
						"name": "posCustomerPhone2",
						"type": "String"
					},
					{
						"name": "posCustomerPhone3",
						"type": "String"
					},
					{
						"name": "n_address",
						"type": "String"
					},
					{
						"name": "n_addr2",
						"type": "String"
					},
					{
						"name": "n_city",
						"type": "String"
					},
					{
						"name": "n_state",
						"type": "String"
					},
					{
						"name": "n_zip9",
						"type": "String"
					},
					{
						"name": "posFaceBookID",
						"type": "String"
					},
					{
						"name": "posTwitterID",
						"type": "String"
					},
					{
						"name": "timestamp",
						"type": "String"
					},
					{
						"name": "customer_type",
						"type": "String"
					},
					{
						"name": "customer_since",
						"type": "String"
					},
					{
						"name": "SourceSystem",
						"type": "String"
					},
					{
						"name": "SourceSubSystem",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/HttpDataset2')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Postalcode",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ID": {
						"type": "string",
						"defaultValue": "ZJERTAWalLbr19V1DoknD4**"
					},
					"Currentmonthyear": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "HttpFile",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat('/Download/Data/',dataset().Currentmonthyear,'/z5max.txt','?ID=',dataset().ID)",
						"type": "Expression"
					},
					"requestMethod": "GET",
					"parameters": {
						"ID": {
							"value": "ZJERTAWalLbr19V1DoknD4**"
						}
					}
				},
				"linkedService": {
					"referenceName": "Postalcode",
					"type": "LinkedServiceReference"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Postalcode')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/HttpDatasetfinal')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Postalcode",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": "/Download/Data/2024.07/z5max.txt"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Postalcode')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/INITIAL_SD_ADDRESS_LOCATION')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STREET_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE_OR_PROV_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ZIP_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STREET_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "CITY",
						"type": "nvarchar"
					},
					{
						"name": "STATE_OR_PROVINCE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ZIP_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_ADDRESS_LOCATION"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/INITIAL_SD_EMAIL_ADDRESS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_EMAIL_ADDRESS"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/INITIAL_SD_PHONE_NUMBER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_PHONE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "PHONE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "IS_VALID",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_PHONE_NUMBER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/INITIAL_SD_RETAIL_CUSTOMER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LAST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "RAW_MIDDLE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "LAST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "MIDDLE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PHONETIC_FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PHONETIC_LAST_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_RETAIL_CUSTOMER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InitialLoad_CommPref')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LEGAL_ENTITY_OPC_TRACKING')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "LEGAL_ENTITY_OPC_TRACK_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OPERATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "PRIMARY_PROFIT_CENTER",
						"type": "nvarchar"
					},
					{
						"name": "ERP_DATABASE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ERP_SYSTEM_NAME",
						"type": "nvarchar"
					},
					{
						"name": "EFFECTIVE_START_DATE",
						"type": "date"
					},
					{
						"name": "EFFECTIVE_END_DATE",
						"type": "date"
					},
					{
						"name": "LEGACY_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COMP_FLAG",
						"type": "bit"
					},
					{
						"name": "ENTERPRISE_FLAG",
						"type": "bit"
					},
					{
						"name": "TRAFFIC_SYSTEM_ID",
						"type": "nvarchar"
					},
					{
						"name": "LIC_TERRITORY",
						"type": "nvarchar"
					},
					{
						"name": "TUA_EXPIRATION_DATE",
						"type": "date"
					},
					{
						"name": "NOTES",
						"type": "nvarchar"
					},
					{
						"name": "OS_ID",
						"type": "nvarchar"
					},
					{
						"name": "OS_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "FD_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_LEGAL_ENTITY_OPC_TRACKING"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Locations')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "Edme_datafactory",
					"table": "Locations"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Lookup_GD_Master_Table')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Enterprise_ReferenceMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Enterprise_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/MasterDataHub_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Master_Table_Max_Date_Sink')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_AllSourceCustomers')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "customerMasterId",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "sourceCustomerId",
						"type": "nvarchar"
					},
					{
						"name": "firstName",
						"type": "nvarchar"
					},
					{
						"name": "middleInitial",
						"type": "nvarchar"
					},
					{
						"name": "lastName",
						"type": "nvarchar"
					},
					{
						"name": "customerEmail1",
						"type": "nvarchar"
					},
					{
						"name": "customerEmail2",
						"type": "nvarchar"
					},
					{
						"name": "customerEmail3",
						"type": "nvarchar"
					},
					{
						"name": "customerPhone1",
						"type": "nvarchar"
					},
					{
						"name": "customerPhone2",
						"type": "nvarchar"
					},
					{
						"name": "customerPhone3",
						"type": "nvarchar"
					},
					{
						"name": "addressLine1",
						"type": "nvarchar"
					},
					{
						"name": "addressLine2",
						"type": "nvarchar"
					},
					{
						"name": "city",
						"type": "nvarchar"
					},
					{
						"name": "state",
						"type": "nvarchar"
					},
					{
						"name": "zipCode",
						"type": "nvarchar"
					},
					{
						"name": "marketId",
						"type": "nvarchar"
					},
					{
						"name": "customerType",
						"type": "nvarchar"
					},
					{
						"name": "sourceSystem",
						"type": "nvarchar"
					},
					{
						"name": "sourceSubSystem",
						"type": "nvarchar"
					},
					{
						"name": "createdDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "updatedDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "createdBy",
						"type": "nvarchar"
					},
					{
						"name": "updatedBy",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "AllSourceCustomers"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_AllSourceCustomers_FileName')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "customerMasterId",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "sourceCustomerId",
						"type": "nvarchar"
					},
					{
						"name": "firstName",
						"type": "nvarchar"
					},
					{
						"name": "middleInitial",
						"type": "nvarchar"
					},
					{
						"name": "lastName",
						"type": "nvarchar"
					},
					{
						"name": "customerEmail1",
						"type": "nvarchar"
					},
					{
						"name": "customerEmail2",
						"type": "nvarchar"
					},
					{
						"name": "customerEmail3",
						"type": "nvarchar"
					},
					{
						"name": "customerPhone1",
						"type": "nvarchar"
					},
					{
						"name": "customerPhone2",
						"type": "nvarchar"
					},
					{
						"name": "customerPhone3",
						"type": "nvarchar"
					},
					{
						"name": "addressLine1",
						"type": "nvarchar"
					},
					{
						"name": "addressLine2",
						"type": "nvarchar"
					},
					{
						"name": "city",
						"type": "nvarchar"
					},
					{
						"name": "state",
						"type": "nvarchar"
					},
					{
						"name": "zipCode",
						"type": "nvarchar"
					},
					{
						"name": "marketId",
						"type": "nvarchar"
					},
					{
						"name": "customerType",
						"type": "nvarchar"
					},
					{
						"name": "sourceSystem",
						"type": "nvarchar"
					},
					{
						"name": "sourceSubSystem",
						"type": "nvarchar"
					},
					{
						"name": "createdDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "updatedDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "createdBy",
						"type": "nvarchar"
					},
					{
						"name": "updatedBy",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "AllSourceCustomers"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_Cdp_Customer_Preferences')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "globalId",
						"type": "nvarchar"
					},
					{
						"name": "customerContact",
						"type": "nvarchar"
					},
					{
						"name": "opt_in",
						"type": "nvarchar"
					},
					{
						"name": "opt_in_type",
						"type": "nvarchar"
					},
					{
						"name": "sourceSystem",
						"type": "nvarchar"
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "contactType",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "cdp_customer_preferences"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_Cdp_Customer_Preferences_INC')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "globalId",
						"type": "nvarchar"
					},
					{
						"name": "customerContact",
						"type": "nvarchar"
					},
					{
						"name": "opt_in",
						"type": "nvarchar"
					},
					{
						"name": "opt_in_type",
						"type": "nvarchar"
					},
					{
						"name": "sourceSystem",
						"type": "nvarchar"
					},
					{
						"name": "dtec",
						"type": "nvarchar"
					},
					{
						"name": "contactType",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "cdp_customer_preferences"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_OptOut')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "CustomerKey",
						"type": "nvarchar"
					},
					{
						"name": "EmailAddress",
						"type": "nvarchar"
					},
					{
						"name": "EmailChannelOptOutFlag",
						"type": "nvarchar"
					},
					{
						"name": "EmailChannelOptStatusDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "DSG_Brand_Flag",
						"type": "nvarchar"
					},
					{
						"name": "EAGR_Brand_Flag",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "OptOut"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_OptOut_INC')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "CustomerKey",
						"type": "nvarchar"
					},
					{
						"name": "EmailAddress",
						"type": "nvarchar"
					},
					{
						"name": "EmailChannelOptOutFlag",
						"type": "nvarchar"
					},
					{
						"name": "EmailChannelOptStatusDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "DSG_Brand_Flag",
						"type": "nvarchar"
					},
					{
						"name": "EAGR_Brand_Flag",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "OptOut"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_Prefrence_MaxDate')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Masterdata_CDP_preferences')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Max_CustomerMasterId_CustomerInfo')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Move_Error_Files_RetailCustomer_Container')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Retail-Customer-Source-Files",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID\tglobalID\tconfidenceScore\tRecID\tposRawContainerRecID\tmarket_id\tposFirstName\tposMiddleInitial\tposLastName\tposCustomerEmail1\tposCustomerEmail2\tposCustomerEmail3\tposCustomerPhone1\tposCustomerPhone2\tposCustomerPhone3\tn_address\tn_addr2\tn_city\tn_state\tn_zip9\tposFaceBookID\tposTwitterID\ttimestamp\tcustomer_type\tcustomer_since\tSourceSystem",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/NationalAssortmentProduct')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "NationalAssortmentProduct.parquet",
						"folderPath": "Retail/SupplyChain/NationalAssortmentProduct",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/NationalAssortmentProduct_Historical')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "HistoricalNationalAssortmentProduct.parquet",
						"folderPath": "Retail/SupplyChain/HistoricalNationalAssortmentProduct",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Old_SA_PRODUCT_KIT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "KIT_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "KIT_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "LAST_MOD_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "CREATED_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "SERIES_ID",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_KEY",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "KIT_RETAIL_TYPE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_STATUS_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_IMPORT_DOMESTIC_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_ENGINEER_DIVISION_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_CLASS_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CODE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SALES_CATEG_CODE_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DFLT_GROUP_CODE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_FAMILYOF_BUSINESS_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SERIES_RT_SL_CAT_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_EXPRESS_SHIP",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PRIMARY_LIFESTYLE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AX_KIT_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_STATUS_CHANGED",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DEAD",
						"type": "nvarchar"
					},
					{
						"name": "KIT_BOX_QTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SEATS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_DINING_CHAIR_QTY_CTN",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_UPC",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ARVR_READY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_STAND_ALONE_FLAG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DIMENSIONS_CONFIRMED",
						"type": "nvarchar"
					},
					{
						"name": "KIT_MFG_WARRANTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_FRIENDLY_DIMENSIONS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_GEN_DESC_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_GEN_LONG_DESC",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FORECAST_PLANNER_ID",
						"type": "nvarchar"
					},
					{
						"name": "KIT_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PRODUCT_DEPTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_DEPTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_HEIGHT_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_HEIGHT_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_WIDTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_WIDTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_ADDITIONAL_DIMENSIONS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CARTON_DEPTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_DEPTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_HEIGHT_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_HEIGHT_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_WIDTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_WIDTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_UNIT_WEIGHT_KG",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_UNIT_WEIGHT_LBS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SUPP_WT_NET_WT_LBS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SUPP_WT_NET_WT_KG",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SELLLING_COUNTRIES",
						"type": "nvarchar"
					},
					{
						"name": "KIT_THIRD_PARTY_KIT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SCENE7_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ROLL_OVER_IMAGE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_KNOCKOUT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COLOR_SWATCH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PHOTO",
						"type": "nvarchar"
					},
					{
						"name": "KIT_GOOGLE_TITLE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PRODUCT_PAGE_URL",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CUBES_FT",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CUBES_M",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_FOB_BASE_PRICE",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CONSUMER_ASSEMBLY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FUTURE_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_KEY_KIT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_TRACKING_PIECE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ALTER_DESC2",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SHOWROOM_MKT_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_TRADEMARK_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ALTERNATE_AFI_FLUFF1",
						"type": "nvarchar"
					},
					{
						"name": "KIT_VALIDATION_COMPLETE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ALTER_DESC3",
						"type": "nvarchar"
					},
					{
						"name": "KIT_EXCLUSIVE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_EXCLUSIVE_COMMENT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COMMODITY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_UPHOLSTERY_COVER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CARTON_VOLUME",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_DENSITY",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_FREIGHT_CLASS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPABLE_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_NOT_AVBL_INDIV_SALE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PURCHASE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PARTS_DRAWINGS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HOMESTORE_PDT_LINE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_RETAIL_ROOM_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SHIPPING_DEPTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_DEPTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_HEIGHT_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_HEIGHT_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_WIDTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_WIDTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PK_LEG_SELLABLE_PKG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COND_HOME_DELIV_ELIG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ATP_SERIES",
						"type": "nvarchar"
					},
					{
						"name": "KIT_VENDOR_NAME",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ASM_INSTR_INTERNAL",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ASM_INSTR_PUBLIC",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COMPONENT_QUANTITY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DIMENSION_SKETCH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HOMESTORE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "KIT_WHOLESALE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET1_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET2_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET3_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET4_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET5_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET6_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET7_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CONSUMER_DESC_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FLUFF_AFI_ENGLISH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FLUFF_PRINT_ENGLISH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FRIENDLY_DESC_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET1_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET2_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET3_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET4_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET5_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET6_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET7_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET8_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_KIT_FLUFF_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ELIG_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "KIT_IS_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ASHCOMM_DELIVERY_MODE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_MATERIAL_ENGLISH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ECOM_MERCHANT_NOTES",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AMAZON_BRAND_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_RETAIL_BRAND_NAME_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_COLOR_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HTS_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_KIT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Old_SA_PRODUCT_KIT_CROSSWALK')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_KIT_CROSSWALK_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PRODUCT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "F_PRODUCT_MAIN_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_PRODUCT_MAIN_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_KIT_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_KIT_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_KIT_CROSSWALK"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Old_SA_PRODUCT_MAIN')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_MAIN_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SOURCE_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "STATUS",
						"type": "nvarchar"
					},
					{
						"name": "LAST_MOD_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "SYSTEM_TIMESTAMP",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ALTERNATE_DESCRIPTION2",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ALTERNATE_AFI_FLUFF1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ALTER_DESC3",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ARVR_READY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ASM_INSTR_INTERNAL",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ASM_INSTR_PUBLIC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_BOX_QTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_CARTON_DEPTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_DEPTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_HEIGHT_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_HEIGHT_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_WIDTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_WIDTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CLASS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COLOR",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COLOR_SWATCH",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COMMODITY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COMPONENT_QUANTITY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CONSUMER_ASSEMBLY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CUBES_FT",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CUBES_M",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_DEAD",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_DIMENSION_SKETCH",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_DINING_CHAIR_QTY_CTN",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_ENGINEERING_DIVISION",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_EXCLUSIVE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_EXCLUSIVE_COMMENT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_EXPRESS_SHIP",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FOB_BASE_PRICE",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_FORECAST_PLANNER_ID",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FRIENDLY_DIMENSIONS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FUTURE_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_GNRL_DESC_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_GNRL_LONG_DESC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_GOOGLE_TITLE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMSTORE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_IMPORT_DOMESTIC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_KEY_ITEM",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_KNOCKOUT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_MTERIAL_REF_NEEDED",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_MFG_WARRANTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_PHOTO",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_PRODUCT_DEPTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_DEPTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_HEIGHT_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_HEIGHT_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_PAGE_URL",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_PRODUCT_WIDTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_WIDTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_RETAIL_BRAND_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_RETAIL_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ROLL_OVERIMAGE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SALES_CATEGORY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SCENE7_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SEATS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SERIES_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_STAND_ALONE_FLAG",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_STATUS_CHANGED",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SUPP_DT_SHIP_ONLY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SUPP_WET_NET_WET_KG",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SUPP_WET_NET_WET_LBS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_THIRD_PARTY_ITEM",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_TRACKING_PIECE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_TRADEMARK_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UNIT_WEIGHT_KG",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UNIT_WEIGHT_LBS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UPC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_VALIDATION_COMPLETE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_WHOLESALE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET2",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET3",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET4",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET5",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET6",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET7",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CONSUMER_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FLUFF_AFI",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FLUFF_PRINT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FRIENDLY_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET2",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET3",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET4",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET5",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET6",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET7",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET8",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_ITEM_FLUFF",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_ASHLEY_HOMESTORE",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_CORP_ONLINE_SELLNG",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_DIVISION",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_EXCLUSIVE_COMMENT",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_FEATURES",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_ID",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_INTERNATIONAL_HS",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_INTRO_DATE",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "SERIES_MAIN_IMAGE",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_RETAIL_SALES_CATEG",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_SHOWROOM",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_SOURCE_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "SERIES_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_STYLE",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_THIRD_PARTY",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_PRIMARY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SHIPPABLE_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ELIG_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_IS_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ASHCOMM_DLVR_MODE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_MATERIAL",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HS_PRODUCT_LINE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ECOM_MERCHANT_NOTES",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AMAZON_BRAND_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_LIFESTYLE_DESC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HTS_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_MAIN"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Old_SA_PRODUCT_PACKAGE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PACKAGE_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "HOMESTORE_PACKAGE_ID",
						"type": "nvarchar"
					},
					{
						"name": "LAST_MOD_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "CREATED_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "PACKAGE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ALTER_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HERO",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_STATUS_CHANGED",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_IS_THIRD_PARTY",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_ID",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_WHOLESALE_ID",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_RETAIL_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ITEM_QUANTITY",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_UOM",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_COLOR",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_KNOCKOUT",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SCENE7_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_VALIDAT_COMPLETE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_VALIDATION_NOTES",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ROLLOVER_IMAGE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_EXPRESS_SHIP",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SALES_CATEG_CODE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SERIES_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASHCOM_TRANSITION",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SWATCH_GROUP_ID",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_DEFAULT_PRODUCT",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_NEW_FLAG_DATE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASHCOMM_DLVR_MODE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_CHANNEL_CHANGE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_EXCLUSIVE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOT_SPOTS_REVIEW",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ALT_DESC1",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASH_TTL_OVERRIDE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HIDDEN_FIELD",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_CONSUMER_CHOICE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_TOTAL_ASM_TIME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASHCOMM_FLAGS",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_NAVIGABLE_CATEG",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HS_PACKAGE_FLUFF",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS1",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS2",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS3",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS4",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS5",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS6",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET1",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET2",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET3",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET4",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET5",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET6",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_FLUFF",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_PACKAGE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Old_SA_PRODUCT_PACKAGE_CROSSWALK')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_PKG_CROSSWALK_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PRODUCT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "F_PRODUCT_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_PRODUCT_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_PACKAGE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_PACKAGE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_PACKAGE_CROSSWALK"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Phone_Chunk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postal_Code_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "*",
						"folderPath": "Postal_Code_Source_Files",
						"fileSystem": "postal-code"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postal_Code_Error_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "*",
						"folderPath": "Postal_Code_Source_Files",
						"fileSystem": "postal-code"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postal_Code_Succeed_Files_Delete')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Postal_Code_Source_Files",
						"fileSystem": "postal-code"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postal_datadownload')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Postal_datadownload",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Postal_datadownload')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postalcodes_Melissa')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Scratch",
					"table": "postalcodes_US"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Prefrence_EDW_Query')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Ashley_EDW",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Ashley_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Prefrence_MaxDate')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_AddressLocationsIncremental')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_EmailAddressesIncremental')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_PhoneNumbersIncremental')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_RetailCustomersAddress')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_RetailCustomersEmailInitial')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_RetailCustomersIncremental')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_RetailCustomersInitial')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Raw_RetailCustomersPhoneInitial')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RcmPrefsSubscriber')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Remove_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Archive",
						"fileSystem": "retail-customer"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Remove_Error_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Error",
						"fileSystem": "retail-customer"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RetailCustomer_CrossWalk_DU_OUT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "CrossWalk_DU_OUT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RetailCustomer_DataSet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "COMM_PREFERNC_EMAIL_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_BATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_GOLDENTYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_MASTERSCOUNT",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_HASOVERRIDE",
						"type": "bit"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ISCONFIRMED",
						"type": "bit"
					},
					{
						"name": "B_CONFSCORE",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CONFIRMATIONSTATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_CONFSCORETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_HASSUGGMERGE",
						"type": "bit"
					},
					{
						"name": "B_SUGGMERGEID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_SUGGMERGECONFSCORE",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_SUGGMERGECONFSCORETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_SUGGMERGEMASTERSCOUNT",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "OPTED_IN",
						"type": "bit"
					},
					{
						"name": "ORGANIZATION",
						"type": "nvarchar"
					},
					{
						"name": "PURPOSE",
						"type": "nvarchar"
					},
					{
						"name": "CHANNEL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_COMMUNICATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_ERROR",
						"type": "nvarchar"
					},
					{
						"name": "SRC_UPDATE",
						"type": "datetime2",
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "GD_COMMUNICTN_PREFERNC_EMAIL"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_Customer_Error_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Error",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID\tglobalID\tconfidence_score\tReID\tposRawContainerRecID\tmarketid\tposFirstName\tposMiddleInitial\tposLastName\tposCustomerEmail1\tposCustomerEmail2\tposCustomerEmail3\tposCustomerPhone1\tposCustomerPhone2\tposCustomerPhone3\tn_address\tn_addr2\tn_city\tn_state\tn_zip9\tposFaceBookID\tposTwitterID\ttimestamp\tcustomer_type\tcustomer_since\tSourceSystem\tSourceSubSystem",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_ProductMaster_EDW_KitComponentCrosswalk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_KIT_CROSSWALK_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PRODUCT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "F_PRODUCT_MAIN_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_PRODUCT_MAIN_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_KIT_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_KIT_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_KIT_CROSSWALK"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_ProductMaster_EDW_Product')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_MAIN_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SOURCE_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "STATUS",
						"type": "nvarchar"
					},
					{
						"name": "LAST_MOD_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "SYSTEM_TIMESTAMP",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ALTERNATE_DESCRIPTION2",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ALTERNATE_AFI_FLUFF1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ALTER_DESC3",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ARVR_READY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ASM_INSTR_INTERNAL",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ASM_INSTR_PUBLIC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_BOX_QTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_CARTON_DEPTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_DEPTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_HEIGHT_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_HEIGHT_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_WIDTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CARTON_WIDTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CLASS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COLOR",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COLOR_SWATCH",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COMMODITY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_COMPONENT_QUANTITY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CONSUMER_ASSEMBLY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CUBES_FT",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_CUBES_M",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_DEAD",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_DIMENSION_SKETCH",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_DINING_CHAIR_QTY_CTN",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_ENGINEERING_DIVISION",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_EXCLUSIVE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_EXCLUSIVE_COMMENT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_EXPRESS_SHIP",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FOB_BASE_PRICE",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_FORECAST_PLANNER_ID",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FRIENDLY_DIMENSIONS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FUTURE_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_GNRL_DESC_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_GNRL_LONG_DESC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_GOOGLE_TITLE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMSTORE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_IMPORT_DOMESTIC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_KEY_ITEM",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_KNOCKOUT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_MTERIAL_REF_NEEDED",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_MFG_WARRANTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ITEM_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_PHOTO",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_PRODUCT_DEPTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_DEPTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_HEIGHT_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_HEIGHT_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_PAGE_URL",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_PRODUCT_WIDTH_IN",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_PRODUCT_WIDTH_MM",
						"type": "decimal",
						"precision": 21,
						"scale": 2
					},
					{
						"name": "ITEM_RETAIL_BRAND_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_RETAIL_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ROLL_OVERIMAGE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SALES_CATEGORY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SCENE7_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SEATS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SERIES_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_STAND_ALONE_FLAG",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_STATUS_CHANGED",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SUPP_DT_SHIP_ONLY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SUPP_WET_NET_WET_KG",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SUPP_WET_NET_WET_LBS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_THIRD_PARTY_ITEM",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_TRACKING_PIECE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_TRADEMARK_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UNIT_WEIGHT_KG",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UNIT_WEIGHT_LBS",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UPC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_VALIDATION_COMPLETE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_WHOLESALE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET2",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET3",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET4",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET5",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET6",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AFI_FEATURE_BULLET7",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_CONSUMER_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FLUFF_AFI",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FLUFF_PRINT",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_FRIENDLY_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET1",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET2",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET3",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET4",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET5",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET6",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET7",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_FT_BULLET8",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HOMESTORE_ITEM_FLUFF",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_ASHLEY_HOMESTORE",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_CORP_ONLINE_SELLNG",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_DIVISION",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_EXCLUSIVE_COMMENT",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_FEATURES",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_ID",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_INTERNATIONAL_HS",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_INTRO_DATE",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "SERIES_MAIN_IMAGE",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_RETAIL_SALES_CATEG",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_SHOWROOM",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_SOURCE_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "SERIES_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_STYLE",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_THIRD_PARTY",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_PRIMARY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_SHIPPABLE_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ELIG_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_IS_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ASHCOMM_DLVR_MODE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_MATERIAL",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HS_PRODUCT_LINE",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_ECOM_MERCHANT_NOTES",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_AMAZON_BRAND_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_LIFESTYLE_DESC",
						"type": "nvarchar"
					},
					{
						"name": "ITEM_HTS_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_MAIN"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_ProductMaster_EDW_ProductCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_CODE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PRODUCT_CODE",
						"type": "nvarchar"
					},
					{
						"name": "IS_ACTIVE",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_CODE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_ProductMaster_EDW_ProductKit')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "KIT_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "KIT_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "LAST_MOD_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "CREATED_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "SERIES_ID",
						"type": "nvarchar"
					},
					{
						"name": "SERIES_KEY",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "KIT_RETAIL_TYPE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_STATUS_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_IMPORT_DOMESTIC_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_ENGINEER_DIVISION_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_CLASS_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CODE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SALES_CATEG_CODE_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DFLT_GROUP_CODE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_FAMILYOF_BUSINESS_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SERIES_RT_SL_CAT_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_EXPRESS_SHIP",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PRIMARY_LIFESTYLE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AX_KIT_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_STATUS_CHANGED",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DEAD",
						"type": "nvarchar"
					},
					{
						"name": "KIT_BOX_QTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SEATS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_DINING_CHAIR_QTY_CTN",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_UPC",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ARVR_READY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_STAND_ALONE_FLAG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SUPPLIER_DT_SHIP_ONLY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DIMENSIONS_CONFIRMED",
						"type": "nvarchar"
					},
					{
						"name": "KIT_MFG_WARRANTY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_FRIENDLY_DIMENSIONS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_GEN_DESC_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_GEN_LONG_DESC",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FORECAST_PLANNER_ID",
						"type": "nvarchar"
					},
					{
						"name": "KIT_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PRODUCT_DEPTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_DEPTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_HEIGHT_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_HEIGHT_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_WIDTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PRODUCT_WIDTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_ADDITIONAL_DIMENSIONS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CARTON_DEPTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_DEPTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_HEIGHT_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_HEIGHT_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_WIDTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_WIDTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_UNIT_WEIGHT_KG",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_UNIT_WEIGHT_LBS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SUPP_WT_NET_WT_LBS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SUPP_WT_NET_WT_KG",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SELLLING_COUNTRIES",
						"type": "nvarchar"
					},
					{
						"name": "KIT_THIRD_PARTY_KIT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SCENE7_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ROLL_OVER_IMAGE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_KNOCKOUT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COLOR_SWATCH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PHOTO",
						"type": "nvarchar"
					},
					{
						"name": "KIT_GOOGLE_TITLE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PRODUCT_PAGE_URL",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CUBES_FT",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CUBES_M",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_FOB_BASE_PRICE",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CONSUMER_ASSEMBLY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FUTURE_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_KEY_KIT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_TRACKING_PIECE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ALTER_DESC2",
						"type": "nvarchar"
					},
					{
						"name": "KIT_SHOWROOM_MKT_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_TRADEMARK_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ALTERNATE_AFI_FLUFF1",
						"type": "nvarchar"
					},
					{
						"name": "KIT_VALIDATION_COMPLETE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ALTER_DESC3",
						"type": "nvarchar"
					},
					{
						"name": "KIT_EXCLUSIVE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_EXCLUSIVE_COMMENT",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COMMODITY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_UPHOLSTERY_COVER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CARTON_VOLUME",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_DENSITY",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_CARTON_FREIGHT_CLASS",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPABLE_UOM_KEY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_NOT_AVBL_INDIV_SALE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PURCHASE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_PARTS_DRAWINGS",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HOMESTORE_PDT_LINE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_RETAIL_ROOM_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_SHIPPING_DEPTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_DEPTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_HEIGHT_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_HEIGHT_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_WIDTH_IN",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_SHIPPING_WIDTH_MM",
						"type": "decimal",
						"precision": 20,
						"scale": 5
					},
					{
						"name": "KIT_PK_LEG_SELLABLE_PKG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COND_HOME_DELIV_ELIG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ATP_SERIES",
						"type": "nvarchar"
					},
					{
						"name": "KIT_VENDOR_NAME",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ASM_INSTR_INTERNAL",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ASM_INSTR_PUBLIC",
						"type": "nvarchar"
					},
					{
						"name": "KIT_COMPONENT_QUANTITY",
						"type": "nvarchar"
					},
					{
						"name": "KIT_DIMENSION_SKETCH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HOMESTORE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "KIT_WHOLESALE_ASM_VIDEO1",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET1_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET2_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET3_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET4_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET5_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET6_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AFI_FT_BULLET7_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_CONSUMER_DESC_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FLUFF_AFI_ENGLISH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FLUFF_PRINT_ENGLISH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_FRIENDLY_DESC_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET1_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET2_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET3_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET4_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET5_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET6_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET7_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_FT_BULLET8_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HS_KIT_FLUFF_ENG",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ELIG_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "KIT_IS_PROTECTION_PLAN",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ASHCOMM_DELIVERY_MODE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_MATERIAL_ENGLISH",
						"type": "nvarchar"
					},
					{
						"name": "KIT_ECOM_MERCHANT_NOTES",
						"type": "nvarchar"
					},
					{
						"name": "KIT_AMAZON_BRAND_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "KIT_RETAIL_BRAND_NAME_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_COLOR_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "KIT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "KIT_HTS_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_KIT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_ProductMaster_EDW_ProductPackage')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PACKAGE_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_KEY",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "HOMESTORE_PACKAGE_ID",
						"type": "nvarchar"
					},
					{
						"name": "LAST_MOD_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "CREATED_DATE_TIME_UTC",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "PACKAGE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ALTER_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HERO",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_STATUS_CHANGED",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_IS_THIRD_PARTY",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_ID",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_WHOLESALE_ID",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_RETAIL_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ITEM_QUANTITY",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_UOM",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_COLOR",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_KNOCKOUT",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SCENE7_IMAGE_SET",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_VALIDAT_COMPLETE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_VALIDATION_NOTES",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ROLLOVER_IMAGE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_EXPRESS_SHIP",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SUPP_DT_SHIP_ONLY",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SALES_CATEG_CODE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SERIES_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SERIES_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASHCOM_TRANSITION",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SWATCH_GROUP_ID",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_DEFAULT_PRODUCT",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_NEW_FLAG_DATE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASHCOMM_DLVR_MODE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_CHANNEL_CHANGE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_EXCLUSIVE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOT_SPOTS_REVIEW",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ALT_DESC1",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASH_TTL_OVERRIDE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HIDDEN_FIELD",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_CONSUMER_CHOICE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_TOTAL_ASM_TIME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_ASHCOMM_FLAGS",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_NAVIGABLE_CATEG",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HS_PACKAGE_FLUFF",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS1",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS2",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS3",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS4",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS5",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_BULLETS6",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET1",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET2",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET3",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET4",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET5",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_HOMESTORE_BULLET6",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_AFI_FLUFF",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_PACKAGE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_ProductMaster_EDW_ProductPackageCrosswalk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_ProductMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_PKG_CROSSWALK_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PRODUCT_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "PRODUCT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "PACKAGE_SOURCE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "F_PRODUCT_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_PRODUCT_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_PACKAGE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_PACKAGE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_PRODUCT_PACKAGE_CROSSWALK"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_ProductMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_ASH_REMOVE_SITE_TRACKING')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "SITE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "ASH_REMOVE_SITE_TRACKING"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_GD_LEGAL_ENTITY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_BATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					},
					{
						"name": "TYPE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "CITY",
						"type": "nvarchar"
					},
					{
						"name": "STATE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_CITY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "OS_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LIC_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "COMPANY_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "GD_LEGAL_ENTITY"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SA_Custome_Hours')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_CUSTOM_HOURS"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SA_HS_OPC_Tracking')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "HS_OPC_TRACKING_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OPERATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "PRIMARY_PROFIT_CENTER",
						"type": "nvarchar"
					},
					{
						"name": "ERP_DATABASE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ERP_SYSTEM_NAME",
						"type": "nvarchar"
					},
					{
						"name": "EFFECTIVE_START_DATE",
						"type": "date"
					},
					{
						"name": "EFFECTIVE_END_DATE",
						"type": "date"
					},
					{
						"name": "LEGACY_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COMP_FLAG",
						"type": "bit"
					},
					{
						"name": "ENTERPRISE_FLAG",
						"type": "bit"
					},
					{
						"name": "TRAFFIC_SYSTEM_ID",
						"type": "nvarchar"
					},
					{
						"name": "LIC_TERRITORY",
						"type": "nvarchar"
					},
					{
						"name": "TUA_EXPIRATION_DATE",
						"type": "date"
					},
					{
						"name": "NOTES",
						"type": "nvarchar"
					},
					{
						"name": "OS_ID",
						"type": "nvarchar"
					},
					{
						"name": "OS_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "FD_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_HS_OPC_TRACKING"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SA_SITE_CONTENT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTENT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_SHORT_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LONG_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LANGUAGE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_CONTENT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SA_SITE_DEFAULT_HOURS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTENT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_SHORT_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LONG_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LANGUAGE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_DEFAULT_HOUR"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SA_SITE_Special_HOURS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTENT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_SHORT_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LONG_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "CONTENT_LANGUAGE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_SPECIAL_HOUR"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SA_Site_Program')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_PROGRAM"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SA_WH_LE_Tracking')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "WH_LE_TRACKING_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "EFFECTIVE_START_DATE",
						"type": "date"
					},
					{
						"name": "EFFECTIVE_END_DATE",
						"type": "date"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "NOTES",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "LEGACY_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "OS_ID",
						"type": "nvarchar"
					},
					{
						"name": "OS_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "FD_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_WH_LE_TRACKING"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SD_HS_OPC_Tracking')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OPERATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "PRIMARY_PROFIT_CENTER",
						"type": "nvarchar"
					},
					{
						"name": "ERP_DATABASE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ERP_SYSTEM_NAME",
						"type": "nvarchar"
					},
					{
						"name": "EFFECTIVE_START_DATE",
						"type": "date"
					},
					{
						"name": "EFFECTIVE_END_DATE",
						"type": "date"
					},
					{
						"name": "LEGACY_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COMP_FLAG",
						"type": "bit"
					},
					{
						"name": "ENTERPRISE_FLAG",
						"type": "bit"
					},
					{
						"name": "TRAFFIC_SYSTEM_ID",
						"type": "nvarchar"
					},
					{
						"name": "LIC_TERRITORY",
						"type": "nvarchar"
					},
					{
						"name": "TUA_EXPIRATION_DATE",
						"type": "date"
					},
					{
						"name": "NOTES",
						"type": "nvarchar"
					},
					{
						"name": "OS_ID",
						"type": "nvarchar"
					},
					{
						"name": "OS_LOCATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "SITE_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "SITE_CITY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "SITE_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "FD_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_HS_OPC_TRACKING"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SD_HS_OP_PC_Tracker')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SITE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ISACTIVE",
						"type": "bit"
					},
					{
						"name": "SITE_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "SITE_OWNERSHIP_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_OWNER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "OPERATIONS_START_DATE",
						"type": "date"
					},
					{
						"name": "OPERATIONS_END_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_CLOSE_DATE",
						"type": "date"
					},
					{
						"name": "LOCAL_CURRENCY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LOCAL_UNIT_OF_MEASURE_ARE",
						"type": "nvarchar"
					},
					{
						"name": "TOTAL_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "OPERATIONS_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "CUSTOMER_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "F_SITE_DEFAULT_HOURS",
						"type": "uniqueidentifier"
					},
					{
						"name": "FD_SITE_DEFAULT_HOURS",
						"type": "nvarchar"
					},
					{
						"name": "SITE_SHIP_TO",
						"type": "nvarchar"
					},
					{
						"name": "RAW_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "MAIN_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FAX",
						"type": "nvarchar"
					},
					{
						"name": "STD_FAX",
						"type": "nvarchar"
					},
					{
						"name": "FAX_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CS_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "VLD_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SALES_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SERVICE_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "F_WAREHOUSE_PARENT",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FS_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FD_WAREHOUSE_PARENT",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_HS_OPC_TRACKING"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SD_HS_OP_PC_Tracker_DAC')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SITE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ISACTIVE",
						"type": "bit"
					},
					{
						"name": "SITE_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "SITE_OWNERSHIP_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_OWNER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "OPERATIONS_START_DATE",
						"type": "date"
					},
					{
						"name": "OPERATIONS_END_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_CLOSE_DATE",
						"type": "date"
					},
					{
						"name": "LOCAL_CURRENCY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LOCAL_UNIT_OF_MEASURE_ARE",
						"type": "nvarchar"
					},
					{
						"name": "TOTAL_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "OPERATIONS_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "CUSTOMER_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "F_SITE_DEFAULT_HOURS",
						"type": "uniqueidentifier"
					},
					{
						"name": "FD_SITE_DEFAULT_HOURS",
						"type": "nvarchar"
					},
					{
						"name": "SITE_SHIP_TO",
						"type": "nvarchar"
					},
					{
						"name": "RAW_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "MAIN_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FAX",
						"type": "nvarchar"
					},
					{
						"name": "STD_FAX",
						"type": "nvarchar"
					},
					{
						"name": "FAX_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CS_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "VLD_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SALES_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SERVICE_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "F_WAREHOUSE_PARENT",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FS_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FD_WAREHOUSE_PARENT",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_HS_OPC_TRACKING"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SD_SITE_MAIN')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "SITE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SITE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ISACTIVE",
						"type": "bit"
					},
					{
						"name": "SITE_DESCRIPTION",
						"type": "nvarchar"
					},
					{
						"name": "SITE_OWNERSHIP_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_OWNER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "OPERATIONS_START_DATE",
						"type": "date"
					},
					{
						"name": "OPERATIONS_END_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "CUSTOMER_CLOSE_DATE",
						"type": "date"
					},
					{
						"name": "LOCAL_CURRENCY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LOCAL_UNIT_OF_MEASURE_ARE",
						"type": "nvarchar"
					},
					{
						"name": "TOTAL_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "OPERATIONS_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "CUSTOMER_SITE_AREA",
						"type": "decimal",
						"precision": 12,
						"scale": 4
					},
					{
						"name": "F_SITE_DEFAULT_HOURS",
						"type": "uniqueidentifier"
					},
					{
						"name": "FD_SITE_DEFAULT_HOURS",
						"type": "nvarchar"
					},
					{
						"name": "SITE_SHIP_TO",
						"type": "nvarchar"
					},
					{
						"name": "RAW_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_MAIN_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "MAIN_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FAX",
						"type": "nvarchar"
					},
					{
						"name": "STD_FAX",
						"type": "nvarchar"
					},
					{
						"name": "FAX_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CS_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "VLD_CS_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SALES_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SALES_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SALES_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_SERVICE_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "SERVICE_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_SERVICE_CHAT",
						"type": "nvarchar"
					},
					{
						"name": "F_WAREHOUSE_PARENT",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FS_WAREHOUSE_PARENT",
						"type": "nvarchar"
					},
					{
						"name": "FD_WAREHOUSE_PARENT",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SD_Site_Legal_Entity')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "SITE_LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CONSTRAINTNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_CONSTRAINTTYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_BATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE_LEGAL_ENTITY"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_SD_Site_Legal_Entity_OWNER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OWNER_FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "OWNER_LAST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "RAW_OWNER_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_OWNER_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "VLD_OWNER_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "OWNER_PHONE_STATUS_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE_LEGAL_ENTITY_OWNER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster_ZipAllocation')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_ZIP_ALLOCATION"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_Sitemaster_Tables')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schemaname": {
						"type": "string"
					},
					"Tablename": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schemaname",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().Tablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_StoreMasterCustom_Sites_JoinCodes')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Location",
						"type": "varchar"
					},
					{
						"name": "JoinCode",
						"type": "varchar"
					},
					{
						"name": "SiteID",
						"type": "varchar"
					},
					{
						"name": "Account",
						"type": "varchar"
					},
					{
						"name": "StoreFrontShipTo",
						"type": "varchar"
					},
					{
						"name": "Type",
						"type": "varchar"
					},
					{
						"name": "Createddate",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "Retail",
					"table": "StoreMasterCustom_Sites_JoinCodes"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_v_DAC_DefaultHours')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_v_location_key_scd')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_EXTERNAL_REF_COUNTRY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "String"
					},
					"Country_Table_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "EXTERNAL_REF_COUNTRY_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A2",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A3",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_LOCAL_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_UN_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().Country_Table_Name",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_EXTERNAL_REF_CURRENCY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Currency_Table_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ENTERPRISE_REF_CURENCY_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CURRENCY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "CURRENCY_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().Currency_Table_Name",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_EXTERNAL_REF_DMA')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Dma_Table_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ENTERPRISE_REF_DMA_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "DMA_REGION",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().Dma_Table_Name",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_EXTERNAL_REF_POSTAL_CODE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "String"
					},
					"PostalCode_Table_Name": {
						"type": "string"
					},
					"Table_Schema": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "EXTERNAL_REF_COUNTRY_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A2",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A3",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_LOCAL_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_UN_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Table_Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().PostalCode_Table_Name",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_EXTERNAL_REF_TIME_ZONE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Time_Zone_Table_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ENTERP_REF_TIME_ZONE_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "TIME_ZONE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "TIME_ZONE_ABR_STD",
						"type": "nvarchar"
					},
					{
						"name": "TIME_ZONE_ABR_DST",
						"type": "nvarchar"
					},
					{
						"name": "UTC_OFFSET_STD",
						"type": "decimal",
						"precision": 5,
						"scale": 0
					},
					{
						"name": "UTC_OFFSET_DST",
						"type": "decimal",
						"precision": 5,
						"scale": 0
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().Time_Zone_Table_Name",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_EXTERNAL_REF_TIME_ZONE_EF')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"Time_Zone_EFF_DT_Table_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ENT_REF_TIME_ZN_EFF_DT_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "TIME_ZONE_EFFECTIVE_YEAR",
						"type": "decimal",
						"precision": 5,
						"scale": 0
					},
					{
						"name": "DST_START_DT",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "DST_END_DT",
						"type": "datetime2",
						"scale": 3
					},
					{
						"name": "F_ENTERPRISE_REF_TIME_ZONE",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "FD_ENTERPRISE_REF_TIME_ZONE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().Time_Zone_EFF_DT_Table_Name",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_EXTERNAL_REF_US_STATE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"US_State_Table_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ENTERP_REF_US_STATE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().US_State_Table_Name",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_LEGAL_ENTITY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					},
					{
						"name": "TYPE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "CITY",
						"type": "nvarchar"
					},
					{
						"name": "STATE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_CITY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "OS_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LIC_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_PHONE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_LEGAL_ENTITY"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_POSTAL_CODE_MASTER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Enterprise_ReferenceMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "ENT_REF_POSTAL_CODE_ID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_OR_PROVINCE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "CITY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "CITY_ABBREVIATION",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "TIME_ZONE",
						"type": "nvarchar"
					},
					{
						"name": "OBSERVES_DST",
						"type": "bit"
					},
					{
						"name": "LATITUDE",
						"type": "decimal",
						"precision": 9,
						"scale": 5
					},
					{
						"name": "LONGITUDE",
						"type": "decimal",
						"precision": 9,
						"scale": 5
					},
					{
						"name": "IS_PREFERRED_CITY_NAME",
						"type": "bit"
					},
					{
						"name": "POSTAL_CODE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "MSA_CODE",
						"type": "nvarchar"
					},
					{
						"name": "FIPS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					},
					{
						"name": "FD_MSA_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_MSA_ID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_ENT_REF_POSTAL_CODE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Enterprise_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SA_POSTAL_CODE_MASTER_Sink')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sink_ReferenceMaster",
					"type": "LinkedServiceReference",
					"parameters": {
						"Database_Name": {
							"value": "@dataset().Database_Name",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"Database_Name": {
						"type": "string"
					},
					"PostalCode_Table_Name": {
						"type": "string"
					},
					"Table_Schema": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_POSTAL_CODE_MASTER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Sink_ReferenceMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SD_ADDRESS_LOCATION')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STREET_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE_OR_PROV_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ZIP_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STREET_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "CITY",
						"type": "nvarchar"
					},
					{
						"name": "STATE_OR_PROVINCE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ZIP_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_ADDRESS_LOCATION"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SD_COMMUNICTN_PREFERNC_EMAIL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "OPTED_IN",
						"type": "bit"
					},
					{
						"name": "ORGANIZATION",
						"type": "nvarchar"
					},
					{
						"name": "PURPOSE",
						"type": "nvarchar"
					},
					{
						"name": "CHANNEL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_COMMUNICATION_ID",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_ERROR",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_COMMUNICTN_PREFERNC_EMAIL"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SD_COMMUNICTN_PREFERNC_PHONE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "PHONE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "OPTED_IN",
						"type": "bit"
					},
					{
						"name": "ORGANIZATION",
						"type": "nvarchar"
					},
					{
						"name": "PURPOSE",
						"type": "nvarchar"
					},
					{
						"name": "CHANNEL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_PHONE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "PHONE_COMM_ID",
						"type": "nvarchar"
					},
					{
						"name": "PHONE_ERROR",
						"type": "nvarchar"
					},
					{
						"name": "IS_VALID",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_COMMUNICTN_PREFERNC_PHONE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SD_EMAIL_ADDRESS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL_ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_EMAIL_ADDRESS"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SD_PHONE_NUMBER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_PHONE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "PHONE_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "F_RETAIL_CUSTOMER",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FS_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "FD_RETAIL_CUSTOMER",
						"type": "nvarchar"
					},
					{
						"name": "IS_VALID",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_PHONE_NUMBER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SD_RETAIL_CUSTOMER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LAST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "RAW_MIDDLE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "LAST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "MIDDLE_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PHONETIC_FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "PHONETIC_LAST_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_RETAIL_CUSTOMER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SD_SITE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OPERATIONAL_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "TYPE",
						"type": "nvarchar"
					},
					{
						"name": "ACCOUNT_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "SHIP_TO_NUM",
						"type": "nvarchar"
					},
					{
						"name": "MODEL",
						"type": "nvarchar"
					},
					{
						"name": "VERSION",
						"type": "nvarchar"
					},
					{
						"name": "TIME_ZONE",
						"type": "nvarchar"
					},
					{
						"name": "LOCAL_CURRENCY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "PHONE",
						"type": "nvarchar"
					},
					{
						"name": "PHONE_STATUS_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CS_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CS_PHONE_STATUS_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "RAW_FAX",
						"type": "nvarchar"
					},
					{
						"name": "FAX",
						"type": "nvarchar"
					},
					{
						"name": "FAX_STATUS_TEXT",
						"type": "nvarchar"
					},
					{
						"name": "SMS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "SOFT_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "GRAND_OPEN_DATE",
						"type": "date"
					},
					{
						"name": "CLOSE_DATE",
						"type": "date"
					},
					{
						"name": "AREA_UNIT_OF_MEASURE",
						"type": "nvarchar"
					},
					{
						"name": "BUILDING_SQFT",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "WAREHOUSE_SQFT",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "SHOWROOM_SQFT",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "OFFICE_SQFT",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "NUM_OF_DOCK_DOORS",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "RETAIL_SYSTEM_NUMBER",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "ENTERPRISE_STORE_NUMBER",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "PROSPECT_ID",
						"type": "nvarchar"
					},
					{
						"name": "DMA_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "DMA",
						"type": "nvarchar"
					},
					{
						"name": "MSA_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "MSA",
						"type": "nvarchar"
					},
					{
						"name": "MARKET",
						"type": "nvarchar"
					},
					{
						"name": "REGION",
						"type": "nvarchar"
					},
					{
						"name": "DOMESTIC_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CATEGORY",
						"type": "nvarchar"
					},
					{
						"name": "F_GOOGLE_ID",
						"type": "nvarchar"
					},
					{
						"name": "FD_GOOGLE_ID",
						"type": "nvarchar"
					},
					{
						"name": "F_SUPPORTING_WAREHOUSE",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SUPPORTING_WAREHOUSE",
						"type": "nvarchar"
					},
					{
						"name": "FS_SUPPORTING_WAREHOUSE",
						"type": "nvarchar"
					},
					{
						"name": "FD_SUPPORTING_WAREHOUSE",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ECOM_FULFILLER_FLAG",
						"type": "bit"
					},
					{
						"name": "CORP_STORE_ID",
						"type": "nvarchar"
					},
					{
						"name": "LAND_LINE",
						"type": "nvarchar"
					},
					{
						"name": "TOLL_FREE",
						"type": "nvarchar"
					},
					{
						"name": "DAC_ACCOUNT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "DAC_LOCATION_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "STORE_LOCATOR_DISABLED",
						"type": "bit"
					},
					{
						"name": "LOCATION_NUMBER",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SITE_ADDITIONAL_INFO')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_SiteMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_ADDITIONAL_INFO_ID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OPR_MONDAY_START_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_MONDAY_END_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_TUESDAY_START_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_TUESDAY_END_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_WEDNESDAY_START_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_WEDNESDAY_END_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_THURSDAY_START_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_THURSDAY_END_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_FRIDAY_START_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_FRIDAY_END_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_SATURDAY_START_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_SATURDAY_END_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_SUNDAY_START_TIME",
						"type": "nvarchar"
					},
					{
						"name": "OPR_SUNDAY_END_TIME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_ADDITIONAL_INFO"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Scratch_GD_ENT_REF_POSTAL_CODE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ENT_REF_POSTAL_CODE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_BATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_OR_PROVINCE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "CITY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "CITY_ABBREVIATION",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "TIME_ZONE",
						"type": "nvarchar"
					},
					{
						"name": "OBSERVES_DST",
						"type": "bit"
					},
					{
						"name": "LATITUDE",
						"type": "decimal",
						"precision": 9,
						"scale": 5
					},
					{
						"name": "LONGITUDE",
						"type": "decimal",
						"precision": 9,
						"scale": 5
					},
					{
						"name": "IS_PREFERRED_CITY_NAME",
						"type": "bit"
					},
					{
						"name": "POSTAL_CODE_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "MSA_CODE",
						"type": "nvarchar"
					},
					{
						"name": "FIPS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Scratch",
					"table": "GD_ENT_REF_POSTAL_CODE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Scratch_GD_LEGAL_ENTITY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_BATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					},
					{
						"name": "TYPE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "CITY",
						"type": "nvarchar"
					},
					{
						"name": "STATE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_CITY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "OS_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LIC_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "COMPANY_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Scratch",
					"table": "GD_LEGAL_ENTITY"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Scratch_SiteMaster_GD_LEGAL_ENTITY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "LEGAL_ENTITY_ID",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_BATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					},
					{
						"name": "TYPE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAW_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CITY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "RAW_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "CITY",
						"type": "nvarchar"
					},
					{
						"name": "STATE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "LATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "LONGITUDE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_ADDR_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_CITY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_POSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY",
						"type": "nvarchar"
					},
					{
						"name": "MAILING_COUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "OS_LEGAL_ENTITY_ID",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "RAW_LIC_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "LIC_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "COMPANY_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "Scratch",
					"table": "SiteMaster_GD_LEGAL_ENTITY"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Cdp_Customer_Deduped')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "string"
					},
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "clusterID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "confidence_score",
						"type": "varchar"
					},
					{
						"name": "globalID",
						"type": "varchar"
					},
					{
						"name": "RecID",
						"type": "varchar"
					},
					{
						"name": "posRawContainerRecID",
						"type": "varchar"
					},
					{
						"name": "posFirstName",
						"type": "varchar"
					},
					{
						"name": "posMiddleInitial",
						"type": "varchar"
					},
					{
						"name": "posLastName",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail1",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail2",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail3",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone1",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone2",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone3",
						"type": "varchar"
					},
					{
						"name": "n_address",
						"type": "varchar"
					},
					{
						"name": "n_addr2",
						"type": "varchar"
					},
					{
						"name": "n_city",
						"type": "varchar"
					},
					{
						"name": "n_state",
						"type": "varchar"
					},
					{
						"name": "n_zip9",
						"type": "varchar"
					},
					{
						"name": "posFaceBookID",
						"type": "varchar"
					},
					{
						"name": "posTwitterID",
						"type": "varchar"
					},
					{
						"name": "market_id",
						"type": "varchar"
					},
					{
						"name": "customer_type",
						"type": "varchar"
					},
					{
						"name": "timestamp",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "customer_since",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "posFirstNameSoundex",
						"type": "varchar"
					},
					{
						"name": "posLastNameSoundex",
						"type": "varchar"
					},
					{
						"name": "Alpha",
						"type": "varchar"
					},
					{
						"name": "SourceSystem",
						"type": "varchar"
					},
					{
						"name": "SourceSubSystem",
						"type": "varchar"
					},
					{
						"name": "racProfitCenter",
						"type": "varchar"
					},
					{
						"name": "racSalesNumber",
						"type": "varchar"
					},
					{
						"name": "do_not_sell",
						"type": "bit"
					},
					{
						"name": "EntryID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "do_not_sell_request_date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "unsubscribe",
						"type": "bit"
					},
					{
						"name": "unsubscribe_date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "birthdate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Repo')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_repo",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_repo')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_AshlyNet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "EDW",
					"table": "ZipAllocation"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_ISO_CountryCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "EXT_REF_COUNTRY_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "COUNTRY_CODE_A2",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A3",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_LOCAL_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_UN_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "ISO",
					"table": "countrycode"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_ISO_StateCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "EXT_REF_US_STATE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "ISO",
					"table": "statecode"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_defaulthours_his')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_hsopc_his')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_sit_his')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_sitecontent_His')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_specialh_his')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Semarchy_Staging_zip_inc')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "EDW",
					"table": "ZipAllocation_INC"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Sink_Postal_Code_Archive')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Archive",
						"fileSystem": "postal-code"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Sink_Postal_code_Error_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Error",
						"fileSystem": "postal-code"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Sink_Retail_Customer_Archive_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Archive",
						"fileSystem": "retail-customer"
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "clusterID\tglobalID\tconfidence_score\tRecID\tposRawContainerRecID\tmarket_id\tposFirstName\tposMiddleInitial\tposLastName\tposCustomerEmail1\tposCustomerEmail2\tposCustomerEmail3\tposCustomerPhone1\tposCustomerPhone2\tposCustomerPhone3\tn_address\tn_addr2\tn_city\tn_state\tn_zip9\tposFaceBookID\tposTwitterID\ttimestamp\tcustomer_type\tcustomer_since\tSourceSystem\tSourceSubSystem",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Sister_SKU')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "SisterSKU.parquet",
						"folderPath": "Retail/SupplyChain/SisterSKU",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Sister_SKU_Historical')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "HistoricalSisterSKU.parquet",
						"folderPath": "Retail/SupplyChain/HistoricalSisterSKU",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/StageInitialLoadRetailChunkControl')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Schema": {
						"type": "String"
					},
					"TableName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().Schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/StageInitialLoadRetailChunkControl_Blob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "String"
					},
					"FileName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Stage_PostalCode_Query')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Staging_AllSourceCustomers')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/StoreMasterCustom_LegalEntities_CompanyCodes')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "StoreMasterCustom_LegalEntities_CompanyCodes",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "legal_entity_id",
						"type": "String"
					},
					{
						"name": "name",
						"type": "String"
					},
					{
						"name": "type",
						"type": "String"
					},
					{
						"name": "lic_contact",
						"type": "String"
					},
					{
						"name": "company_code",
						"type": "String"
					},
					{
						"name": "lic_contact_email",
						"type": "String"
					},
					{
						"name": "raw_lic_contact_phone",
						"type": "String"
					},
					{
						"name": "raw_addr_line1",
						"type": "String"
					},
					{
						"name": "raw_addr_line2",
						"type": "String"
					},
					{
						"name": "raw_city",
						"type": "String"
					},
					{
						"name": "raw_state",
						"type": "String"
					},
					{
						"name": "raw_state_code",
						"type": "String"
					},
					{
						"name": "raw_country",
						"type": "String"
					},
					{
						"name": "raw_country_code",
						"type": "String"
					},
					{
						"name": "raw_postal_code",
						"type": "String"
					},
					{
						"name": "raw_longitude",
						"type": "String"
					},
					{
						"name": "raw_latitude",
						"type": "String"
					},
					{
						"name": "mailing_addr_line1",
						"type": "String"
					},
					{
						"name": "mailing_addr_line2",
						"type": "String"
					},
					{
						"name": "mailing_city",
						"type": "String"
					},
					{
						"name": "mailing_state",
						"type": "String"
					},
					{
						"name": "mailing_state_code",
						"type": "String"
					},
					{
						"name": "mailing_country",
						"type": "String"
					},
					{
						"name": "mailing_country_code",
						"type": "String"
					},
					{
						"name": "mailing_postal_code",
						"type": "String"
					},
					{
						"name": "os_legal_entity_id",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/StoreMasterCustom_LegalEntities_Mapping')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "StoreMasterCustom_LegalEntities_Mapping",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "EntityName",
						"type": "String"
					},
					{
						"name": "LegalEntityID",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/StoreMasterCustom_Sites_JoinCodes')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": "SiteMasterFiles",
						"fileSystem": "raw-zone"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "JoinCode",
						"type": "String"
					},
					{
						"name": "Location",
						"type": "String"
					},
					{
						"name": "SiteID",
						"type": "String"
					},
					{
						"name": "AccountNumber",
						"type": "String"
					},
					{
						"name": "StoreFrontShipTo",
						"type": "String"
					},
					{
						"name": "Type",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Store_Details_Files')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "dac_store_details",
						"fileSystem": "raw-zone"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"AccountID": {
							"type": "string"
						},
						"LocationID": {
							"type": "string"
						},
						"LocationNumber": {
							"type": "string"
						},
						"ReferenceCode": {
							"type": "string"
						},
						"CreatedBy": {
							"type": "string"
						},
						"ModifiedBy": {
							"type": "string"
						},
						"Created": {
							"type": "string"
						},
						"Modified": {
							"type": "string"
						},
						"LocationData": {
							"type": "object",
							"properties": {
								"KeyFields": {
									"type": "object",
									"properties": {
										"CSOLocationID": {
											"type": "string"
										},
										"ITGAccountId": {
											"type": "string"
										},
										"ITGAccountNumber": {
											"type": "string"
										},
										"ITGClientId": {
											"type": "string"
										},
										"ITGClientNumber": {
											"type": "string"
										},
										"AgencyCode": {
											"type": "string"
										},
										"Reference Code": {
											"type": "string"
										},
										"CMR": {
											"type": "string"
										},
										"Open Holidays": {
											"type": "string"
										},
										"Exteriorphoto": {
											"type": "string"
										},
										"CustomerServiceHours": {
											"type": "string"
										},
										"HideAddress": {
											"type": "string"
										},
										"PinMarker": {
											"type": "string"
										},
										"AutoDisplayPoint": {
											"type": "string"
										},
										"ScheduleApptURL": {
											"type": "string"
										},
										"GoogleBusinessDescription": {
											"type": "string"
										},
										"primarylanguage": {
											"type": "string"
										},
										"ChainName": {
											"type": "string"
										},
										"StoreLocatorDisabled": {
											"type": "string"
										},
										"AppleBusinessName": {
											"type": "string"
										},
										"StoreStatus": {
											"type": "string"
										},
										"Flyerlink": {
											"type": "string"
										},
										"ManagerName": {
											"type": "string"
										},
										"ManagerDescription": {
											"type": "string"
										},
										"Promotion1Image": {
											"type": "string"
										},
										"PodiumID": {
											"type": "string"
										},
										"ReportGroup": {
											"type": "string"
										},
										"Promotion2Image": {
											"type": "string"
										},
										"Reference Code 2": {
											"type": "string"
										},
										"Google Preferred Photo": {
											"type": "string"
										},
										"Promotion1URL": {
											"type": "string"
										},
										"Promotion2URL": {
											"type": "string"
										}
									}
								},
								"DisplayPoint": {
									"type": "object",
									"properties": {
										"Type": {
											"type": "string"
										},
										"Latitude": {
											"type": "number"
										},
										"Longitude": {
											"type": "number"
										},
										"VerificationType": {
											"type": "string"
										}
									}
								},
								"BusinessStatus": {
									"type": "string"
								},
								"Status": {
									"type": "string"
								},
								"BusinessName": {
									"type": "object",
									"properties": {
										"Name": {
											"type": "string"
										},
										"LongName": {
											"type": "string"
										},
										"Locale": {
											"type": "integer"
										}
									}
								},
								"BusinessDescription": {
									"type": "object",
									"properties": {
										"Description": {
											"type": "string"
										},
										"ShortDescription": {
											"type": "string"
										},
										"LongDescription": {
											"type": "string"
										}
									}
								},
								"PrimaryAddress": {
									"type": "object",
									"properties": {
										"AddressLine1": {
											"type": "string"
										},
										"Locality": {
											"type": "string"
										},
										"Region": {
											"type": "string"
										},
										"PostalCode": {
											"type": "string"
										},
										"CountryCode": {
											"type": "string"
										},
										"AddressLine2": {
											"type": "string"
										}
									}
								},
								"PhoneNumbers": {
									"type": "object",
									"properties": {
										"PrimaryPhoneNumber": {
											"type": "string"
										},
										"Landline": {
											"type": "string"
										},
										"TollFree": {
											"type": "string"
										},
										"Fax": {
											"type": "string"
										}
									}
								},
								"WebsiteURL": {
									"type": "string"
								},
								"AlternateWebsiteURL": {
									"type": "string"
								},
								"MediaURLs": {
									"type": "object",
									"properties": {
										"FacebookURL": {
											"type": "string"
										},
										"TwitterURL": {
											"type": "string"
										},
										"InstagramURL": {
											"type": "string"
										},
										"PinterestURL": {
											"type": "string"
										},
										"SocialNetworkURL": {
											"type": "string"
										}
									}
								},
								"HoursOfOperationStructured": {
									"type": "object",
									"properties": {
										"Su": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Mo": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Tu": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"We": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Th": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Fr": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"Sa": {
											"type": "object",
											"properties": {
												"Ranges": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"StartTime": {
																"type": "string"
															},
															"EndTime": {
																"type": "string"
															}
														}
													}
												},
												"State": {
													"type": "string"
												}
											}
										},
										"SpecialHours": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"Date": {
														"type": "string"
													},
													"Ranges": {
														"type": "array",
														"items": {
															"type": "object",
															"properties": {
																"StartTime": {
																	"type": "string"
																},
																"EndTime": {
																	"type": "string"
																}
															}
														}
													},
													"State": {
														"type": "string"
													}
												}
											}
										}
									}
								},
								"BusinessCategories": {
									"type": "object",
									"properties": {
										"Category1": {
											"type": "string"
										},
										"Category2": {
											"type": "string"
										},
										"Category3": {
											"type": "string"
										},
										"Category4": {
											"type": "string"
										},
										"Category5": {
											"type": "string"
										},
										"Category6": {
											"type": "string"
										},
										"Category7": {
											"type": "string"
										},
										"Category8": {
											"type": "string"
										},
										"Category9": {
											"type": "string"
										},
										"Category10": {
											"type": "string"
										}
									}
								},
								"EmailAddress": {
									"type": "string"
								},
								"PhotoURLs": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"Type": {
												"type": "string"
											},
											"URL": {
												"type": "string"
											},
											"Name": {
												"type": "string"
											}
										}
									}
								},
								"KeywordsSpecialties": {
									"type": "string"
								},
								"Products": {
									"type": "string"
								},
								"Services": {
									"type": "string"
								},
								"Brands": {
									"type": "string"
								},
								"Tagline": {
									"type": "string"
								},
								"AreasServed": {
									"type": "string"
								},
								"Languages": {
									"type": "string"
								},
								"PaymentMethods": {
									"type": "string"
								},
								"YearFounded": {
									"type": "string"
								},
								"NumberEmployees": {
									"type": "string"
								}
							}
						},
						"ADFWebActivityResponseHeaders": {
							"type": "object",
							"properties": {
								"Pragma": {
									"type": "string"
								},
								"Access-Control-Expose-Headers": {
									"type": "string"
								},
								"Cache-Control": {
									"type": "string"
								},
								"Set-Cookie": {
									"type": "string"
								},
								"Request-Context": {
									"type": "string"
								},
								"Date": {
									"type": "string"
								},
								"Content-Length": {
									"type": "string"
								},
								"Content-Type": {
									"type": "string"
								},
								"Expires": {
									"type": "string"
								}
							}
						},
						"effectiveIntegrationRuntime": {
							"type": "string"
						},
						"executionDuration": {
							"type": "integer"
						},
						"durationInQueue": {
							"type": "object",
							"properties": {
								"integrationRuntimeQueue": {
									"type": "integer"
								}
							}
						},
						"billingReference": {
							"type": "object",
							"properties": {
								"activityType": {
									"type": "string"
								},
								"billableDuration": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"meterType": {
												"type": "string"
											},
											"duration": {
												"type": "number"
											},
											"unit": {
												"type": "string"
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/USA_Zip_Code_File')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHubStg",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"filename_USA": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().filename_USA",
							"type": "Expression"
						},
						"folderPath": "Postal_Code_Source_Files",
						"fileSystem": "postal-code"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "City",
						"type": "String"
					},
					{
						"name": "ST",
						"type": "String"
					},
					{
						"name": "ZIP",
						"type": "String"
					},
					{
						"name": "A/C",
						"type": "String"
					},
					{
						"name": "FIPS",
						"type": "String"
					},
					{
						"name": "County",
						"type": "String"
					},
					{
						"name": "Pref?",
						"type": "String"
					},
					{
						"name": "T/Z",
						"type": "String"
					},
					{
						"name": "DST?",
						"type": "String"
					},
					{
						"name": "Lat",
						"type": "String"
					},
					{
						"name": "Long",
						"type": "String"
					},
					{
						"name": "MSA",
						"type": "String"
					},
					{
						"name": "PMSA",
						"type": "String"
					},
					{
						"name": "Abbreviation",
						"type": "String"
					},
					{
						"name": "MA",
						"type": "String"
					},
					{
						"name": "Type",
						"type": "String"
					},
					{
						"name": "CBSA",
						"type": "String"
					},
					{
						"name": "Div",
						"type": "String"
					},
					{
						"name": "Population",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/US_Zip_Code_Table')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Ref_PostalCode",
					"table": "ZipInfo_USz5max"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/UpdateTriggerTime')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Update_Email_Chunk')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/WestFoundation')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "WestFoundation.parquet",
						"folderPath": "Retail/SupplyChain/WestFoundation",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/WestFoundation_Historical')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EDW_Ashleylake",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "HistoricalWestFoundation.parquet",
						"folderPath": "Retail/SupplyChain/HistoricalWestFoundation",
						"fileSystem": "trusted-zone"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/EDW_Ashleylake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/cdp_customer_deduped')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CDP_CustomerProfiling",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "clusterID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "confidence_score",
						"type": "varchar"
					},
					{
						"name": "globalID",
						"type": "varchar"
					},
					{
						"name": "RecID",
						"type": "varchar"
					},
					{
						"name": "posRawContainerRecID",
						"type": "varchar"
					},
					{
						"name": "posFirstName",
						"type": "varchar"
					},
					{
						"name": "posMiddleInitial",
						"type": "varchar"
					},
					{
						"name": "posLastName",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail1",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail2",
						"type": "varchar"
					},
					{
						"name": "posCustomerEmail3",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone1",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone2",
						"type": "varchar"
					},
					{
						"name": "posCustomerPhone3",
						"type": "varchar"
					},
					{
						"name": "n_address",
						"type": "varchar"
					},
					{
						"name": "n_addr2",
						"type": "varchar"
					},
					{
						"name": "n_city",
						"type": "varchar"
					},
					{
						"name": "n_state",
						"type": "varchar"
					},
					{
						"name": "n_zip9",
						"type": "varchar"
					},
					{
						"name": "posFaceBookID",
						"type": "varchar"
					},
					{
						"name": "posTwitterID",
						"type": "varchar"
					},
					{
						"name": "market_id",
						"type": "varchar"
					},
					{
						"name": "customer_type",
						"type": "varchar"
					},
					{
						"name": "timestamp",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "customer_since",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "dtec",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "posFirstNameSoundex",
						"type": "varchar"
					},
					{
						"name": "posLastNameSoundex",
						"type": "varchar"
					},
					{
						"name": "Alpha",
						"type": "varchar"
					},
					{
						"name": "SourceSystem",
						"type": "varchar"
					},
					{
						"name": "SourceSubSystem",
						"type": "varchar"
					},
					{
						"name": "racProfitCenter",
						"type": "nvarchar"
					},
					{
						"name": "racSalesNumber",
						"type": "nvarchar"
					},
					{
						"name": "do_not_sell",
						"type": "bit"
					},
					{
						"name": "Flag",
						"type": "varchar"
					},
					{
						"name": "EntryID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "do_not_sell_request_date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "unsubscribe",
						"type": "bit"
					},
					{
						"name": "unsubscribe_date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "birthdate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/CDP_CustomerProfiling')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_postalcode_StateOrProvinceCode')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_EXTERNAL_REF_COUNTRY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "EXTERNAL_REF_COUNTRY_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A2",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_CODE_A3",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_LOCAL_NAME",
						"type": "nvarchar"
					},
					{
						"name": "COUNTRY_UN_CODE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_EXTERNAL_REF_COUNTRY"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_EXTERNAL_REF_US_STATE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "EXTERNAL_REF_US_STATE_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "STATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STATE_NAME",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_EXTERNAL_REF_US_STATE"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SA_SITE_CONTACT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "SITE_CONTACT_ID",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DUPSOPERATIONID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_DUPSMERGETARGET",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_COPIEDFROM",
						"type": "uniqueidentifier"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "CONTACT_FIRST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "CONTACT_LAST_NAME",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "STD_CONTACT_PHONE",
						"type": "nvarchar"
					},
					{
						"name": "CONTACT_PHONE_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAW_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "VLD_CONTACT_EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "SITE_CONTACT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "F_SITE_MAIN",
						"type": "uniqueidentifier"
					},
					{
						"name": "FP_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FS_SITE_MAIN",
						"type": "nvarchar"
					},
					{
						"name": "FD_SITE_MAIN",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SA_SITE_CONTACT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail_dbo_SD_SITE_OWNER')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "masterDataHub_Retail",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "B_LOADID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_PUBID",
						"type": "nvarchar"
					},
					{
						"name": "B_SOURCEID",
						"type": "nvarchar"
					},
					{
						"name": "B_CLASSNAME",
						"type": "nvarchar"
					},
					{
						"name": "B_ERROR_STATUS",
						"type": "nvarchar"
					},
					{
						"name": "B_ORIGINALBATCHID",
						"type": "decimal",
						"precision": 38,
						"scale": 0
					},
					{
						"name": "B_OPERATIONID",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETETYPE",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_DELETEAUTHOR",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEOPERATION",
						"type": "nvarchar"
					},
					{
						"name": "B_DELETEPATH",
						"type": "nvarchar"
					},
					{
						"name": "B_CREDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_UPDDATE",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "B_CREATOR",
						"type": "nvarchar"
					},
					{
						"name": "B_UPDATOR",
						"type": "nvarchar"
					},
					{
						"name": "OWNER_NAME",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_STATUS_CODE",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS_ERROR_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE1",
						"type": "nvarchar"
					},
					{
						"name": "RAWADDRESS_LINE2",
						"type": "nvarchar"
					},
					{
						"name": "RAWCITY",
						"type": "nvarchar"
					},
					{
						"name": "RAWSTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "RAWCOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NAME",
						"type": "nvarchar"
					},
					{
						"name": "STASTREET_NUMBER",
						"type": "nvarchar"
					},
					{
						"name": "STACITY",
						"type": "nvarchar"
					},
					{
						"name": "STASTATE_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STAPOSTAL_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STACOUNTRY_CODE",
						"type": "nvarchar"
					},
					{
						"name": "STALATITUDE",
						"type": "nvarchar"
					},
					{
						"name": "STALONGITUDE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SD_SITE_OWNER"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHub_Retail')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterData_CDP_CrossWalk_DU_OUT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "CrossWalk_DU_OUT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterdata_CDP_CrossWalk_MD_OUT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "Masterdata_CDP",
					"table": "CrossWalk_MD_OUT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/retailCustomer_dbo_CrossWalk_MD_OUT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "CrossWalk_MD_OUT"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/retail_v_legal_entity_scd')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "semarchy_staging",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/semarchy_staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/usp_ASH_REMOVE_LOAD')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Retail_CustomerMaster",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Retail_CustomerMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AFIEDME_KeyVault_dev')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('AFIEDME_KeyVault_dev_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AGR_Demo')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFileStorage",
				"typeProperties": {
					"connectionString": "[parameters('AGR_Demo_connectionString')]",
					"fileShare": "inventoryapiratesdemo"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Ashley_EDW')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('Ashley_EDW_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Ashley_EDW_Prod')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('Ashley_EDW_Prod_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureFileStorage1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFileStorage",
				"typeProperties": {
					"host": "[parameters('AzureFileStorage1_properties_typeProperties_host')]",
					"userId": "[parameters('AzureFileStorage1_properties_typeProperties_userId')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('AzureFileStorage1_password')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureKeyVault_Secrets_Postalcode')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('AzureKeyVault_Secrets_Postalcode_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CDP_CustomerProfiling')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('CDP_CustomerProfiling_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DSTrackingTest')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "CosmosDb",
				"typeProperties": {
					"connectionString": "[parameters('DSTrackingTest_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DataAnyWhereProdRestAPI')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('DataAnyWhereProdRestAPI_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDW_Ashleylake')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('EDW_Ashleylake_properties_typeProperties_url')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EnterpriseMarketingFabricWarehouse')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "warehouse connector for enterprise marketing on microsoft fabric",
				"annotations": [],
				"type": "Warehouse",
				"typeProperties": {
					"endpoint": "[parameters('EnterpriseMarketingFabricWarehouse_properties_typeProperties_endpoint')]",
					"artifactId": "3db94680-4ad7-4d5c-b01a-f4ea9080ee66",
					"workspaceId": "743b6721-2de5-4ad5-98c4-88136ec2cdcd",
					"tenant": "[parameters('EnterpriseMarketingFabricWarehouse_properties_typeProperties_tenant')]",
					"servicePrincipalCredentialType": "ServicePrincipalKey",
					"servicePrincipalId": "[parameters('EnterpriseMarketingFabricWarehouse_properties_typeProperties_servicePrincipalId')]",
					"servicePrincipalCredential": {
						"type": "SecureString",
						"value": "[parameters('EnterpriseMarketingFabricWarehouse_servicePrincipalCredential')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EnterpriseMarketingLakehouse')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "lakehouse connector to fabric for zeta event data",
				"annotations": [],
				"type": "Lakehouse",
				"typeProperties": {
					"workspaceId": "743b6721-2de5-4ad5-98c4-88136ec2cdcd",
					"artifactId": "f770fbad-de57-4a3c-a7e6-ae709d5c0e6c",
					"tenant": "[parameters('EnterpriseMarketingLakehouse_properties_typeProperties_tenant')]",
					"servicePrincipalId": "[parameters('EnterpriseMarketingLakehouse_properties_typeProperties_servicePrincipalId')]",
					"servicePrincipalCredentialType": "ServicePrincipalKey",
					"servicePrincipalCredential": {
						"type": "SecureString",
						"value": "[parameters('EnterpriseMarketingLakehouse_servicePrincipalCredential')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Enterprise_ReferenceMaster')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Enterprise_ReferenceMaster_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LS_AzureFunction')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFunction",
				"typeProperties": {
					"functionAppUrl": "[parameters('LS_AzureFunction_properties_typeProperties_functionAppUrl')]",
					"authentication": "Anonymous",
					"functionKey": {
						"type": "SecureString",
						"value": "[parameters('LS_AzureFunction_functionKey')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LS_SMARTSHEET')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Smartsheet",
				"typeProperties": {
					"apiToken": {
						"type": "SecureString",
						"value": "[parameters('LS_SMARTSHEET_apiToken')]"
					},
					"encryptedCredential": "ew0KICAiVmVyc2lvbiI6ICIyMDE3LTExLTMwIiwNCiAgIlByb3RlY3Rpb25Nb2RlIjogIktleSIsDQogICJTZWNyZXRDb250ZW50VHlwZSI6ICJQbGFpbnRleHQiLA0KICAiQ3JlZGVudGlhbElkIjogIkRBVEFGQUNUT1JZQDY2NzQ5RUU5LTRFMkQtNEVDRC1BRUUzLTdCQTJGODg3RkFDMF9iOWI3ZDJkYy1jMGIxLTRjYjMtYjE2Yy1hZmExNmYxZDM1YjUiDQp9"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LS_Smartsheets')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Smartsheet",
				"typeProperties": {
					"apiToken": {
						"type": "SecureString",
						"value": "[parameters('LS_Smartsheets_apiToken')]"
					},
					"encryptedCredential": "ew0KICAiVmVyc2lvbiI6ICIyMDE3LTExLTMwIiwNCiAgIlByb3RlY3Rpb25Nb2RlIjogIktleSIsDQogICJTZWNyZXRDb250ZW50VHlwZSI6ICJQbGFpbnRleHQiLA0KICAiQ3JlZGVudGlhbElkIjogIkRBVEFGQUNUT1JZQDY2NzQ5RUU5LTRFMkQtNEVDRC1BRUUzLTdCQTJGODg3RkFDMF9lNmJjOWI1Ny02ZjM4LTQ1ZTMtOTU1MC0zNWQyNTgwMWZhYjUiDQp9"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Ls_CSV_FlatFile')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('Ls_CSV_FlatFile_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postal_datadownload')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('Postal_datadownload_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Postalcode')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('Postalcode_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Prod_afimasterdatahubstg')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('Prod_afimasterdatahubstg_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('Prod_afimasterdatahubstg_accountKey')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RawZone')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('RawZone_properties_typeProperties_url')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestService1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('RestService1_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Rest_Postalcodes')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"parameters": {
					"BaseURL": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('Rest_Postalcodes_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('Rest_Postalcodes_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AFIEDME_KeyVault_dev",
							"type": "LinkedServiceReference"
						},
						"secretName": "melissa-data-license-key"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/AFIEDME_KeyVault_dev')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_CustomerMaster')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Retail_CustomerMaster_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_ProductMaster')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Retail_ProductMaster_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Retail_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Retail_SiteMaster_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Sink_ReferenceMaster')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"parameters": {
					"Database_Name": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Sink_ReferenceMaster_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Smartsheet1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Smartsheet",
				"typeProperties": {
					"apiToken": {
						"type": "SecureString",
						"value": "[parameters('Smartsheet1_apiToken')]"
					},
					"encryptedCredential": "ew0KICAiVmVyc2lvbiI6ICIyMDE3LTExLTMwIiwNCiAgIlByb3RlY3Rpb25Nb2RlIjogIktleSIsDQogICJTZWNyZXRDb250ZW50VHlwZSI6ICJQbGFpbnRleHQiLA0KICAiQ3JlZGVudGlhbElkIjogIkRBVEFGQUNUT1JZQDY2NzQ5RUU5LTRFMkQtNEVDRC1BRUUzLTdCQTJGODg3RkFDMF9lYzVmMTlmZi00NTZmLTQ3ZWMtYjQ2Mi0wODMwODY1MDkzODEiDQp9"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SmartsheetLinkedinService')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Smartsheet",
				"typeProperties": {
					"apiToken": {
						"type": "SecureString",
						"value": "[parameters('SmartsheetLinkedinService_apiToken')]"
					},
					"encryptedCredential": "ew0KICAiVmVyc2lvbiI6ICIyMDE3LTExLTMwIiwNCiAgIlByb3RlY3Rpb25Nb2RlIjogIktleSIsDQogICJTZWNyZXRDb250ZW50VHlwZSI6ICJQbGFpbnRleHQiLA0KICAiQ3JlZGVudGlhbElkIjogIkRBVEFGQUNUT1JZQDY2NzQ5RUU5LTRFMkQtNEVDRC1BRUUzLTdCQTJGODg3RkFDMF8wYmU5OWY0YS1mODA0LTRmMzctYmE2YS1mODA0OGIxMzlmNGIiDQp9"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Smartsheet_Storemasterlist')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Smartsheet",
				"typeProperties": {
					"apiToken": {
						"type": "SecureString",
						"value": "[parameters('Smartsheet_Storemasterlist_apiToken')]"
					},
					"encryptedCredential": "ew0KICAiVmVyc2lvbiI6ICIyMDE3LTExLTMwIiwNCiAgIlByb3RlY3Rpb25Nb2RlIjogIktleSIsDQogICJTZWNyZXRDb250ZW50VHlwZSI6ICJQbGFpbnRleHQiLA0KICAiQ3JlZGVudGlhbElkIjogIkRBVEFGQUNUT1JZQDY2NzQ5RUU5LTRFMkQtNEVDRC1BRUUzLTdCQTJGODg3RkFDMF82MzAzZTBhMy04ZmE3LTQ2OWItYTBhYS1iNWUyNTQ3ZTFlNTQiDQp9"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TestFileShare123')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFileStorage",
				"typeProperties": {
					"connectionString": "[parameters('TestFileShare123_connectionString')]",
					"fileShare": "mcmh-file-share"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Wholesale_sitemaster')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Wholesale_sitemaster_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/agr_cdp_func')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFunction",
				"typeProperties": {
					"functionAppUrl": "[parameters('agr_cdp_func_properties_typeProperties_functionAppUrl')]",
					"authentication": "Anonymous",
					"functionKey": {
						"type": "SecureString",
						"value": "[parameters('agr_cdp_func_functionKey')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/agr_multi_channel_mktg_hub_customer_dev_func')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFunction",
				"typeProperties": {
					"functionAppUrl": "[parameters('agr_multi_channel_mktg_hub_customer_dev_func_properties_typeProperties_functionAppUrl')]",
					"authentication": "Anonymous",
					"functionKey": {
						"type": "SecureString",
						"value": "[parameters('agr_multi_channel_mktg_hub_customer_dev_func_functionKey')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/edmeCosmos')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "CosmosDb",
				"typeProperties": {
					"connectionString": "[parameters('edmeCosmos_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHubStg')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('masterDataHubStg_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('masterDataHubStg_accountKey')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/masterDataHub_Retail')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('masterDataHub_Retail_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/sandbox_zone')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('sandbox_zone_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/semarchy_repo')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('semarchy_repo_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/semarchy_staging')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "semarchy_staging",
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('semarchy_staging_connectionString')]"
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/test')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFunction",
				"typeProperties": {
					"functionAppUrl": "[parameters('test_properties_typeProperties_functionAppUrl')]",
					"authentication": "Anonymous",
					"functionKey": {
						"type": "SecureString",
						"value": "[parameters('test_functionKey')]"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/00_Load_SiteMaster')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "00_Load_SiteMaster",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2024-02-12T15:34:00",
						"timeZone": "Eastern Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								6
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/00_Load_SiteMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/00_Load_SiteMaster_Initial')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "00_Load_SiteMaster_Initial",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Week",
						"interval": 1,
						"startTime": "2023-10-10T12:52:00",
						"timeZone": "Eastern Standard Time",
						"schedule": {
							"minutes": [
								30
							],
							"hours": [
								22
							],
							"weekDays": [
								"Sunday"
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/00_Load_SiteMaster_Initial')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CustomerInitialChunkLoad')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Customer Chunk Load",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_RetailCustomer_RetailCustomerLoad_InitialLoad",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 3,
						"startTime": "2023-02-03T10:00:00",
						"timeZone": "Eastern Standard Time"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_RetailCustomer_RetailCustomerLoad_InitialLoad')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDWPIMDailyLoad')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Load product data into Semarchy side from EDW",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_Load_Retail_ProductMasterLoad",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2022-08-22T05:00:00",
						"timeZone": "Eastern Standard Time"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_Load_Retail_ProductMasterLoad')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDWPIMDailyRemoveLoad')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_ProductMasterLoad_Retail_Delete_PIM_EDW",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-10-03T05:49:00",
						"timeZone": "Eastern Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								6
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_ProductMasterLoad_Retail_Delete_PIM_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LoadNationalAssortmentToEDW')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "LoadNASisterSKUColorwheelToEDW",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_National_Assortment_SemarchyToEDW",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-07-28T06:00:00",
						"timeZone": "Eastern Standard Time"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_National_Assortment_SemarchyToEDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LoadRetailCustomerCommunicationPreferenceLoadIncremental')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Load Incremental RetailCustomer Preference data into Semarchy SD table from staging table",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_RetailCustomer_CommunicationPreferenceLoad_Incremental",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 3,
						"startTime": "2023-04-04T00:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_RetailCustomer_CommunicationPreferenceLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LoadRetailCustomerLoadIncremental')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Load Incremental RetailCustomer Data into the Semarchy SD table from staging table ",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_Load_RetailCustomerLoad_Incremental",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 1,
						"startTime": "2023-01-03T00:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_Load_RetailCustomerLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load_ProductMaster_PIM_RPM')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_ProductMaster_Retail_PIM_RPM",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2024-12-17T05:14:00",
						"timeZone": "India Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								9
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_ProductMaster_Retail_PIM_RPM')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIM_Product_direct_load_RPM')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_ProductMasterLoad_PIM_RPM",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 4,
						"startTime": "2025-01-09T04:23:00",
						"timeZone": "India Standard Time"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_ProductMasterLoad_PIM_RPM')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ReProcessErrorFilesRetailCustomerLoadIncremental')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "ReProcess RetailCustomer Error Files from the error folder",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "ReProcess_ErrorFiles_Stage_Retail_Customer_RetailCustomerLoad_Incremental",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 2,
						"startTime": "2023-03-15T00:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/ReProcess_ErrorFiles_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RemoveRetailCustomerLoadArchiveFiles')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Remove last 20 days old Retail Customer Archive CSV file from archive folder",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Remove_RetailCustomerLoad_Archive_Files",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-03-14T06:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Remove_RetailCustomerLoad_Archive_Files')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SiteMaster_INC_Delete')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_SiteMaster_Incremental_Delete",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2025-03-19T09:42:00",
						"timeZone": "India Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								13
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Incremental_Delete')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Site_Mater_incremental')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_SiteMaster_Incremental",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2024-08-28T11:49:00",
						"timeZone": "India Standard Time",
						"schedule": {
							"minutes": [
								30
							],
							"hours": [
								11
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_SiteMaster_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Site_RSA_incremental')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_SiteMaster_Incremental_RSA",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2024-12-05T14:56:00",
						"timeZone": "India Standard Time",
						"schedule": {
							"minutes": [
								55
							],
							"hours": [
								11
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_SiteMaster_Incremental_RSA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/StageRetailCustomerRetailCustomerLoadIncremental')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Load Incremental Retail Customer CSV files from storage to staging table",
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_Stage_Retail_Customer_RetailCustomerLoad_Incremental",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 1,
						"startTime": "2023-01-02T01:50:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_Stage_Retail_Customer_RetailCustomerLoad_Incremental')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Wholesale_Container_WH_Port')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Orchestrate_Containerrate_WHSMST_PortMaster",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Month",
						"interval": 1,
						"startTime": "2024-08-28T09:56:00",
						"timeZone": "India Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								19
							],
							"monthDays": [
								28
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Orchestrate_Containerrate_WHSMST_PortMaster')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Wholesale_Containerrate_EDW')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Load_Containerrate_Semarchy_EDW",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2024-09-18T10:34:00Z",
						"timeZone": "UTC",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								7
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Load_Containerrate_Semarchy_EDW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/stage_site_edw_staging_zipallocation')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Stage_Site_EDW_Staging_ZipAllocation",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2025-01-06T06:26:00",
						"timeZone": "India Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								15
							]
						}
					}
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/pipelines/Stage_Site_EDW_Staging_ZipAllocation')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AARCWIVDSQ12226-integrationRuntime1')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"description": "AARCWIVDSQ12226-Test",
				"typeProperties": {}
			},
			"dependsOn": [
				"[variables('factoryId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF_Stage_SiteMaster_RDC_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This Dataflow loads RDC info to Semarchy staging",
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_Smartsheets",
								"type": "LinkedServiceReference"
							},
							"name": "SRCSMARTSHEET",
							"description": "Smartsheet data-RDCMasterlist"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DS_SEM_STG_Smartsheet",
								"type": "DatasetReference"
							},
							"name": "RDCMasterlist",
							"rejectedDataLinkedService": {
								"referenceName": "masterDataHubStg",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Status as string,",
						"          Location as string,",
						"          {Bindy ID} as string,",
						"          {Account #} as string,",
						"          {RDC Ship To} as string,",
						"          Entity as string,",
						"          {Licensee / Contact} as string,",
						"          {RDC Address} as string,",
						"          {RDC City} as string,",
						"          {RDC State} as string,",
						"          {RDC Zip} as string,",
						"          {RDC Country} as string,",
						"          {RDC Sq. Ft.} as string,",
						"          {RDC Dock Doors} as string,",
						"          {Is Ecom Fulfiller} as string,",
						"          {Acquisition Date} as string,",
						"          {Modified Date} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'smartsheet',",
						"     format: 'rest',",
						"     entityId: '7848339512971140',",
						"     entityType: 'sheets') ~> SRCSMARTSHEET",
						"SRCSMARTSHEET select(mapColumn(",
						"          Status,",
						"          Location,",
						"          BindyID = {Bindy ID},",
						"          Account = {Account #},",
						"          ShipTo = {RDC Ship To},",
						"          Entity,",
						"          LicenseeContact = {Licensee / Contact},",
						"          Address = {RDC Address},",
						"          City = {RDC City},",
						"          State = {RDC State},",
						"          Zip = {RDC Zip},",
						"          Country = {RDC Country},",
						"          WarehouseSqFt = {RDC Sq. Ft.},",
						"          WarehouseDockDoors = {RDC Dock Doors},",
						"          IsEcomFulfiller = {Is Ecom Fulfiller},",
						"          AcquisitionDate = {Acquisition Date},",
						"          ModifiedDate = {Modified Date}",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Status as string,",
						"          Location as string,",
						"          BindyID as string,",
						"          Account as integer,",
						"          ShipTo as string,",
						"          Entity as string,",
						"          LicenseeContact as string,",
						"          Address as string,",
						"          City as string,",
						"          State as string,",
						"          Zip as string,",
						"          Country as string,",
						"          WarehouseSqFt as integer,",
						"          WarehouseDockDoors as integer,",
						"          IsEcomFulfiller as string,",
						"          AcquisitionDate as date,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['Delete from Smartsheet.RDCMasterlist'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     outputRejectedData: true,",
						"     outputAssertFailedRows: true,",
						"     assertFailure_fileSystem: 'Error',",
						"     assertFailure_folderPath: 'RDC',",
						"     mapColumn(",
						"          Status,",
						"          Location,",
						"          BindyID,",
						"          Account,",
						"          ShipTo,",
						"          Entity,",
						"          LicenseeContact,",
						"          Address,",
						"          City,",
						"          State,",
						"          Zip,",
						"          Country,",
						"          WarehouseSqFt,",
						"          WarehouseDockDoors,",
						"          IsEcomFulfiller,",
						"          AcquisitionDate,",
						"          ModifiedDate",
						"     )) ~> RDCMasterlist"
					]
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/LS_Smartsheets')]",
				"[concat(variables('factoryId'), '/datasets/DS_SEM_STG_Smartsheet')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF_Stage_SiteMaster_Store_Smartsheet')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This Dataflow loads RDC info to Semarchy staging",
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "Smartsheet_Storemasterlist",
								"type": "LinkedServiceReference"
							},
							"name": "SRCStoremasterlist"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DS_StoreMasterlist",
								"type": "DatasetReference"
							},
							"name": "sink",
							"rejectedDataLinkedService": {
								"referenceName": "masterDataHubStg",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "select"
						},
						{
							"name": "derivedColumn"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Status as string,",
						"          LocationKey as string,",
						"          {Prospect ID} as string,",
						"          {Google ID} as string,",
						"          {Bindy ID} as string,",
						"          StoreID as string,",
						"          ProfitCenter as string,",
						"          Location as string,",
						"          Country as string,",
						"          {Account #} as string,",
						"          {Store Front Ship-To} as string,",
						"          Entity as string,",
						"          {Licensee / Contact} as string,",
						"          {Soft Open Date} as string,",
						"          {Acquisition Date} as string,",
						"          {Closure Date} as string,",
						"          ShopperTrakLocID as string,",
						"          {Store Address} as string,",
						"          City as string,",
						"          {State / Province} as string,",
						"          ZIP as string,",
						"          {DMA ID} as string,",
						"          {DMA Region} as string,",
						"          {Showroom Sq. Ft.} as string,",
						"          {Store Type} as string,",
						"          {Store Model} as string,",
						"          {Store Version} as string,",
						"          Market as string,",
						"          Region as string,",
						"          {Building Ownership} as string,",
						"          {Country Category} as string,",
						"          {Domestic Category} as string,",
						"          Classification as string,",
						"          {Store Phone} as string,",
						"          {District Manager} as string,",
						"          {BD Director} as string,",
						"          {Licensee Marketing Manager} as string,",
						"          {Licensee Sales Field Manager} as string,",
						"          {Licensee Email} as string,",
						"          {Licensee Phone #} as string,",
						"          IMS as string,",
						"          {Corporation Address} as string,",
						"          {Corp City} as string,",
						"          {Corp State} as string,",
						"          {Corp Zip} as string,",
						"          {RDC Address} as string,",
						"          {RDC City} as string,",
						"          {RDC State} as string,",
						"          {RDC Zip} as string,",
						"          {RDC Ship To} as string,",
						"          {RDC Sq. Ft.} as string,",
						"          {RDC Dock Doors} as string,",
						"          {TUA Expiration Date} as string,",
						"          {Licensed Territory} as string,",
						"          Latitude as string,",
						"          Longitude as string,",
						"          Notes as string,",
						"          {Store Email} as string,",
						"          {Unit #} as string,",
						"          {OneSource ID} as string,",
						"          {HS Database Name} as string,",
						"          SVP as string,",
						"          VP as string,",
						"          {Sr. RD} as string,",
						"          RD as string,",
						"          {Store Manager} as string,",
						"          {Store Mgr. Phone} as string,",
						"          {Sales Manager (1)} as string,",
						"          {Sales Manager (2)} as string,",
						"          {Sales Manager (3)} as string,",
						"          {Sales Manager (4)} as string,",
						"          {Office Manager} as string,",
						"          {Director of Ops} as string,",
						"          {Regional Ops Mgr} as string,",
						"          {Ops Mgr} as string,",
						"          {Comp Status} as string,",
						"          {Kit #} as string,",
						"          {Traffic Divisor} as string,",
						"          ERP as string,",
						"          {DTC Technology} as string,",
						"          {DTC Brand} as string,",
						"          {Forum ID} as string,",
						"          {Account Type} as string,",
						"          {Facade Current Image} as string,",
						"          {Website Facade Current} as string,",
						"          {Store Manager Image} as string,",
						"          {Enterprise Facade Image} as string,",
						"          {Lease Terms} as string,",
						"          {Modified Date} as string,",
						"          {DAC ID} as string,",
						"          {Status Reports} as string,",
						"          {Model Counts} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     store: 'smartsheet',",
						"     format: 'rest',",
						"     entityId: '4179009966761860',",
						"     entityType: 'sheets') ~> SRCStoremasterlist",
						"SRCStoremasterlist select(mapColumn(",
						"          Status,",
						"          LocationKey,",
						"          ProspectID = {Prospect ID},",
						"          GoogleID = {Google ID},",
						"          BindyID = {Bindy ID},",
						"          StoreID,",
						"          ProfitCenter,",
						"          Location,",
						"          Country,",
						"          Account = {Account #},",
						"          StoreFrontShipTo = {Store Front Ship-To},",
						"          Entity,",
						"          LicenseeContact = {Licensee / Contact},",
						"          SoftOpenDate = {Soft Open Date},",
						"          AcquisitionDate = {Acquisition Date},",
						"          ClosureDate = {Closure Date},",
						"          ShopperTrakLocID,",
						"          StoreAddress = {Store Address},",
						"          City,",
						"          StateProvince = {State / Province},",
						"          ZIP,",
						"          DMAID = {DMA ID},",
						"          DMARegion = {DMA Region},",
						"          ShowroomSqFt = {Showroom Sq. Ft.},",
						"          StoreType = {Store Type},",
						"          StoreModel = {Store Model},",
						"          StoreVersion = {Store Version},",
						"          Market,",
						"          Region,",
						"          BuildingOwnership = {Building Ownership},",
						"          CountryCategory = {Country Category},",
						"          DomesticCategory = {Domestic Category},",
						"          Classification,",
						"          StorePhone = {Store Phone},",
						"          DistrictManager = {District Manager},",
						"          BDDirector = {BD Director},",
						"          LicenseeMarketingManager = {Licensee Marketing Manager},",
						"          LicenseeEmail = {Licensee Email},",
						"          LicenseePhone = {Licensee Phone #},",
						"          IMS,",
						"          CorporationAddress = {Corporation Address},",
						"          CorpCity = {Corp City},",
						"          CorpState = {Corp State},",
						"          CorpZip = {Corp Zip},",
						"          RDCAddress = {RDC Address},",
						"          RDCCity = {RDC City},",
						"          RDCState = {RDC State},",
						"          RDCZip = {RDC Zip},",
						"          RDCShipTo = {RDC Ship To},",
						"          RDCSqFt = {RDC Sq. Ft.},",
						"          RDCDockDoors = {RDC Dock Doors},",
						"          TUAExpirationDate = {TUA Expiration Date},",
						"          LicensedTerritory = {Licensed Territory},",
						"          Latitude,",
						"          Longitude,",
						"          Notes,",
						"          StoreEmail = {Store Email},",
						"          Unit = {Unit #},",
						"          OneSourceID = {OneSource ID},",
						"          HSDatabaseName = {HS Database Name},",
						"          SVP,",
						"          VP,",
						"          SrRD = {Sr. RD},",
						"          RD,",
						"          StoreManager = {Store Manager},",
						"          StoreMgrPhone = {Store Mgr. Phone},",
						"          SalesManager1 = {Sales Manager (1)},",
						"          SalesManager2 = {Sales Manager (2)},",
						"          SalesManager3 = {Sales Manager (3)},",
						"          SalesManager4 = {Sales Manager (4)},",
						"          OfficeManager = {Office Manager},",
						"          DirectorOfOps = {Director of Ops},",
						"          RegionalOpsMgr = {Regional Ops Mgr},",
						"          OpsMgr = {Ops Mgr},",
						"          CompStatus = {Comp Status},",
						"          Kit = {Kit #},",
						"          TrafficDivisor = {Traffic Divisor},",
						"          ERP,",
						"          DTCTechnology = {DTC Technology},",
						"          DTCBrand = {DTC Brand},",
						"          ForumID = {Forum ID},",
						"          AccountType = {Account Type},",
						"          FacadeCurrentImage = {Facade Current Image},",
						"          WebsiteFacadeCurrent = {Website Facade Current},",
						"          StoreManagerImage = {Store Manager Image},",
						"          EnterpriseFacadeImage = {Enterprise Facade Image},",
						"          LicenseeSalesFieldManager = {Licensee Sales Field Manager},",
						"          DACID = {DAC ID},",
						"          LeaseTerms = {Lease Terms},",
						"          ModifiedDate = {Modified Date},",
						"          StatusReports = {Status Reports},",
						"          ModelCounts = {Model Counts}",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> select",
						"select derive(Comments = 'STORESMARTSHEET') ~> derivedColumn",
						"derivedColumn sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Status as string,",
						"          LocationKey as string,",
						"          ProspectID as string,",
						"          GoogleID as string,",
						"          BindyID as string,",
						"          StoreID as string,",
						"          ProfitCenter as string,",
						"          Location as string,",
						"          Country as string,",
						"          Account as string,",
						"          StoreFrontShipTo as string,",
						"          Entity as string,",
						"          LicenseeContact as string,",
						"          SoftOpenDate as date,",
						"          AcquisitionDate as date,",
						"          ClosureDate as date,",
						"          ShopperTrakLocID as string,",
						"          StoreAddress as string,",
						"          City as string,",
						"          StateProvince as string,",
						"          ZIP as string,",
						"          DMAID as string,",
						"          DMARegion as string,",
						"          ShowroomSqFt as string,",
						"          StoreType as string,",
						"          StoreModel as string,",
						"          StoreVersion as string,",
						"          Market as string,",
						"          Region as string,",
						"          BuildingOwnership as string,",
						"          CountryCategory as string,",
						"          DomesticCategory as string,",
						"          Classification as string,",
						"          StorePhone as string,",
						"          DistrictManager as string,",
						"          BDDirector as string,",
						"          LicenseeEmail as string,",
						"          LicenseePhone as string,",
						"          CorporationAddress as string,",
						"          CorpCity as string,",
						"          CorpState as string,",
						"          CorpZip as string,",
						"          RDCAddress as string,",
						"          RDCCity as string,",
						"          RDCState as string,",
						"          RDCZip as string,",
						"          RDCShipTo as string,",
						"          RDCSqFt as string,",
						"          RDCDockDoors as string,",
						"          TUAExpirationDate as date,",
						"          LicensedTerritory as string,",
						"          Latitude as string,",
						"          Longitude as string,",
						"          Notes as string,",
						"          StoreEmail as string,",
						"          Unit as string,",
						"          OneSourceID as string,",
						"          HSDatabaseName as string,",
						"          SVP as string,",
						"          VP as string,",
						"          SrRD as string,",
						"          RD as string,",
						"          StoreManager as string,",
						"          StoreMgrPhone as string,",
						"          SalesManager1 as string,",
						"          SalesManager2 as string,",
						"          SalesManager3 as string,",
						"          SalesManager4 as string,",
						"          OfficeManager as string,",
						"          DirectorOfOps as string,",
						"          RegionalOpsMgr as string,",
						"          OpsMgr as string,",
						"          CompStatus as string,",
						"          Kit as string,",
						"          TrafficDivisor as string,",
						"          ERP as string,",
						"          DTCTechnology as string,",
						"          DTCBrand as string,",
						"          ForumID as string,",
						"          AccountType as string,",
						"          FacadeCurrentImage as string,",
						"          WebsiteFacadeCurrent as string,",
						"          StoreManagerImage as string,",
						"          EnterpriseFacadeImage as string,",
						"          LicenseeSalesDistrict as string,",
						"          LicenseeSalesRegion as string,",
						"          ModifiedDate as date,",
						"          LicenseeMarketingManager as string,",
						"          IMS as string,",
						"          LeaseTerms as string,",
						"          StatusReports as string,",
						"          ModelCounts as string,",
						"          Comments as string,",
						"          DAC_ID as string,",
						"          createddate as timestamp,",
						"          LicenseeSalesFieldManager as string,",
						"          DACID as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['Delete from Smartsheet.StoreMasterCustom'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     outputRejectedData: true,",
						"     outputAssertFailedRows: true,",
						"     assertFailure_fileSystem: 'Error',",
						"     assertFailure_folderPath: 'Store',",
						"     mapColumn(",
						"          Status,",
						"          LocationKey,",
						"          ProspectID,",
						"          GoogleID,",
						"          BindyID,",
						"          StoreID,",
						"          ProfitCenter,",
						"          Location,",
						"          Country,",
						"          Account,",
						"          StoreFrontShipTo,",
						"          Entity,",
						"          LicenseeContact,",
						"          SoftOpenDate,",
						"          AcquisitionDate,",
						"          ClosureDate,",
						"          ShopperTrakLocID,",
						"          StoreAddress,",
						"          City,",
						"          StateProvince,",
						"          ZIP,",
						"          DMAID,",
						"          DMARegion,",
						"          ShowroomSqFt,",
						"          StoreType,",
						"          StoreModel,",
						"          StoreVersion,",
						"          Market,",
						"          Region,",
						"          BuildingOwnership,",
						"          CountryCategory,",
						"          DomesticCategory,",
						"          Classification,",
						"          StorePhone,",
						"          DistrictManager,",
						"          BDDirector,",
						"          LicenseeEmail,",
						"          LicenseePhone,",
						"          CorporationAddress,",
						"          CorpCity,",
						"          CorpState,",
						"          CorpZip,",
						"          RDCAddress,",
						"          RDCCity,",
						"          RDCState,",
						"          RDCZip,",
						"          RDCShipTo,",
						"          RDCSqFt,",
						"          RDCDockDoors,",
						"          TUAExpirationDate,",
						"          LicensedTerritory,",
						"          Latitude,",
						"          Longitude,",
						"          Notes,",
						"          StoreEmail,",
						"          Unit,",
						"          OneSourceID,",
						"          HSDatabaseName,",
						"          SVP,",
						"          VP,",
						"          SrRD,",
						"          RD,",
						"          StoreManager,",
						"          StoreMgrPhone,",
						"          SalesManager1,",
						"          SalesManager2,",
						"          SalesManager3,",
						"          SalesManager4,",
						"          OfficeManager,",
						"          DirectorOfOps,",
						"          RegionalOpsMgr,",
						"          OpsMgr,",
						"          CompStatus,",
						"          Kit,",
						"          TrafficDivisor,",
						"          ERP,",
						"          DTCTechnology,",
						"          DTCBrand,",
						"          ForumID,",
						"          AccountType,",
						"          FacadeCurrentImage,",
						"          WebsiteFacadeCurrent,",
						"          StoreManagerImage,",
						"          EnterpriseFacadeImage,",
						"          ModifiedDate,",
						"          LicenseeMarketingManager,",
						"          IMS,",
						"          LeaseTerms,",
						"          StatusReports,",
						"          ModelCounts,",
						"          Comments,",
						"          LicenseeSalesFieldManager,",
						"          DACID",
						"     )) ~> sink"
					]
				}
			},
			"dependsOn": [
				"[variables('factoryId')]",
				"[concat(variables('factoryId'), '/linkedServices/Smartsheet_Storemasterlist')]",
				"[concat(variables('factoryId'), '/datasets/DS_StoreMasterlist')]",
				"[concat(variables('factoryId'), '/linkedServices/masterDataHubStg')]"
			]
		},
		{
			"name": "[parameters('factoryName')]",
			"type": "Microsoft.DataFactory/factories",
			"apiVersion": "2018-06-01",
			"properties": {
				"globalParameters": {
					"DAC_Accountid": {
						"type": "string",
						"value": "[parameters('dataFactory_properties_globalParameters_DAC_Accountid_value')]"
					},
					"DAC_SubscriptionKey": {
						"type": "string",
						"value": "[parameters('dataFactory_properties_globalParameters_DAC_SubscriptionKey_value')]"
					},
					"ADF_SubscriptionID": {
						"type": "string",
						"value": "[parameters('dataFactory_properties_globalParameters_ADF_SubscriptionID_value')]"
					},
					"Melissa_LicenseKey": {
						"type": "string",
						"value": "[parameters('dataFactory_properties_globalParameters_Melissa_LicenseKey_value')]"
					}
				}
			},
			"dependsOn": [],
			"location": "[parameters('dataFactory_location')]",
			"identity": {
				"type": "[parameters('dataFactory_identity_type')]"
			}
		}
	]
}