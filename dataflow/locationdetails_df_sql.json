{
	"name": "locationdetails_df_sql",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Json_dac_source_ds",
						"type": "DatasetReference"
					},
					"name": "sourceDACJson"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSqlLocationServices",
						"type": "DatasetReference"
					},
					"name": "sinkLocationServices"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlBusinessDetails",
						"type": "DatasetReference"
					},
					"name": "sinkBusinessDetails"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlBusinessCategories",
						"type": "DatasetReference"
					},
					"name": "sinkBusinessCategories"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlLocationDetails",
						"type": "DatasetReference"
					},
					"name": "sinkLocationDetails"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlPhotoUrls",
						"type": "DatasetReference"
					},
					"name": "sinkPhotoURLs"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlLocationHours",
						"type": "DatasetReference"
					},
					"name": "sinkLocationHours"
				}
			],
			"transformations": [
				{
					"name": "flattenLocationServices"
				},
				{
					"name": "flattenBusinessDetails"
				},
				{
					"name": "flattenBusinessCategories"
				},
				{
					"name": "flattenLocationDetails"
				},
				{
					"name": "flattenPhotoURLs"
				},
				{
					"name": "flattenLocationHours"
				}
			],
			"script": "source(output(\n\t\tAccountID as string,\n\t\tLocationID as string,\n\t\tLocationNumber as string,\n\t\tReferenceCode as string,\n\t\tCreatedBy as string,\n\t\tModifiedBy as string,\n\t\tCreated as string,\n\t\tModified as string,\n\t\tLocationData as (KeyFields as (CSOLocationID as string, ITGAccountId as string, ITGAccountNumber as string, ITGClientId as string, ITGClientNumber as string, AgencyCode as string, {Reference Code} as string, CMR as string, {Open Holidays} as string, Exteriorphoto as string, AutoDisplayPoint as string, HideAddress as string, PinMarker as string, ChainName as string, primarylanguage as string, Promotion1Image as string, Promotion1URL as string, GoogleBusinessDescription as string, CustomerServiceHours as string, Flyerlink as string, ManagerDescription as string, ScheduleApptURL as string, ManagerName as string, {Reference Code 2} as string, Promotion2Image as string), DisplayPoint as (Type as string, Latitude as double, Longitude as double, VerificationType as string), BusinessStatus as string, Status as string, BusinessName as (Name as string, LongName as string, Locale as integer), BusinessDescription as (Description as string, ShortDescription as string, LongDescription as string), PrimaryAddress as (AddressLine1 as string, Locality as string, Region as string, PostalCode as string, CountryCode as string), PhoneNumbers as (PrimaryPhoneNumber as string, Fax as string, Landline as string), WebsiteURL as string, AlternateWebsiteURL as string, MediaURLs as (FacebookURL as string, TwitterURL as string, LinkedInURL as string, InstagramURL as string, PinterestURL as string), HoursOfOperationStructured as (Su as (Ranges as (StartTime as string, EndTime as string)[], State as integer), Mo as (Ranges as (StartTime as string, EndTime as string)[], State as integer), Tu as (Ranges as (StartTime as string, EndTime as string)[], State as integer), We as (Ranges as (StartTime as string, EndTime as string)[], State as integer), Th as (Ranges as (StartTime as string, EndTime as string)[], State as integer), Fr as (Ranges as (StartTime as string, EndTime as string)[], State as integer), Sa as (Ranges as (StartTime as string, EndTime as string)[], State as integer)), BusinessCategories as (Category1 as string, Category2 as string, Category3 as string, Category4 as string, Category5 as string, Category6 as string, Category7 as string, Category8 as string, Category9 as string), PhotoURLs as (Type as string, URL as string, Name as string)[], KeywordsSpecialties as string, Products as string, Services as string, Brands as string, Tagline as string, AreasServed as string, PaymentMethods as string, CredentialsCertifications as string, YearFounded as string)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tdocumentForm: 'documentPerLine') ~> sourceDACJson\nsourceDACJson foldDown(unroll(LocationData.PhotoURLs),\n\tmapColumn(\n\t\tKeywordsSpecialties = LocationData.KeywordsSpecialties,\n\t\tProducts = LocationData.Products,\n\t\tServices = LocationData.Services,\n\t\tBrands = LocationData.Brands,\n\t\tTagline = LocationData.Tagline,\n\t\tAreasServed = LocationData.AreasServed,\n\t\tLocationNumber\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> flattenLocationServices\nsourceDACJson foldDown(unroll(LocationData.PhotoURLs),\n\tmapColumn(\n\t\tBusinessStatus = LocationData.BusinessStatus,\n\t\tBusinessName = LocationData.BusinessName,\n\t\tBusinessDescription = LocationData.BusinessDescription,\n\t\tLocationNumber,\n\t\tBusinessLongName = LocationData.BusinessName.LongName,\n\t\tLocale = LocationData.BusinessName.Locale,\n\t\tBusinessShortDescription = LocationData.BusinessDescription.ShortDescription,\n\t\tLongDescription = LocationData.BusinessDescription.LongDescription,\n\t\tWebsiteURL = LocationData.WebsiteURL,\n\t\tAlternateWebsiteURL = LocationData.AlternateWebsiteURL,\n\t\tMediaURLs = LocationData.MediaURLs\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> flattenBusinessDetails\nsourceDACJson foldDown(unroll(LocationData.PhotoURLs),\n\tmapColumn(\n\t\tLocationNumber,\n\t\tCategory1 = LocationData.BusinessCategories.Category1,\n\t\tCategory2 = LocationData.BusinessCategories.Category2,\n\t\tCategory3 = LocationData.BusinessCategories.Category3,\n\t\tCategory4 = LocationData.BusinessCategories.Category4,\n\t\tCategory5 = LocationData.BusinessCategories.Category5,\n\t\tCategory6 = LocationData.BusinessCategories.Category6,\n\t\tCategory7 = LocationData.BusinessCategories.Category7,\n\t\tCategory8 = LocationData.BusinessCategories.Category8,\n\t\tCategory9 = LocationData.BusinessCategories.Category9\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> flattenBusinessCategories\nsourceDACJson foldDown(unroll(LocationData.PhotoURLs),\n\tmapColumn(\n\t\tAccountID,\n\t\tLocationID,\n\t\tLocationNumber,\n\t\tCreatedBy,\n\t\tModifiedBy,\n\t\tCreated,\n\t\tModified,\n\t\tCSOLocationID = LocationData.KeyFields.CSOLocationID,\n\t\tITGAccountID = LocationData.KeyFields.ITGAccountId,\n\t\tITGAccountNumber = LocationData.KeyFields.ITGAccountNumber,\n\t\tITGClientId = LocationData.KeyFields.ITGClientId,\n\t\tITGClientNumber = LocationData.KeyFields.ITGClientNumber,\n\t\tAgencyCode = LocationData.KeyFields.AgencyCode,\n\t\tReferenceCode = LocationData.KeyFields.{Reference Code},\n\t\tCMR = LocationData.KeyFields.CMR,\n\t\tOpenHolidays = LocationData.KeyFields.{Open Holidays},\n\t\tExteriorphoto = LocationData.KeyFields.Exteriorphoto,\n\t\tCustomerServiceHours = LocationData.KeyFields.CustomerServiceHours,\n\t\tHideAddress = LocationData.KeyFields.HideAddress,\n\t\tPinMarker = LocationData.KeyFields.PinMarker,\n\t\tScheduleApptURL = LocationData.KeyFields.ScheduleApptURL,\n\t\tReferenceCode2 = LocationData.KeyFields.{Reference Code 2},\n\t\tChainName = LocationData.KeyFields.ChainName,\n\t\tAutoDisplayPoint = LocationData.KeyFields.AutoDisplayPoint,\n\t\tprimarylanguage = LocationData.KeyFields.primarylanguage,\n\t\tGoogleBusinessDescription = LocationData.KeyFields.GoogleBusinessDescription,\n\t\tPromotion2Image = LocationData.KeyFields.Promotion2Image,\n\t\tPromotion1Image = LocationData.KeyFields.Promotion1Image,\n\t\tFlyerlink = LocationData.KeyFields.Flyerlink,\n\t\tPrimaryAddressLine1 = LocationData.PrimaryAddress.AddressLine1,\n\t\tPrimaryLocality = LocationData.PrimaryAddress.Locality,\n\t\tPrimaryRegion = LocationData.PrimaryAddress.Region,\n\t\tPrimaryPostalCode = LocationData.PrimaryAddress.PostalCode,\n\t\tPrimaryCountryCode = LocationData.PrimaryAddress.CountryCode,\n\t\tDisplayPoint_Type = LocationData.DisplayPoint.Type,\n\t\tDisplayPoint_Latitude = LocationData.DisplayPoint.Latitude,\n\t\tDisplayPoint_Longitude = LocationData.DisplayPoint.Longitude,\n\t\tDisplayPoint_VerificationType = LocationData.DisplayPoint.VerificationType,\n\t\tPrimaryPhoneNumber = LocationData.PhoneNumbers.PrimaryPhoneNumber,\n\t\tFax = LocationData.PhoneNumbers.Fax,\n\t\tLandline = LocationData.PhoneNumbers.Landline,\n\t\tPaymentMethods = LocationData.PaymentMethods,\n\t\tPromotion1URL = LocationData.KeyFields.Promotion1URL\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> flattenLocationDetails\nsourceDACJson foldDown(unroll(LocationData.PhotoURLs),\n\tmapColumn(\n\t\tType = LocationData.PhotoURLs.Type,\n\t\tURL = LocationData.PhotoURLs.URL,\n\t\tName = LocationData.PhotoURLs.Name,\n\t\tLocationNumber\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> flattenPhotoURLs\nsourceDACJson foldDown(unroll(LocationData.PhotoURLs),\n\tmapColumn(\n\t\tLocationNumber,\n\t\tSu = LocationData.HoursOfOperationStructured.Su,\n\t\tStartTime = LocationData.HoursOfOperationStructured.Su.Ranges.StartTime,\n\t\tEndTime = LocationData.HoursOfOperationStructured.Su.Ranges.EndTime,\n\t\tstate = LocationData.HoursOfOperationStructured.Su.State\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> flattenLocationHours\nflattenLocationServices sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tLocationNumber as string,\n\t\tKeywordsSpecialties as string,\n\t\tProducts as string,\n\t\tServices as string,\n\t\tBrands as string,\n\t\tTagline as string,\n\t\tAreasServed as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tLocationNumber,\n\t\tKeywordsSpecialties,\n\t\tProducts,\n\t\tServices,\n\t\tBrands,\n\t\tTagline,\n\t\tAreasServed\n\t)) ~> sinkLocationServices\nflattenBusinessDetails sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tLocationNumber as string,\n\t\tBusinessStatus as string,\n\t\tBusinessName as string,\n\t\tBusinessLongName as string,\n\t\tLocale as string,\n\t\tBusinessDescription as string,\n\t\tBusinessShortDescription as string,\n\t\tBusinessLongDescription as string,\n\t\tWebsiteURL as string,\n\t\tAlternateWebsiteURL as string,\n\t\tMediaURL as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tLocationNumber,\n\t\tBusinessStatus,\n\t\tBusinessName = BusinessName.Name,\n\t\tBusinessLongName,\n\t\tLocale = BusinessName.Locale,\n\t\tBusinessDescription = BusinessDescription.Description,\n\t\tBusinessShortDescription,\n\t\tBusinessLongDescription = BusinessDescription.LongDescription,\n\t\tWebsiteURL,\n\t\tAlternateWebsiteURL,\n\t\tMediaURL = AlternateWebsiteURL\n\t)) ~> sinkBusinessDetails\nflattenBusinessCategories sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tLocationNumber as string,\n\t\tCategory1 as string,\n\t\tCategory2 as string,\n\t\tCategory3 as string,\n\t\tCategory4 as string,\n\t\tCategory5 as string,\n\t\tCategory6 as string,\n\t\tCategory7 as string,\n\t\tCategory8 as string,\n\t\tCategory9 as string,\n\t\tCategory10 as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tLocationNumber,\n\t\tCategory1,\n\t\tCategory2,\n\t\tCategory3,\n\t\tCategory4,\n\t\tCategory5,\n\t\tCategory6,\n\t\tCategory7,\n\t\tCategory8,\n\t\tCategory9\n\t)) ~> sinkBusinessCategories\nflattenLocationDetails sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tAccountID as string,\n\t\tLocationID as string,\n\t\tLocationNumber as string,\n\t\tCreatedBy as string,\n\t\tModifiedBy as string,\n\t\tCreated as timestamp,\n\t\tModified as timestamp,\n\t\tCSOLocationID as string,\n\t\tITGAccountId as string,\n\t\tITGAccountNumber as string,\n\t\tITGClientId as string,\n\t\tITGClientNumber as string,\n\t\tAgencyCode as string,\n\t\tReferenceCode as string,\n\t\tCMR as string,\n\t\tOpenHolidays as string,\n\t\tExteriorPhoto as string,\n\t\tCustomerServiceHours as string,\n\t\tHideAddress as string,\n\t\tPinMarker as string,\n\t\tScheduleApptURL as string,\n\t\tReferenceCode2 as string,\n\t\tChainName as string,\n\t\tAutoDisplayPoint as string,\n\t\tPrimaryLanguage as string,\n\t\tGoogleBusinessDescription as string,\n\t\tPromotion2Image as string,\n\t\tPromotion1Image as string,\n\t\tFlyerLink as string,\n\t\tPrimaryAddressLine1 as string,\n\t\tPrimaryLocality as string,\n\t\tPrimaryRegion as string,\n\t\tPrimaryPostalCode as string,\n\t\tPrimaryCountryCode as string,\n\t\tDisplayPoint_Type as string,\n\t\tDisplayPoint_Latitude as string,\n\t\tDisplayPoint_Longitude as string,\n\t\tDisplayPoint_VerificationType as string,\n\t\tPrimaryPhoneNumber as string,\n\t\tFax as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tAccountID,\n\t\tLocationID,\n\t\tLocationNumber,\n\t\tCreatedBy,\n\t\tModifiedBy,\n\t\tCSOLocationID,\n\t\tITGAccountId = ITGAccountID,\n\t\tITGAccountNumber,\n\t\tITGClientId,\n\t\tITGClientNumber,\n\t\tAgencyCode,\n\t\tReferenceCode,\n\t\tCMR,\n\t\tOpenHolidays,\n\t\tExteriorPhoto = Exteriorphoto,\n\t\tCustomerServiceHours,\n\t\tHideAddress,\n\t\tPinMarker,\n\t\tScheduleApptURL,\n\t\tReferenceCode2,\n\t\tChainName,\n\t\tAutoDisplayPoint,\n\t\tPrimaryLanguage = primarylanguage,\n\t\tGoogleBusinessDescription,\n\t\tPromotion2Image,\n\t\tPromotion1Image,\n\t\tFlyerLink = Flyerlink,\n\t\tPrimaryAddressLine1,\n\t\tPrimaryLocality,\n\t\tPrimaryRegion,\n\t\tPrimaryPostalCode,\n\t\tPrimaryCountryCode,\n\t\tDisplayPoint_Type,\n\t\tDisplayPoint_Latitude,\n\t\tDisplayPoint_Longitude,\n\t\tDisplayPoint_VerificationType,\n\t\tPrimaryPhoneNumber,\n\t\tFax\n\t)) ~> sinkLocationDetails\nflattenPhotoURLs sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tLocationNumber as string,\n\t\tCategory1 as string,\n\t\tCategory2 as string,\n\t\tCategory3 as string,\n\t\tCategory4 as string,\n\t\tCategory5 as string,\n\t\tCategory6 as string,\n\t\tCategory7 as string,\n\t\tCategory8 as string,\n\t\tCategory9 as string,\n\t\tCategory10 as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tLocationNumber\n\t)) ~> sinkPhotoURLs\nflattenLocationHours sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tAccountID as string,\n\t\tLocationID as string,\n\t\tLocationNumber as string,\n\t\tType as string,\n\t\tURL as string,\n\t\tName as string,\n\t\tDescription as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tLocationNumber\n\t)) ~> sinkLocationHours"
		}
	}
}