{
	"name": "locations_dataflow_copy1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "store_payload_input_ds_copy1",
						"type": "DatasetReference"
					},
					"name": "sourceLocation"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "dac_sink_ds",
						"type": "DatasetReference"
					},
					"name": "sinkLocation"
				}
			],
			"transformations": [
				{
					"name": "FlattenData"
				}
			],
			"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\thttpMethod: 'GET',\n\ttimeout: 30,\n\tpaginationRules: ['supportRFC5988' -> 'true'],\n\tresponseFormat: ['type' -> 'json', 'documentForm' -> 'arrayOfDocuments']) ~> sourceLocation\nsourceLocation foldDown(unroll(body.Data),\n\tmapColumn(\n\t\tContinuationToken = body.ContinuationToken,\n\t\tBusinessStatus = body.Data.BusinessStatus,\n\t\tLocationID = body.Data.LocationID,\n\t\tLocationNumber = body.Data.LocationNumber,\n\t\tLongBusinessName = body.Data.LongBusinessName,\n\t\tAddressLine1 = body.Data.PrimaryAddress.AddressLine1,\n\t\tAddressLine2 = body.Data.PrimaryAddress.AddressLine2,\n\t\tCountryCode = body.Data.PrimaryAddress.CountryCode,\n\t\tLocality = body.Data.PrimaryAddress.Locality,\n\t\tPostalCode = body.Data.PrimaryAddress.PostalCode,\n\t\tRegion = body.Data.PrimaryAddress.Region,\n\t\tPrimaryPhoneNumber = body.Data.PrimaryPhoneNumber,\n\t\tReferenceCode = body.Data.ReferenceCode,\n\t\tStatus = body.Data.Status\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> FlattenData\nFlattenData sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['locations_response_4'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> sinkLocation"
		}
	}
}