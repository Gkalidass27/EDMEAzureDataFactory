{
	"name": "DF_Stage_SiteMaster_Store_Smartsheet",
	"properties": {
		"description": "This Dataflow loads RDC info to Semarchy staging",
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "Smartsheet_Storemasterlist",
						"type": "LinkedServiceReference"
					},
					"name": "SRCStoremasterlist"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Smartsheet_staging_test",
						"type": "DatasetReference"
					},
					"name": "sink",
					"rejectedDataLinkedService": {
						"referenceName": "masterDataHubStg",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "select"
				},
				{
					"name": "derivedColumn"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Status as string,",
				"          LocationKey as string,",
				"          {Prospect ID} as string,",
				"          {Google ID} as string,",
				"          {Bindy ID} as string,",
				"          StoreID as string,",
				"          ProfitCenter as string,",
				"          Location as string,",
				"          Country as string,",
				"          {Account #} as string,",
				"          {Store Front Ship-To} as string,",
				"          Entity as string,",
				"          {Licensee / Contact} as string,",
				"          {Soft Open Date} as string,",
				"          {Acquisition Date} as string,",
				"          {Closure Date} as string,",
				"          ShopperTrakLocID as string,",
				"          {Store Address} as string,",
				"          City as string,",
				"          {State / Province} as string,",
				"          ZIP as string,",
				"          {DMA ID} as string,",
				"          {DMA Region} as string,",
				"          {Showroom Sq. Ft.} as string,",
				"          {Store Type} as string,",
				"          {Store Model} as string,",
				"          {Store Version} as string,",
				"          Market as string,",
				"          Region as string,",
				"          {Building Ownership} as string,",
				"          {Country Category} as string,",
				"          {Domestic Category} as string,",
				"          Classification as string,",
				"          {Store Phone} as string,",
				"          {District Manager} as string,",
				"          {Secondary Support} as string,",
				"          {BD Director} as string,",
				"          {Licensee Marketing Manager} as string,",
				"          {Licensee Sales Field Manager} as string,",
				"          {Licensee Email} as string,",
				"          {Licensee Phone #} as string,",
				"          IMS as string,",
				"          {Corporation Address} as string,",
				"          {Corp City} as string,",
				"          {Corp State} as string,",
				"          {Corp Zip} as string,",
				"          {RDC Address} as string,",
				"          {RDC City} as string,",
				"          {RDC State} as string,",
				"          {RDC Zip} as string,",
				"          {RDC Ship To} as string,",
				"          {RDC Sq. Ft.} as string,",
				"          {RDC Dock Doors} as string,",
				"          {TUA Expiration Date} as string,",
				"          {Licensed Territory} as string,",
				"          Latitude as string,",
				"          Longitude as string,",
				"          Notes as string,",
				"          {Store Email} as string,",
				"          {Unit #} as string,",
				"          {OneSource ID} as string,",
				"          {HS Database Name} as string,",
				"          SVP as string,",
				"          VP as string,",
				"          {Sr. RD} as string,",
				"          RD as string,",
				"          {Store Manager} as string,",
				"          {Store Mgr. Phone} as string,",
				"          {Sales Manager (1)} as string,",
				"          {Sales Manager (2)} as string,",
				"          {Sales Manager (3)} as string,",
				"          {Sales Manager (4)} as string,",
				"          {Office Manager} as string,",
				"          {Director of Ops} as string,",
				"          {Regional Ops Mgr} as string,",
				"          {Ops Mgr} as string,",
				"          {Comp Status} as string,",
				"          {Kit #} as string,",
				"          {Traffic Divisor} as string,",
				"          ERP as string,",
				"          {DTC Technology} as string,",
				"          {DTC Brand} as string,",
				"          {Forum ID} as string,",
				"          {Account Type} as string,",
				"          {Facade Current Image} as string,",
				"          {Website Facade Current} as string,",
				"          {Store Manager Image} as string,",
				"          {Enterprise Facade Image} as string,",
				"          {Lease Terms} as string,",
				"          {Modified Date} as string,",
				"          {DAC ID} as string,",
				"          {Status Reports} as string,",
				"          {Model Counts} as string,",
				"          {Credit Analyst} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: true,",
				"     store: 'smartsheet',",
				"     format: 'rest',",
				"     entityId: '4179009966761860',",
				"     entityType: 'sheets') ~> SRCStoremasterlist",
				"SRCStoremasterlist select(mapColumn(",
				"          Status,",
				"          LocationKey,",
				"          ProspectID = {Prospect ID},",
				"          GoogleID = {Google ID},",
				"          BindyID = {Bindy ID},",
				"          StoreID,",
				"          ProfitCenter,",
				"          Location,",
				"          Country,",
				"          Account = {Account #},",
				"          StoreFrontShipTo = {Store Front Ship-To},",
				"          Entity,",
				"          LicenseeContact = {Licensee / Contact},",
				"          SoftOpenDate = {Soft Open Date},",
				"          AcquisitionDate = {Acquisition Date},",
				"          ClosureDate = {Closure Date},",
				"          ShopperTrakLocID,",
				"          StoreAddress = {Store Address},",
				"          City,",
				"          StateProvince = {State / Province},",
				"          ZIP,",
				"          DMAID = {DMA ID},",
				"          DMARegion = {DMA Region},",
				"          ShowroomSqFt = {Showroom Sq. Ft.},",
				"          StoreType = {Store Type},",
				"          StoreModel = {Store Model},",
				"          StoreVersion = {Store Version},",
				"          Market,",
				"          Region,",
				"          BuildingOwnership = {Building Ownership},",
				"          CountryCategory = {Country Category},",
				"          DomesticCategory = {Domestic Category},",
				"          Classification,",
				"          StorePhone = {Store Phone},",
				"          DistrictManager = {District Manager},",
				"          BDDirector = {BD Director},",
				"          LicenseeMarketingManager = {Licensee Marketing Manager},",
				"          LicenseeEmail = {Licensee Email},",
				"          LicenseePhone = {Licensee Phone #},",
				"          IMS,",
				"          CorporationAddress = {Corporation Address},",
				"          CorpCity = {Corp City},",
				"          CorpState = {Corp State},",
				"          CorpZip = {Corp Zip},",
				"          RDCAddress = {RDC Address},",
				"          RDCCity = {RDC City},",
				"          RDCState = {RDC State},",
				"          RDCZip = {RDC Zip},",
				"          RDCShipTo = {RDC Ship To},",
				"          RDCSqFt = {RDC Sq. Ft.},",
				"          RDCDockDoors = {RDC Dock Doors},",
				"          TUAExpirationDate = {TUA Expiration Date},",
				"          LicensedTerritory = {Licensed Territory},",
				"          Latitude,",
				"          Longitude,",
				"          Notes,",
				"          StoreEmail = {Store Email},",
				"          Unit = {Unit #},",
				"          OneSourceID = {OneSource ID},",
				"          HSDatabaseName = {HS Database Name},",
				"          SVP,",
				"          VP,",
				"          SrRD = {Sr. RD},",
				"          RD,",
				"          StoreManager = {Store Manager},",
				"          StoreMgrPhone = {Store Mgr. Phone},",
				"          SalesManager1 = {Sales Manager (1)},",
				"          SalesManager2 = {Sales Manager (2)},",
				"          SalesManager3 = {Sales Manager (3)},",
				"          SalesManager4 = {Sales Manager (4)},",
				"          OfficeManager = {Office Manager},",
				"          DirectorOfOps = {Director of Ops},",
				"          RegionalOpsMgr = {Regional Ops Mgr},",
				"          OpsMgr = {Ops Mgr},",
				"          CompStatus = {Comp Status},",
				"          Kit = {Kit #},",
				"          TrafficDivisor = {Traffic Divisor},",
				"          ERP,",
				"          DTCTechnology = {DTC Technology},",
				"          DTCBrand = {DTC Brand},",
				"          ForumID = {Forum ID},",
				"          AccountType = {Account Type},",
				"          FacadeCurrentImage = {Facade Current Image},",
				"          WebsiteFacadeCurrent = {Website Facade Current},",
				"          StoreManagerImage = {Store Manager Image},",
				"          EnterpriseFacadeImage = {Enterprise Facade Image},",
				"          LicenseeSalesFieldManager = {Licensee Sales Field Manager},",
				"          DACID = {DAC ID},",
				"          LeaseTerms = {Lease Terms},",
				"          ModifiedDate = {Modified Date},",
				"          StatusReports = {Status Reports},",
				"          ModelCounts = {Model Counts}",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> select",
				"select derive(CompStatus = coalesce(toString(CompStatus), ''),",
				"          Comments = 'STORESMARTSHEET') ~> derivedColumn",
				"derivedColumn sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     preSQLs:['Delete from Smartsheet.StoreMasterCustom'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     outputRejectedData: true,",
				"     outputAssertFailedRows: true,",
				"     assertFailure_fileSystem: 'Error',",
				"     assertFailure_folderPath: 'Store',",
				"     mapColumn(",
				"          Status,",
				"          LocationKey,",
				"          ProspectID,",
				"          GoogleID,",
				"          BindyID,",
				"          StoreID,",
				"          ProfitCenter,",
				"          Location,",
				"          Country,",
				"          Account,",
				"          StoreFrontShipTo,",
				"          Entity,",
				"          LicenseeContact,",
				"          SoftOpenDate,",
				"          AcquisitionDate,",
				"          ClosureDate,",
				"          ShopperTrakLocID,",
				"          StoreAddress,",
				"          City,",
				"          StateProvince,",
				"          ZIP,",
				"          DMAID,",
				"          DMARegion,",
				"          ShowroomSqFt,",
				"          StoreType,",
				"          StoreModel,",
				"          StoreVersion,",
				"          Market,",
				"          Region,",
				"          BuildingOwnership,",
				"          CountryCategory,",
				"          DomesticCategory,",
				"          Classification,",
				"          StorePhone,",
				"          DistrictManager,",
				"          BDDirector,",
				"          LicenseeEmail,",
				"          LicenseePhone,",
				"          CorporationAddress,",
				"          CorpCity,",
				"          CorpState,",
				"          CorpZip,",
				"          RDCAddress,",
				"          RDCCity,",
				"          RDCState,",
				"          RDCZip,",
				"          RDCShipTo,",
				"          RDCSqFt,",
				"          RDCDockDoors,",
				"          TUAExpirationDate,",
				"          LicensedTerritory,",
				"          Latitude,",
				"          Longitude,",
				"          Notes,",
				"          StoreEmail,",
				"          Unit,",
				"          OneSourceID,",
				"          HSDatabaseName,",
				"          SVP,",
				"          VP,",
				"          SrRD,",
				"          RD,",
				"          StoreManager,",
				"          StoreMgrPhone,",
				"          SalesManager1,",
				"          SalesManager2,",
				"          SalesManager3,",
				"          SalesManager4,",
				"          OfficeManager,",
				"          DirectorOfOps,",
				"          RegionalOpsMgr,",
				"          OpsMgr,",
				"          CompStatus,",
				"          Kit,",
				"          TrafficDivisor,",
				"          ERP,",
				"          DTCTechnology,",
				"          DTCBrand,",
				"          ForumID,",
				"          AccountType,",
				"          FacadeCurrentImage,",
				"          WebsiteFacadeCurrent,",
				"          StoreManagerImage,",
				"          EnterpriseFacadeImage,",
				"          ModifiedDate,",
				"          LicenseeMarketingManager,",
				"          IMS,",
				"          LeaseTerms,",
				"          StatusReports,",
				"          ModelCounts,",
				"          Comments,",
				"          LicenseeSalesFieldManager,",
				"          DACID",
				"     )) ~> sink"
			]
		}
	}
}