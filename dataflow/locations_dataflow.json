{
	"name": "locations_dataflow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "GetDACLocationRestAPI",
						"type": "DatasetReference"
					},
					"name": "sourceLocation"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DACResponse",
						"type": "DatasetReference"
					},
					"name": "sinkLocation"
				}
			],
			"transformations": [
				{
					"name": "FlattenData"
				}
			],
			"script": "source(output(\n\t\tbody as (ContinuationToken as string, Count as short, Data as (BusinessStatus as string, LocationID as string, LocationNumber as long, LongBusinessName as string, PrimaryAddress as (AddressLine1 as string, AddressLine2 as string, CountryCode as string, Locality as string, PostalCode as integer, Region as string), PrimaryPhoneNumber as long, ReferenceCode as integer, Status as string)[]),\n\t\theaders as [string,string]\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\thttpMethod: 'GET',\n\ttimeout: 30,\n\trequestInterval: 0,\n\tpaginationRules: ['supportRFC5988' -> 'true'],\n\tresponseFormat: ['type' -> 'json', 'documentForm' -> 'documentPerLine']) ~> sourceLocation\nsourceLocation foldDown(unroll(body.Data),\n\tmapColumn(\n\t\tBusinessStatus = body.Data.BusinessStatus,\n\t\tLocationID = body.Data.LocationID,\n\t\tLocationNumber = body.Data.LocationNumber,\n\t\tLongBusinessName = body.Data.LongBusinessName,\n\t\tAddressLine1 = body.Data.PrimaryAddress.AddressLine1,\n\t\tAddressLine2 = body.Data.PrimaryAddress.AddressLine2,\n\t\tCountryCode = body.Data.PrimaryAddress.CountryCode,\n\t\tLocality = body.Data.PrimaryAddress.Locality,\n\t\tPostalCode = body.Data.PrimaryAddress.PostalCode,\n\t\tRegion = body.Data.PrimaryAddress.Region,\n\t\tPrimaryPhoneNumber = body.Data.PrimaryPhoneNumber,\n\t\tReferenceCode = body.Data.ReferenceCode,\n\t\tStatus = body.Data.Status\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> FlattenData\nFlattenData sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['locations_response'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> sinkLocation"
		}
	}
}