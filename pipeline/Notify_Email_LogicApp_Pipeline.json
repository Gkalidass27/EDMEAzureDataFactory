{
	"name": "Notify_Email_LogicApp_Pipeline",
	"properties": {
		"activities": [
			{
				"name": "Set_Email_JSON_Schema",
				"type": "SetVariable",
				"dependsOn": [],
				"policy": {
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"variableName": "emailPayload",
					"value": {
						"value": "@concat('{','\"subscription\":\"',replace(pipeline().parameters.subscription,'\"','\\\\\"'),'\"',',\"resourceGroup\":\"',replace(pipeline().parameters.resourceGroup,'\"','\\\\\"'),'\"',',\"dataFactoryName\":\"',replace(pipeline().parameters.dataFactoryName,'\"','\\\\\"'),'\"',',\"runId\":\"',replace(pipeline().parameters.runId,'\"','\\\\\"'),'\"',',\"name\":\"',replace(pipeline().parameters.name,'\"','\\\\\"'),'\"',',\"status\":\"',replace(pipeline().parameters.status,'\"','\\\\\"'),'\"',',\"triggerTime\":\"',replace(pipeline().parameters.triggerTime,'\"','\\\\\"'),'\"',',\"executionEndTime\":\"',replace(pipeline().parameters.executionEndTime,'\"','\\\\\"'),'\"',',\"runDuration\":\"',replace(pipeline().parameters.runDuration,'\"','\\\\\"'),'\"',',\"message\":\"',replace(pipeline().parameters.message,'\"','\\\\\"'),'\"',',\"notificationTime\":\"',replace(pipeline().parameters.notificationTime,'\"','\\\\\"'),'\"',',\"to\":\"',replace(pipeline().parameters.to,'\"','\\\\\"'),'\"',',\"subject\":\"',replace(pipeline().parameters.subject,'\"','\\\\\"'),'\"','}')",
						"type": "Expression"
					}
				}
			},
			{
				"name": "Invoke_Email_LogicApp_Url",
				"type": "WebActivity",
				"dependsOn": [
					{
						"activity": "Set_Email_JSON_Schema",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"method": "POST",
					"headers": {
						"Content-Type": "application/json"
					},
					"url": {
						"value": "@pipeline().globalParameters.GP_EmailLogicAppUrl",
						"type": "Expression"
					},
					"body": {
						"value": "@json(variables('emailPayload'))",
						"type": "Expression"
					}
				}
			}
		],
		"parameters": {
			"subscription": {
				"type": "string",
				"defaultValue": "f2330f9f-3a8b-498c-a2d6-476e4f263349"
			},
			"resourceGroup": {
				"type": "string",
				"defaultValue": "afi-edme-rg"
			},
			"dataFactoryName": {
				"type": "string",
				"defaultValue": "afi-edme-dev-df"
			},
			"runId": {
				"type": "string",
				"defaultValue": "baf47fc5-8017-420c-aa80-bf8881cbe9bd"
			},
			"name": {
				"type": "string",
				"defaultValue": "pl_Retail_Corporate_Store_Incremental_EDW"
			},
			"status": {
				"type": "string",
				"defaultValue": "Success"
			},
			"triggerTime": {
				"type": "string",
				"defaultValue": "11/18/2025 06:20:36"
			},
			"executionEndTime": {
				"type": "string",
				"defaultValue": "11/18/2025 06:21:27"
			},
			"runDuration": {
				"type": "string",
				"defaultValue": "51"
			},
			"message": {
				"type": "string",
				"defaultValue": "Store CDC: 1 new stores, 0 updated stores"
			},
			"notificationTime": {
				"type": "string",
				"defaultValue": "11/18/2025 06:21:28"
			},
			"to": {
				"type": "string",
				"defaultValue": "gkalidass@ashleyfurniture.com"
			},
			"subject": {
				"type": "string",
				"defaultValue": "Pipeline execution alert â€“ pl_Retail_Corporate_Store_Incremental_EDW"
			},
			"Email_Logicapp_URL": {
				"type": "string"
			}
		},
		"variables": {
			"emailPayload": {
				"type": "String"
			}
		},
		"folder": {
			"name": "Notifications"
		},
		"annotations": []
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}